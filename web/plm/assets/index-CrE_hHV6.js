import{e as hT,f as mR,r as P,g as gR,R as Pn,u as Ni,h as xR,i as Xp,O as fx,j as td,k as yR,N as By,l as vR}from"./vendor-react-Bcg5RD6B.js";import{r as _R,_ as Me,c as bR,l as SR,g as MR,a as wR,t as Gs,C as Qi,u as CR,b as Ml,d as Wa,e as Vc,f as TR,h as Qn,i as lt,j as jR,k as ER,m as pT,n as he,o as AR,p as mT,R as RR,v as qc,q as Op,s as Oo,S as tn,w as gT,x as DR,y as IR,z as mn,A as Gc,B as OR,M as PR,D as LR,L as wl,P as NR,E as Au,F as FR,G as gv,T as rn,H as Pi,I as Be,J as zR,K as kR,N as xT,O as ci,Q as xv,U as Gr,V as yT,W as zo,X as vT,Y as Gu,Z as _T,$ as yv,a0 as bT,a1 as ST,a2 as MT,a3 as Ps,a4 as Pp,a5 as wT,a6 as Lp,a7 as Iu,a8 as Cl,a9 as BR,aa as UR,ab as Np,ac as Ls,ad as Oi,ae as $1,af as wi,ag as CT,ah as An,ai as me,aj as Mt,ak as J,al as HR,am as kr,an as ni,ao as na,ap as ra,aq as wa,ar as _e,as as Ii,at as ft,au as Mi,av as er,aw as VR,ax as Xe,ay as Ya,az as ee,aA as Nt,aB as Pe,aC as qa,aD as Yt,aE as sn,aF as $u,aG as Tl,aH as rr,aI as TT,aJ as Bn,aK as jT,aL as Zn,aM as pa,aN as qR,aO as Br,aP as Ru,aQ as No,aR as Ur,aS as ET,aT as Wu,aU as Fp,aV as AT,aW as Uy,aX as W1,aY as Il,aZ as en,a_ as gi,a$ as zp,b0 as GR,b1 as RT,b2 as Hy,b3 as DT,b4 as Zi,b5 as Li,b6 as Yu,b7 as $r,b8 as Fc,b9 as IT,ba as OT,bb as $R,bc as Ol,bd as pe,be as Ws,bf as PT,bg as WR,bh as nd,bi as vp,bj as hx,bk as Ka,bl as YR,bm as Y1,bn as KR,bo as Qp,bp as XR,bq as QR,br as ZR,bs as JR,bt as e3,bu as t3,bv as n3,bw as i3,bx as a3,by as s3,bz as r3,bA as o3,bB as l3,bC as c3,bD as vv,bE as LT,bF as Vy,bG as d3,bH as u3,bI as f3,bJ as qy,bK as h3,bL as p3,bM as m3,bN as g3,bO as NT,bP as x3,bQ as FT}from"./vendor-antd-B0Frx3GD.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();var px={exports:{}},Kd={};var K1;function y3(){if(K1)return Kd;K1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,o,l){var d=null;if(l!==void 0&&(d=""+l),o.key!==void 0&&(d=""+o.key),"key"in o){l={};for(var u in o)u!=="key"&&(l[u]=o[u])}else l=o;return o=l.ref,{$$typeof:t,type:s,key:d,ref:o!==void 0?o:null,props:l}}return Kd.Fragment=e,Kd.jsx=n,Kd.jsxs=n,Kd}var X1;function v3(){return X1||(X1=1,px.exports=y3()),px.exports}var i=v3(),mx={exports:{}},Xd={},gx={exports:{}},xx={};var Q1;function _3(){return Q1||(Q1=1,(function(t){function e(A,q){var B=A.length;A.push(q);e:for(;0<B;){var W=B-1>>>1,Q=A[W];if(0<o(Q,q))A[W]=q,A[B]=Q,B=W;else break e}}function n(A){return A.length===0?null:A[0]}function s(A){if(A.length===0)return null;var q=A[0],B=A.pop();if(B!==q){A[0]=B;e:for(var W=0,Q=A.length,ne=Q>>>1;W<ne;){var de=2*(W+1)-1,$=A[de],X=de+1,le=A[X];if(0>o($,B))X<Q&&0>o(le,$)?(A[W]=le,A[X]=B,W=X):(A[W]=$,A[de]=B,W=de);else if(X<Q&&0>o(le,B))A[W]=le,A[X]=B,W=X;else break e}}return q}function o(A,q){var B=A.sortIndex-q.sortIndex;return B!==0?B:A.id-q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var d=Date,u=d.now();t.unstable_now=function(){return d.now()-u}}var h=[],p=[],m=1,g=null,v=3,C=!1,b=!1,_=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function N(A){for(var q=n(p);q!==null;){if(q.callback===null)s(p);else if(q.startTime<=A)s(p),q.sortIndex=q.expirationTime,e(h,q);else break;q=n(p)}}function T(A){if(_=!1,N(A),!b)if(n(h)!==null)b=!0,j||(j=!0,V());else{var q=n(p);q!==null&&F(T,q.startTime-A)}}var j=!1,E=-1,R=5,M=-1;function I(){return y?!0:!(t.unstable_now()-M<R)}function z(){if(y=!1,j){var A=t.unstable_now();M=A;var q=!0;try{e:{b=!1,_&&(_=!1,D(E),E=-1),C=!0;var B=v;try{t:{for(N(A),g=n(h);g!==null&&!(g.expirationTime>A&&I());){var W=g.callback;if(typeof W=="function"){g.callback=null,v=g.priorityLevel;var Q=W(g.expirationTime<=A);if(A=t.unstable_now(),typeof Q=="function"){g.callback=Q,N(A),q=!0;break t}g===n(h)&&s(h),N(A)}else s(h);g=n(h)}if(g!==null)q=!0;else{var ne=n(p);ne!==null&&F(T,ne.startTime-A),q=!1}}break e}finally{g=null,v=B,C=!1}q=void 0}}finally{q?V():j=!1}}}var V;if(typeof L=="function")V=function(){L(z)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,k=O.port2;O.port1.onmessage=z,V=function(){k.postMessage(null)}}else V=function(){S(z,0)};function F(A,q){E=S(function(){A(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(A){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var B=v;v=q;try{return A()}finally{v=B}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(A,q){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var B=v;v=A;try{return q()}finally{v=B}},t.unstable_scheduleCallback=function(A,q,B){var W=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?W+B:W):B=W,A){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=B+Q,A={id:m++,callback:q,priorityLevel:A,startTime:B,expirationTime:Q,sortIndex:-1},B>W?(A.sortIndex=B,e(p,A),n(h)===null&&A===n(p)&&(_?(D(E),E=-1):_=!0,F(T,B-W))):(A.sortIndex=Q,e(h,A),b||C||(b=!0,j||(j=!0,V()))),A},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(A){var q=v;return function(){var B=v;v=q;try{return A.apply(this,arguments)}finally{v=B}}}})(xx)),xx}var Z1;function b3(){return Z1||(Z1=1,gx.exports=_3()),gx.exports}var J1;function S3(){if(J1)return Xd;J1=1;var t=b3(),e=hT(),n=mR();function s(a){var r="https://react.dev/errors/"+a;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)r+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var r=a,c=a;if(a.alternate)for(;r.return;)r=r.return;else{a=r;do r=a,(r.flags&4098)!==0&&(c=r.return),a=r.return;while(a)}return r.tag===3?c:null}function d(a){if(a.tag===13){var r=a.memoizedState;if(r===null&&(a=a.alternate,a!==null&&(r=a.memoizedState)),r!==null)return r.dehydrated}return null}function u(a){if(a.tag===31){var r=a.memoizedState;if(r===null&&(a=a.alternate,a!==null&&(r=a.memoizedState)),r!==null)return r.dehydrated}return null}function h(a){if(l(a)!==a)throw Error(s(188))}function p(a){var r=a.alternate;if(!r){if(r=l(a),r===null)throw Error(s(188));return r!==a?null:a}for(var c=a,f=r;;){var x=c.return;if(x===null)break;var w=x.alternate;if(w===null){if(f=x.return,f!==null){c=f;continue}break}if(x.child===w.child){for(w=x.child;w;){if(w===c)return h(x),a;if(w===f)return h(x),r;w=w.sibling}throw Error(s(188))}if(c.return!==f.return)c=x,f=w;else{for(var U=!1,Y=x.child;Y;){if(Y===c){U=!0,c=x,f=w;break}if(Y===f){U=!0,f=x,c=w;break}Y=Y.sibling}if(!U){for(Y=w.child;Y;){if(Y===c){U=!0,c=w,f=x;break}if(Y===f){U=!0,f=w,c=x;break}Y=Y.sibling}if(!U)throw Error(s(189))}}if(c.alternate!==f)throw Error(s(190))}if(c.tag!==3)throw Error(s(188));return c.stateNode.current===c?a:r}function m(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a;for(a=a.child;a!==null;){if(r=m(a),r!==null)return r;a=a.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),L=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function V(a){return a===null||typeof a!="object"?null:(a=z&&a[z]||a["@@iterator"],typeof a=="function"?a:null)}var O=Symbol.for("react.client.reference");function k(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===O?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case _:return"Fragment";case S:return"Profiler";case y:return"StrictMode";case T:return"Suspense";case j:return"SuspenseList";case M:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case b:return"Portal";case L:return a.displayName||"Context";case D:return(a._context.displayName||"Context")+".Consumer";case N:var r=a.render;return a=a.displayName,a||(a=r.displayName||r.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case E:return r=a.displayName||null,r!==null?r:k(a.type)||"Memo";case R:r=a._payload,a=a._init;try{return k(a(r))}catch{}}return null}var F=Array.isArray,A=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},W=[],Q=-1;function ne(a){return{current:a}}function de(a){0>Q||(a.current=W[Q],W[Q]=null,Q--)}function $(a,r){Q++,W[Q]=a.current,a.current=r}var X=ne(null),le=ne(null),oe=ne(null),ue=ne(null);function Ye(a,r){switch($(oe,r),$(le,a),$(X,null),r.nodeType){case 9:case 11:a=(a=r.documentElement)&&(a=a.namespaceURI)?m1(a):0;break;default:if(a=r.tagName,r=r.namespaceURI)r=m1(r),a=g1(r,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}de(X),$(X,a)}function ae(){de(X),de(le),de(oe)}function fe(a){a.memoizedState!==null&&$(ue,a);var r=X.current,c=g1(r,a.type);r!==c&&($(le,a),$(X,c))}function pt(a){le.current===a&&(de(X),de(le)),ue.current===a&&(de(ue),Gd._currentValue=B)}var _t,Se;function $e(a){if(_t===void 0)try{throw Error()}catch(c){var r=c.stack.trim().match(/\n( *(at )?)/);_t=r&&r[1]||"",Se=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_t+a+Se}var jt=!1;function Fe(a,r){if(!a||jt)return"";jt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(r){var Ge=function(){throw Error()};if(Object.defineProperty(Ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ge,[])}catch(Le){var Ie=Le}Reflect.construct(a,[],Ge)}else{try{Ge.call()}catch(Le){Ie=Le}a.call(Ge.prototype)}}else{try{throw Error()}catch(Le){Ie=Le}(Ge=a())&&typeof Ge.catch=="function"&&Ge.catch(function(){})}}catch(Le){if(Le&&Ie&&typeof Le.stack=="string")return[Le.stack,Ie.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=f.DetermineComponentFrameRoot(),U=w[0],Y=w[1];if(U&&Y){var se=U.split(`
`),Ae=Y.split(`
`);for(x=f=0;f<se.length&&!se[f].includes("DetermineComponentFrameRoot");)f++;for(;x<Ae.length&&!Ae[x].includes("DetermineComponentFrameRoot");)x++;if(f===se.length||x===Ae.length)for(f=se.length-1,x=Ae.length-1;1<=f&&0<=x&&se[f]!==Ae[x];)x--;for(;1<=f&&0<=x;f--,x--)if(se[f]!==Ae[x]){if(f!==1||x!==1)do if(f--,x--,0>x||se[f]!==Ae[x]){var ke=`
`+se[f].replace(" at new "," at ");return a.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",a.displayName)),ke}while(1<=f&&0<=x);break}}}finally{jt=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?$e(c):""}function Dt(a,r){switch(a.tag){case 26:case 27:case 5:return $e(a.type);case 16:return $e("Lazy");case 13:return a.child!==r&&r!==null?$e("Suspense Fallback"):$e("Suspense");case 19:return $e("SuspenseList");case 0:case 15:return Fe(a.type,!1);case 11:return Fe(a.type.render,!1);case 1:return Fe(a.type,!0);case 31:return $e("Activity");default:return""}}function te(a){try{var r="",c=null;do r+=Dt(a,c),c=a,a=a.return;while(a);return r}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var bt=Object.prototype.hasOwnProperty,It=t.unstable_scheduleCallback,tt=t.unstable_cancelCallback,nt=t.unstable_shouldYield,G=t.unstable_requestPaint,H=t.unstable_now,ie=t.unstable_getCurrentPriorityLevel,we=t.unstable_ImmediatePriority,Ce=t.unstable_UserBlockingPriority,ge=t.unstable_NormalPriority,je=t.unstable_LowPriority,He=t.unstable_IdlePriority,dt=t.log,gt=t.unstable_setDisableYieldValue,We=null,qe=null;function at(a){if(typeof dt=="function"&&gt(a),qe&&typeof qe.setStrictMode=="function")try{qe.setStrictMode(We,a)}catch{}}var ot=Math.clz32?Math.clz32:re,st=Math.log,it=Math.LN2;function re(a){return a>>>=0,a===0?32:31-(st(a)/it|0)|0}var rt=256,Ze=262144,ht=4194304;function Ke(a){var r=a&42;if(r!==0)return r;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Ue(a,r,c){var f=a.pendingLanes;if(f===0)return 0;var x=0,w=a.suspendedLanes,U=a.pingedLanes;a=a.warmLanes;var Y=f&134217727;return Y!==0?(f=Y&~w,f!==0?x=Ke(f):(U&=Y,U!==0?x=Ke(U):c||(c=Y&~a,c!==0&&(x=Ke(c))))):(Y=f&~w,Y!==0?x=Ke(Y):U!==0?x=Ke(U):c||(c=f&~a,c!==0&&(x=Ke(c)))),x===0?0:r!==0&&r!==x&&(r&w)===0&&(w=x&-x,c=r&-r,w>=c||w===32&&(c&4194048)!==0)?r:x}function Je(a,r){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&r)===0}function ye(a,r){switch(a){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ut(){var a=ht;return ht<<=1,(ht&62914560)===0&&(ht=4194304),a}function Et(a){for(var r=[],c=0;31>c;c++)r.push(a);return r}function si(a,r){a.pendingLanes|=r,r!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function la(a,r,c,f,x,w){var U=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var Y=a.entanglements,se=a.expirationTimes,Ae=a.hiddenUpdates;for(c=U&~c;0<c;){var ke=31-ot(c),Ge=1<<ke;Y[ke]=0,se[ke]=-1;var Ie=Ae[ke];if(Ie!==null)for(Ae[ke]=null,ke=0;ke<Ie.length;ke++){var Le=Ie[ke];Le!==null&&(Le.lane&=-536870913)}c&=~Ge}f!==0&&hs(a,f,0),w!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=w&~(U&~r))}function hs(a,r,c){a.pendingLanes|=r,a.suspendedLanes&=~r;var f=31-ot(r);a.entangledLanes|=r,a.entanglements[f]=a.entanglements[f]|1073741824|c&261930}function or(a,r){var c=a.entangledLanes|=r;for(a=a.entanglements;c;){var f=31-ot(c),x=1<<f;x&r|a[f]&r&&(a[f]|=r),c&=~x}}function be(a,r){var c=r&-r;return c=(c&42)!==0?1:et(c),(c&(a.suspendedLanes|r))!==0?0:c}function et(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ze(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Qe(){var a=q.p;return a!==0?a:(a=window.event,a===void 0?32:k1(a.type))}function Ht(a,r){var c=q.p;try{return q.p=a,r()}finally{q.p=c}}var Gt=Math.random().toString(36).slice(2),dn="__reactFiber$"+Gt,gn="__reactProps$"+Gt,yt="__reactContainer$"+Gt,an="__reactEvents$"+Gt,jn="__reactListeners$"+Gt,Vt="__reactHandles$"+Gt,ca="__reactResources$"+Gt,Ea="__reactMarker$"+Gt;function ps(a){delete a[dn],delete a[gn],delete a[an],delete a[jn],delete a[Vt]}function ms(a){var r=a[dn];if(r)return r;for(var c=a.parentNode;c;){if(r=c[yt]||c[dn]){if(c=r.alternate,r.child!==null||c!==null&&c.child!==null)for(a=M1(a);a!==null;){if(c=a[dn])return c;a=M1(a)}return r}a=c,c=a.parentNode}return null}function gs(a){if(a=a[dn]||a[yt]){var r=a.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return a}return null}function Qr(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a.stateNode;throw Error(s(33))}function da(a){var r=a[ca];return r||(r=a[ca]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function K(a){a[Ea]=!0}var xe=new Set,Oe={};function De(a,r){Te(a,r),Te(a+"Capture",r)}function Te(a,r){for(Oe[a]=r,a=0;a<r.length;a++)xe.add(r[a])}var mt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),St={},xt={};function Ct(a){return bt.call(xt,a)?!0:bt.call(St,a)?!1:mt.test(a)?xt[a]=!0:(St[a]=!0,!1)}function Ot(a,r,c){if(Ct(r))if(c===null)a.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(r);return;case"boolean":var f=r.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(r);return}}a.setAttribute(r,""+c)}}function kt(a,r,c){if(c===null)a.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(r);return}a.setAttribute(r,""+c)}}function Pt(a,r,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(r,c,""+f)}}function Bt(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Mn(a){var r=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Kn(a,r,c){var f=Object.getOwnPropertyDescriptor(a.constructor.prototype,r);if(!a.hasOwnProperty(r)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,w=f.set;return Object.defineProperty(a,r,{configurable:!0,get:function(){return x.call(this)},set:function(U){c=""+U,w.call(this,U)}}),Object.defineProperty(a,r,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(U){c=""+U},stopTracking:function(){a._valueTracker=null,delete a[r]}}}}function qn(a){if(!a._valueTracker){var r=Mn(a)?"checked":"value";a._valueTracker=Kn(a,r,""+a[r])}}function En(a){if(!a)return!1;var r=a._valueTracker;if(!r)return!0;var c=r.getValue(),f="";return a&&(f=Mn(a)?a.checked?"true":"false":a.value),a=f,a!==c?(r.setValue(a),!0):!1}function Ft(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var wn=/[\n"\\]/g;function Wt(a){return a.replace(wn,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Fi(a,r,c,f,x,w,U,Y){a.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?a.type=U:a.removeAttribute("type"),r!=null?U==="number"?(r===0&&a.value===""||a.value!=r)&&(a.value=""+Bt(r)):a.value!==""+Bt(r)&&(a.value=""+Bt(r)):U!=="submit"&&U!=="reset"||a.removeAttribute("value"),r!=null?zi(a,U,Bt(r)):c!=null?zi(a,U,Bt(c)):f!=null&&a.removeAttribute("value"),x==null&&w!=null&&(a.defaultChecked=!!w),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?a.name=""+Bt(Y):a.removeAttribute("name")}function lr(a,r,c,f,x,w,U,Y){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(a.type=w),r!=null||c!=null){if(!(w!=="submit"&&w!=="reset"||r!=null)){qn(a);return}c=c!=null?""+Bt(c):"",r=r!=null?""+Bt(r):c,Y||r===a.value||(a.value=r),a.defaultValue=r}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=Y?a.checked:!!f,a.defaultChecked=!!f,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(a.name=U),qn(a)}function zi(a,r,c){r==="number"&&Ft(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Xa(a,r,c,f){if(a=a.options,r){r={};for(var x=0;x<c.length;x++)r["$"+c[x]]=!0;for(c=0;c<a.length;c++)x=r.hasOwnProperty("$"+a[c].value),a[c].selected!==x&&(a[c].selected=x),x&&f&&(a[c].defaultSelected=!0)}else{for(c=""+Bt(c),r=null,x=0;x<a.length;x++){if(a[x].value===c){a[x].selected=!0,f&&(a[x].defaultSelected=!0);return}r!==null||a[x].disabled||(r=a[x])}r!==null&&(r.selected=!0)}}function Rn(a,r,c){if(r!=null&&(r=""+Bt(r),r!==a.value&&(a.value=r),c==null)){a.defaultValue!==r&&(a.defaultValue=r);return}a.defaultValue=c!=null?""+Bt(c):""}function ki(a,r,c,f){if(r==null){if(f!=null){if(c!=null)throw Error(s(92));if(F(f)){if(1<f.length)throw Error(s(93));f=f[0]}c=f}c==null&&(c=""),r=c}c=Bt(r),a.defaultValue=c,f=a.textContent,f===c&&f!==""&&f!==null&&(a.value=f),qn(a)}function xi(a,r){if(r){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=r;return}}a.textContent=r}var Bi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ui(a,r,c){var f=r.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?a.setProperty(r,""):r==="float"?a.cssFloat="":a[r]="":f?a.setProperty(r,c):typeof c!="number"||c===0||Bi.has(r)?r==="float"?a.cssFloat=c:a[r]=(""+c).trim():a[r]=c+"px"}function Ll(a,r,c){if(r!=null&&typeof r!="object")throw Error(s(62));if(a=a.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||r!=null&&r.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var x in r)f=r[x],r.hasOwnProperty(x)&&c[x]!==f&&Ui(a,x,f)}else for(var w in r)r.hasOwnProperty(w)&&Ui(a,w,r[w])}function xs(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var u2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),f2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ff(a){return f2.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function cr(){}var cm=null;function dm(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Nl=null,Fl=null;function p_(a){var r=gs(a);if(r&&(a=r.stateNode)){var c=a[gn]||null;e:switch(a=r.stateNode,r.type){case"input":if(Fi(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),r=c.name,c.type==="radio"&&r!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Wt(""+r)+'"][type="radio"]'),r=0;r<c.length;r++){var f=c[r];if(f!==a&&f.form===a.form){var x=f[gn]||null;if(!x)throw Error(s(90));Fi(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(r=0;r<c.length;r++)f=c[r],f.form===a.form&&En(f)}break e;case"textarea":Rn(a,c.value,c.defaultValue);break e;case"select":r=c.value,r!=null&&Xa(a,!!c.multiple,r,!1)}}}var um=!1;function m_(a,r,c){if(um)return a(r,c);um=!0;try{var f=a(r);return f}finally{if(um=!1,(Nl!==null||Fl!==null)&&(Jf(),Nl&&(r=Nl,a=Fl,Fl=Nl=null,p_(r),a)))for(r=0;r<a.length;r++)p_(a[r])}}function ld(a,r){var c=a.stateNode;if(c===null)return null;var f=c[gn]||null;if(f===null)return null;c=f[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(s(231,r,typeof c));return c}var dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fm=!1;if(dr)try{var cd={};Object.defineProperty(cd,"passive",{get:function(){fm=!0}}),window.addEventListener("test",cd,cd),window.removeEventListener("test",cd,cd)}catch{fm=!1}var Zr=null,hm=null,hf=null;function g_(){if(hf)return hf;var a,r=hm,c=r.length,f,x="value"in Zr?Zr.value:Zr.textContent,w=x.length;for(a=0;a<c&&r[a]===x[a];a++);var U=c-a;for(f=1;f<=U&&r[c-f]===x[w-f];f++);return hf=x.slice(a,1<f?1-f:void 0)}function pf(a){var r=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&r===13&&(a=13)):a=r,a===10&&(a=13),32<=a||a===13?a:0}function mf(){return!0}function x_(){return!1}function ga(a){function r(c,f,x,w,U){this._reactName=c,this._targetInst=x,this.type=f,this.nativeEvent=w,this.target=U,this.currentTarget=null;for(var Y in a)a.hasOwnProperty(Y)&&(c=a[Y],this[Y]=c?c(w):w[Y]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?mf:x_,this.isPropagationStopped=x_,this}return g(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=mf)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=mf)},persist:function(){},isPersistent:mf}),r}var Uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gf=ga(Uo),dd=g({},Uo,{view:0,detail:0}),h2=ga(dd),pm,mm,ud,xf=g({},dd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xm,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ud&&(ud&&a.type==="mousemove"?(pm=a.screenX-ud.screenX,mm=a.screenY-ud.screenY):mm=pm=0,ud=a),pm)},movementY:function(a){return"movementY"in a?a.movementY:mm}}),y_=ga(xf),p2=g({},xf,{dataTransfer:0}),m2=ga(p2),g2=g({},dd,{relatedTarget:0}),gm=ga(g2),x2=g({},Uo,{animationName:0,elapsedTime:0,pseudoElement:0}),y2=ga(x2),v2=g({},Uo,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),_2=ga(v2),b2=g({},Uo,{data:0}),v_=ga(b2),S2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},w2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function C2(a){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(a):(a=w2[a])?!!r[a]:!1}function xm(){return C2}var T2=g({},dd,{key:function(a){if(a.key){var r=S2[a.key]||a.key;if(r!=="Unidentified")return r}return a.type==="keypress"?(a=pf(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?M2[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xm,charCode:function(a){return a.type==="keypress"?pf(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?pf(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),j2=ga(T2),E2=g({},xf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),__=ga(E2),A2=g({},dd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xm}),R2=ga(A2),D2=g({},Uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),I2=ga(D2),O2=g({},xf,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),P2=ga(O2),L2=g({},Uo,{newState:0,oldState:0}),N2=ga(L2),F2=[9,13,27,32],ym=dr&&"CompositionEvent"in window,fd=null;dr&&"documentMode"in document&&(fd=document.documentMode);var z2=dr&&"TextEvent"in window&&!fd,b_=dr&&(!ym||fd&&8<fd&&11>=fd),S_=" ",M_=!1;function w_(a,r){switch(a){case"keyup":return F2.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C_(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var zl=!1;function k2(a,r){switch(a){case"compositionend":return C_(r);case"keypress":return r.which!==32?null:(M_=!0,S_);case"textInput":return a=r.data,a===S_&&M_?null:a;default:return null}}function B2(a,r){if(zl)return a==="compositionend"||!ym&&w_(a,r)?(a=g_(),hf=hm=Zr=null,zl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return b_&&r.locale!=="ko"?null:r.data;default:return null}}var U2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function T_(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r==="input"?!!U2[a.type]:r==="textarea"}function j_(a,r,c,f){Nl?Fl?Fl.push(f):Fl=[f]:Nl=f,r=rh(r,"onChange"),0<r.length&&(c=new gf("onChange","change",null,c,f),a.push({event:c,listeners:r}))}var hd=null,pd=null;function H2(a){c1(a,0)}function yf(a){var r=Qr(a);if(En(r))return a}function E_(a,r){if(a==="change")return r}var A_=!1;if(dr){var vm;if(dr){var _m="oninput"in document;if(!_m){var R_=document.createElement("div");R_.setAttribute("oninput","return;"),_m=typeof R_.oninput=="function"}vm=_m}else vm=!1;A_=vm&&(!document.documentMode||9<document.documentMode)}function D_(){hd&&(hd.detachEvent("onpropertychange",I_),pd=hd=null)}function I_(a){if(a.propertyName==="value"&&yf(pd)){var r=[];j_(r,pd,a,dm(a)),m_(H2,r)}}function V2(a,r,c){a==="focusin"?(D_(),hd=r,pd=c,hd.attachEvent("onpropertychange",I_)):a==="focusout"&&D_()}function q2(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return yf(pd)}function G2(a,r){if(a==="click")return yf(r)}function $2(a,r){if(a==="input"||a==="change")return yf(r)}function W2(a,r){return a===r&&(a!==0||1/a===1/r)||a!==a&&r!==r}var Aa=typeof Object.is=="function"?Object.is:W2;function md(a,r){if(Aa(a,r))return!0;if(typeof a!="object"||a===null||typeof r!="object"||r===null)return!1;var c=Object.keys(a),f=Object.keys(r);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var x=c[f];if(!bt.call(r,x)||!Aa(a[x],r[x]))return!1}return!0}function O_(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function P_(a,r){var c=O_(a);a=0;for(var f;c;){if(c.nodeType===3){if(f=a+c.textContent.length,a<=r&&f>=r)return{node:c,offset:r-a};a=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=O_(c)}}function L_(a,r){return a&&r?a===r?!0:a&&a.nodeType===3?!1:r&&r.nodeType===3?L_(a,r.parentNode):"contains"in a?a.contains(r):a.compareDocumentPosition?!!(a.compareDocumentPosition(r)&16):!1:!1}function N_(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var r=Ft(a.document);r instanceof a.HTMLIFrameElement;){try{var c=typeof r.contentWindow.location.href=="string"}catch{c=!1}if(c)a=r.contentWindow;else break;r=Ft(a.document)}return r}function bm(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r&&(r==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||r==="textarea"||a.contentEditable==="true")}var Y2=dr&&"documentMode"in document&&11>=document.documentMode,kl=null,Sm=null,gd=null,Mm=!1;function F_(a,r,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Mm||kl==null||kl!==Ft(f)||(f=kl,"selectionStart"in f&&bm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),gd&&md(gd,f)||(gd=f,f=rh(Sm,"onSelect"),0<f.length&&(r=new gf("onSelect","select",null,r,c),a.push({event:r,listeners:f}),r.target=kl)))}function Ho(a,r){var c={};return c[a.toLowerCase()]=r.toLowerCase(),c["Webkit"+a]="webkit"+r,c["Moz"+a]="moz"+r,c}var Bl={animationend:Ho("Animation","AnimationEnd"),animationiteration:Ho("Animation","AnimationIteration"),animationstart:Ho("Animation","AnimationStart"),transitionrun:Ho("Transition","TransitionRun"),transitionstart:Ho("Transition","TransitionStart"),transitioncancel:Ho("Transition","TransitionCancel"),transitionend:Ho("Transition","TransitionEnd")},wm={},z_={};dr&&(z_=document.createElement("div").style,"AnimationEvent"in window||(delete Bl.animationend.animation,delete Bl.animationiteration.animation,delete Bl.animationstart.animation),"TransitionEvent"in window||delete Bl.transitionend.transition);function Vo(a){if(wm[a])return wm[a];if(!Bl[a])return a;var r=Bl[a],c;for(c in r)if(r.hasOwnProperty(c)&&c in z_)return wm[a]=r[c];return a}var k_=Vo("animationend"),B_=Vo("animationiteration"),U_=Vo("animationstart"),K2=Vo("transitionrun"),X2=Vo("transitionstart"),Q2=Vo("transitioncancel"),H_=Vo("transitionend"),V_=new Map,Cm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cm.push("scrollEnd");function ys(a,r){V_.set(a,r),De(r,[a])}var vf=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Qa=[],Ul=0,Tm=0;function _f(){for(var a=Ul,r=Tm=Ul=0;r<a;){var c=Qa[r];Qa[r++]=null;var f=Qa[r];Qa[r++]=null;var x=Qa[r];Qa[r++]=null;var w=Qa[r];if(Qa[r++]=null,f!==null&&x!==null){var U=f.pending;U===null?x.next=x:(x.next=U.next,U.next=x),f.pending=x}w!==0&&q_(c,x,w)}}function bf(a,r,c,f){Qa[Ul++]=a,Qa[Ul++]=r,Qa[Ul++]=c,Qa[Ul++]=f,Tm|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function jm(a,r,c,f){return bf(a,r,c,f),Sf(a)}function qo(a,r){return bf(a,null,null,r),Sf(a)}function q_(a,r,c){a.lanes|=c;var f=a.alternate;f!==null&&(f.lanes|=c);for(var x=!1,w=a.return;w!==null;)w.childLanes|=c,f=w.alternate,f!==null&&(f.childLanes|=c),w.tag===22&&(a=w.stateNode,a===null||a._visibility&1||(x=!0)),a=w,w=w.return;return a.tag===3?(w=a.stateNode,x&&r!==null&&(x=31-ot(c),a=w.hiddenUpdates,f=a[x],f===null?a[x]=[r]:f.push(r),r.lane=c|536870912),w):null}function Sf(a){if(50<zd)throw zd=0,Ng=null,Error(s(185));for(var r=a.return;r!==null;)a=r,r=a.return;return a.tag===3?a.stateNode:null}var Hl={};function Z2(a,r,c,f){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ra(a,r,c,f){return new Z2(a,r,c,f)}function Em(a){return a=a.prototype,!(!a||!a.isReactComponent)}function ur(a,r){var c=a.alternate;return c===null?(c=Ra(a.tag,r,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=r,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,r=a.dependencies,c.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function G_(a,r){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=r,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,r=c.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),a}function Mf(a,r,c,f,x,w){var U=0;if(f=a,typeof a=="function")Em(a)&&(U=1);else if(typeof a=="string")U=iR(a,c,X.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case M:return a=Ra(31,c,r,x),a.elementType=M,a.lanes=w,a;case _:return Go(c.children,x,w,r);case y:U=8,x|=24;break;case S:return a=Ra(12,c,r,x|2),a.elementType=S,a.lanes=w,a;case T:return a=Ra(13,c,r,x),a.elementType=T,a.lanes=w,a;case j:return a=Ra(19,c,r,x),a.elementType=j,a.lanes=w,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case L:U=10;break e;case D:U=9;break e;case N:U=11;break e;case E:U=14;break e;case R:U=16,f=null;break e}U=29,c=Error(s(130,a===null?"null":typeof a,"")),f=null}return r=Ra(U,c,r,x),r.elementType=a,r.type=f,r.lanes=w,r}function Go(a,r,c,f){return a=Ra(7,a,f,r),a.lanes=c,a}function Am(a,r,c){return a=Ra(6,a,null,r),a.lanes=c,a}function $_(a){var r=Ra(18,null,null,0);return r.stateNode=a,r}function Rm(a,r,c){return r=Ra(4,a.children!==null?a.children:[],a.key,r),r.lanes=c,r.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},r}var W_=new WeakMap;function Za(a,r){if(typeof a=="object"&&a!==null){var c=W_.get(a);return c!==void 0?c:(r={value:a,source:r,stack:te(r)},W_.set(a,r),r)}return{value:a,source:r,stack:te(r)}}var Vl=[],ql=0,wf=null,xd=0,Ja=[],es=0,Jr=null,zs=1,ks="";function fr(a,r){Vl[ql++]=xd,Vl[ql++]=wf,wf=a,xd=r}function Y_(a,r,c){Ja[es++]=zs,Ja[es++]=ks,Ja[es++]=Jr,Jr=a;var f=zs;a=ks;var x=32-ot(f)-1;f&=~(1<<x),c+=1;var w=32-ot(r)+x;if(30<w){var U=x-x%5;w=(f&(1<<U)-1).toString(32),f>>=U,x-=U,zs=1<<32-ot(r)+x|c<<x|f,ks=w+a}else zs=1<<w|c<<x|f,ks=a}function Dm(a){a.return!==null&&(fr(a,1),Y_(a,1,0))}function Im(a){for(;a===wf;)wf=Vl[--ql],Vl[ql]=null,xd=Vl[--ql],Vl[ql]=null;for(;a===Jr;)Jr=Ja[--es],Ja[es]=null,ks=Ja[--es],Ja[es]=null,zs=Ja[--es],Ja[es]=null}function K_(a,r){Ja[es++]=zs,Ja[es++]=ks,Ja[es++]=Jr,zs=r.id,ks=r.overflow,Jr=a}var Hi=null,Wn=null,pn=!1,eo=null,ts=!1,Om=Error(s(519));function to(a){var r=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yd(Za(r,a)),Om}function X_(a){var r=a.stateNode,c=a.type,f=a.memoizedProps;switch(r[dn]=a,r[gn]=f,c){case"dialog":ln("cancel",r),ln("close",r);break;case"iframe":case"object":case"embed":ln("load",r);break;case"video":case"audio":for(c=0;c<Bd.length;c++)ln(Bd[c],r);break;case"source":ln("error",r);break;case"img":case"image":case"link":ln("error",r),ln("load",r);break;case"details":ln("toggle",r);break;case"input":ln("invalid",r),lr(r,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":ln("invalid",r);break;case"textarea":ln("invalid",r),ki(r,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||r.textContent===""+c||f.suppressHydrationWarning===!0||h1(r.textContent,c)?(f.popover!=null&&(ln("beforetoggle",r),ln("toggle",r)),f.onScroll!=null&&ln("scroll",r),f.onScrollEnd!=null&&ln("scrollend",r),f.onClick!=null&&(r.onclick=cr),r=!0):r=!1,r||to(a,!0)}function Q_(a){for(Hi=a.return;Hi;)switch(Hi.tag){case 5:case 31:case 13:ts=!1;return;case 27:case 3:ts=!0;return;default:Hi=Hi.return}}function Gl(a){if(a!==Hi)return!1;if(!pn)return Q_(a),pn=!0,!1;var r=a.tag,c;if((c=r!==3&&r!==27)&&((c=r===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||Qg(a.type,a.memoizedProps)),c=!c),c&&Wn&&to(a),Q_(a),r===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(317));Wn=S1(a)}else if(r===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(317));Wn=S1(a)}else r===27?(r=Wn,go(a.type)?(a=nx,nx=null,Wn=a):Wn=r):Wn=Hi?is(a.stateNode.nextSibling):null;return!0}function $o(){Wn=Hi=null,pn=!1}function Pm(){var a=eo;return a!==null&&(_a===null?_a=a:_a.push.apply(_a,a),eo=null),a}function yd(a){eo===null?eo=[a]:eo.push(a)}var Lm=ne(null),Wo=null,hr=null;function no(a,r,c){$(Lm,r._currentValue),r._currentValue=c}function pr(a){a._currentValue=Lm.current,de(Lm)}function Nm(a,r,c){for(;a!==null;){var f=a.alternate;if((a.childLanes&r)!==r?(a.childLanes|=r,f!==null&&(f.childLanes|=r)):f!==null&&(f.childLanes&r)!==r&&(f.childLanes|=r),a===c)break;a=a.return}}function Fm(a,r,c,f){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var w=x.dependencies;if(w!==null){var U=x.child;w=w.firstContext;e:for(;w!==null;){var Y=w;w=x;for(var se=0;se<r.length;se++)if(Y.context===r[se]){w.lanes|=c,Y=w.alternate,Y!==null&&(Y.lanes|=c),Nm(w.return,c,a),f||(U=null);break e}w=Y.next}}else if(x.tag===18){if(U=x.return,U===null)throw Error(s(341));U.lanes|=c,w=U.alternate,w!==null&&(w.lanes|=c),Nm(U,c,a),U=null}else U=x.child;if(U!==null)U.return=x;else for(U=x;U!==null;){if(U===a){U=null;break}if(x=U.sibling,x!==null){x.return=U.return,U=x;break}U=U.return}x=U}}function $l(a,r,c,f){a=null;for(var x=r,w=!1;x!==null;){if(!w){if((x.flags&524288)!==0)w=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var U=x.alternate;if(U===null)throw Error(s(387));if(U=U.memoizedProps,U!==null){var Y=x.type;Aa(x.pendingProps.value,U.value)||(a!==null?a.push(Y):a=[Y])}}else if(x===ue.current){if(U=x.alternate,U===null)throw Error(s(387));U.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(Gd):a=[Gd])}x=x.return}a!==null&&Fm(r,a,c,f),r.flags|=262144}function Cf(a){for(a=a.firstContext;a!==null;){if(!Aa(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Yo(a){Wo=a,hr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Vi(a){return Z_(Wo,a)}function Tf(a,r){return Wo===null&&Yo(a),Z_(a,r)}function Z_(a,r){var c=r._currentValue;if(r={context:r,memoizedValue:c,next:null},hr===null){if(a===null)throw Error(s(308));hr=r,a.dependencies={lanes:0,firstContext:r},a.flags|=524288}else hr=hr.next=r;return c}var J2=typeof AbortController<"u"?AbortController:function(){var a=[],r=this.signal={aborted:!1,addEventListener:function(c,f){a.push(f)}};this.abort=function(){r.aborted=!0,a.forEach(function(c){return c()})}},eA=t.unstable_scheduleCallback,tA=t.unstable_NormalPriority,di={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zm(){return{controller:new J2,data:new Map,refCount:0}}function vd(a){a.refCount--,a.refCount===0&&eA(tA,function(){a.controller.abort()})}var _d=null,km=0,Wl=0,Yl=null;function nA(a,r){if(_d===null){var c=_d=[];km=0,Wl=Hg(),Yl={status:"pending",value:void 0,then:function(f){c.push(f)}}}return km++,r.then(J_,J_),r}function J_(){if(--km===0&&_d!==null){Yl!==null&&(Yl.status="fulfilled");var a=_d;_d=null,Wl=0,Yl=null;for(var r=0;r<a.length;r++)(0,a[r])()}}function iA(a,r){var c=[],f={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return a.then(function(){f.status="fulfilled",f.value=r;for(var x=0;x<c.length;x++)(0,c[x])(r)},function(x){for(f.status="rejected",f.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),f}var eb=A.S;A.S=function(a,r){FS=H(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&nA(a,r),eb!==null&&eb(a,r)};var Ko=ne(null);function Bm(){var a=Ko.current;return a!==null?a:Un.pooledCache}function jf(a,r){r===null?$(Ko,Ko.current):$(Ko,r.pool)}function tb(){var a=Bm();return a===null?null:{parent:di._currentValue,pool:a}}var Kl=Error(s(460)),Um=Error(s(474)),Ef=Error(s(542)),Af={then:function(){}};function nb(a){return a=a.status,a==="fulfilled"||a==="rejected"}function ib(a,r,c){switch(c=a[c],c===void 0?a.push(r):c!==r&&(r.then(cr,cr),r=c),r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,sb(a),a;default:if(typeof r.status=="string")r.then(cr,cr);else{if(a=Un,a!==null&&100<a.shellSuspendCounter)throw Error(s(482));a=r,a.status="pending",a.then(function(f){if(r.status==="pending"){var x=r;x.status="fulfilled",x.value=f}},function(f){if(r.status==="pending"){var x=r;x.status="rejected",x.reason=f}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,sb(a),a}throw Qo=r,Kl}}function Xo(a){try{var r=a._init;return r(a._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Qo=c,Kl):c}}var Qo=null;function ab(){if(Qo===null)throw Error(s(459));var a=Qo;return Qo=null,a}function sb(a){if(a===Kl||a===Ef)throw Error(s(483))}var Xl=null,bd=0;function Rf(a){var r=bd;return bd+=1,Xl===null&&(Xl=[]),ib(Xl,a,r)}function Sd(a,r){r=r.props.ref,a.ref=r!==void 0?r:null}function Df(a,r){throw r.$$typeof===v?Error(s(525)):(a=Object.prototype.toString.call(r),Error(s(31,a==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":a)))}function rb(a){function r(ve,ce){if(a){var Ee=ve.deletions;Ee===null?(ve.deletions=[ce],ve.flags|=16):Ee.push(ce)}}function c(ve,ce){if(!a)return null;for(;ce!==null;)r(ve,ce),ce=ce.sibling;return null}function f(ve){for(var ce=new Map;ve!==null;)ve.key!==null?ce.set(ve.key,ve):ce.set(ve.index,ve),ve=ve.sibling;return ce}function x(ve,ce){return ve=ur(ve,ce),ve.index=0,ve.sibling=null,ve}function w(ve,ce,Ee){return ve.index=Ee,a?(Ee=ve.alternate,Ee!==null?(Ee=Ee.index,Ee<ce?(ve.flags|=67108866,ce):Ee):(ve.flags|=67108866,ce)):(ve.flags|=1048576,ce)}function U(ve){return a&&ve.alternate===null&&(ve.flags|=67108866),ve}function Y(ve,ce,Ee,Ve){return ce===null||ce.tag!==6?(ce=Am(Ee,ve.mode,Ve),ce.return=ve,ce):(ce=x(ce,Ee),ce.return=ve,ce)}function se(ve,ce,Ee,Ve){var zt=Ee.type;return zt===_?ke(ve,ce,Ee.props.children,Ve,Ee.key):ce!==null&&(ce.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===R&&Xo(zt)===ce.type)?(ce=x(ce,Ee.props),Sd(ce,Ee),ce.return=ve,ce):(ce=Mf(Ee.type,Ee.key,Ee.props,null,ve.mode,Ve),Sd(ce,Ee),ce.return=ve,ce)}function Ae(ve,ce,Ee,Ve){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==Ee.containerInfo||ce.stateNode.implementation!==Ee.implementation?(ce=Rm(Ee,ve.mode,Ve),ce.return=ve,ce):(ce=x(ce,Ee.children||[]),ce.return=ve,ce)}function ke(ve,ce,Ee,Ve,zt){return ce===null||ce.tag!==7?(ce=Go(Ee,ve.mode,Ve,zt),ce.return=ve,ce):(ce=x(ce,Ee),ce.return=ve,ce)}function Ge(ve,ce,Ee){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=Am(""+ce,ve.mode,Ee),ce.return=ve,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case C:return Ee=Mf(ce.type,ce.key,ce.props,null,ve.mode,Ee),Sd(Ee,ce),Ee.return=ve,Ee;case b:return ce=Rm(ce,ve.mode,Ee),ce.return=ve,ce;case R:return ce=Xo(ce),Ge(ve,ce,Ee)}if(F(ce)||V(ce))return ce=Go(ce,ve.mode,Ee,null),ce.return=ve,ce;if(typeof ce.then=="function")return Ge(ve,Rf(ce),Ee);if(ce.$$typeof===L)return Ge(ve,Tf(ve,ce),Ee);Df(ve,ce)}return null}function Ie(ve,ce,Ee,Ve){var zt=ce!==null?ce.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return zt!==null?null:Y(ve,ce,""+Ee,Ve);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case C:return Ee.key===zt?se(ve,ce,Ee,Ve):null;case b:return Ee.key===zt?Ae(ve,ce,Ee,Ve):null;case R:return Ee=Xo(Ee),Ie(ve,ce,Ee,Ve)}if(F(Ee)||V(Ee))return zt!==null?null:ke(ve,ce,Ee,Ve,null);if(typeof Ee.then=="function")return Ie(ve,ce,Rf(Ee),Ve);if(Ee.$$typeof===L)return Ie(ve,ce,Tf(ve,Ee),Ve);Df(ve,Ee)}return null}function Le(ve,ce,Ee,Ve,zt){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint")return ve=ve.get(Ee)||null,Y(ce,ve,""+Ve,zt);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case C:return ve=ve.get(Ve.key===null?Ee:Ve.key)||null,se(ce,ve,Ve,zt);case b:return ve=ve.get(Ve.key===null?Ee:Ve.key)||null,Ae(ce,ve,Ve,zt);case R:return Ve=Xo(Ve),Le(ve,ce,Ee,Ve,zt)}if(F(Ve)||V(Ve))return ve=ve.get(Ee)||null,ke(ce,ve,Ve,zt,null);if(typeof Ve.then=="function")return Le(ve,ce,Ee,Rf(Ve),zt);if(Ve.$$typeof===L)return Le(ve,ce,Ee,Tf(ce,Ve),zt);Df(ce,Ve)}return null}function Tt(ve,ce,Ee,Ve){for(var zt=null,_n=null,Lt=ce,Qt=ce=0,fn=null;Lt!==null&&Qt<Ee.length;Qt++){Lt.index>Qt?(fn=Lt,Lt=null):fn=Lt.sibling;var bn=Ie(ve,Lt,Ee[Qt],Ve);if(bn===null){Lt===null&&(Lt=fn);break}a&&Lt&&bn.alternate===null&&r(ve,Lt),ce=w(bn,ce,Qt),_n===null?zt=bn:_n.sibling=bn,_n=bn,Lt=fn}if(Qt===Ee.length)return c(ve,Lt),pn&&fr(ve,Qt),zt;if(Lt===null){for(;Qt<Ee.length;Qt++)Lt=Ge(ve,Ee[Qt],Ve),Lt!==null&&(ce=w(Lt,ce,Qt),_n===null?zt=Lt:_n.sibling=Lt,_n=Lt);return pn&&fr(ve,Qt),zt}for(Lt=f(Lt);Qt<Ee.length;Qt++)fn=Le(Lt,ve,Qt,Ee[Qt],Ve),fn!==null&&(a&&fn.alternate!==null&&Lt.delete(fn.key===null?Qt:fn.key),ce=w(fn,ce,Qt),_n===null?zt=fn:_n.sibling=fn,_n=fn);return a&&Lt.forEach(function(bo){return r(ve,bo)}),pn&&fr(ve,Qt),zt}function Ut(ve,ce,Ee,Ve){if(Ee==null)throw Error(s(151));for(var zt=null,_n=null,Lt=ce,Qt=ce=0,fn=null,bn=Ee.next();Lt!==null&&!bn.done;Qt++,bn=Ee.next()){Lt.index>Qt?(fn=Lt,Lt=null):fn=Lt.sibling;var bo=Ie(ve,Lt,bn.value,Ve);if(bo===null){Lt===null&&(Lt=fn);break}a&&Lt&&bo.alternate===null&&r(ve,Lt),ce=w(bo,ce,Qt),_n===null?zt=bo:_n.sibling=bo,_n=bo,Lt=fn}if(bn.done)return c(ve,Lt),pn&&fr(ve,Qt),zt;if(Lt===null){for(;!bn.done;Qt++,bn=Ee.next())bn=Ge(ve,bn.value,Ve),bn!==null&&(ce=w(bn,ce,Qt),_n===null?zt=bn:_n.sibling=bn,_n=bn);return pn&&fr(ve,Qt),zt}for(Lt=f(Lt);!bn.done;Qt++,bn=Ee.next())bn=Le(Lt,ve,Qt,bn.value,Ve),bn!==null&&(a&&bn.alternate!==null&&Lt.delete(bn.key===null?Qt:bn.key),ce=w(bn,ce,Qt),_n===null?zt=bn:_n.sibling=bn,_n=bn);return a&&Lt.forEach(function(pR){return r(ve,pR)}),pn&&fr(ve,Qt),zt}function zn(ve,ce,Ee,Ve){if(typeof Ee=="object"&&Ee!==null&&Ee.type===_&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case C:e:{for(var zt=Ee.key;ce!==null;){if(ce.key===zt){if(zt=Ee.type,zt===_){if(ce.tag===7){c(ve,ce.sibling),Ve=x(ce,Ee.props.children),Ve.return=ve,ve=Ve;break e}}else if(ce.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===R&&Xo(zt)===ce.type){c(ve,ce.sibling),Ve=x(ce,Ee.props),Sd(Ve,Ee),Ve.return=ve,ve=Ve;break e}c(ve,ce);break}else r(ve,ce);ce=ce.sibling}Ee.type===_?(Ve=Go(Ee.props.children,ve.mode,Ve,Ee.key),Ve.return=ve,ve=Ve):(Ve=Mf(Ee.type,Ee.key,Ee.props,null,ve.mode,Ve),Sd(Ve,Ee),Ve.return=ve,ve=Ve)}return U(ve);case b:e:{for(zt=Ee.key;ce!==null;){if(ce.key===zt)if(ce.tag===4&&ce.stateNode.containerInfo===Ee.containerInfo&&ce.stateNode.implementation===Ee.implementation){c(ve,ce.sibling),Ve=x(ce,Ee.children||[]),Ve.return=ve,ve=Ve;break e}else{c(ve,ce);break}else r(ve,ce);ce=ce.sibling}Ve=Rm(Ee,ve.mode,Ve),Ve.return=ve,ve=Ve}return U(ve);case R:return Ee=Xo(Ee),zn(ve,ce,Ee,Ve)}if(F(Ee))return Tt(ve,ce,Ee,Ve);if(V(Ee)){if(zt=V(Ee),typeof zt!="function")throw Error(s(150));return Ee=zt.call(Ee),Ut(ve,ce,Ee,Ve)}if(typeof Ee.then=="function")return zn(ve,ce,Rf(Ee),Ve);if(Ee.$$typeof===L)return zn(ve,ce,Tf(ve,Ee),Ve);Df(ve,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint"?(Ee=""+Ee,ce!==null&&ce.tag===6?(c(ve,ce.sibling),Ve=x(ce,Ee),Ve.return=ve,ve=Ve):(c(ve,ce),Ve=Am(Ee,ve.mode,Ve),Ve.return=ve,ve=Ve),U(ve)):c(ve,ce)}return function(ve,ce,Ee,Ve){try{bd=0;var zt=zn(ve,ce,Ee,Ve);return Xl=null,zt}catch(Lt){if(Lt===Kl||Lt===Ef)throw Lt;var _n=Ra(29,Lt,null,ve.mode);return _n.lanes=Ve,_n.return=ve,_n}}}var Zo=rb(!0),ob=rb(!1),io=!1;function Hm(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vm(a,r){a=a.updateQueue,r.updateQueue===a&&(r.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ao(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function so(a,r,c){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(Cn&2)!==0){var x=f.pending;return x===null?r.next=r:(r.next=x.next,x.next=r),f.pending=r,r=Sf(a),q_(a,null,c),r}return bf(a,f,r,c),Sf(a)}function Md(a,r,c){if(r=r.updateQueue,r!==null&&(r=r.shared,(c&4194048)!==0)){var f=r.lanes;f&=a.pendingLanes,c|=f,r.lanes=c,or(a,c)}}function qm(a,r){var c=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var x=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var U={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};w===null?x=w=U:w=w.next=U,c=c.next}while(c!==null);w===null?x=w=r:w=w.next=r}else x=w=r;c={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:w,shared:f.shared,callbacks:f.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=r:a.next=r,c.lastBaseUpdate=r}var Gm=!1;function wd(){if(Gm){var a=Yl;if(a!==null)throw a}}function Cd(a,r,c,f){Gm=!1;var x=a.updateQueue;io=!1;var w=x.firstBaseUpdate,U=x.lastBaseUpdate,Y=x.shared.pending;if(Y!==null){x.shared.pending=null;var se=Y,Ae=se.next;se.next=null,U===null?w=Ae:U.next=Ae,U=se;var ke=a.alternate;ke!==null&&(ke=ke.updateQueue,Y=ke.lastBaseUpdate,Y!==U&&(Y===null?ke.firstBaseUpdate=Ae:Y.next=Ae,ke.lastBaseUpdate=se))}if(w!==null){var Ge=x.baseState;U=0,ke=Ae=se=null,Y=w;do{var Ie=Y.lane&-536870913,Le=Ie!==Y.lane;if(Le?(un&Ie)===Ie:(f&Ie)===Ie){Ie!==0&&Ie===Wl&&(Gm=!0),ke!==null&&(ke=ke.next={lane:0,tag:Y.tag,payload:Y.payload,callback:null,next:null});e:{var Tt=a,Ut=Y;Ie=r;var zn=c;switch(Ut.tag){case 1:if(Tt=Ut.payload,typeof Tt=="function"){Ge=Tt.call(zn,Ge,Ie);break e}Ge=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Ut.payload,Ie=typeof Tt=="function"?Tt.call(zn,Ge,Ie):Tt,Ie==null)break e;Ge=g({},Ge,Ie);break e;case 2:io=!0}}Ie=Y.callback,Ie!==null&&(a.flags|=64,Le&&(a.flags|=8192),Le=x.callbacks,Le===null?x.callbacks=[Ie]:Le.push(Ie))}else Le={lane:Ie,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},ke===null?(Ae=ke=Le,se=Ge):ke=ke.next=Le,U|=Ie;if(Y=Y.next,Y===null){if(Y=x.shared.pending,Y===null)break;Le=Y,Y=Le.next,Le.next=null,x.lastBaseUpdate=Le,x.shared.pending=null}}while(!0);ke===null&&(se=Ge),x.baseState=se,x.firstBaseUpdate=Ae,x.lastBaseUpdate=ke,w===null&&(x.shared.lanes=0),uo|=U,a.lanes=U,a.memoizedState=Ge}}function lb(a,r){if(typeof a!="function")throw Error(s(191,a));a.call(r)}function cb(a,r){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)lb(c[a],r)}var Ql=ne(null),If=ne(0);function db(a,r){a=Mr,$(If,a),$(Ql,r),Mr=a|r.baseLanes}function $m(){$(If,Mr),$(Ql,Ql.current)}function Wm(){Mr=If.current,de(Ql),de(If)}var Da=ne(null),ns=null;function ro(a){var r=a.alternate;$(ri,ri.current&1),$(Da,a),ns===null&&(r===null||Ql.current!==null||r.memoizedState!==null)&&(ns=a)}function Ym(a){$(ri,ri.current),$(Da,a),ns===null&&(ns=a)}function ub(a){a.tag===22?($(ri,ri.current),$(Da,a),ns===null&&(ns=a)):oo()}function oo(){$(ri,ri.current),$(Da,Da.current)}function Ia(a){de(Da),ns===a&&(ns=null),de(ri)}var ri=ne(0);function Of(a){for(var r=a;r!==null;){if(r.tag===13){var c=r.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||ex(c)||tx(c)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var mr=0,Kt=null,Nn=null,ui=null,Pf=!1,Zl=!1,Jo=!1,Lf=0,Td=0,Jl=null,aA=0;function ei(){throw Error(s(321))}function Km(a,r){if(r===null)return!1;for(var c=0;c<r.length&&c<a.length;c++)if(!Aa(a[c],r[c]))return!1;return!0}function Xm(a,r,c,f,x,w){return mr=w,Kt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,A.H=a===null||a.memoizedState===null?Yb:ug,Jo=!1,w=c(f,x),Jo=!1,Zl&&(w=hb(r,c,f,x)),fb(a),w}function fb(a){A.H=Ad;var r=Nn!==null&&Nn.next!==null;if(mr=0,ui=Nn=Kt=null,Pf=!1,Td=0,Jl=null,r)throw Error(s(300));a===null||fi||(a=a.dependencies,a!==null&&Cf(a)&&(fi=!0))}function hb(a,r,c,f){Kt=a;var x=0;do{if(Zl&&(Jl=null),Td=0,Zl=!1,25<=x)throw Error(s(301));if(x+=1,ui=Nn=null,a.updateQueue!=null){var w=a.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}A.H=Kb,w=r(c,f)}while(Zl);return w}function sA(){var a=A.H,r=a.useState()[0];return r=typeof r.then=="function"?jd(r):r,a=a.useState()[0],(Nn!==null?Nn.memoizedState:null)!==a&&(Kt.flags|=1024),r}function Qm(){var a=Lf!==0;return Lf=0,a}function Zm(a,r,c){r.updateQueue=a.updateQueue,r.flags&=-2053,a.lanes&=~c}function Jm(a){if(Pf){for(a=a.memoizedState;a!==null;){var r=a.queue;r!==null&&(r.pending=null),a=a.next}Pf=!1}mr=0,ui=Nn=Kt=null,Zl=!1,Td=Lf=0,Jl=null}function ua(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ui===null?Kt.memoizedState=ui=a:ui=ui.next=a,ui}function oi(){if(Nn===null){var a=Kt.alternate;a=a!==null?a.memoizedState:null}else a=Nn.next;var r=ui===null?Kt.memoizedState:ui.next;if(r!==null)ui=r,Nn=a;else{if(a===null)throw Kt.alternate===null?Error(s(467)):Error(s(310));Nn=a,a={memoizedState:Nn.memoizedState,baseState:Nn.baseState,baseQueue:Nn.baseQueue,queue:Nn.queue,next:null},ui===null?Kt.memoizedState=ui=a:ui=ui.next=a}return ui}function Nf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jd(a){var r=Td;return Td+=1,Jl===null&&(Jl=[]),a=ib(Jl,a,r),r=Kt,(ui===null?r.memoizedState:ui.next)===null&&(r=r.alternate,A.H=r===null||r.memoizedState===null?Yb:ug),a}function Ff(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return jd(a);if(a.$$typeof===L)return Vi(a)}throw Error(s(438,String(a)))}function eg(a){var r=null,c=Kt.updateQueue;if(c!==null&&(r=c.memoCache),r==null){var f=Kt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(r={data:f.data.map(function(x){return x.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),c===null&&(c=Nf(),Kt.updateQueue=c),c.memoCache=r,c=r.data[r.index],c===void 0)for(c=r.data[r.index]=Array(a),f=0;f<a;f++)c[f]=I;return r.index++,c}function gr(a,r){return typeof r=="function"?r(a):r}function zf(a){var r=oi();return tg(r,Nn,a)}function tg(a,r,c){var f=a.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=c;var x=a.baseQueue,w=f.pending;if(w!==null){if(x!==null){var U=x.next;x.next=w.next,w.next=U}r.baseQueue=x=w,f.pending=null}if(w=a.baseState,x===null)a.memoizedState=w;else{r=x.next;var Y=U=null,se=null,Ae=r,ke=!1;do{var Ge=Ae.lane&-536870913;if(Ge!==Ae.lane?(un&Ge)===Ge:(mr&Ge)===Ge){var Ie=Ae.revertLane;if(Ie===0)se!==null&&(se=se.next={lane:0,revertLane:0,gesture:null,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),Ge===Wl&&(ke=!0);else if((mr&Ie)===Ie){Ae=Ae.next,Ie===Wl&&(ke=!0);continue}else Ge={lane:0,revertLane:Ae.revertLane,gesture:null,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},se===null?(Y=se=Ge,U=w):se=se.next=Ge,Kt.lanes|=Ie,uo|=Ie;Ge=Ae.action,Jo&&c(w,Ge),w=Ae.hasEagerState?Ae.eagerState:c(w,Ge)}else Ie={lane:Ge,revertLane:Ae.revertLane,gesture:Ae.gesture,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},se===null?(Y=se=Ie,U=w):se=se.next=Ie,Kt.lanes|=Ge,uo|=Ge;Ae=Ae.next}while(Ae!==null&&Ae!==r);if(se===null?U=w:se.next=Y,!Aa(w,a.memoizedState)&&(fi=!0,ke&&(c=Yl,c!==null)))throw c;a.memoizedState=w,a.baseState=U,a.baseQueue=se,f.lastRenderedState=w}return x===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function ng(a){var r=oi(),c=r.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=a;var f=c.dispatch,x=c.pending,w=r.memoizedState;if(x!==null){c.pending=null;var U=x=x.next;do w=a(w,U.action),U=U.next;while(U!==x);Aa(w,r.memoizedState)||(fi=!0),r.memoizedState=w,r.baseQueue===null&&(r.baseState=w),c.lastRenderedState=w}return[w,f]}function pb(a,r,c){var f=Kt,x=oi(),w=pn;if(w){if(c===void 0)throw Error(s(407));c=c()}else c=r();var U=!Aa((Nn||x).memoizedState,c);if(U&&(x.memoizedState=c,fi=!0),x=x.queue,sg(xb.bind(null,f,x,a),[a]),x.getSnapshot!==r||U||ui!==null&&ui.memoizedState.tag&1){if(f.flags|=2048,ec(9,{destroy:void 0},gb.bind(null,f,x,c,r),null),Un===null)throw Error(s(349));w||(mr&127)!==0||mb(f,r,c)}return c}function mb(a,r,c){a.flags|=16384,a={getSnapshot:r,value:c},r=Kt.updateQueue,r===null?(r=Nf(),Kt.updateQueue=r,r.stores=[a]):(c=r.stores,c===null?r.stores=[a]:c.push(a))}function gb(a,r,c,f){r.value=c,r.getSnapshot=f,yb(r)&&vb(a)}function xb(a,r,c){return c(function(){yb(r)&&vb(a)})}function yb(a){var r=a.getSnapshot;a=a.value;try{var c=r();return!Aa(a,c)}catch{return!0}}function vb(a){var r=qo(a,2);r!==null&&ba(r,a,2)}function ig(a){var r=ua();if(typeof a=="function"){var c=a;if(a=c(),Jo){at(!0);try{c()}finally{at(!1)}}}return r.memoizedState=r.baseState=a,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:a},r}function _b(a,r,c,f){return a.baseState=c,tg(a,Nn,typeof f=="function"?f:gr)}function rA(a,r,c,f,x){if(Uf(a))throw Error(s(485));if(a=r.action,a!==null){var w={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){w.listeners.push(U)}};A.T!==null?c(!0):w.isTransition=!1,f(w),c=r.pending,c===null?(w.next=r.pending=w,bb(r,w)):(w.next=c.next,r.pending=c.next=w)}}function bb(a,r){var c=r.action,f=r.payload,x=a.state;if(r.isTransition){var w=A.T,U={};A.T=U;try{var Y=c(x,f),se=A.S;se!==null&&se(U,Y),Sb(a,r,Y)}catch(Ae){ag(a,r,Ae)}finally{w!==null&&U.types!==null&&(w.types=U.types),A.T=w}}else try{w=c(x,f),Sb(a,r,w)}catch(Ae){ag(a,r,Ae)}}function Sb(a,r,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Mb(a,r,f)},function(f){return ag(a,r,f)}):Mb(a,r,c)}function Mb(a,r,c){r.status="fulfilled",r.value=c,wb(r),a.state=c,r=a.pending,r!==null&&(c=r.next,c===r?a.pending=null:(c=c.next,r.next=c,bb(a,c)))}function ag(a,r,c){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do r.status="rejected",r.reason=c,wb(r),r=r.next;while(r!==f)}a.action=null}function wb(a){a=a.listeners;for(var r=0;r<a.length;r++)(0,a[r])()}function Cb(a,r){return r}function Tb(a,r){if(pn){var c=Un.formState;if(c!==null){e:{var f=Kt;if(pn){if(Wn){t:{for(var x=Wn,w=ts;x.nodeType!==8;){if(!w){x=null;break t}if(x=is(x.nextSibling),x===null){x=null;break t}}w=x.data,x=w==="F!"||w==="F"?x:null}if(x){Wn=is(x.nextSibling),f=x.data==="F!";break e}}to(f)}f=!1}f&&(r=c[0])}}return c=ua(),c.memoizedState=c.baseState=r,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cb,lastRenderedState:r},c.queue=f,c=Gb.bind(null,Kt,f),f.dispatch=c,f=ig(!1),w=dg.bind(null,Kt,!1,f.queue),f=ua(),x={state:r,dispatch:null,action:a,pending:null},f.queue=x,c=rA.bind(null,Kt,x,w,c),x.dispatch=c,f.memoizedState=a,[r,c,!1]}function jb(a){var r=oi();return Eb(r,Nn,a)}function Eb(a,r,c){if(r=tg(a,r,Cb)[0],a=zf(gr)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var f=jd(r)}catch(U){throw U===Kl?Ef:U}else f=r;r=oi();var x=r.queue,w=x.dispatch;return c!==r.memoizedState&&(Kt.flags|=2048,ec(9,{destroy:void 0},oA.bind(null,x,c),null)),[f,w,a]}function oA(a,r){a.action=r}function Ab(a){var r=oi(),c=Nn;if(c!==null)return Eb(r,c,a);oi(),r=r.memoizedState,c=oi();var f=c.queue.dispatch;return c.memoizedState=a,[r,f,!1]}function ec(a,r,c,f){return a={tag:a,create:c,deps:f,inst:r,next:null},r=Kt.updateQueue,r===null&&(r=Nf(),Kt.updateQueue=r),c=r.lastEffect,c===null?r.lastEffect=a.next=a:(f=c.next,c.next=a,a.next=f,r.lastEffect=a),a}function Rb(){return oi().memoizedState}function kf(a,r,c,f){var x=ua();Kt.flags|=a,x.memoizedState=ec(1|r,{destroy:void 0},c,f===void 0?null:f)}function Bf(a,r,c,f){var x=oi();f=f===void 0?null:f;var w=x.memoizedState.inst;Nn!==null&&f!==null&&Km(f,Nn.memoizedState.deps)?x.memoizedState=ec(r,w,c,f):(Kt.flags|=a,x.memoizedState=ec(1|r,w,c,f))}function Db(a,r){kf(8390656,8,a,r)}function sg(a,r){Bf(2048,8,a,r)}function lA(a){Kt.flags|=4;var r=Kt.updateQueue;if(r===null)r=Nf(),Kt.updateQueue=r,r.events=[a];else{var c=r.events;c===null?r.events=[a]:c.push(a)}}function Ib(a){var r=oi().memoizedState;return lA({ref:r,nextImpl:a}),function(){if((Cn&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}function Ob(a,r){return Bf(4,2,a,r)}function Pb(a,r){return Bf(4,4,a,r)}function Lb(a,r){if(typeof r=="function"){a=a();var c=r(a);return function(){typeof c=="function"?c():r(null)}}if(r!=null)return a=a(),r.current=a,function(){r.current=null}}function Nb(a,r,c){c=c!=null?c.concat([a]):null,Bf(4,4,Lb.bind(null,r,a),c)}function rg(){}function Fb(a,r){var c=oi();r=r===void 0?null:r;var f=c.memoizedState;return r!==null&&Km(r,f[1])?f[0]:(c.memoizedState=[a,r],a)}function zb(a,r){var c=oi();r=r===void 0?null:r;var f=c.memoizedState;if(r!==null&&Km(r,f[1]))return f[0];if(f=a(),Jo){at(!0);try{a()}finally{at(!1)}}return c.memoizedState=[f,r],f}function og(a,r,c){return c===void 0||(mr&1073741824)!==0&&(un&261930)===0?a.memoizedState=r:(a.memoizedState=c,a=kS(),Kt.lanes|=a,uo|=a,c)}function kb(a,r,c,f){return Aa(c,r)?c:Ql.current!==null?(a=og(a,c,f),Aa(a,r)||(fi=!0),a):(mr&42)===0||(mr&1073741824)!==0&&(un&261930)===0?(fi=!0,a.memoizedState=c):(a=kS(),Kt.lanes|=a,uo|=a,r)}function Bb(a,r,c,f,x){var w=q.p;q.p=w!==0&&8>w?w:8;var U=A.T,Y={};A.T=Y,dg(a,!1,r,c);try{var se=x(),Ae=A.S;if(Ae!==null&&Ae(Y,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var ke=iA(se,f);Ed(a,r,ke,La(a))}else Ed(a,r,f,La(a))}catch(Ge){Ed(a,r,{then:function(){},status:"rejected",reason:Ge},La())}finally{q.p=w,U!==null&&Y.types!==null&&(U.types=Y.types),A.T=U}}function cA(){}function lg(a,r,c,f){if(a.tag!==5)throw Error(s(476));var x=Ub(a).queue;Bb(a,x,r,B,c===null?cA:function(){return Hb(a),c(f)})}function Ub(a){var r=a.memoizedState;if(r!==null)return r;r={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:B},next:null};var c={};return r.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:c},next:null},a.memoizedState=r,a=a.alternate,a!==null&&(a.memoizedState=r),r}function Hb(a){var r=Ub(a);r.next===null&&(r=a.alternate.memoizedState),Ed(a,r.next.queue,{},La())}function cg(){return Vi(Gd)}function Vb(){return oi().memoizedState}function qb(){return oi().memoizedState}function dA(a){for(var r=a.return;r!==null;){switch(r.tag){case 24:case 3:var c=La();a=ao(c);var f=so(r,a,c);f!==null&&(ba(f,r,c),Md(f,r,c)),r={cache:zm()},a.payload=r;return}r=r.return}}function uA(a,r,c){var f=La();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Uf(a)?$b(r,c):(c=jm(a,r,c,f),c!==null&&(ba(c,a,f),Wb(c,r,f)))}function Gb(a,r,c){var f=La();Ed(a,r,c,f)}function Ed(a,r,c,f){var x={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Uf(a))$b(r,x);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=r.lastRenderedReducer,w!==null))try{var U=r.lastRenderedState,Y=w(U,c);if(x.hasEagerState=!0,x.eagerState=Y,Aa(Y,U))return bf(a,r,x,0),Un===null&&_f(),!1}catch{}if(c=jm(a,r,x,f),c!==null)return ba(c,a,f),Wb(c,r,f),!0}return!1}function dg(a,r,c,f){if(f={lane:2,revertLane:Hg(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Uf(a)){if(r)throw Error(s(479))}else r=jm(a,c,f,2),r!==null&&ba(r,a,2)}function Uf(a){var r=a.alternate;return a===Kt||r!==null&&r===Kt}function $b(a,r){Zl=Pf=!0;var c=a.pending;c===null?r.next=r:(r.next=c.next,c.next=r),a.pending=r}function Wb(a,r,c){if((c&4194048)!==0){var f=r.lanes;f&=a.pendingLanes,c|=f,r.lanes=c,or(a,c)}}var Ad={readContext:Vi,use:Ff,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useLayoutEffect:ei,useInsertionEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useSyncExternalStore:ei,useId:ei,useHostTransitionStatus:ei,useFormState:ei,useActionState:ei,useOptimistic:ei,useMemoCache:ei,useCacheRefresh:ei};Ad.useEffectEvent=ei;var Yb={readContext:Vi,use:Ff,useCallback:function(a,r){return ua().memoizedState=[a,r===void 0?null:r],a},useContext:Vi,useEffect:Db,useImperativeHandle:function(a,r,c){c=c!=null?c.concat([a]):null,kf(4194308,4,Lb.bind(null,r,a),c)},useLayoutEffect:function(a,r){return kf(4194308,4,a,r)},useInsertionEffect:function(a,r){kf(4,2,a,r)},useMemo:function(a,r){var c=ua();r=r===void 0?null:r;var f=a();if(Jo){at(!0);try{a()}finally{at(!1)}}return c.memoizedState=[f,r],f},useReducer:function(a,r,c){var f=ua();if(c!==void 0){var x=c(r);if(Jo){at(!0);try{c(r)}finally{at(!1)}}}else x=r;return f.memoizedState=f.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},f.queue=a,a=a.dispatch=uA.bind(null,Kt,a),[f.memoizedState,a]},useRef:function(a){var r=ua();return a={current:a},r.memoizedState=a},useState:function(a){a=ig(a);var r=a.queue,c=Gb.bind(null,Kt,r);return r.dispatch=c,[a.memoizedState,c]},useDebugValue:rg,useDeferredValue:function(a,r){var c=ua();return og(c,a,r)},useTransition:function(){var a=ig(!1);return a=Bb.bind(null,Kt,a.queue,!0,!1),ua().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,r,c){var f=Kt,x=ua();if(pn){if(c===void 0)throw Error(s(407));c=c()}else{if(c=r(),Un===null)throw Error(s(349));(un&127)!==0||mb(f,r,c)}x.memoizedState=c;var w={value:c,getSnapshot:r};return x.queue=w,Db(xb.bind(null,f,w,a),[a]),f.flags|=2048,ec(9,{destroy:void 0},gb.bind(null,f,w,c,r),null),c},useId:function(){var a=ua(),r=Un.identifierPrefix;if(pn){var c=ks,f=zs;c=(f&~(1<<32-ot(f)-1)).toString(32)+c,r="_"+r+"R_"+c,c=Lf++,0<c&&(r+="H"+c.toString(32)),r+="_"}else c=aA++,r="_"+r+"r_"+c.toString(32)+"_";return a.memoizedState=r},useHostTransitionStatus:cg,useFormState:Tb,useActionState:Tb,useOptimistic:function(a){var r=ua();r.memoizedState=r.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=c,r=dg.bind(null,Kt,!0,c),c.dispatch=r,[a,r]},useMemoCache:eg,useCacheRefresh:function(){return ua().memoizedState=dA.bind(null,Kt)},useEffectEvent:function(a){var r=ua(),c={impl:a};return r.memoizedState=c,function(){if((Cn&2)!==0)throw Error(s(440));return c.impl.apply(void 0,arguments)}}},ug={readContext:Vi,use:Ff,useCallback:Fb,useContext:Vi,useEffect:sg,useImperativeHandle:Nb,useInsertionEffect:Ob,useLayoutEffect:Pb,useMemo:zb,useReducer:zf,useRef:Rb,useState:function(){return zf(gr)},useDebugValue:rg,useDeferredValue:function(a,r){var c=oi();return kb(c,Nn.memoizedState,a,r)},useTransition:function(){var a=zf(gr)[0],r=oi().memoizedState;return[typeof a=="boolean"?a:jd(a),r]},useSyncExternalStore:pb,useId:Vb,useHostTransitionStatus:cg,useFormState:jb,useActionState:jb,useOptimistic:function(a,r){var c=oi();return _b(c,Nn,a,r)},useMemoCache:eg,useCacheRefresh:qb};ug.useEffectEvent=Ib;var Kb={readContext:Vi,use:Ff,useCallback:Fb,useContext:Vi,useEffect:sg,useImperativeHandle:Nb,useInsertionEffect:Ob,useLayoutEffect:Pb,useMemo:zb,useReducer:ng,useRef:Rb,useState:function(){return ng(gr)},useDebugValue:rg,useDeferredValue:function(a,r){var c=oi();return Nn===null?og(c,a,r):kb(c,Nn.memoizedState,a,r)},useTransition:function(){var a=ng(gr)[0],r=oi().memoizedState;return[typeof a=="boolean"?a:jd(a),r]},useSyncExternalStore:pb,useId:Vb,useHostTransitionStatus:cg,useFormState:Ab,useActionState:Ab,useOptimistic:function(a,r){var c=oi();return Nn!==null?_b(c,Nn,a,r):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:eg,useCacheRefresh:qb};Kb.useEffectEvent=Ib;function fg(a,r,c,f){r=a.memoizedState,c=c(f,r),c=c==null?r:g({},r,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var hg={enqueueSetState:function(a,r,c){a=a._reactInternals;var f=La(),x=ao(f);x.payload=r,c!=null&&(x.callback=c),r=so(a,x,f),r!==null&&(ba(r,a,f),Md(r,a,f))},enqueueReplaceState:function(a,r,c){a=a._reactInternals;var f=La(),x=ao(f);x.tag=1,x.payload=r,c!=null&&(x.callback=c),r=so(a,x,f),r!==null&&(ba(r,a,f),Md(r,a,f))},enqueueForceUpdate:function(a,r){a=a._reactInternals;var c=La(),f=ao(c);f.tag=2,r!=null&&(f.callback=r),r=so(a,f,c),r!==null&&(ba(r,a,c),Md(r,a,c))}};function Xb(a,r,c,f,x,w,U){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,w,U):r.prototype&&r.prototype.isPureReactComponent?!md(c,f)||!md(x,w):!0}function Qb(a,r,c,f){a=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(c,f),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(c,f),r.state!==a&&hg.enqueueReplaceState(r,r.state,null)}function el(a,r){var c=r;if("ref"in r){c={};for(var f in r)f!=="ref"&&(c[f]=r[f])}if(a=a.defaultProps){c===r&&(c=g({},c));for(var x in a)c[x]===void 0&&(c[x]=a[x])}return c}function Zb(a){vf(a)}function Jb(a){console.error(a)}function eS(a){vf(a)}function Hf(a,r){try{var c=a.onUncaughtError;c(r.value,{componentStack:r.stack})}catch(f){setTimeout(function(){throw f})}}function tS(a,r,c){try{var f=a.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function pg(a,r,c){return c=ao(c),c.tag=3,c.payload={element:null},c.callback=function(){Hf(a,r)},c}function nS(a){return a=ao(a),a.tag=3,a}function iS(a,r,c,f){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var w=f.value;a.payload=function(){return x(w)},a.callback=function(){tS(r,c,f)}}var U=c.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(a.callback=function(){tS(r,c,f),typeof x!="function"&&(fo===null?fo=new Set([this]):fo.add(this));var Y=f.stack;this.componentDidCatch(f.value,{componentStack:Y!==null?Y:""})})}function fA(a,r,c,f,x){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(r=c.alternate,r!==null&&$l(r,c,x,!0),c=Da.current,c!==null){switch(c.tag){case 31:case 13:return ns===null?eh():c.alternate===null&&ti===0&&(ti=3),c.flags&=-257,c.flags|=65536,c.lanes=x,f===Af?c.flags|=16384:(r=c.updateQueue,r===null?c.updateQueue=new Set([f]):r.add(f),kg(a,f,x)),!1;case 22:return c.flags|=65536,f===Af?c.flags|=16384:(r=c.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=r):(c=r.retryQueue,c===null?r.retryQueue=new Set([f]):c.add(f)),kg(a,f,x)),!1}throw Error(s(435,c.tag))}return kg(a,f,x),eh(),!1}if(pn)return r=Da.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=x,f!==Om&&(a=Error(s(422),{cause:f}),yd(Za(a,c)))):(f!==Om&&(r=Error(s(423),{cause:f}),yd(Za(r,c))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,f=Za(f,c),x=pg(a.stateNode,f,x),qm(a,x),ti!==4&&(ti=2)),!1;var w=Error(s(520),{cause:f});if(w=Za(w,c),Fd===null?Fd=[w]:Fd.push(w),ti!==4&&(ti=2),r===null)return!0;f=Za(f,c),c=r;do{switch(c.tag){case 3:return c.flags|=65536,a=x&-x,c.lanes|=a,a=pg(c.stateNode,f,a),qm(c,a),!1;case 1:if(r=c.type,w=c.stateNode,(c.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(fo===null||!fo.has(w))))return c.flags|=65536,x&=-x,c.lanes|=x,x=nS(x),iS(x,a,c,f),qm(c,x),!1}c=c.return}while(c!==null);return!1}var mg=Error(s(461)),fi=!1;function qi(a,r,c,f){r.child=a===null?ob(r,null,c,f):Zo(r,a.child,c,f)}function aS(a,r,c,f,x){c=c.render;var w=r.ref;if("ref"in f){var U={};for(var Y in f)Y!=="ref"&&(U[Y]=f[Y])}else U=f;return Yo(r),f=Xm(a,r,c,U,w,x),Y=Qm(),a!==null&&!fi?(Zm(a,r,x),xr(a,r,x)):(pn&&Y&&Dm(r),r.flags|=1,qi(a,r,f,x),r.child)}function sS(a,r,c,f,x){if(a===null){var w=c.type;return typeof w=="function"&&!Em(w)&&w.defaultProps===void 0&&c.compare===null?(r.tag=15,r.type=w,rS(a,r,w,f,x)):(a=Mf(c.type,null,f,r,r.mode,x),a.ref=r.ref,a.return=r,r.child=a)}if(w=a.child,!Mg(a,x)){var U=w.memoizedProps;if(c=c.compare,c=c!==null?c:md,c(U,f)&&a.ref===r.ref)return xr(a,r,x)}return r.flags|=1,a=ur(w,f),a.ref=r.ref,a.return=r,r.child=a}function rS(a,r,c,f,x){if(a!==null){var w=a.memoizedProps;if(md(w,f)&&a.ref===r.ref)if(fi=!1,r.pendingProps=f=w,Mg(a,x))(a.flags&131072)!==0&&(fi=!0);else return r.lanes=a.lanes,xr(a,r,x)}return gg(a,r,c,f,x)}function oS(a,r,c,f){var x=f.children,w=a!==null?a.memoizedState:null;if(a===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((r.flags&128)!==0){if(w=w!==null?w.baseLanes|c:c,a!==null){for(f=r.child=a.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~w}else f=0,r.child=null;return lS(a,r,w,c,f)}if((c&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},a!==null&&jf(r,w!==null?w.cachePool:null),w!==null?db(r,w):$m(),ub(r);else return f=r.lanes=536870912,lS(a,r,w!==null?w.baseLanes|c:c,c,f)}else w!==null?(jf(r,w.cachePool),db(r,w),oo(),r.memoizedState=null):(a!==null&&jf(r,null),$m(),oo());return qi(a,r,x,c),r.child}function Rd(a,r){return a!==null&&a.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function lS(a,r,c,f,x){var w=Bm();return w=w===null?null:{parent:di._currentValue,pool:w},r.memoizedState={baseLanes:c,cachePool:w},a!==null&&jf(r,null),$m(),ub(r),a!==null&&$l(a,r,f,!0),r.childLanes=x,null}function Vf(a,r){return r=Gf({mode:r.mode,children:r.children},a.mode),r.ref=a.ref,a.child=r,r.return=a,r}function cS(a,r,c){return Zo(r,a.child,null,c),a=Vf(r,r.pendingProps),a.flags|=2,Ia(r),r.memoizedState=null,a}function hA(a,r,c){var f=r.pendingProps,x=(r.flags&128)!==0;if(r.flags&=-129,a===null){if(pn){if(f.mode==="hidden")return a=Vf(r,f),r.lanes=536870912,Rd(null,a);if(Ym(r),(a=Wn)?(a=b1(a,ts),a=a!==null&&a.data==="&"?a:null,a!==null&&(r.memoizedState={dehydrated:a,treeContext:Jr!==null?{id:zs,overflow:ks}:null,retryLane:536870912,hydrationErrors:null},c=$_(a),c.return=r,r.child=c,Hi=r,Wn=null)):a=null,a===null)throw to(r);return r.lanes=536870912,null}return Vf(r,f)}var w=a.memoizedState;if(w!==null){var U=w.dehydrated;if(Ym(r),x)if(r.flags&256)r.flags&=-257,r=cS(a,r,c);else if(r.memoizedState!==null)r.child=a.child,r.flags|=128,r=null;else throw Error(s(558));else if(fi||$l(a,r,c,!1),x=(c&a.childLanes)!==0,fi||x){if(f=Un,f!==null&&(U=be(f,c),U!==0&&U!==w.retryLane))throw w.retryLane=U,qo(a,U),ba(f,a,U),mg;eh(),r=cS(a,r,c)}else a=w.treeContext,Wn=is(U.nextSibling),Hi=r,pn=!0,eo=null,ts=!1,a!==null&&K_(r,a),r=Vf(r,f),r.flags|=4096;return r}return a=ur(a.child,{mode:f.mode,children:f.children}),a.ref=r.ref,r.child=a,a.return=r,a}function qf(a,r){var c=r.ref;if(c===null)a!==null&&a.ref!==null&&(r.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(s(284));(a===null||a.ref!==c)&&(r.flags|=4194816)}}function gg(a,r,c,f,x){return Yo(r),c=Xm(a,r,c,f,void 0,x),f=Qm(),a!==null&&!fi?(Zm(a,r,x),xr(a,r,x)):(pn&&f&&Dm(r),r.flags|=1,qi(a,r,c,x),r.child)}function dS(a,r,c,f,x,w){return Yo(r),r.updateQueue=null,c=hb(r,f,c,x),fb(a),f=Qm(),a!==null&&!fi?(Zm(a,r,w),xr(a,r,w)):(pn&&f&&Dm(r),r.flags|=1,qi(a,r,c,w),r.child)}function uS(a,r,c,f,x){if(Yo(r),r.stateNode===null){var w=Hl,U=c.contextType;typeof U=="object"&&U!==null&&(w=Vi(U)),w=new c(f,w),r.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=hg,r.stateNode=w,w._reactInternals=r,w=r.stateNode,w.props=f,w.state=r.memoizedState,w.refs={},Hm(r),U=c.contextType,w.context=typeof U=="object"&&U!==null?Vi(U):Hl,w.state=r.memoizedState,U=c.getDerivedStateFromProps,typeof U=="function"&&(fg(r,c,U,f),w.state=r.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(U=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),U!==w.state&&hg.enqueueReplaceState(w,w.state,null),Cd(r,f,w,x),wd(),w.state=r.memoizedState),typeof w.componentDidMount=="function"&&(r.flags|=4194308),f=!0}else if(a===null){w=r.stateNode;var Y=r.memoizedProps,se=el(c,Y);w.props=se;var Ae=w.context,ke=c.contextType;U=Hl,typeof ke=="object"&&ke!==null&&(U=Vi(ke));var Ge=c.getDerivedStateFromProps;ke=typeof Ge=="function"||typeof w.getSnapshotBeforeUpdate=="function",Y=r.pendingProps!==Y,ke||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(Y||Ae!==U)&&Qb(r,w,f,U),io=!1;var Ie=r.memoizedState;w.state=Ie,Cd(r,f,w,x),wd(),Ae=r.memoizedState,Y||Ie!==Ae||io?(typeof Ge=="function"&&(fg(r,c,Ge,f),Ae=r.memoizedState),(se=io||Xb(r,c,se,f,Ie,Ae,U))?(ke||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(r.flags|=4194308)):(typeof w.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=f,r.memoizedState=Ae),w.props=f,w.state=Ae,w.context=U,f=se):(typeof w.componentDidMount=="function"&&(r.flags|=4194308),f=!1)}else{w=r.stateNode,Vm(a,r),U=r.memoizedProps,ke=el(c,U),w.props=ke,Ge=r.pendingProps,Ie=w.context,Ae=c.contextType,se=Hl,typeof Ae=="object"&&Ae!==null&&(se=Vi(Ae)),Y=c.getDerivedStateFromProps,(Ae=typeof Y=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(U!==Ge||Ie!==se)&&Qb(r,w,f,se),io=!1,Ie=r.memoizedState,w.state=Ie,Cd(r,f,w,x),wd();var Le=r.memoizedState;U!==Ge||Ie!==Le||io||a!==null&&a.dependencies!==null&&Cf(a.dependencies)?(typeof Y=="function"&&(fg(r,c,Y,f),Le=r.memoizedState),(ke=io||Xb(r,c,ke,f,Ie,Le,se)||a!==null&&a.dependencies!==null&&Cf(a.dependencies))?(Ae||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(f,Le,se),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(f,Le,se)),typeof w.componentDidUpdate=="function"&&(r.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof w.componentDidUpdate!="function"||U===a.memoizedProps&&Ie===a.memoizedState||(r.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&Ie===a.memoizedState||(r.flags|=1024),r.memoizedProps=f,r.memoizedState=Le),w.props=f,w.state=Le,w.context=se,f=ke):(typeof w.componentDidUpdate!="function"||U===a.memoizedProps&&Ie===a.memoizedState||(r.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&Ie===a.memoizedState||(r.flags|=1024),f=!1)}return w=f,qf(a,r),f=(r.flags&128)!==0,w||f?(w=r.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:w.render(),r.flags|=1,a!==null&&f?(r.child=Zo(r,a.child,null,x),r.child=Zo(r,null,c,x)):qi(a,r,c,x),r.memoizedState=w.state,a=r.child):a=xr(a,r,x),a}function fS(a,r,c,f){return $o(),r.flags|=256,qi(a,r,c,f),r.child}var xg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yg(a){return{baseLanes:a,cachePool:tb()}}function vg(a,r,c){return a=a!==null?a.childLanes&~c:0,r&&(a|=Pa),a}function hS(a,r,c){var f=r.pendingProps,x=!1,w=(r.flags&128)!==0,U;if((U=w)||(U=a!==null&&a.memoizedState===null?!1:(ri.current&2)!==0),U&&(x=!0,r.flags&=-129),U=(r.flags&32)!==0,r.flags&=-33,a===null){if(pn){if(x?ro(r):oo(),(a=Wn)?(a=b1(a,ts),a=a!==null&&a.data!=="&"?a:null,a!==null&&(r.memoizedState={dehydrated:a,treeContext:Jr!==null?{id:zs,overflow:ks}:null,retryLane:536870912,hydrationErrors:null},c=$_(a),c.return=r,r.child=c,Hi=r,Wn=null)):a=null,a===null)throw to(r);return tx(a)?r.lanes=32:r.lanes=536870912,null}var Y=f.children;return f=f.fallback,x?(oo(),x=r.mode,Y=Gf({mode:"hidden",children:Y},x),f=Go(f,x,c,null),Y.return=r,f.return=r,Y.sibling=f,r.child=Y,f=r.child,f.memoizedState=yg(c),f.childLanes=vg(a,U,c),r.memoizedState=xg,Rd(null,f)):(ro(r),_g(r,Y))}var se=a.memoizedState;if(se!==null&&(Y=se.dehydrated,Y!==null)){if(w)r.flags&256?(ro(r),r.flags&=-257,r=bg(a,r,c)):r.memoizedState!==null?(oo(),r.child=a.child,r.flags|=128,r=null):(oo(),Y=f.fallback,x=r.mode,f=Gf({mode:"visible",children:f.children},x),Y=Go(Y,x,c,null),Y.flags|=2,f.return=r,Y.return=r,f.sibling=Y,r.child=f,Zo(r,a.child,null,c),f=r.child,f.memoizedState=yg(c),f.childLanes=vg(a,U,c),r.memoizedState=xg,r=Rd(null,f));else if(ro(r),tx(Y)){if(U=Y.nextSibling&&Y.nextSibling.dataset,U)var Ae=U.dgst;U=Ae,f=Error(s(419)),f.stack="",f.digest=U,yd({value:f,source:null,stack:null}),r=bg(a,r,c)}else if(fi||$l(a,r,c,!1),U=(c&a.childLanes)!==0,fi||U){if(U=Un,U!==null&&(f=be(U,c),f!==0&&f!==se.retryLane))throw se.retryLane=f,qo(a,f),ba(U,a,f),mg;ex(Y)||eh(),r=bg(a,r,c)}else ex(Y)?(r.flags|=192,r.child=a.child,r=null):(a=se.treeContext,Wn=is(Y.nextSibling),Hi=r,pn=!0,eo=null,ts=!1,a!==null&&K_(r,a),r=_g(r,f.children),r.flags|=4096);return r}return x?(oo(),Y=f.fallback,x=r.mode,se=a.child,Ae=se.sibling,f=ur(se,{mode:"hidden",children:f.children}),f.subtreeFlags=se.subtreeFlags&65011712,Ae!==null?Y=ur(Ae,Y):(Y=Go(Y,x,c,null),Y.flags|=2),Y.return=r,f.return=r,f.sibling=Y,r.child=f,Rd(null,f),f=r.child,Y=a.child.memoizedState,Y===null?Y=yg(c):(x=Y.cachePool,x!==null?(se=di._currentValue,x=x.parent!==se?{parent:se,pool:se}:x):x=tb(),Y={baseLanes:Y.baseLanes|c,cachePool:x}),f.memoizedState=Y,f.childLanes=vg(a,U,c),r.memoizedState=xg,Rd(a.child,f)):(ro(r),c=a.child,a=c.sibling,c=ur(c,{mode:"visible",children:f.children}),c.return=r,c.sibling=null,a!==null&&(U=r.deletions,U===null?(r.deletions=[a],r.flags|=16):U.push(a)),r.child=c,r.memoizedState=null,c)}function _g(a,r){return r=Gf({mode:"visible",children:r},a.mode),r.return=a,a.child=r}function Gf(a,r){return a=Ra(22,a,null,r),a.lanes=0,a}function bg(a,r,c){return Zo(r,a.child,null,c),a=_g(r,r.pendingProps.children),a.flags|=2,r.memoizedState=null,a}function pS(a,r,c){a.lanes|=r;var f=a.alternate;f!==null&&(f.lanes|=r),Nm(a.return,r,c)}function Sg(a,r,c,f,x,w){var U=a.memoizedState;U===null?a.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:x,treeForkCount:w}:(U.isBackwards=r,U.rendering=null,U.renderingStartTime=0,U.last=f,U.tail=c,U.tailMode=x,U.treeForkCount=w)}function mS(a,r,c){var f=r.pendingProps,x=f.revealOrder,w=f.tail;f=f.children;var U=ri.current,Y=(U&2)!==0;if(Y?(U=U&1|2,r.flags|=128):U&=1,$(ri,U),qi(a,r,f,c),f=pn?xd:0,!Y&&a!==null&&(a.flags&128)!==0)e:for(a=r.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&pS(a,c,r);else if(a.tag===19)pS(a,c,r);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(x){case"forwards":for(c=r.child,x=null;c!==null;)a=c.alternate,a!==null&&Of(a)===null&&(x=c),c=c.sibling;c=x,c===null?(x=r.child,r.child=null):(x=c.sibling,c.sibling=null),Sg(r,!1,x,c,w,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,x=r.child,r.child=null;x!==null;){if(a=x.alternate,a!==null&&Of(a)===null){r.child=x;break}a=x.sibling,x.sibling=c,c=x,x=a}Sg(r,!0,c,null,w,f);break;case"together":Sg(r,!1,null,null,void 0,f);break;default:r.memoizedState=null}return r.child}function xr(a,r,c){if(a!==null&&(r.dependencies=a.dependencies),uo|=r.lanes,(c&r.childLanes)===0)if(a!==null){if($l(a,r,c,!1),(c&r.childLanes)===0)return null}else return null;if(a!==null&&r.child!==a.child)throw Error(s(153));if(r.child!==null){for(a=r.child,c=ur(a,a.pendingProps),r.child=c,c.return=r;a.sibling!==null;)a=a.sibling,c=c.sibling=ur(a,a.pendingProps),c.return=r;c.sibling=null}return r.child}function Mg(a,r){return(a.lanes&r)!==0?!0:(a=a.dependencies,!!(a!==null&&Cf(a)))}function pA(a,r,c){switch(r.tag){case 3:Ye(r,r.stateNode.containerInfo),no(r,di,a.memoizedState.cache),$o();break;case 27:case 5:fe(r);break;case 4:Ye(r,r.stateNode.containerInfo);break;case 10:no(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Ym(r),null;break;case 13:var f=r.memoizedState;if(f!==null)return f.dehydrated!==null?(ro(r),r.flags|=128,null):(c&r.child.childLanes)!==0?hS(a,r,c):(ro(r),a=xr(a,r,c),a!==null?a.sibling:null);ro(r);break;case 19:var x=(a.flags&128)!==0;if(f=(c&r.childLanes)!==0,f||($l(a,r,c,!1),f=(c&r.childLanes)!==0),x){if(f)return mS(a,r,c);r.flags|=128}if(x=r.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),$(ri,ri.current),f)break;return null;case 22:return r.lanes=0,oS(a,r,c,r.pendingProps);case 24:no(r,di,a.memoizedState.cache)}return xr(a,r,c)}function gS(a,r,c){if(a!==null)if(a.memoizedProps!==r.pendingProps)fi=!0;else{if(!Mg(a,c)&&(r.flags&128)===0)return fi=!1,pA(a,r,c);fi=(a.flags&131072)!==0}else fi=!1,pn&&(r.flags&1048576)!==0&&Y_(r,xd,r.index);switch(r.lanes=0,r.tag){case 16:e:{var f=r.pendingProps;if(a=Xo(r.elementType),r.type=a,typeof a=="function")Em(a)?(f=el(a,f),r.tag=1,r=uS(null,r,a,f,c)):(r.tag=0,r=gg(null,r,a,f,c));else{if(a!=null){var x=a.$$typeof;if(x===N){r.tag=11,r=aS(null,r,a,f,c);break e}else if(x===E){r.tag=14,r=sS(null,r,a,f,c);break e}}throw r=k(a)||a,Error(s(306,r,""))}}return r;case 0:return gg(a,r,r.type,r.pendingProps,c);case 1:return f=r.type,x=el(f,r.pendingProps),uS(a,r,f,x,c);case 3:e:{if(Ye(r,r.stateNode.containerInfo),a===null)throw Error(s(387));f=r.pendingProps;var w=r.memoizedState;x=w.element,Vm(a,r),Cd(r,f,null,c);var U=r.memoizedState;if(f=U.cache,no(r,di,f),f!==w.cache&&Fm(r,[di],c,!0),wd(),f=U.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:U.cache},r.updateQueue.baseState=w,r.memoizedState=w,r.flags&256){r=fS(a,r,f,c);break e}else if(f!==x){x=Za(Error(s(424)),r),yd(x),r=fS(a,r,f,c);break e}else for(a=r.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,Wn=is(a.firstChild),Hi=r,pn=!0,eo=null,ts=!0,c=ob(r,null,f,c),r.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if($o(),f===x){r=xr(a,r,c);break e}qi(a,r,f,c)}r=r.child}return r;case 26:return qf(a,r),a===null?(c=j1(r.type,null,r.pendingProps,null))?r.memoizedState=c:pn||(c=r.type,a=r.pendingProps,f=oh(oe.current).createElement(c),f[dn]=r,f[gn]=a,Gi(f,c,a),K(f),r.stateNode=f):r.memoizedState=j1(r.type,a.memoizedProps,r.pendingProps,a.memoizedState),null;case 27:return fe(r),a===null&&pn&&(f=r.stateNode=w1(r.type,r.pendingProps,oe.current),Hi=r,ts=!0,x=Wn,go(r.type)?(nx=x,Wn=is(f.firstChild)):Wn=x),qi(a,r,r.pendingProps.children,c),qf(a,r),a===null&&(r.flags|=4194304),r.child;case 5:return a===null&&pn&&((x=f=Wn)&&(f=qA(f,r.type,r.pendingProps,ts),f!==null?(r.stateNode=f,Hi=r,Wn=is(f.firstChild),ts=!1,x=!0):x=!1),x||to(r)),fe(r),x=r.type,w=r.pendingProps,U=a!==null?a.memoizedProps:null,f=w.children,Qg(x,w)?f=null:U!==null&&Qg(x,U)&&(r.flags|=32),r.memoizedState!==null&&(x=Xm(a,r,sA,null,null,c),Gd._currentValue=x),qf(a,r),qi(a,r,f,c),r.child;case 6:return a===null&&pn&&((a=c=Wn)&&(c=GA(c,r.pendingProps,ts),c!==null?(r.stateNode=c,Hi=r,Wn=null,a=!0):a=!1),a||to(r)),null;case 13:return hS(a,r,c);case 4:return Ye(r,r.stateNode.containerInfo),f=r.pendingProps,a===null?r.child=Zo(r,null,f,c):qi(a,r,f,c),r.child;case 11:return aS(a,r,r.type,r.pendingProps,c);case 7:return qi(a,r,r.pendingProps,c),r.child;case 8:return qi(a,r,r.pendingProps.children,c),r.child;case 12:return qi(a,r,r.pendingProps.children,c),r.child;case 10:return f=r.pendingProps,no(r,r.type,f.value),qi(a,r,f.children,c),r.child;case 9:return x=r.type._context,f=r.pendingProps.children,Yo(r),x=Vi(x),f=f(x),r.flags|=1,qi(a,r,f,c),r.child;case 14:return sS(a,r,r.type,r.pendingProps,c);case 15:return rS(a,r,r.type,r.pendingProps,c);case 19:return mS(a,r,c);case 31:return hA(a,r,c);case 22:return oS(a,r,c,r.pendingProps);case 24:return Yo(r),f=Vi(di),a===null?(x=Bm(),x===null&&(x=Un,w=zm(),x.pooledCache=w,w.refCount++,w!==null&&(x.pooledCacheLanes|=c),x=w),r.memoizedState={parent:f,cache:x},Hm(r),no(r,di,x)):((a.lanes&c)!==0&&(Vm(a,r),Cd(r,null,null,c),wd()),x=a.memoizedState,w=r.memoizedState,x.parent!==f?(x={parent:f,cache:f},r.memoizedState=x,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=x),no(r,di,f)):(f=w.cache,no(r,di,f),f!==x.cache&&Fm(r,[di],c,!0))),qi(a,r,r.pendingProps.children,c),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function yr(a){a.flags|=4}function wg(a,r,c,f,x){if((r=(a.mode&32)!==0)&&(r=!1),r){if(a.flags|=16777216,(x&335544128)===x)if(a.stateNode.complete)a.flags|=8192;else if(VS())a.flags|=8192;else throw Qo=Af,Um}else a.flags&=-16777217}function xS(a,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!I1(r))if(VS())a.flags|=8192;else throw Qo=Af,Um}function $f(a,r){r!==null&&(a.flags|=4),a.flags&16384&&(r=a.tag!==22?ut():536870912,a.lanes|=r,ac|=r)}function Dd(a,r){if(!pn)switch(a.tailMode){case"hidden":r=a.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?r||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Yn(a){var r=a.alternate!==null&&a.alternate.child===a.child,c=0,f=0;if(r)for(var x=a.child;x!==null;)c|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)c|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=f,a.childLanes=c,r}function mA(a,r,c){var f=r.pendingProps;switch(Im(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(r),null;case 1:return Yn(r),null;case 3:return c=r.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),r.memoizedState.cache!==f&&(r.flags|=2048),pr(di),ae(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(Gl(r)?yr(r):a===null||a.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Pm())),Yn(r),null;case 26:var x=r.type,w=r.memoizedState;return a===null?(yr(r),w!==null?(Yn(r),xS(r,w)):(Yn(r),wg(r,x,null,f,c))):w?w!==a.memoizedState?(yr(r),Yn(r),xS(r,w)):(Yn(r),r.flags&=-16777217):(a=a.memoizedProps,a!==f&&yr(r),Yn(r),wg(r,x,a,f,c)),null;case 27:if(pt(r),c=oe.current,x=r.type,a!==null&&r.stateNode!=null)a.memoizedProps!==f&&yr(r);else{if(!f){if(r.stateNode===null)throw Error(s(166));return Yn(r),null}a=X.current,Gl(r)?X_(r):(a=w1(x,f,c),r.stateNode=a,yr(r))}return Yn(r),null;case 5:if(pt(r),x=r.type,a!==null&&r.stateNode!=null)a.memoizedProps!==f&&yr(r);else{if(!f){if(r.stateNode===null)throw Error(s(166));return Yn(r),null}if(w=X.current,Gl(r))X_(r);else{var U=oh(oe.current);switch(w){case 1:w=U.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:w=U.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":w=U.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":w=U.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":w=U.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof f.is=="string"?U.createElement("select",{is:f.is}):U.createElement("select"),f.multiple?w.multiple=!0:f.size&&(w.size=f.size);break;default:w=typeof f.is=="string"?U.createElement(x,{is:f.is}):U.createElement(x)}}w[dn]=r,w[gn]=f;e:for(U=r.child;U!==null;){if(U.tag===5||U.tag===6)w.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===r)break e;for(;U.sibling===null;){if(U.return===null||U.return===r)break e;U=U.return}U.sibling.return=U.return,U=U.sibling}r.stateNode=w;e:switch(Gi(w,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&yr(r)}}return Yn(r),wg(r,r.type,a===null?null:a.memoizedProps,r.pendingProps,c),null;case 6:if(a&&r.stateNode!=null)a.memoizedProps!==f&&yr(r);else{if(typeof f!="string"&&r.stateNode===null)throw Error(s(166));if(a=oe.current,Gl(r)){if(a=r.stateNode,c=r.memoizedProps,f=null,x=Hi,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}a[dn]=r,a=!!(a.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||h1(a.nodeValue,c)),a||to(r,!0)}else a=oh(a).createTextNode(f),a[dn]=r,r.stateNode=a}return Yn(r),null;case 31:if(c=r.memoizedState,a===null||a.memoizedState!==null){if(f=Gl(r),c!==null){if(a===null){if(!f)throw Error(s(318));if(a=r.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(557));a[dn]=r}else $o(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Yn(r),a=!1}else c=Pm(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=c),a=!0;if(!a)return r.flags&256?(Ia(r),r):(Ia(r),null);if((r.flags&128)!==0)throw Error(s(558))}return Yn(r),null;case 13:if(f=r.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=Gl(r),f!==null&&f.dehydrated!==null){if(a===null){if(!x)throw Error(s(318));if(x=r.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(s(317));x[dn]=r}else $o(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Yn(r),x=!1}else x=Pm(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return r.flags&256?(Ia(r),r):(Ia(r),null)}return Ia(r),(r.flags&128)!==0?(r.lanes=c,r):(c=f!==null,a=a!==null&&a.memoizedState!==null,c&&(f=r.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),w=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(w=f.memoizedState.cachePool.pool),w!==x&&(f.flags|=2048)),c!==a&&c&&(r.child.flags|=8192),$f(r,r.updateQueue),Yn(r),null);case 4:return ae(),a===null&&$g(r.stateNode.containerInfo),Yn(r),null;case 10:return pr(r.type),Yn(r),null;case 19:if(de(ri),f=r.memoizedState,f===null)return Yn(r),null;if(x=(r.flags&128)!==0,w=f.rendering,w===null)if(x)Dd(f,!1);else{if(ti!==0||a!==null&&(a.flags&128)!==0)for(a=r.child;a!==null;){if(w=Of(a),w!==null){for(r.flags|=128,Dd(f,!1),a=w.updateQueue,r.updateQueue=a,$f(r,a),r.subtreeFlags=0,a=c,c=r.child;c!==null;)G_(c,a),c=c.sibling;return $(ri,ri.current&1|2),pn&&fr(r,f.treeForkCount),r.child}a=a.sibling}f.tail!==null&&H()>Qf&&(r.flags|=128,x=!0,Dd(f,!1),r.lanes=4194304)}else{if(!x)if(a=Of(w),a!==null){if(r.flags|=128,x=!0,a=a.updateQueue,r.updateQueue=a,$f(r,a),Dd(f,!0),f.tail===null&&f.tailMode==="hidden"&&!w.alternate&&!pn)return Yn(r),null}else 2*H()-f.renderingStartTime>Qf&&c!==536870912&&(r.flags|=128,x=!0,Dd(f,!1),r.lanes=4194304);f.isBackwards?(w.sibling=r.child,r.child=w):(a=f.last,a!==null?a.sibling=w:r.child=w,f.last=w)}return f.tail!==null?(a=f.tail,f.rendering=a,f.tail=a.sibling,f.renderingStartTime=H(),a.sibling=null,c=ri.current,$(ri,x?c&1|2:c&1),pn&&fr(r,f.treeForkCount),a):(Yn(r),null);case 22:case 23:return Ia(r),Wm(),f=r.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(r.flags|=8192):f&&(r.flags|=8192),f?(c&536870912)!==0&&(r.flags&128)===0&&(Yn(r),r.subtreeFlags&6&&(r.flags|=8192)):Yn(r),c=r.updateQueue,c!==null&&$f(r,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),f=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),f!==c&&(r.flags|=2048),a!==null&&de(Ko),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),pr(di),Yn(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function gA(a,r){switch(Im(r),r.tag){case 1:return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 3:return pr(di),ae(),a=r.flags,(a&65536)!==0&&(a&128)===0?(r.flags=a&-65537|128,r):null;case 26:case 27:case 5:return pt(r),null;case 31:if(r.memoizedState!==null){if(Ia(r),r.alternate===null)throw Error(s(340));$o()}return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 13:if(Ia(r),a=r.memoizedState,a!==null&&a.dehydrated!==null){if(r.alternate===null)throw Error(s(340));$o()}return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 19:return de(ri),null;case 4:return ae(),null;case 10:return pr(r.type),null;case 22:case 23:return Ia(r),Wm(),a!==null&&de(Ko),a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 24:return pr(di),null;case 25:return null;default:return null}}function yS(a,r){switch(Im(r),r.tag){case 3:pr(di),ae();break;case 26:case 27:case 5:pt(r);break;case 4:ae();break;case 31:r.memoizedState!==null&&Ia(r);break;case 13:Ia(r);break;case 19:de(ri);break;case 10:pr(r.type);break;case 22:case 23:Ia(r),Wm(),a!==null&&de(Ko);break;case 24:pr(di)}}function Id(a,r){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var x=f.next;c=x;do{if((c.tag&a)===a){f=void 0;var w=c.create,U=c.inst;f=w(),U.destroy=f}c=c.next}while(c!==x)}}catch(Y){In(r,r.return,Y)}}function lo(a,r,c){try{var f=r.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var w=x.next;f=w;do{if((f.tag&a)===a){var U=f.inst,Y=U.destroy;if(Y!==void 0){U.destroy=void 0,x=r;var se=c,Ae=Y;try{Ae()}catch(ke){In(x,se,ke)}}}f=f.next}while(f!==w)}}catch(ke){In(r,r.return,ke)}}function vS(a){var r=a.updateQueue;if(r!==null){var c=a.stateNode;try{cb(r,c)}catch(f){In(a,a.return,f)}}}function _S(a,r,c){c.props=el(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(f){In(a,r,f)}}function Od(a,r){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof c=="function"?a.refCleanup=c(f):c.current=f}}catch(x){In(a,r,x)}}function Bs(a,r){var c=a.ref,f=a.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(x){In(a,r,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){In(a,r,x)}else c.current=null}function bS(a){var r=a.type,c=a.memoizedProps,f=a.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(x){In(a,a.return,x)}}function Cg(a,r,c){try{var f=a.stateNode;zA(f,a.type,c,r),f[gn]=r}catch(x){In(a,a.return,x)}}function SS(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&go(a.type)||a.tag===4}function Tg(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||SS(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&go(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function jg(a,r,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,r?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,r):(r=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,r.appendChild(a),c=c._reactRootContainer,c!=null||r.onclick!==null||(r.onclick=cr));else if(f!==4&&(f===27&&go(a.type)&&(c=a.stateNode,r=null),a=a.child,a!==null))for(jg(a,r,c),a=a.sibling;a!==null;)jg(a,r,c),a=a.sibling}function Wf(a,r,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,r?c.insertBefore(a,r):c.appendChild(a);else if(f!==4&&(f===27&&go(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Wf(a,r,c),a=a.sibling;a!==null;)Wf(a,r,c),a=a.sibling}function MS(a){var r=a.stateNode,c=a.memoizedProps;try{for(var f=a.type,x=r.attributes;x.length;)r.removeAttributeNode(x[0]);Gi(r,f,c),r[dn]=a,r[gn]=c}catch(w){In(a,a.return,w)}}var vr=!1,hi=!1,Eg=!1,wS=typeof WeakSet=="function"?WeakSet:Set,Ei=null;function xA(a,r){if(a=a.containerInfo,Kg=ph,a=N_(a),bm(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var x=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var U=0,Y=-1,se=-1,Ae=0,ke=0,Ge=a,Ie=null;t:for(;;){for(var Le;Ge!==c||x!==0&&Ge.nodeType!==3||(Y=U+x),Ge!==w||f!==0&&Ge.nodeType!==3||(se=U+f),Ge.nodeType===3&&(U+=Ge.nodeValue.length),(Le=Ge.firstChild)!==null;)Ie=Ge,Ge=Le;for(;;){if(Ge===a)break t;if(Ie===c&&++Ae===x&&(Y=U),Ie===w&&++ke===f&&(se=U),(Le=Ge.nextSibling)!==null)break;Ge=Ie,Ie=Ge.parentNode}Ge=Le}c=Y===-1||se===-1?null:{start:Y,end:se}}else c=null}c=c||{start:0,end:0}}else c=null;for(Xg={focusedElem:a,selectionRange:c},ph=!1,Ei=r;Ei!==null;)if(r=Ei,a=r.child,(r.subtreeFlags&1028)!==0&&a!==null)a.return=r,Ei=a;else for(;Ei!==null;){switch(r=Ei,w=r.alternate,a=r.flags,r.tag){case 0:if((a&4)!==0&&(a=r.updateQueue,a=a!==null?a.events:null,a!==null))for(c=0;c<a.length;c++)x=a[c],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&w!==null){a=void 0,c=r,x=w.memoizedProps,w=w.memoizedState,f=c.stateNode;try{var Tt=el(c.type,x);a=f.getSnapshotBeforeUpdate(Tt,w),f.__reactInternalSnapshotBeforeUpdate=a}catch(Ut){In(c,c.return,Ut)}}break;case 3:if((a&1024)!==0){if(a=r.stateNode.containerInfo,c=a.nodeType,c===9)Jg(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Jg(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(s(163))}if(a=r.sibling,a!==null){a.return=r.return,Ei=a;break}Ei=r.return}}function CS(a,r,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:br(a,c),f&4&&Id(5,c);break;case 1:if(br(a,c),f&4)if(a=c.stateNode,r===null)try{a.componentDidMount()}catch(U){In(c,c.return,U)}else{var x=el(c.type,r.memoizedProps);r=r.memoizedState;try{a.componentDidUpdate(x,r,a.__reactInternalSnapshotBeforeUpdate)}catch(U){In(c,c.return,U)}}f&64&&vS(c),f&512&&Od(c,c.return);break;case 3:if(br(a,c),f&64&&(a=c.updateQueue,a!==null)){if(r=null,c.child!==null)switch(c.child.tag){case 27:case 5:r=c.child.stateNode;break;case 1:r=c.child.stateNode}try{cb(a,r)}catch(U){In(c,c.return,U)}}break;case 27:r===null&&f&4&&MS(c);case 26:case 5:br(a,c),r===null&&f&4&&bS(c),f&512&&Od(c,c.return);break;case 12:br(a,c);break;case 31:br(a,c),f&4&&ES(a,c);break;case 13:br(a,c),f&4&&AS(a,c),f&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=TA.bind(null,c),$A(a,c))));break;case 22:if(f=c.memoizedState!==null||vr,!f){r=r!==null&&r.memoizedState!==null||hi,x=vr;var w=hi;vr=f,(hi=r)&&!w?Sr(a,c,(c.subtreeFlags&8772)!==0):br(a,c),vr=x,hi=w}break;case 30:break;default:br(a,c)}}function TS(a){var r=a.alternate;r!==null&&(a.alternate=null,TS(r)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(r=a.stateNode,r!==null&&ps(r)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Xn=null,xa=!1;function _r(a,r,c){for(c=c.child;c!==null;)jS(a,r,c),c=c.sibling}function jS(a,r,c){if(qe&&typeof qe.onCommitFiberUnmount=="function")try{qe.onCommitFiberUnmount(We,c)}catch{}switch(c.tag){case 26:hi||Bs(c,r),_r(a,r,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:hi||Bs(c,r);var f=Xn,x=xa;go(c.type)&&(Xn=c.stateNode,xa=!1),_r(a,r,c),Hd(c.stateNode),Xn=f,xa=x;break;case 5:hi||Bs(c,r);case 6:if(f=Xn,x=xa,Xn=null,_r(a,r,c),Xn=f,xa=x,Xn!==null)if(xa)try{(Xn.nodeType===9?Xn.body:Xn.nodeName==="HTML"?Xn.ownerDocument.body:Xn).removeChild(c.stateNode)}catch(w){In(c,r,w)}else try{Xn.removeChild(c.stateNode)}catch(w){In(c,r,w)}break;case 18:Xn!==null&&(xa?(a=Xn,v1(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),fc(a)):v1(Xn,c.stateNode));break;case 4:f=Xn,x=xa,Xn=c.stateNode.containerInfo,xa=!0,_r(a,r,c),Xn=f,xa=x;break;case 0:case 11:case 14:case 15:lo(2,c,r),hi||lo(4,c,r),_r(a,r,c);break;case 1:hi||(Bs(c,r),f=c.stateNode,typeof f.componentWillUnmount=="function"&&_S(c,r,f)),_r(a,r,c);break;case 21:_r(a,r,c);break;case 22:hi=(f=hi)||c.memoizedState!==null,_r(a,r,c),hi=f;break;default:_r(a,r,c)}}function ES(a,r){if(r.memoizedState===null&&(a=r.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{fc(a)}catch(c){In(r,r.return,c)}}}function AS(a,r){if(r.memoizedState===null&&(a=r.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{fc(a)}catch(c){In(r,r.return,c)}}function yA(a){switch(a.tag){case 31:case 13:case 19:var r=a.stateNode;return r===null&&(r=a.stateNode=new wS),r;case 22:return a=a.stateNode,r=a._retryCache,r===null&&(r=a._retryCache=new wS),r;default:throw Error(s(435,a.tag))}}function Yf(a,r){var c=yA(a);r.forEach(function(f){if(!c.has(f)){c.add(f);var x=jA.bind(null,a,f);f.then(x,x)}})}function ya(a,r){var c=r.deletions;if(c!==null)for(var f=0;f<c.length;f++){var x=c[f],w=a,U=r,Y=U;e:for(;Y!==null;){switch(Y.tag){case 27:if(go(Y.type)){Xn=Y.stateNode,xa=!1;break e}break;case 5:Xn=Y.stateNode,xa=!1;break e;case 3:case 4:Xn=Y.stateNode.containerInfo,xa=!0;break e}Y=Y.return}if(Xn===null)throw Error(s(160));jS(w,U,x),Xn=null,xa=!1,w=x.alternate,w!==null&&(w.return=null),x.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)RS(r,a),r=r.sibling}var vs=null;function RS(a,r){var c=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ya(r,a),va(a),f&4&&(lo(3,a,a.return),Id(3,a),lo(5,a,a.return));break;case 1:ya(r,a),va(a),f&512&&(hi||c===null||Bs(c,c.return)),f&64&&vr&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var x=vs;if(ya(r,a),va(a),f&512&&(hi||c===null||Bs(c,c.return)),f&4){var w=c!==null?c.memoizedState:null;if(f=a.memoizedState,c===null)if(f===null)if(a.stateNode===null){e:{f=a.type,c=a.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":w=x.getElementsByTagName("title")[0],(!w||w[Ea]||w[dn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=x.createElement(f),x.head.insertBefore(w,x.querySelector("head > title"))),Gi(w,f,c),w[dn]=a,K(w),f=w;break e;case"link":var U=R1("link","href",x).get(f+(c.href||""));if(U){for(var Y=0;Y<U.length;Y++)if(w=U[Y],w.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&w.getAttribute("rel")===(c.rel==null?null:c.rel)&&w.getAttribute("title")===(c.title==null?null:c.title)&&w.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){U.splice(Y,1);break t}}w=x.createElement(f),Gi(w,f,c),x.head.appendChild(w);break;case"meta":if(U=R1("meta","content",x).get(f+(c.content||""))){for(Y=0;Y<U.length;Y++)if(w=U[Y],w.getAttribute("content")===(c.content==null?null:""+c.content)&&w.getAttribute("name")===(c.name==null?null:c.name)&&w.getAttribute("property")===(c.property==null?null:c.property)&&w.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&w.getAttribute("charset")===(c.charSet==null?null:c.charSet)){U.splice(Y,1);break t}}w=x.createElement(f),Gi(w,f,c),x.head.appendChild(w);break;default:throw Error(s(468,f))}w[dn]=a,K(w),f=w}a.stateNode=f}else D1(x,a.type,a.stateNode);else a.stateNode=A1(x,f,a.memoizedProps);else w!==f?(w===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):w.count--,f===null?D1(x,a.type,a.stateNode):A1(x,f,a.memoizedProps)):f===null&&a.stateNode!==null&&Cg(a,a.memoizedProps,c.memoizedProps)}break;case 27:ya(r,a),va(a),f&512&&(hi||c===null||Bs(c,c.return)),c!==null&&f&4&&Cg(a,a.memoizedProps,c.memoizedProps);break;case 5:if(ya(r,a),va(a),f&512&&(hi||c===null||Bs(c,c.return)),a.flags&32){x=a.stateNode;try{xi(x,"")}catch(Tt){In(a,a.return,Tt)}}f&4&&a.stateNode!=null&&(x=a.memoizedProps,Cg(a,x,c!==null?c.memoizedProps:x)),f&1024&&(Eg=!0);break;case 6:if(ya(r,a),va(a),f&4){if(a.stateNode===null)throw Error(s(162));f=a.memoizedProps,c=a.stateNode;try{c.nodeValue=f}catch(Tt){In(a,a.return,Tt)}}break;case 3:if(dh=null,x=vs,vs=lh(r.containerInfo),ya(r,a),vs=x,va(a),f&4&&c!==null&&c.memoizedState.isDehydrated)try{fc(r.containerInfo)}catch(Tt){In(a,a.return,Tt)}Eg&&(Eg=!1,DS(a));break;case 4:f=vs,vs=lh(a.stateNode.containerInfo),ya(r,a),va(a),vs=f;break;case 12:ya(r,a),va(a);break;case 31:ya(r,a),va(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Yf(a,f)));break;case 13:ya(r,a),va(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Xf=H()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Yf(a,f)));break;case 22:x=a.memoizedState!==null;var se=c!==null&&c.memoizedState!==null,Ae=vr,ke=hi;if(vr=Ae||x,hi=ke||se,ya(r,a),hi=ke,vr=Ae,va(a),f&8192)e:for(r=a.stateNode,r._visibility=x?r._visibility&-2:r._visibility|1,x&&(c===null||se||vr||hi||tl(a)),c=null,r=a;;){if(r.tag===5||r.tag===26){if(c===null){se=c=r;try{if(w=se.stateNode,x)U=w.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{Y=se.stateNode;var Ge=se.memoizedProps.style,Ie=Ge!=null&&Ge.hasOwnProperty("display")?Ge.display:null;Y.style.display=Ie==null||typeof Ie=="boolean"?"":(""+Ie).trim()}}catch(Tt){In(se,se.return,Tt)}}}else if(r.tag===6){if(c===null){se=r;try{se.stateNode.nodeValue=x?"":se.memoizedProps}catch(Tt){In(se,se.return,Tt)}}}else if(r.tag===18){if(c===null){se=r;try{var Le=se.stateNode;x?_1(Le,!0):_1(se.stateNode,!1)}catch(Tt){In(se,se.return,Tt)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===a)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;c===r&&(c=null),r=r.return}c===r&&(c=null),r.sibling.return=r.return,r=r.sibling}f&4&&(f=a.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Yf(a,c))));break;case 19:ya(r,a),va(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Yf(a,f)));break;case 30:break;case 21:break;default:ya(r,a),va(a)}}function va(a){var r=a.flags;if(r&2){try{for(var c,f=a.return;f!==null;){if(SS(f)){c=f;break}f=f.return}if(c==null)throw Error(s(160));switch(c.tag){case 27:var x=c.stateNode,w=Tg(a);Wf(a,w,x);break;case 5:var U=c.stateNode;c.flags&32&&(xi(U,""),c.flags&=-33);var Y=Tg(a);Wf(a,Y,U);break;case 3:case 4:var se=c.stateNode.containerInfo,Ae=Tg(a);jg(a,Ae,se);break;default:throw Error(s(161))}}catch(ke){In(a,a.return,ke)}a.flags&=-3}r&4096&&(a.flags&=-4097)}function DS(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var r=a;DS(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),a=a.sibling}}function br(a,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)CS(a,r.alternate,r),r=r.sibling}function tl(a){for(a=a.child;a!==null;){var r=a;switch(r.tag){case 0:case 11:case 14:case 15:lo(4,r,r.return),tl(r);break;case 1:Bs(r,r.return);var c=r.stateNode;typeof c.componentWillUnmount=="function"&&_S(r,r.return,c),tl(r);break;case 27:Hd(r.stateNode);case 26:case 5:Bs(r,r.return),tl(r);break;case 22:r.memoizedState===null&&tl(r);break;case 30:tl(r);break;default:tl(r)}a=a.sibling}}function Sr(a,r,c){for(c=c&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var f=r.alternate,x=a,w=r,U=w.flags;switch(w.tag){case 0:case 11:case 15:Sr(x,w,c),Id(4,w);break;case 1:if(Sr(x,w,c),f=w,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Ae){In(f,f.return,Ae)}if(f=w,x=f.updateQueue,x!==null){var Y=f.stateNode;try{var se=x.shared.hiddenCallbacks;if(se!==null)for(x.shared.hiddenCallbacks=null,x=0;x<se.length;x++)lb(se[x],Y)}catch(Ae){In(f,f.return,Ae)}}c&&U&64&&vS(w),Od(w,w.return);break;case 27:MS(w);case 26:case 5:Sr(x,w,c),c&&f===null&&U&4&&bS(w),Od(w,w.return);break;case 12:Sr(x,w,c);break;case 31:Sr(x,w,c),c&&U&4&&ES(x,w);break;case 13:Sr(x,w,c),c&&U&4&&AS(x,w);break;case 22:w.memoizedState===null&&Sr(x,w,c),Od(w,w.return);break;case 30:break;default:Sr(x,w,c)}r=r.sibling}}function Ag(a,r){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(a=r.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&vd(c))}function Rg(a,r){a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&vd(a))}function _s(a,r,c,f){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)IS(a,r,c,f),r=r.sibling}function IS(a,r,c,f){var x=r.flags;switch(r.tag){case 0:case 11:case 15:_s(a,r,c,f),x&2048&&Id(9,r);break;case 1:_s(a,r,c,f);break;case 3:_s(a,r,c,f),x&2048&&(a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&vd(a)));break;case 12:if(x&2048){_s(a,r,c,f),a=r.stateNode;try{var w=r.memoizedProps,U=w.id,Y=w.onPostCommit;typeof Y=="function"&&Y(U,r.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(se){In(r,r.return,se)}}else _s(a,r,c,f);break;case 31:_s(a,r,c,f);break;case 13:_s(a,r,c,f);break;case 23:break;case 22:w=r.stateNode,U=r.alternate,r.memoizedState!==null?w._visibility&2?_s(a,r,c,f):Pd(a,r):w._visibility&2?_s(a,r,c,f):(w._visibility|=2,tc(a,r,c,f,(r.subtreeFlags&10256)!==0||!1)),x&2048&&Ag(U,r);break;case 24:_s(a,r,c,f),x&2048&&Rg(r.alternate,r);break;default:_s(a,r,c,f)}}function tc(a,r,c,f,x){for(x=x&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var w=a,U=r,Y=c,se=f,Ae=U.flags;switch(U.tag){case 0:case 11:case 15:tc(w,U,Y,se,x),Id(8,U);break;case 23:break;case 22:var ke=U.stateNode;U.memoizedState!==null?ke._visibility&2?tc(w,U,Y,se,x):Pd(w,U):(ke._visibility|=2,tc(w,U,Y,se,x)),x&&Ae&2048&&Ag(U.alternate,U);break;case 24:tc(w,U,Y,se,x),x&&Ae&2048&&Rg(U.alternate,U);break;default:tc(w,U,Y,se,x)}r=r.sibling}}function Pd(a,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var c=a,f=r,x=f.flags;switch(f.tag){case 22:Pd(c,f),x&2048&&Ag(f.alternate,f);break;case 24:Pd(c,f),x&2048&&Rg(f.alternate,f);break;default:Pd(c,f)}r=r.sibling}}var Ld=8192;function nc(a,r,c){if(a.subtreeFlags&Ld)for(a=a.child;a!==null;)OS(a,r,c),a=a.sibling}function OS(a,r,c){switch(a.tag){case 26:nc(a,r,c),a.flags&Ld&&a.memoizedState!==null&&aR(c,vs,a.memoizedState,a.memoizedProps);break;case 5:nc(a,r,c);break;case 3:case 4:var f=vs;vs=lh(a.stateNode.containerInfo),nc(a,r,c),vs=f;break;case 22:a.memoizedState===null&&(f=a.alternate,f!==null&&f.memoizedState!==null?(f=Ld,Ld=16777216,nc(a,r,c),Ld=f):nc(a,r,c));break;default:nc(a,r,c)}}function PS(a){var r=a.alternate;if(r!==null&&(a=r.child,a!==null)){r.child=null;do r=a.sibling,a.sibling=null,a=r;while(a!==null)}}function Nd(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var f=r[c];Ei=f,NS(f,a)}PS(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)LS(a),a=a.sibling}function LS(a){switch(a.tag){case 0:case 11:case 15:Nd(a),a.flags&2048&&lo(9,a,a.return);break;case 3:Nd(a);break;case 12:Nd(a);break;case 22:var r=a.stateNode;a.memoizedState!==null&&r._visibility&2&&(a.return===null||a.return.tag!==13)?(r._visibility&=-3,Kf(a)):Nd(a);break;default:Nd(a)}}function Kf(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var f=r[c];Ei=f,NS(f,a)}PS(a)}for(a=a.child;a!==null;){switch(r=a,r.tag){case 0:case 11:case 15:lo(8,r,r.return),Kf(r);break;case 22:c=r.stateNode,c._visibility&2&&(c._visibility&=-3,Kf(r));break;default:Kf(r)}a=a.sibling}}function NS(a,r){for(;Ei!==null;){var c=Ei;switch(c.tag){case 0:case 11:case 15:lo(8,c,r);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:vd(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,Ei=f;else e:for(c=a;Ei!==null;){f=Ei;var x=f.sibling,w=f.return;if(TS(f),f===c){Ei=null;break e}if(x!==null){x.return=w,Ei=x;break e}Ei=w}}}var vA={getCacheForType:function(a){var r=Vi(di),c=r.data.get(a);return c===void 0&&(c=a(),r.data.set(a,c)),c},cacheSignal:function(){return Vi(di).controller.signal}},_A=typeof WeakMap=="function"?WeakMap:Map,Cn=0,Un=null,on=null,un=0,Dn=0,Oa=null,co=!1,ic=!1,Dg=!1,Mr=0,ti=0,uo=0,nl=0,Ig=0,Pa=0,ac=0,Fd=null,_a=null,Og=!1,Xf=0,FS=0,Qf=1/0,Zf=null,fo=null,yi=0,ho=null,sc=null,wr=0,Pg=0,Lg=null,zS=null,zd=0,Ng=null;function La(){return(Cn&2)!==0&&un!==0?un&-un:A.T!==null?Hg():Qe()}function kS(){if(Pa===0)if((un&536870912)===0||pn){var a=Ze;Ze<<=1,(Ze&3932160)===0&&(Ze=262144),Pa=a}else Pa=536870912;return a=Da.current,a!==null&&(a.flags|=32),Pa}function ba(a,r,c){(a===Un&&(Dn===2||Dn===9)||a.cancelPendingCommit!==null)&&(rc(a,0),po(a,un,Pa,!1)),si(a,c),((Cn&2)===0||a!==Un)&&(a===Un&&((Cn&2)===0&&(nl|=c),ti===4&&po(a,un,Pa,!1)),Us(a))}function BS(a,r,c){if((Cn&6)!==0)throw Error(s(327));var f=!c&&(r&127)===0&&(r&a.expiredLanes)===0||Je(a,r),x=f?MA(a,r):zg(a,r,!0),w=f;do{if(x===0){ic&&!f&&po(a,r,0,!1);break}else{if(c=a.current.alternate,w&&!bA(c)){x=zg(a,r,!1),w=!1;continue}if(x===2){if(w=r,a.errorRecoveryDisabledLanes&w)var U=0;else U=a.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){r=U;e:{var Y=a;x=Fd;var se=Y.current.memoizedState.isDehydrated;if(se&&(rc(Y,U).flags|=256),U=zg(Y,U,!1),U!==2){if(Dg&&!se){Y.errorRecoveryDisabledLanes|=w,nl|=w,x=4;break e}w=_a,_a=x,w!==null&&(_a===null?_a=w:_a.push.apply(_a,w))}x=U}if(w=!1,x!==2)continue}}if(x===1){rc(a,0),po(a,r,0,!0);break}e:{switch(f=a,w=x,w){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:po(f,r,Pa,!co);break e;case 2:_a=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(x=Xf+300-H(),10<x)){if(po(f,r,Pa,!co),Ue(f,0,!0)!==0)break e;wr=r,f.timeoutHandle=x1(US.bind(null,f,c,_a,Zf,Og,r,Pa,nl,ac,co,w,"Throttled",-0,0),x);break e}US(f,c,_a,Zf,Og,r,Pa,nl,ac,co,w,null,-0,0)}}break}while(!0);Us(a)}function US(a,r,c,f,x,w,U,Y,se,Ae,ke,Ge,Ie,Le){if(a.timeoutHandle=-1,Ge=r.subtreeFlags,Ge&8192||(Ge&16785408)===16785408){Ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:cr},OS(r,w,Ge);var Tt=(w&62914560)===w?Xf-H():(w&4194048)===w?FS-H():0;if(Tt=sR(Ge,Tt),Tt!==null){wr=w,a.cancelPendingCommit=Tt(KS.bind(null,a,r,w,c,f,x,U,Y,se,ke,Ge,null,Ie,Le)),po(a,w,U,!Ae);return}}KS(a,r,w,c,f,x,U,Y,se)}function bA(a){for(var r=a;;){var c=r.tag;if((c===0||c===11||c===15)&&r.flags&16384&&(c=r.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var x=c[f],w=x.getSnapshot;x=x.value;try{if(!Aa(w(),x))return!1}catch{return!1}}if(c=r.child,r.subtreeFlags&16384&&c!==null)c.return=r,r=c;else{if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function po(a,r,c,f){r&=~Ig,r&=~nl,a.suspendedLanes|=r,a.pingedLanes&=~r,f&&(a.warmLanes|=r),f=a.expirationTimes;for(var x=r;0<x;){var w=31-ot(x),U=1<<w;f[w]=-1,x&=~U}c!==0&&hs(a,c,r)}function Jf(){return(Cn&6)===0?(kd(0),!1):!0}function Fg(){if(on!==null){if(Dn===0)var a=on.return;else a=on,hr=Wo=null,Jm(a),Xl=null,bd=0,a=on;for(;a!==null;)yS(a.alternate,a),a=a.return;on=null}}function rc(a,r){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,UA(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),wr=0,Fg(),Un=a,on=c=ur(a.current,null),un=r,Dn=0,Oa=null,co=!1,ic=Je(a,r),Dg=!1,ac=Pa=Ig=nl=uo=ti=0,_a=Fd=null,Og=!1,(r&8)!==0&&(r|=r&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=r;0<f;){var x=31-ot(f),w=1<<x;r|=a[x],f&=~w}return Mr=r,_f(),c}function HS(a,r){Kt=null,A.H=Ad,r===Kl||r===Ef?(r=ab(),Dn=3):r===Um?(r=ab(),Dn=4):Dn=r===mg?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Oa=r,on===null&&(ti=1,Hf(a,Za(r,a.current)))}function VS(){var a=Da.current;return a===null?!0:(un&4194048)===un?ns===null:(un&62914560)===un||(un&536870912)!==0?a===ns:!1}function qS(){var a=A.H;return A.H=Ad,a===null?Ad:a}function GS(){var a=A.A;return A.A=vA,a}function eh(){ti=4,co||(un&4194048)!==un&&Da.current!==null||(ic=!0),(uo&134217727)===0&&(nl&134217727)===0||Un===null||po(Un,un,Pa,!1)}function zg(a,r,c){var f=Cn;Cn|=2;var x=qS(),w=GS();(Un!==a||un!==r)&&(Zf=null,rc(a,r)),r=!1;var U=ti;e:do try{if(Dn!==0&&on!==null){var Y=on,se=Oa;switch(Dn){case 8:Fg(),U=6;break e;case 3:case 2:case 9:case 6:Da.current===null&&(r=!0);var Ae=Dn;if(Dn=0,Oa=null,oc(a,Y,se,Ae),c&&ic){U=0;break e}break;default:Ae=Dn,Dn=0,Oa=null,oc(a,Y,se,Ae)}}SA(),U=ti;break}catch(ke){HS(a,ke)}while(!0);return r&&a.shellSuspendCounter++,hr=Wo=null,Cn=f,A.H=x,A.A=w,on===null&&(Un=null,un=0,_f()),U}function SA(){for(;on!==null;)$S(on)}function MA(a,r){var c=Cn;Cn|=2;var f=qS(),x=GS();Un!==a||un!==r?(Zf=null,Qf=H()+500,rc(a,r)):ic=Je(a,r);e:do try{if(Dn!==0&&on!==null){r=on;var w=Oa;t:switch(Dn){case 1:Dn=0,Oa=null,oc(a,r,w,1);break;case 2:case 9:if(nb(w)){Dn=0,Oa=null,WS(r);break}r=function(){Dn!==2&&Dn!==9||Un!==a||(Dn=7),Us(a)},w.then(r,r);break e;case 3:Dn=7;break e;case 4:Dn=5;break e;case 7:nb(w)?(Dn=0,Oa=null,WS(r)):(Dn=0,Oa=null,oc(a,r,w,7));break;case 5:var U=null;switch(on.tag){case 26:U=on.memoizedState;case 5:case 27:var Y=on;if(U?I1(U):Y.stateNode.complete){Dn=0,Oa=null;var se=Y.sibling;if(se!==null)on=se;else{var Ae=Y.return;Ae!==null?(on=Ae,th(Ae)):on=null}break t}}Dn=0,Oa=null,oc(a,r,w,5);break;case 6:Dn=0,Oa=null,oc(a,r,w,6);break;case 8:Fg(),ti=6;break e;default:throw Error(s(462))}}wA();break}catch(ke){HS(a,ke)}while(!0);return hr=Wo=null,A.H=f,A.A=x,Cn=c,on!==null?0:(Un=null,un=0,_f(),ti)}function wA(){for(;on!==null&&!nt();)$S(on)}function $S(a){var r=gS(a.alternate,a,Mr);a.memoizedProps=a.pendingProps,r===null?th(a):on=r}function WS(a){var r=a,c=r.alternate;switch(r.tag){case 15:case 0:r=dS(c,r,r.pendingProps,r.type,void 0,un);break;case 11:r=dS(c,r,r.pendingProps,r.type.render,r.ref,un);break;case 5:Jm(r);default:yS(c,r),r=on=G_(r,Mr),r=gS(c,r,Mr)}a.memoizedProps=a.pendingProps,r===null?th(a):on=r}function oc(a,r,c,f){hr=Wo=null,Jm(r),Xl=null,bd=0;var x=r.return;try{if(fA(a,x,r,c,un)){ti=1,Hf(a,Za(c,a.current)),on=null;return}}catch(w){if(x!==null)throw on=x,w;ti=1,Hf(a,Za(c,a.current)),on=null;return}r.flags&32768?(pn||f===1?a=!0:ic||(un&536870912)!==0?a=!1:(co=a=!0,(f===2||f===9||f===3||f===6)&&(f=Da.current,f!==null&&f.tag===13&&(f.flags|=16384))),YS(r,a)):th(r)}function th(a){var r=a;do{if((r.flags&32768)!==0){YS(r,co);return}a=r.return;var c=mA(r.alternate,r,Mr);if(c!==null){on=c;return}if(r=r.sibling,r!==null){on=r;return}on=r=a}while(r!==null);ti===0&&(ti=5)}function YS(a,r){do{var c=gA(a.alternate,a);if(c!==null){c.flags&=32767,on=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!r&&(a=a.sibling,a!==null)){on=a;return}on=a=c}while(a!==null);ti=6,on=null}function KS(a,r,c,f,x,w,U,Y,se){a.cancelPendingCommit=null;do nh();while(yi!==0);if((Cn&6)!==0)throw Error(s(327));if(r!==null){if(r===a.current)throw Error(s(177));if(w=r.lanes|r.childLanes,w|=Tm,la(a,c,w,U,Y,se),a===Un&&(on=Un=null,un=0),sc=r,ho=a,wr=c,Pg=w,Lg=x,zS=f,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,EA(ge,function(){return e1(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||f){f=A.T,A.T=null,x=q.p,q.p=2,U=Cn,Cn|=4;try{xA(a,r,c)}finally{Cn=U,q.p=x,A.T=f}}yi=1,XS(),QS(),ZS()}}function XS(){if(yi===1){yi=0;var a=ho,r=sc,c=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||c){c=A.T,A.T=null;var f=q.p;q.p=2;var x=Cn;Cn|=4;try{RS(r,a);var w=Xg,U=N_(a.containerInfo),Y=w.focusedElem,se=w.selectionRange;if(U!==Y&&Y&&Y.ownerDocument&&L_(Y.ownerDocument.documentElement,Y)){if(se!==null&&bm(Y)){var Ae=se.start,ke=se.end;if(ke===void 0&&(ke=Ae),"selectionStart"in Y)Y.selectionStart=Ae,Y.selectionEnd=Math.min(ke,Y.value.length);else{var Ge=Y.ownerDocument||document,Ie=Ge&&Ge.defaultView||window;if(Ie.getSelection){var Le=Ie.getSelection(),Tt=Y.textContent.length,Ut=Math.min(se.start,Tt),zn=se.end===void 0?Ut:Math.min(se.end,Tt);!Le.extend&&Ut>zn&&(U=zn,zn=Ut,Ut=U);var ve=P_(Y,Ut),ce=P_(Y,zn);if(ve&&ce&&(Le.rangeCount!==1||Le.anchorNode!==ve.node||Le.anchorOffset!==ve.offset||Le.focusNode!==ce.node||Le.focusOffset!==ce.offset)){var Ee=Ge.createRange();Ee.setStart(ve.node,ve.offset),Le.removeAllRanges(),Ut>zn?(Le.addRange(Ee),Le.extend(ce.node,ce.offset)):(Ee.setEnd(ce.node,ce.offset),Le.addRange(Ee))}}}}for(Ge=[],Le=Y;Le=Le.parentNode;)Le.nodeType===1&&Ge.push({element:Le,left:Le.scrollLeft,top:Le.scrollTop});for(typeof Y.focus=="function"&&Y.focus(),Y=0;Y<Ge.length;Y++){var Ve=Ge[Y];Ve.element.scrollLeft=Ve.left,Ve.element.scrollTop=Ve.top}}ph=!!Kg,Xg=Kg=null}finally{Cn=x,q.p=f,A.T=c}}a.current=r,yi=2}}function QS(){if(yi===2){yi=0;var a=ho,r=sc,c=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||c){c=A.T,A.T=null;var f=q.p;q.p=2;var x=Cn;Cn|=4;try{CS(a,r.alternate,r)}finally{Cn=x,q.p=f,A.T=c}}yi=3}}function ZS(){if(yi===4||yi===3){yi=0,G();var a=ho,r=sc,c=wr,f=zS;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?yi=5:(yi=0,sc=ho=null,JS(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(fo=null),ze(c),r=r.stateNode,qe&&typeof qe.onCommitFiberRoot=="function")try{qe.onCommitFiberRoot(We,r,void 0,(r.current.flags&128)===128)}catch{}if(f!==null){r=A.T,x=q.p,q.p=2,A.T=null;try{for(var w=a.onRecoverableError,U=0;U<f.length;U++){var Y=f[U];w(Y.value,{componentStack:Y.stack})}}finally{A.T=r,q.p=x}}(wr&3)!==0&&nh(),Us(a),x=a.pendingLanes,(c&261930)!==0&&(x&42)!==0?a===Ng?zd++:(zd=0,Ng=a):zd=0,kd(0)}}function JS(a,r){(a.pooledCacheLanes&=r)===0&&(r=a.pooledCache,r!=null&&(a.pooledCache=null,vd(r)))}function nh(){return XS(),QS(),ZS(),e1()}function e1(){if(yi!==5)return!1;var a=ho,r=Pg;Pg=0;var c=ze(wr),f=A.T,x=q.p;try{q.p=32>c?32:c,A.T=null,c=Lg,Lg=null;var w=ho,U=wr;if(yi=0,sc=ho=null,wr=0,(Cn&6)!==0)throw Error(s(331));var Y=Cn;if(Cn|=4,LS(w.current),IS(w,w.current,U,c),Cn=Y,kd(0,!1),qe&&typeof qe.onPostCommitFiberRoot=="function")try{qe.onPostCommitFiberRoot(We,w)}catch{}return!0}finally{q.p=x,A.T=f,JS(a,r)}}function t1(a,r,c){r=Za(c,r),r=pg(a.stateNode,r,2),a=so(a,r,2),a!==null&&(si(a,2),Us(a))}function In(a,r,c){if(a.tag===3)t1(a,a,c);else for(;r!==null;){if(r.tag===3){t1(r,a,c);break}else if(r.tag===1){var f=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(fo===null||!fo.has(f))){a=Za(c,a),c=nS(2),f=so(r,c,2),f!==null&&(iS(c,f,r,a),si(f,2),Us(f));break}}r=r.return}}function kg(a,r,c){var f=a.pingCache;if(f===null){f=a.pingCache=new _A;var x=new Set;f.set(r,x)}else x=f.get(r),x===void 0&&(x=new Set,f.set(r,x));x.has(c)||(Dg=!0,x.add(c),a=CA.bind(null,a,r,c),r.then(a,a))}function CA(a,r,c){var f=a.pingCache;f!==null&&f.delete(r),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,Un===a&&(un&c)===c&&(ti===4||ti===3&&(un&62914560)===un&&300>H()-Xf?(Cn&2)===0&&rc(a,0):Ig|=c,ac===un&&(ac=0)),Us(a)}function n1(a,r){r===0&&(r=ut()),a=qo(a,r),a!==null&&(si(a,r),Us(a))}function TA(a){var r=a.memoizedState,c=0;r!==null&&(c=r.retryLane),n1(a,c)}function jA(a,r){var c=0;switch(a.tag){case 31:case 13:var f=a.stateNode,x=a.memoizedState;x!==null&&(c=x.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(s(314))}f!==null&&f.delete(r),n1(a,c)}function EA(a,r){return It(a,r)}var ih=null,lc=null,Bg=!1,ah=!1,Ug=!1,mo=0;function Us(a){a!==lc&&a.next===null&&(lc===null?ih=lc=a:lc=lc.next=a),ah=!0,Bg||(Bg=!0,RA())}function kd(a,r){if(!Ug&&ah){Ug=!0;do for(var c=!1,f=ih;f!==null;){if(a!==0){var x=f.pendingLanes;if(x===0)var w=0;else{var U=f.suspendedLanes,Y=f.pingedLanes;w=(1<<31-ot(42|a)+1)-1,w&=x&~(U&~Y),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(c=!0,r1(f,w))}else w=un,w=Ue(f,f===Un?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(w&3)===0||Je(f,w)||(c=!0,r1(f,w));f=f.next}while(c);Ug=!1}}function AA(){i1()}function i1(){ah=Bg=!1;var a=0;mo!==0&&BA()&&(a=mo);for(var r=H(),c=null,f=ih;f!==null;){var x=f.next,w=a1(f,r);w===0?(f.next=null,c===null?ih=x:c.next=x,x===null&&(lc=c)):(c=f,(a!==0||(w&3)!==0)&&(ah=!0)),f=x}yi!==0&&yi!==5||kd(a),mo!==0&&(mo=0)}function a1(a,r){for(var c=a.suspendedLanes,f=a.pingedLanes,x=a.expirationTimes,w=a.pendingLanes&-62914561;0<w;){var U=31-ot(w),Y=1<<U,se=x[U];se===-1?((Y&c)===0||(Y&f)!==0)&&(x[U]=ye(Y,r)):se<=r&&(a.expiredLanes|=Y),w&=~Y}if(r=Un,c=un,c=Ue(a,a===r?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,c===0||a===r&&(Dn===2||Dn===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&tt(f),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||Je(a,c)){if(r=c&-c,r===a.callbackPriority)return r;switch(f!==null&&tt(f),ze(c)){case 2:case 8:c=Ce;break;case 32:c=ge;break;case 268435456:c=He;break;default:c=ge}return f=s1.bind(null,a),c=It(c,f),a.callbackPriority=r,a.callbackNode=c,r}return f!==null&&f!==null&&tt(f),a.callbackPriority=2,a.callbackNode=null,2}function s1(a,r){if(yi!==0&&yi!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(nh()&&a.callbackNode!==c)return null;var f=un;return f=Ue(a,a===Un?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(BS(a,f,r),a1(a,H()),a.callbackNode!=null&&a.callbackNode===c?s1.bind(null,a):null)}function r1(a,r){if(nh())return null;BS(a,r,!0)}function RA(){HA(function(){(Cn&6)!==0?It(we,AA):i1()})}function Hg(){if(mo===0){var a=Wl;a===0&&(a=rt,rt<<=1,(rt&261888)===0&&(rt=256)),mo=a}return mo}function o1(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ff(""+a)}function l1(a,r){var c=r.ownerDocument.createElement("input");return c.name=r.name,c.value=r.value,a.id&&c.setAttribute("form",a.id),r.parentNode.insertBefore(c,r),a=new FormData(a),c.parentNode.removeChild(c),a}function DA(a,r,c,f,x){if(r==="submit"&&c&&c.stateNode===x){var w=o1((x[gn]||null).action),U=f.submitter;U&&(r=(r=U[gn]||null)?o1(r.formAction):U.getAttribute("formAction"),r!==null&&(w=r,U=null));var Y=new gf("action","action",null,f,x);a.push({event:Y,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(mo!==0){var se=U?l1(x,U):new FormData(x);lg(c,{pending:!0,data:se,method:x.method,action:w},null,se)}}else typeof w=="function"&&(Y.preventDefault(),se=U?l1(x,U):new FormData(x),lg(c,{pending:!0,data:se,method:x.method,action:w},w,se))},currentTarget:x}]})}}for(var Vg=0;Vg<Cm.length;Vg++){var qg=Cm[Vg],IA=qg.toLowerCase(),OA=qg[0].toUpperCase()+qg.slice(1);ys(IA,"on"+OA)}ys(k_,"onAnimationEnd"),ys(B_,"onAnimationIteration"),ys(U_,"onAnimationStart"),ys("dblclick","onDoubleClick"),ys("focusin","onFocus"),ys("focusout","onBlur"),ys(K2,"onTransitionRun"),ys(X2,"onTransitionStart"),ys(Q2,"onTransitionCancel"),ys(H_,"onTransitionEnd"),Te("onMouseEnter",["mouseout","mouseover"]),Te("onMouseLeave",["mouseout","mouseover"]),Te("onPointerEnter",["pointerout","pointerover"]),Te("onPointerLeave",["pointerout","pointerover"]),De("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),De("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),De("onBeforeInput",["compositionend","keypress","textInput","paste"]),De("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bd));function c1(a,r){r=(r&4)!==0;for(var c=0;c<a.length;c++){var f=a[c],x=f.event;f=f.listeners;e:{var w=void 0;if(r)for(var U=f.length-1;0<=U;U--){var Y=f[U],se=Y.instance,Ae=Y.currentTarget;if(Y=Y.listener,se!==w&&x.isPropagationStopped())break e;w=Y,x.currentTarget=Ae;try{w(x)}catch(ke){vf(ke)}x.currentTarget=null,w=se}else for(U=0;U<f.length;U++){if(Y=f[U],se=Y.instance,Ae=Y.currentTarget,Y=Y.listener,se!==w&&x.isPropagationStopped())break e;w=Y,x.currentTarget=Ae;try{w(x)}catch(ke){vf(ke)}x.currentTarget=null,w=se}}}}function ln(a,r){var c=r[an];c===void 0&&(c=r[an]=new Set);var f=a+"__bubble";c.has(f)||(d1(r,a,2,!1),c.add(f))}function Gg(a,r,c){var f=0;r&&(f|=4),d1(c,a,f,r)}var sh="_reactListening"+Math.random().toString(36).slice(2);function $g(a){if(!a[sh]){a[sh]=!0,xe.forEach(function(c){c!=="selectionchange"&&(PA.has(c)||Gg(c,!1,a),Gg(c,!0,a))});var r=a.nodeType===9?a:a.ownerDocument;r===null||r[sh]||(r[sh]=!0,Gg("selectionchange",!1,r))}}function d1(a,r,c,f){switch(k1(r)){case 2:var x=lR;break;case 8:x=cR;break;default:x=ox}c=x.bind(null,r,c,a),x=void 0,!fm||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(x=!0),f?x!==void 0?a.addEventListener(r,c,{capture:!0,passive:x}):a.addEventListener(r,c,!0):x!==void 0?a.addEventListener(r,c,{passive:x}):a.addEventListener(r,c,!1)}function Wg(a,r,c,f,x){var w=f;if((r&1)===0&&(r&2)===0&&f!==null)e:for(;;){if(f===null)return;var U=f.tag;if(U===3||U===4){var Y=f.stateNode.containerInfo;if(Y===x)break;if(U===4)for(U=f.return;U!==null;){var se=U.tag;if((se===3||se===4)&&U.stateNode.containerInfo===x)return;U=U.return}for(;Y!==null;){if(U=ms(Y),U===null)return;if(se=U.tag,se===5||se===6||se===26||se===27){f=w=U;continue e}Y=Y.parentNode}}f=f.return}m_(function(){var Ae=w,ke=dm(c),Ge=[];e:{var Ie=V_.get(a);if(Ie!==void 0){var Le=gf,Tt=a;switch(a){case"keypress":if(pf(c)===0)break e;case"keydown":case"keyup":Le=j2;break;case"focusin":Tt="focus",Le=gm;break;case"focusout":Tt="blur",Le=gm;break;case"beforeblur":case"afterblur":Le=gm;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=y_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=m2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=R2;break;case k_:case B_:case U_:Le=y2;break;case H_:Le=I2;break;case"scroll":case"scrollend":Le=h2;break;case"wheel":Le=P2;break;case"copy":case"cut":case"paste":Le=_2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=__;break;case"toggle":case"beforetoggle":Le=N2}var Ut=(r&4)!==0,zn=!Ut&&(a==="scroll"||a==="scrollend"),ve=Ut?Ie!==null?Ie+"Capture":null:Ie;Ut=[];for(var ce=Ae,Ee;ce!==null;){var Ve=ce;if(Ee=Ve.stateNode,Ve=Ve.tag,Ve!==5&&Ve!==26&&Ve!==27||Ee===null||ve===null||(Ve=ld(ce,ve),Ve!=null&&Ut.push(Ud(ce,Ve,Ee))),zn)break;ce=ce.return}0<Ut.length&&(Ie=new Le(Ie,Tt,null,c,ke),Ge.push({event:Ie,listeners:Ut}))}}if((r&7)===0){e:{if(Ie=a==="mouseover"||a==="pointerover",Le=a==="mouseout"||a==="pointerout",Ie&&c!==cm&&(Tt=c.relatedTarget||c.fromElement)&&(ms(Tt)||Tt[yt]))break e;if((Le||Ie)&&(Ie=ke.window===ke?ke:(Ie=ke.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,Le?(Tt=c.relatedTarget||c.toElement,Le=Ae,Tt=Tt?ms(Tt):null,Tt!==null&&(zn=l(Tt),Ut=Tt.tag,Tt!==zn||Ut!==5&&Ut!==27&&Ut!==6)&&(Tt=null)):(Le=null,Tt=Ae),Le!==Tt)){if(Ut=y_,Ve="onMouseLeave",ve="onMouseEnter",ce="mouse",(a==="pointerout"||a==="pointerover")&&(Ut=__,Ve="onPointerLeave",ve="onPointerEnter",ce="pointer"),zn=Le==null?Ie:Qr(Le),Ee=Tt==null?Ie:Qr(Tt),Ie=new Ut(Ve,ce+"leave",Le,c,ke),Ie.target=zn,Ie.relatedTarget=Ee,Ve=null,ms(ke)===Ae&&(Ut=new Ut(ve,ce+"enter",Tt,c,ke),Ut.target=Ee,Ut.relatedTarget=zn,Ve=Ut),zn=Ve,Le&&Tt)t:{for(Ut=LA,ve=Le,ce=Tt,Ee=0,Ve=ve;Ve;Ve=Ut(Ve))Ee++;Ve=0;for(var zt=ce;zt;zt=Ut(zt))Ve++;for(;0<Ee-Ve;)ve=Ut(ve),Ee--;for(;0<Ve-Ee;)ce=Ut(ce),Ve--;for(;Ee--;){if(ve===ce||ce!==null&&ve===ce.alternate){Ut=ve;break t}ve=Ut(ve),ce=Ut(ce)}Ut=null}else Ut=null;Le!==null&&u1(Ge,Ie,Le,Ut,!1),Tt!==null&&zn!==null&&u1(Ge,zn,Tt,Ut,!0)}}e:{if(Ie=Ae?Qr(Ae):window,Le=Ie.nodeName&&Ie.nodeName.toLowerCase(),Le==="select"||Le==="input"&&Ie.type==="file")var _n=E_;else if(T_(Ie))if(A_)_n=$2;else{_n=q2;var Lt=V2}else Le=Ie.nodeName,!Le||Le.toLowerCase()!=="input"||Ie.type!=="checkbox"&&Ie.type!=="radio"?Ae&&xs(Ae.elementType)&&(_n=E_):_n=G2;if(_n&&(_n=_n(a,Ae))){j_(Ge,_n,c,ke);break e}Lt&&Lt(a,Ie,Ae),a==="focusout"&&Ae&&Ie.type==="number"&&Ae.memoizedProps.value!=null&&zi(Ie,"number",Ie.value)}switch(Lt=Ae?Qr(Ae):window,a){case"focusin":(T_(Lt)||Lt.contentEditable==="true")&&(kl=Lt,Sm=Ae,gd=null);break;case"focusout":gd=Sm=kl=null;break;case"mousedown":Mm=!0;break;case"contextmenu":case"mouseup":case"dragend":Mm=!1,F_(Ge,c,ke);break;case"selectionchange":if(Y2)break;case"keydown":case"keyup":F_(Ge,c,ke)}var Qt;if(ym)e:{switch(a){case"compositionstart":var fn="onCompositionStart";break e;case"compositionend":fn="onCompositionEnd";break e;case"compositionupdate":fn="onCompositionUpdate";break e}fn=void 0}else zl?w_(a,c)&&(fn="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(fn="onCompositionStart");fn&&(b_&&c.locale!=="ko"&&(zl||fn!=="onCompositionStart"?fn==="onCompositionEnd"&&zl&&(Qt=g_()):(Zr=ke,hm="value"in Zr?Zr.value:Zr.textContent,zl=!0)),Lt=rh(Ae,fn),0<Lt.length&&(fn=new v_(fn,a,null,c,ke),Ge.push({event:fn,listeners:Lt}),Qt?fn.data=Qt:(Qt=C_(c),Qt!==null&&(fn.data=Qt)))),(Qt=z2?k2(a,c):B2(a,c))&&(fn=rh(Ae,"onBeforeInput"),0<fn.length&&(Lt=new v_("onBeforeInput","beforeinput",null,c,ke),Ge.push({event:Lt,listeners:fn}),Lt.data=Qt)),DA(Ge,a,Ae,c,ke)}c1(Ge,r)})}function Ud(a,r,c){return{instance:a,listener:r,currentTarget:c}}function rh(a,r){for(var c=r+"Capture",f=[];a!==null;){var x=a,w=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||w===null||(x=ld(a,c),x!=null&&f.unshift(Ud(a,x,w)),x=ld(a,r),x!=null&&f.push(Ud(a,x,w))),a.tag===3)return f;a=a.return}return[]}function LA(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function u1(a,r,c,f,x){for(var w=r._reactName,U=[];c!==null&&c!==f;){var Y=c,se=Y.alternate,Ae=Y.stateNode;if(Y=Y.tag,se!==null&&se===f)break;Y!==5&&Y!==26&&Y!==27||Ae===null||(se=Ae,x?(Ae=ld(c,w),Ae!=null&&U.unshift(Ud(c,Ae,se))):x||(Ae=ld(c,w),Ae!=null&&U.push(Ud(c,Ae,se)))),c=c.return}U.length!==0&&a.push({event:r,listeners:U})}var NA=/\r\n?/g,FA=/\u0000|\uFFFD/g;function f1(a){return(typeof a=="string"?a:""+a).replace(NA,`
`).replace(FA,"")}function h1(a,r){return r=f1(r),f1(a)===r}function Fn(a,r,c,f,x,w){switch(c){case"children":typeof f=="string"?r==="body"||r==="textarea"&&f===""||xi(a,f):(typeof f=="number"||typeof f=="bigint")&&r!=="body"&&xi(a,""+f);break;case"className":kt(a,"class",f);break;case"tabIndex":kt(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":kt(a,c,f);break;case"style":Ll(a,f,w);break;case"data":if(r!=="object"){kt(a,"data",f);break}case"src":case"href":if(f===""&&(r!=="a"||c!=="href")){a.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=ff(""+f),a.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(c==="formAction"?(r!=="input"&&Fn(a,r,"name",x.name,x,null),Fn(a,r,"formEncType",x.formEncType,x,null),Fn(a,r,"formMethod",x.formMethod,x,null),Fn(a,r,"formTarget",x.formTarget,x,null)):(Fn(a,r,"encType",x.encType,x,null),Fn(a,r,"method",x.method,x,null),Fn(a,r,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=ff(""+f),a.setAttribute(c,f);break;case"onClick":f!=null&&(a.onclick=cr);break;case"onScroll":f!=null&&ln("scroll",a);break;case"onScrollEnd":f!=null&&ln("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(c=f.__html,c!=null){if(x.children!=null)throw Error(s(60));a.innerHTML=c}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}c=ff(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""+f):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":f===!0?a.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,f):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(c,f):a.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(c):a.setAttribute(c,f);break;case"popover":ln("beforetoggle",a),ln("toggle",a),Ot(a,"popover",f);break;case"xlinkActuate":Pt(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Pt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Pt(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Pt(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Pt(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Pt(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Pt(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Pt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Pt(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Ot(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=u2.get(c)||c,Ot(a,c,f))}}function Yg(a,r,c,f,x,w){switch(c){case"style":Ll(a,f,w);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(c=f.__html,c!=null){if(x.children!=null)throw Error(s(60));a.innerHTML=c}}break;case"children":typeof f=="string"?xi(a,f):(typeof f=="number"||typeof f=="bigint")&&xi(a,""+f);break;case"onScroll":f!=null&&ln("scroll",a);break;case"onScrollEnd":f!=null&&ln("scrollend",a);break;case"onClick":f!=null&&(a.onclick=cr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Oe.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),r=c.slice(2,x?c.length-7:void 0),w=a[gn]||null,w=w!=null?w[c]:null,typeof w=="function"&&a.removeEventListener(r,w,x),typeof f=="function")){typeof w!="function"&&w!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(r,f,x);break e}c in a?a[c]=f:f===!0?a.setAttribute(c,""):Ot(a,c,f)}}}function Gi(a,r,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ln("error",a),ln("load",a);var f=!1,x=!1,w;for(w in c)if(c.hasOwnProperty(w)){var U=c[w];if(U!=null)switch(w){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Fn(a,r,w,U,c,null)}}x&&Fn(a,r,"srcSet",c.srcSet,c,null),f&&Fn(a,r,"src",c.src,c,null);return;case"input":ln("invalid",a);var Y=w=U=x=null,se=null,Ae=null;for(f in c)if(c.hasOwnProperty(f)){var ke=c[f];if(ke!=null)switch(f){case"name":x=ke;break;case"type":U=ke;break;case"checked":se=ke;break;case"defaultChecked":Ae=ke;break;case"value":w=ke;break;case"defaultValue":Y=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(s(137,r));break;default:Fn(a,r,f,ke,c,null)}}lr(a,w,Y,se,Ae,U,x,!1);return;case"select":ln("invalid",a),f=U=w=null;for(x in c)if(c.hasOwnProperty(x)&&(Y=c[x],Y!=null))switch(x){case"value":w=Y;break;case"defaultValue":U=Y;break;case"multiple":f=Y;default:Fn(a,r,x,Y,c,null)}r=w,c=U,a.multiple=!!f,r!=null?Xa(a,!!f,r,!1):c!=null&&Xa(a,!!f,c,!0);return;case"textarea":ln("invalid",a),w=x=f=null;for(U in c)if(c.hasOwnProperty(U)&&(Y=c[U],Y!=null))switch(U){case"value":f=Y;break;case"defaultValue":x=Y;break;case"children":w=Y;break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(s(91));break;default:Fn(a,r,U,Y,c,null)}ki(a,f,x,w);return;case"option":for(se in c)c.hasOwnProperty(se)&&(f=c[se],f!=null)&&(se==="selected"?a.selected=f&&typeof f!="function"&&typeof f!="symbol":Fn(a,r,se,f,c,null));return;case"dialog":ln("beforetoggle",a),ln("toggle",a),ln("cancel",a),ln("close",a);break;case"iframe":case"object":ln("load",a);break;case"video":case"audio":for(f=0;f<Bd.length;f++)ln(Bd[f],a);break;case"image":ln("error",a),ln("load",a);break;case"details":ln("toggle",a);break;case"embed":case"source":case"link":ln("error",a),ln("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ae in c)if(c.hasOwnProperty(Ae)&&(f=c[Ae],f!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Fn(a,r,Ae,f,c,null)}return;default:if(xs(r)){for(ke in c)c.hasOwnProperty(ke)&&(f=c[ke],f!==void 0&&Yg(a,r,ke,f,c,void 0));return}}for(Y in c)c.hasOwnProperty(Y)&&(f=c[Y],f!=null&&Fn(a,r,Y,f,c,null))}function zA(a,r,c,f){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,w=null,U=null,Y=null,se=null,Ae=null,ke=null;for(Le in c){var Ge=c[Le];if(c.hasOwnProperty(Le)&&Ge!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":se=Ge;default:f.hasOwnProperty(Le)||Fn(a,r,Le,null,f,Ge)}}for(var Ie in f){var Le=f[Ie];if(Ge=c[Ie],f.hasOwnProperty(Ie)&&(Le!=null||Ge!=null))switch(Ie){case"type":w=Le;break;case"name":x=Le;break;case"checked":Ae=Le;break;case"defaultChecked":ke=Le;break;case"value":U=Le;break;case"defaultValue":Y=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(s(137,r));break;default:Le!==Ge&&Fn(a,r,Ie,Le,f,Ge)}}Fi(a,U,Y,se,Ae,ke,w,x);return;case"select":Le=U=Y=Ie=null;for(w in c)if(se=c[w],c.hasOwnProperty(w)&&se!=null)switch(w){case"value":break;case"multiple":Le=se;default:f.hasOwnProperty(w)||Fn(a,r,w,null,f,se)}for(x in f)if(w=f[x],se=c[x],f.hasOwnProperty(x)&&(w!=null||se!=null))switch(x){case"value":Ie=w;break;case"defaultValue":Y=w;break;case"multiple":U=w;default:w!==se&&Fn(a,r,x,w,f,se)}r=Y,c=U,f=Le,Ie!=null?Xa(a,!!c,Ie,!1):!!f!=!!c&&(r!=null?Xa(a,!!c,r,!0):Xa(a,!!c,c?[]:"",!1));return;case"textarea":Le=Ie=null;for(Y in c)if(x=c[Y],c.hasOwnProperty(Y)&&x!=null&&!f.hasOwnProperty(Y))switch(Y){case"value":break;case"children":break;default:Fn(a,r,Y,null,f,x)}for(U in f)if(x=f[U],w=c[U],f.hasOwnProperty(U)&&(x!=null||w!=null))switch(U){case"value":Ie=x;break;case"defaultValue":Le=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(s(91));break;default:x!==w&&Fn(a,r,U,x,f,w)}Rn(a,Ie,Le);return;case"option":for(var Tt in c)Ie=c[Tt],c.hasOwnProperty(Tt)&&Ie!=null&&!f.hasOwnProperty(Tt)&&(Tt==="selected"?a.selected=!1:Fn(a,r,Tt,null,f,Ie));for(se in f)Ie=f[se],Le=c[se],f.hasOwnProperty(se)&&Ie!==Le&&(Ie!=null||Le!=null)&&(se==="selected"?a.selected=Ie&&typeof Ie!="function"&&typeof Ie!="symbol":Fn(a,r,se,Ie,f,Le));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ut in c)Ie=c[Ut],c.hasOwnProperty(Ut)&&Ie!=null&&!f.hasOwnProperty(Ut)&&Fn(a,r,Ut,null,f,Ie);for(Ae in f)if(Ie=f[Ae],Le=c[Ae],f.hasOwnProperty(Ae)&&Ie!==Le&&(Ie!=null||Le!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(s(137,r));break;default:Fn(a,r,Ae,Ie,f,Le)}return;default:if(xs(r)){for(var zn in c)Ie=c[zn],c.hasOwnProperty(zn)&&Ie!==void 0&&!f.hasOwnProperty(zn)&&Yg(a,r,zn,void 0,f,Ie);for(ke in f)Ie=f[ke],Le=c[ke],!f.hasOwnProperty(ke)||Ie===Le||Ie===void 0&&Le===void 0||Yg(a,r,ke,Ie,f,Le);return}}for(var ve in c)Ie=c[ve],c.hasOwnProperty(ve)&&Ie!=null&&!f.hasOwnProperty(ve)&&Fn(a,r,ve,null,f,Ie);for(Ge in f)Ie=f[Ge],Le=c[Ge],!f.hasOwnProperty(Ge)||Ie===Le||Ie==null&&Le==null||Fn(a,r,Ge,Ie,f,Le)}function p1(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function kA(){if(typeof performance.getEntriesByType=="function"){for(var a=0,r=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var x=c[f],w=x.transferSize,U=x.initiatorType,Y=x.duration;if(w&&Y&&p1(U)){for(U=0,Y=x.responseEnd,f+=1;f<c.length;f++){var se=c[f],Ae=se.startTime;if(Ae>Y)break;var ke=se.transferSize,Ge=se.initiatorType;ke&&p1(Ge)&&(se=se.responseEnd,U+=ke*(se<Y?1:(Y-Ae)/(se-Ae)))}if(--f,r+=8*(w+U)/(x.duration/1e3),a++,10<a)break}}if(0<a)return r/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var Kg=null,Xg=null;function oh(a){return a.nodeType===9?a:a.ownerDocument}function m1(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function g1(a,r){if(a===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&r==="foreignObject"?0:a}function Qg(a,r){return a==="textarea"||a==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Zg=null;function BA(){var a=window.event;return a&&a.type==="popstate"?a===Zg?!1:(Zg=a,!0):(Zg=null,!1)}var x1=typeof setTimeout=="function"?setTimeout:void 0,UA=typeof clearTimeout=="function"?clearTimeout:void 0,y1=typeof Promise=="function"?Promise:void 0,HA=typeof queueMicrotask=="function"?queueMicrotask:typeof y1<"u"?function(a){return y1.resolve(null).then(a).catch(VA)}:x1;function VA(a){setTimeout(function(){throw a})}function go(a){return a==="head"}function v1(a,r){var c=r,f=0;do{var x=c.nextSibling;if(a.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"||c==="/&"){if(f===0){a.removeChild(x),fc(r);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Hd(a.ownerDocument.documentElement);else if(c==="head"){c=a.ownerDocument.head,Hd(c);for(var w=c.firstChild;w;){var U=w.nextSibling,Y=w.nodeName;w[Ea]||Y==="SCRIPT"||Y==="STYLE"||Y==="LINK"&&w.rel.toLowerCase()==="stylesheet"||c.removeChild(w),w=U}}else c==="body"&&Hd(a.ownerDocument.body);c=x}while(c);fc(r)}function _1(a,r){var c=a;a=0;do{var f=c.nextSibling;if(c.nodeType===1?r?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(r?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(a===0)break;a--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||a++;c=f}while(c)}function Jg(a){var r=a.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var c=r;switch(r=r.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Jg(c),ps(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function qA(a,r,c,f){for(;a.nodeType===1;){var x=c;if(a.nodeName.toLowerCase()!==r.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[Ea])switch(r){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(w=a.getAttribute("rel"),w==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(w!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(w=a.getAttribute("src"),(w!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&w&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(r==="input"&&a.type==="hidden"){var w=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===w)return a}else return a;if(a=is(a.nextSibling),a===null)break}return null}function GA(a,r,c){if(r==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=is(a.nextSibling),a===null))return null;return a}function b1(a,r){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!r||(a=is(a.nextSibling),a===null))return null;return a}function ex(a){return a.data==="$?"||a.data==="$~"}function tx(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function $A(a,r){var c=a.ownerDocument;if(a.data==="$~")a._reactRetry=r;else if(a.data!=="$?"||c.readyState!=="loading")r();else{var f=function(){r(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function is(a){for(;a!=null;a=a.nextSibling){var r=a.nodeType;if(r===1||r===3)break;if(r===8){if(r=a.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return a}var nx=null;function S1(a){a=a.nextSibling;for(var r=0;a;){if(a.nodeType===8){var c=a.data;if(c==="/$"||c==="/&"){if(r===0)return is(a.nextSibling);r--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||r++}a=a.nextSibling}return null}function M1(a){a=a.previousSibling;for(var r=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(r===0)return a;r--}else c!=="/$"&&c!=="/&"||r++}a=a.previousSibling}return null}function w1(a,r,c){switch(r=oh(c),a){case"html":if(a=r.documentElement,!a)throw Error(s(452));return a;case"head":if(a=r.head,!a)throw Error(s(453));return a;case"body":if(a=r.body,!a)throw Error(s(454));return a;default:throw Error(s(451))}}function Hd(a){for(var r=a.attributes;r.length;)a.removeAttributeNode(r[0]);ps(a)}var as=new Map,C1=new Set;function lh(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Cr=q.d;q.d={f:WA,r:YA,D:KA,C:XA,L:QA,m:ZA,X:eR,S:JA,M:tR};function WA(){var a=Cr.f(),r=Jf();return a||r}function YA(a){var r=gs(a);r!==null&&r.tag===5&&r.type==="form"?Hb(r):Cr.r(a)}var cc=typeof document>"u"?null:document;function T1(a,r,c){var f=cc;if(f&&typeof r=="string"&&r){var x=Wt(r);x='link[rel="'+a+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),C1.has(x)||(C1.add(x),a={rel:a,crossOrigin:c,href:r},f.querySelector(x)===null&&(r=f.createElement("link"),Gi(r,"link",a),K(r),f.head.appendChild(r)))}}function KA(a){Cr.D(a),T1("dns-prefetch",a,null)}function XA(a,r){Cr.C(a,r),T1("preconnect",a,r)}function QA(a,r,c){Cr.L(a,r,c);var f=cc;if(f&&a&&r){var x='link[rel="preload"][as="'+Wt(r)+'"]';r==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+Wt(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+Wt(c.imageSizes)+'"]')):x+='[href="'+Wt(a)+'"]';var w=x;switch(r){case"style":w=dc(a);break;case"script":w=uc(a)}as.has(w)||(a=g({rel:"preload",href:r==="image"&&c&&c.imageSrcSet?void 0:a,as:r},c),as.set(w,a),f.querySelector(x)!==null||r==="style"&&f.querySelector(Vd(w))||r==="script"&&f.querySelector(qd(w))||(r=f.createElement("link"),Gi(r,"link",a),K(r),f.head.appendChild(r)))}}function ZA(a,r){Cr.m(a,r);var c=cc;if(c&&a){var f=r&&typeof r.as=="string"?r.as:"script",x='link[rel="modulepreload"][as="'+Wt(f)+'"][href="'+Wt(a)+'"]',w=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=uc(a)}if(!as.has(w)&&(a=g({rel:"modulepreload",href:a},r),as.set(w,a),c.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(qd(w)))return}f=c.createElement("link"),Gi(f,"link",a),K(f),c.head.appendChild(f)}}}function JA(a,r,c){Cr.S(a,r,c);var f=cc;if(f&&a){var x=da(f).hoistableStyles,w=dc(a);r=r||"default";var U=x.get(w);if(!U){var Y={loading:0,preload:null};if(U=f.querySelector(Vd(w)))Y.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":r},c),(c=as.get(w))&&ix(a,c);var se=U=f.createElement("link");K(se),Gi(se,"link",a),se._p=new Promise(function(Ae,ke){se.onload=Ae,se.onerror=ke}),se.addEventListener("load",function(){Y.loading|=1}),se.addEventListener("error",function(){Y.loading|=2}),Y.loading|=4,ch(U,r,f)}U={type:"stylesheet",instance:U,count:1,state:Y},x.set(w,U)}}}function eR(a,r){Cr.X(a,r);var c=cc;if(c&&a){var f=da(c).hoistableScripts,x=uc(a),w=f.get(x);w||(w=c.querySelector(qd(x)),w||(a=g({src:a,async:!0},r),(r=as.get(x))&&ax(a,r),w=c.createElement("script"),K(w),Gi(w,"link",a),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(x,w))}}function tR(a,r){Cr.M(a,r);var c=cc;if(c&&a){var f=da(c).hoistableScripts,x=uc(a),w=f.get(x);w||(w=c.querySelector(qd(x)),w||(a=g({src:a,async:!0,type:"module"},r),(r=as.get(x))&&ax(a,r),w=c.createElement("script"),K(w),Gi(w,"link",a),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(x,w))}}function j1(a,r,c,f){var x=(x=oe.current)?lh(x):null;if(!x)throw Error(s(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(r=dc(c.href),c=da(x).hoistableStyles,f=c.get(r),f||(f={type:"style",instance:null,count:0,state:null},c.set(r,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=dc(c.href);var w=da(x).hoistableStyles,U=w.get(a);if(U||(x=x.ownerDocument||x,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(a,U),(w=x.querySelector(Vd(a)))&&!w._p&&(U.instance=w,U.state.loading=5),as.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},as.set(a,c),w||nR(x,a,c,U.state))),r&&f===null)throw Error(s(528,""));return U}if(r&&f!==null)throw Error(s(529,""));return null;case"script":return r=c.async,c=c.src,typeof c=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=uc(c),c=da(x).hoistableScripts,f=c.get(r),f||(f={type:"script",instance:null,count:0,state:null},c.set(r,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,a))}}function dc(a){return'href="'+Wt(a)+'"'}function Vd(a){return'link[rel="stylesheet"]['+a+"]"}function E1(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function nR(a,r,c,f){a.querySelector('link[rel="preload"][as="style"]['+r+"]")?f.loading=1:(r=a.createElement("link"),f.preload=r,r.addEventListener("load",function(){return f.loading|=1}),r.addEventListener("error",function(){return f.loading|=2}),Gi(r,"link",c),K(r),a.head.appendChild(r))}function uc(a){return'[src="'+Wt(a)+'"]'}function qd(a){return"script[async]"+a}function A1(a,r,c){if(r.count++,r.instance===null)switch(r.type){case"style":var f=a.querySelector('style[data-href~="'+Wt(c.href)+'"]');if(f)return r.instance=f,K(f),f;var x=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),K(f),Gi(f,"style",x),ch(f,c.precedence,a),r.instance=f;case"stylesheet":x=dc(c.href);var w=a.querySelector(Vd(x));if(w)return r.state.loading|=4,r.instance=w,K(w),w;f=E1(c),(x=as.get(x))&&ix(f,x),w=(a.ownerDocument||a).createElement("link"),K(w);var U=w;return U._p=new Promise(function(Y,se){U.onload=Y,U.onerror=se}),Gi(w,"link",f),r.state.loading|=4,ch(w,c.precedence,a),r.instance=w;case"script":return w=uc(c.src),(x=a.querySelector(qd(w)))?(r.instance=x,K(x),x):(f=c,(x=as.get(w))&&(f=g({},c),ax(f,x)),a=a.ownerDocument||a,x=a.createElement("script"),K(x),Gi(x,"link",f),a.head.appendChild(x),r.instance=x);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(f=r.instance,r.state.loading|=4,ch(f,c.precedence,a));return r.instance}function ch(a,r,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,w=x,U=0;U<f.length;U++){var Y=f[U];if(Y.dataset.precedence===r)w=Y;else if(w!==x)break}w?w.parentNode.insertBefore(a,w.nextSibling):(r=c.nodeType===9?c.head:c,r.insertBefore(a,r.firstChild))}function ix(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.title==null&&(a.title=r.title)}function ax(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.integrity==null&&(a.integrity=r.integrity)}var dh=null;function R1(a,r,c){if(dh===null){var f=new Map,x=dh=new Map;x.set(c,f)}else x=dh,f=x.get(c),f||(f=new Map,x.set(c,f));if(f.has(a))return f;for(f.set(a,null),c=c.getElementsByTagName(a),x=0;x<c.length;x++){var w=c[x];if(!(w[Ea]||w[dn]||a==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var U=w.getAttribute(r)||"";U=a+U;var Y=f.get(U);Y?Y.push(w):f.set(U,[w])}}return f}function D1(a,r,c){a=a.ownerDocument||a,a.head.insertBefore(c,r==="title"?a.querySelector("head > title"):null)}function iR(a,r,c){if(c===1||r.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(a=r.disabled,typeof r.precedence=="string"&&a==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function I1(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function aR(a,r,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var x=dc(f.href),w=r.querySelector(Vd(x));if(w){r=w._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(a.count++,a=uh.bind(a),r.then(a,a)),c.state.loading|=4,c.instance=w,K(w);return}w=r.ownerDocument||r,f=E1(f),(x=as.get(x))&&ix(f,x),w=w.createElement("link"),K(w);var U=w;U._p=new Promise(function(Y,se){U.onload=Y,U.onerror=se}),Gi(w,"link",f),c.instance=w}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(c,r),(r=c.state.preload)&&(c.state.loading&3)===0&&(a.count++,c=uh.bind(a),r.addEventListener("load",c),r.addEventListener("error",c))}}var sx=0;function sR(a,r){return a.stylesheets&&a.count===0&&hh(a,a.stylesheets),0<a.count||0<a.imgCount?function(c){var f=setTimeout(function(){if(a.stylesheets&&hh(a,a.stylesheets),a.unsuspend){var w=a.unsuspend;a.unsuspend=null,w()}},6e4+r);0<a.imgBytes&&sx===0&&(sx=62500*kA());var x=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&hh(a,a.stylesheets),a.unsuspend)){var w=a.unsuspend;a.unsuspend=null,w()}},(a.imgBytes>sx?50:800)+r);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function uh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)hh(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var fh=null;function hh(a,r){a.stylesheets=null,a.unsuspend!==null&&(a.count++,fh=new Map,r.forEach(rR,a),fh=null,uh.call(a))}function rR(a,r){if(!(r.state.loading&4)){var c=fh.get(a);if(c)var f=c.get(null);else{c=new Map,fh.set(a,c);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<x.length;w++){var U=x[w];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(c.set(U.dataset.precedence,U),f=U)}f&&c.set(null,f)}x=r.instance,U=x.getAttribute("data-precedence"),w=c.get(U)||f,w===f&&c.set(null,x),c.set(U,x),this.count++,f=uh.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),w?w.parentNode.insertBefore(x,w.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),r.state.loading|=4}}var Gd={$$typeof:L,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function oR(a,r,c,f,x,w,U,Y,se){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Et(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Et(0),this.hiddenUpdates=Et(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=w,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function O1(a,r,c,f,x,w,U,Y,se,Ae,ke,Ge){return a=new oR(a,r,c,U,se,Ae,ke,Ge,Y),r=1,w===!0&&(r|=24),w=Ra(3,null,null,r),a.current=w,w.stateNode=a,r=zm(),r.refCount++,a.pooledCache=r,r.refCount++,w.memoizedState={element:f,isDehydrated:c,cache:r},Hm(w),a}function P1(a){return a?(a=Hl,a):Hl}function L1(a,r,c,f,x,w){x=P1(x),f.context===null?f.context=x:f.pendingContext=x,f=ao(r),f.payload={element:c},w=w===void 0?null:w,w!==null&&(f.callback=w),c=so(a,f,r),c!==null&&(ba(c,a,r),Md(c,a,r))}function N1(a,r){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<r?c:r}}function rx(a,r){N1(a,r),(a=a.alternate)&&N1(a,r)}function F1(a){if(a.tag===13||a.tag===31){var r=qo(a,67108864);r!==null&&ba(r,a,67108864),rx(a,67108864)}}function z1(a){if(a.tag===13||a.tag===31){var r=La();r=et(r);var c=qo(a,r);c!==null&&ba(c,a,r),rx(a,r)}}var ph=!0;function lR(a,r,c,f){var x=A.T;A.T=null;var w=q.p;try{q.p=2,ox(a,r,c,f)}finally{q.p=w,A.T=x}}function cR(a,r,c,f){var x=A.T;A.T=null;var w=q.p;try{q.p=8,ox(a,r,c,f)}finally{q.p=w,A.T=x}}function ox(a,r,c,f){if(ph){var x=lx(f);if(x===null)Wg(a,r,f,mh,c),B1(a,f);else if(uR(x,a,r,c,f))f.stopPropagation();else if(B1(a,f),r&4&&-1<dR.indexOf(a)){for(;x!==null;){var w=gs(x);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var U=Ke(w.pendingLanes);if(U!==0){var Y=w;for(Y.pendingLanes|=2,Y.entangledLanes|=2;U;){var se=1<<31-ot(U);Y.entanglements[1]|=se,U&=~se}Us(w),(Cn&6)===0&&(Qf=H()+500,kd(0))}}break;case 31:case 13:Y=qo(w,2),Y!==null&&ba(Y,w,2),Jf(),rx(w,2)}if(w=lx(f),w===null&&Wg(a,r,f,mh,c),w===x)break;x=w}x!==null&&f.stopPropagation()}else Wg(a,r,f,null,c)}}function lx(a){return a=dm(a),cx(a)}var mh=null;function cx(a){if(mh=null,a=ms(a),a!==null){var r=l(a);if(r===null)a=null;else{var c=r.tag;if(c===13){if(a=d(r),a!==null)return a;a=null}else if(c===31){if(a=u(r),a!==null)return a;a=null}else if(c===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;a=null}else r!==a&&(a=null)}}return mh=a,null}function k1(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ie()){case we:return 2;case Ce:return 8;case ge:case je:return 32;case He:return 268435456;default:return 32}default:return 32}}var dx=!1,xo=null,yo=null,vo=null,$d=new Map,Wd=new Map,_o=[],dR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function B1(a,r){switch(a){case"focusin":case"focusout":xo=null;break;case"dragenter":case"dragleave":yo=null;break;case"mouseover":case"mouseout":vo=null;break;case"pointerover":case"pointerout":$d.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wd.delete(r.pointerId)}}function Yd(a,r,c,f,x,w){return a===null||a.nativeEvent!==w?(a={blockedOn:r,domEventName:c,eventSystemFlags:f,nativeEvent:w,targetContainers:[x]},r!==null&&(r=gs(r),r!==null&&F1(r)),a):(a.eventSystemFlags|=f,r=a.targetContainers,x!==null&&r.indexOf(x)===-1&&r.push(x),a)}function uR(a,r,c,f,x){switch(r){case"focusin":return xo=Yd(xo,a,r,c,f,x),!0;case"dragenter":return yo=Yd(yo,a,r,c,f,x),!0;case"mouseover":return vo=Yd(vo,a,r,c,f,x),!0;case"pointerover":var w=x.pointerId;return $d.set(w,Yd($d.get(w)||null,a,r,c,f,x)),!0;case"gotpointercapture":return w=x.pointerId,Wd.set(w,Yd(Wd.get(w)||null,a,r,c,f,x)),!0}return!1}function U1(a){var r=ms(a.target);if(r!==null){var c=l(r);if(c!==null){if(r=c.tag,r===13){if(r=d(c),r!==null){a.blockedOn=r,Ht(a.priority,function(){z1(c)});return}}else if(r===31){if(r=u(c),r!==null){a.blockedOn=r,Ht(a.priority,function(){z1(c)});return}}else if(r===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function gh(a){if(a.blockedOn!==null)return!1;for(var r=a.targetContainers;0<r.length;){var c=lx(a.nativeEvent);if(c===null){c=a.nativeEvent;var f=new c.constructor(c.type,c);cm=f,c.target.dispatchEvent(f),cm=null}else return r=gs(c),r!==null&&F1(r),a.blockedOn=c,!1;r.shift()}return!0}function H1(a,r,c){gh(a)&&c.delete(r)}function fR(){dx=!1,xo!==null&&gh(xo)&&(xo=null),yo!==null&&gh(yo)&&(yo=null),vo!==null&&gh(vo)&&(vo=null),$d.forEach(H1),Wd.forEach(H1)}function xh(a,r){a.blockedOn===r&&(a.blockedOn=null,dx||(dx=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,fR)))}var yh=null;function V1(a){yh!==a&&(yh=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){yh===a&&(yh=null);for(var r=0;r<a.length;r+=3){var c=a[r],f=a[r+1],x=a[r+2];if(typeof f!="function"){if(cx(f||c)===null)continue;break}var w=gs(c);w!==null&&(a.splice(r,3),r-=3,lg(w,{pending:!0,data:x,method:c.method,action:f},f,x))}}))}function fc(a){function r(se){return xh(se,a)}xo!==null&&xh(xo,a),yo!==null&&xh(yo,a),vo!==null&&xh(vo,a),$d.forEach(r),Wd.forEach(r);for(var c=0;c<_o.length;c++){var f=_o[c];f.blockedOn===a&&(f.blockedOn=null)}for(;0<_o.length&&(c=_o[0],c.blockedOn===null);)U1(c),c.blockedOn===null&&_o.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var x=c[f],w=c[f+1],U=x[gn]||null;if(typeof w=="function")U||V1(c);else if(U){var Y=null;if(w&&w.hasAttribute("formAction")){if(x=w,U=w[gn]||null)Y=U.formAction;else if(cx(x)!==null)continue}else Y=U.action;typeof Y=="function"?c[f+1]=Y:(c.splice(f,3),f-=3),V1(c)}}}function q1(){function a(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(U){return x=U})},focusReset:"manual",scroll:"manual"})}function r(){x!==null&&(x(),x=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),x!==null&&(x(),x=null)}}}function ux(a){this._internalRoot=a}vh.prototype.render=ux.prototype.render=function(a){var r=this._internalRoot;if(r===null)throw Error(s(409));var c=r.current,f=La();L1(c,f,a,r,null,null)},vh.prototype.unmount=ux.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var r=a.containerInfo;L1(a.current,2,null,a,null,null),Jf(),r[yt]=null}};function vh(a){this._internalRoot=a}vh.prototype.unstable_scheduleHydration=function(a){if(a){var r=Qe();a={blockedOn:null,target:a,priority:r};for(var c=0;c<_o.length&&r!==0&&r<_o[c].priority;c++);_o.splice(c,0,a),c===0&&U1(a)}};var G1=e.version;if(G1!=="19.2.4")throw Error(s(527,G1,"19.2.4"));q.findDOMNode=function(a){var r=a._reactInternals;if(r===void 0)throw typeof a.render=="function"?Error(s(188)):(a=Object.keys(a).join(","),Error(s(268,a)));return a=p(r),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var hR={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:A,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_h.isDisabled&&_h.supportsFiber)try{We=_h.inject(hR),qe=_h}catch{}}return Xd.createRoot=function(a,r){if(!o(a))throw Error(s(299));var c=!1,f="",x=Zb,w=Jb,U=eS;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(x=r.onUncaughtError),r.onCaughtError!==void 0&&(w=r.onCaughtError),r.onRecoverableError!==void 0&&(U=r.onRecoverableError)),r=O1(a,1,!1,null,null,c,f,null,x,w,U,q1),a[yt]=r.current,$g(a),new ux(r)},Xd.hydrateRoot=function(a,r,c){if(!o(a))throw Error(s(299));var f=!1,x="",w=Zb,U=Jb,Y=eS,se=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(U=c.onCaughtError),c.onRecoverableError!==void 0&&(Y=c.onRecoverableError),c.formState!==void 0&&(se=c.formState)),r=O1(a,1,!0,r,c??null,f,x,se,w,U,Y,q1),r.context=P1(null),c=r.current,f=La(),f=et(f),x=ao(f),x.callback=null,so(c,x,f),c=f,r.current.lanes=c,si(r,c),Us(r),a[yt]=r.current,$g(a),new vh(r)},Xd.version="19.2.4",Xd}var eM;function M3(){if(eM)return mx.exports;eM=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),mx.exports=S3(),mx.exports}var w3=M3(),id=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},C3={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},T3=class{#e=C3;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},pl=new T3;function j3(t){setTimeout(t,0)}var jl=typeof window>"u"||"Deno"in globalThis;function ha(){}function E3(t,e){return typeof t=="function"?t(e):t}function Gy(t){return typeof t=="number"&&t>=0&&t!==1/0}function zT(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Fo(t,e){return typeof t=="function"?t(e):t}function cs(t,e){return typeof t=="function"?t(e):t}function tM(t,e){const{type:n="all",exact:s,fetchStatus:o,predicate:l,queryKey:d,stale:u}=t;if(d){if(s){if(e.queryHash!==_v(d,e.options))return!1}else if(!Ou(e.queryKey,d))return!1}if(n!=="all"){const h=e.isActive();if(n==="active"&&!h||n==="inactive"&&h)return!1}return!(typeof u=="boolean"&&e.isStale()!==u||o&&o!==e.state.fetchStatus||l&&!l(e))}function nM(t,e){const{exact:n,status:s,predicate:o,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(El(e.options.mutationKey)!==El(l))return!1}else if(!Ou(e.options.mutationKey,l))return!1}return!(s&&e.state.status!==s||o&&!o(e))}function _v(t,e){return(e?.queryKeyHashFn||El)(t)}function El(t){return JSON.stringify(t,(e,n)=>$y(n)?Object.keys(n).sort().reduce((s,o)=>(s[o]=n[o],s),{}):n)}function Ou(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Ou(t[n],e[n])):!1}var A3=Object.prototype.hasOwnProperty;function kT(t,e,n=0){if(t===e)return t;if(n>500)return e;const s=iM(t)&&iM(e);if(!s&&!($y(t)&&$y(e)))return e;const l=(s?t:Object.keys(t)).length,d=s?e:Object.keys(e),u=d.length,h=s?new Array(u):{};let p=0;for(let m=0;m<u;m++){const g=s?m:d[m],v=t[g],C=e[g];if(v===C){h[g]=v,(s?m<l:A3.call(t,g))&&p++;continue}if(v===null||C===null||typeof v!="object"||typeof C!="object"){h[g]=C;continue}const b=kT(v,C,n+1);h[g]=b,b===v&&p++}return l===u&&p===l?t:h}function kp(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function iM(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function $y(t){if(!aM(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!aM(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function aM(t){return Object.prototype.toString.call(t)==="[object Object]"}function R3(t){return new Promise(e=>{pl.setTimeout(e,t)})}function Wy(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?kT(t,e):e}function D3(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function I3(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var bv=Symbol();function BT(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===bv?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Sv(t,e){return typeof t=="function"?t(...e):!!t}function O3(t,e,n){let s=!1,o;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(o??=e(),s||(s=!0,o.aborted?n():o.addEventListener("abort",n,{once:!0})),o)}),t}var P3=class extends id{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!jl&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Mv=new P3;function Yy(){let t,e;const n=new Promise((o,l)=>{t=o,e=l});n.status="pending",n.catch(()=>{});function s(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{s({status:"fulfilled",value:o}),t(o)},n.reject=o=>{s({status:"rejected",reason:o}),e(o)},n}var L3=j3;function N3(){let t=[],e=0,n=u=>{u()},s=u=>{u()},o=L3;const l=u=>{e?t.push(u):o(()=>{n(u)})},d=()=>{const u=t;t=[],u.length&&o(()=>{s(()=>{u.forEach(h=>{n(h)})})})};return{batch:u=>{let h;e++;try{h=u()}finally{e--,e||d()}return h},batchCalls:u=>(...h)=>{l(()=>{u(...h)})},schedule:l,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{o=u}}}var Si=N3(),F3=class extends id{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!jl&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},Bp=new F3;function z3(t){return Math.min(1e3*2**t,3e4)}function UT(t){return(t??"online")==="online"?Bp.isOnline():!0}var Ky=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function HT(t){let e=!1,n=0,s;const o=Yy(),l=()=>o.status!=="pending",d=_=>{if(!l()){const y=new Ky(_);v(y),t.onCancel?.(y)}},u=()=>{e=!0},h=()=>{e=!1},p=()=>Mv.isFocused()&&(t.networkMode==="always"||Bp.isOnline())&&t.canRun(),m=()=>UT(t.networkMode)&&t.canRun(),g=_=>{l()||(s?.(),o.resolve(_))},v=_=>{l()||(s?.(),o.reject(_))},C=()=>new Promise(_=>{s=y=>{(l()||p())&&_(y)},t.onPause?.()}).then(()=>{s=void 0,l()||t.onContinue?.()}),b=()=>{if(l())return;let _;const y=n===0?t.initialPromise:void 0;try{_=y??t.fn()}catch(S){_=Promise.reject(S)}Promise.resolve(_).then(g).catch(S=>{if(l())return;const D=t.retry??(jl?0:3),L=t.retryDelay??z3,N=typeof L=="function"?L(n,S):L,T=D===!0||typeof D=="number"&&n<D||typeof D=="function"&&D(n,S);if(e||!T){v(S);return}n++,t.onFail?.(n,S),R3(N).then(()=>p()?void 0:C()).then(()=>{e?v(S):b()})})};return{promise:o,status:()=>o.status,cancel:d,continue:()=>(s?.(),o),cancelRetry:u,continueRetry:h,canStart:m,start:()=>(m()?b():C().then(b),o)}}var VT=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Gy(this.gcTime)&&(this.#e=pl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(jl?1/0:300*1e3))}clearGcTimeout(){this.#e&&(pl.clearTimeout(this.#e),this.#e=void 0)}},k3=class extends VT{#e;#t;#n;#a;#i;#r;#o;constructor(t){super(),this.#o=!1,this.#r=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#a=t.client,this.#n=this.#a.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=rM(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#i?.promise}setOptions(t){if(this.options={...this.#r,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=rM(this.options);e.data!==void 0&&(this.setState(sM(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const n=Wy(this.state.data,t,this.options);return this.#s({data:n,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),n}setState(t,e){this.#s({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#i?.promise;return this.#i?.cancel(t),e?e.then(ha).catch(ha):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>cs(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===bv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Fo(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!zT(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#i?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#i?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#i&&(this.#o?this.#i.cancel({revert:!0}):this.#i.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#i?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#i)return this.#i.continueRetry(),this.#i.promise}if(t&&this.setOptions(t),!this.options.queryFn){const u=this.observers.find(h=>h.options.queryFn);u&&this.setOptions(u.options)}const n=new AbortController,s=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(this.#o=!0,n.signal)})},o=()=>{const u=BT(this.options,e),p=(()=>{const m={client:this.#a,queryKey:this.queryKey,meta:this.meta};return s(m),m})();return this.#o=!1,this.options.persister?this.options.persister(u,p,this):u(p)},d=(()=>{const u={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#a,state:this.state,fetchFn:o};return s(u),u})();this.options.behavior?.onFetch(d,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==d.fetchOptions?.meta)&&this.#s({type:"fetch",meta:d.fetchOptions?.meta}),this.#i=HT({initialPromise:e?.initialPromise,fn:d.fetchFn,onCancel:u=>{u instanceof Ky&&u.revert&&this.setState({...this.#t,fetchStatus:"idle"}),n.abort()},onFail:(u,h)=>{this.#s({type:"failed",failureCount:u,error:h})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0});try{const u=await this.#i.start();if(u===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(u),this.#n.config.onSuccess?.(u,this),this.#n.config.onSettled?.(u,this.state.error,this),u}catch(u){if(u instanceof Ky){if(u.silent)return this.#i.promise;if(u.revert){if(this.state.data===void 0)throw u;return this.state.data}}throw this.#s({type:"error",error:u}),this.#n.config.onError?.(u,this),this.#n.config.onSettled?.(this.state.data,u,this),u}finally{this.scheduleGc()}}#s(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...qT(n.data,this.options),fetchMeta:t.meta??null};case"success":const s={...n,...sM(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?s:void 0,s;case"error":const o=t.error;return{...n,error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),Si.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function qT(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:UT(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function sM(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function rM(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var B3=class extends id{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Yy(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#a=void 0;#i;#r;#o;#s;#m;#f;#h;#c;#d;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),oM(this.#t,this.options)?this.#u():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Xy(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Xy(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#_(),this.#b(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof cs(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#t.setOptions(this.options),e._defaulted&&!kp(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const s=this.hasListeners();s&&lM(this.#t,n,this.options,e)&&this.#u(),this.updateResult(),s&&(this.#t!==n||cs(this.options.enabled,this.#t)!==cs(e.enabled,this.#t)||Fo(this.options.staleTime,this.#t)!==Fo(e.staleTime,this.#t))&&this.#g();const o=this.#x();s&&(this.#t!==n||cs(this.options.enabled,this.#t)!==cs(e.enabled,this.#t)||o!==this.#l)&&this.#y(o)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return H3(this,n)&&(this.#a=n,this.#r=this.options,this.#i=this.#t.state),n}getCurrentResult(){return this.#a}trackResult(t,e){return new Proxy(t,{get:(n,s)=>(this.trackProp(s),e?.(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,s))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#u({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#a))}#u(t){this.#S();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(ha)),e}#g(){this.#_();const t=Fo(this.options.staleTime,this.#t);if(jl||this.#a.isStale||!Gy(t))return;const n=zT(this.#a.dataUpdatedAt,t)+1;this.#c=pl.setTimeout(()=>{this.#a.isStale||this.updateResult()},n)}#x(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#y(t){this.#b(),this.#l=t,!(jl||cs(this.options.enabled,this.#t)===!1||!Gy(this.#l)||this.#l===0)&&(this.#d=pl.setInterval(()=>{(this.options.refetchIntervalInBackground||Mv.isFocused())&&this.#u()},this.#l))}#v(){this.#g(),this.#y(this.#x())}#_(){this.#c&&(pl.clearTimeout(this.#c),this.#c=void 0)}#b(){this.#d&&(pl.clearInterval(this.#d),this.#d=void 0)}createResult(t,e){const n=this.#t,s=this.options,o=this.#a,l=this.#i,d=this.#r,h=t!==n?t.state:this.#n,{state:p}=t;let m={...p},g=!1,v;if(e._optimisticResults){const R=this.hasListeners(),M=!R&&oM(t,e),I=R&&lM(t,n,e,s);(M||I)&&(m={...m,...qT(p.data,t.options)}),e._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:C,errorUpdatedAt:b,status:_}=m;v=m.data;let y=!1;if(e.placeholderData!==void 0&&v===void 0&&_==="pending"){let R;o?.isPlaceholderData&&e.placeholderData===d?.placeholderData?(R=o.data,y=!0):R=typeof e.placeholderData=="function"?e.placeholderData(this.#h?.state.data,this.#h):e.placeholderData,R!==void 0&&(_="success",v=Wy(o?.data,R,e),g=!0)}if(e.select&&v!==void 0&&!y)if(o&&v===l?.data&&e.select===this.#m)v=this.#f;else try{this.#m=e.select,v=e.select(v),v=Wy(o?.data,v,e),this.#f=v,this.#s=null}catch(R){this.#s=R}this.#s&&(C=this.#s,v=this.#f,b=Date.now(),_="error");const S=m.fetchStatus==="fetching",D=_==="pending",L=_==="error",N=D&&S,T=v!==void 0,E={status:_,fetchStatus:m.fetchStatus,isPending:D,isSuccess:_==="success",isError:L,isInitialLoading:N,isLoading:N,data:v,dataUpdatedAt:m.dataUpdatedAt,error:C,errorUpdatedAt:b,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>h.dataUpdateCount||m.errorUpdateCount>h.errorUpdateCount,isFetching:S,isRefetching:S&&!D,isLoadingError:L&&!T,isPaused:m.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:L&&T,isStale:wv(t,e),refetch:this.refetch,promise:this.#o,isEnabled:cs(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const R=E.data!==void 0,M=E.status==="error"&&!R,I=O=>{M?O.reject(E.error):R&&O.resolve(E.data)},z=()=>{const O=this.#o=E.promise=Yy();I(O)},V=this.#o;switch(V.status){case"pending":t.queryHash===n.queryHash&&I(V);break;case"fulfilled":(M||E.data!==V.value)&&z();break;case"rejected":(!M||E.error!==V.reason)&&z();break}}return E}updateResult(){const t=this.#a,e=this.createResult(this.#t,this.options);if(this.#i=this.#t.state,this.#r=this.options,this.#i.data!==void 0&&(this.#h=this.#t),kp(e,t))return;this.#a=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,o=typeof s=="function"?s():s;if(o==="all"||!o&&!this.#p.size)return!0;const l=new Set(o??this.#p);return this.options.throwOnError&&l.add("error"),Object.keys(this.#a).some(d=>{const u=d;return this.#a[u]!==t[u]&&l.has(u)})};this.#M({listeners:n()})}#S(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#M(t){Si.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#a)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function U3(t,e){return cs(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function oM(t,e){return U3(t,e)||t.state.data!==void 0&&Xy(t,e,e.refetchOnMount)}function Xy(t,e,n){if(cs(e.enabled,t)!==!1&&Fo(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&wv(t,e)}return!1}function lM(t,e,n,s){return(t!==e||cs(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&wv(t,n)}function wv(t,e){return cs(e.enabled,t)!==!1&&t.isStaleByTime(Fo(e.staleTime,t))}function H3(t,e){return!kp(t.getCurrentResult(),e)}function cM(t){return{onFetch:(e,n)=>{const s=e.options,o=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],d=e.state.data?.pageParams||[];let u={pages:[],pageParams:[]},h=0;const p=async()=>{let m=!1;const g=b=>{O3(b,()=>e.signal,()=>m=!0)},v=BT(e.options,e.fetchOptions),C=async(b,_,y)=>{if(m)return Promise.reject();if(_==null&&b.pages.length)return Promise.resolve(b);const D=(()=>{const j={client:e.client,queryKey:e.queryKey,pageParam:_,direction:y?"backward":"forward",meta:e.options.meta};return g(j),j})(),L=await v(D),{maxPages:N}=e.options,T=y?I3:D3;return{pages:T(b.pages,L,N),pageParams:T(b.pageParams,_,N)}};if(o&&l.length){const b=o==="backward",_=b?V3:dM,y={pages:l,pageParams:d},S=_(s,y);u=await C(y,S,b)}else{const b=t??l.length;do{const _=h===0?d[0]??s.initialPageParam:dM(s,u);if(h>0&&_==null)break;u=await C(u,_),h++}while(h<b)}return u};e.options.persister?e.fetchFn=()=>e.options.persister?.(p,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=p}}}function dM(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function V3(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var q3=class extends VT{#e;#t;#n;#a;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#t=[],this.state=t.state||GT(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#a?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#i({type:"continue"})},n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#a=HT({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(l,d)=>{this.#i({type:"failed",failureCount:l,error:d})},onPause:()=>{this.#i({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const s=this.state.status==="pending",o=!this.#a.canStart();try{if(s)e();else{this.#i({type:"pending",variables:t,isPaused:o}),this.#n.config.onMutate&&await this.#n.config.onMutate(t,this,n);const d=await this.options.onMutate?.(t,n);d!==this.state.context&&this.#i({type:"pending",context:d,variables:t,isPaused:o})}const l=await this.#a.start();return await this.#n.config.onSuccess?.(l,t,this.state.context,this,n),await this.options.onSuccess?.(l,t,this.state.context,n),await this.#n.config.onSettled?.(l,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(l,null,t,this.state.context,n),this.#i({type:"success",data:l}),l}catch(l){try{await this.#n.config.onError?.(l,t,this.state.context,this,n)}catch(d){Promise.reject(d)}try{await this.options.onError?.(l,t,this.state.context,n)}catch(d){Promise.reject(d)}try{await this.#n.config.onSettled?.(void 0,l,this.state.variables,this.state.context,this,n)}catch(d){Promise.reject(d)}try{await this.options.onSettled?.(void 0,l,t,this.state.context,n)}catch(d){Promise.reject(d)}throw this.#i({type:"error",error:l}),l}finally{this.#n.runNext(this)}}#i(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Si.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function GT(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var G3=class extends id{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const s=new q3({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(s),s}add(t){this.#e.add(t);const e=bh(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=bh(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=bh(t);if(typeof e=="string"){const s=this.#t.get(e)?.find(o=>o.state.status==="pending");return!s||s===t}else return!0}runNext(t){const e=bh(t);return typeof e=="string"?this.#t.get(e)?.find(s=>s!==t&&s.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Si.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>nM(e,n))}findAll(t={}){return this.getAll().filter(e=>nM(t,e))}notify(t){Si.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Si.batch(()=>Promise.all(t.map(e=>e.continue().catch(ha))))}};function bh(t){return t.options.scope?.id}var $3=class extends id{#e;#t=void 0;#n;#a;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),kp(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&El(n.mutationKey)!==El(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#r(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#i(),this.#r()}mutate(e,n){return this.#a=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#i(){const e=this.#n?.state??GT();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#r(e){Si.batch(()=>{if(this.#a&&this.hasListeners()){const n=this.#t.variables,s=this.#t.context,o={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#a.onSuccess?.(e.data,n,s,o)}catch(l){Promise.reject(l)}try{this.#a.onSettled?.(e.data,null,n,s,o)}catch(l){Promise.reject(l)}}else if(e?.type==="error"){try{this.#a.onError?.(e.error,n,s,o)}catch(l){Promise.reject(l)}try{this.#a.onSettled?.(void 0,e.error,n,s,o)}catch(l){Promise.reject(l)}}}this.listeners.forEach(n=>{n(this.#t)})})}},W3=class extends id{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const s=e.queryKey,o=e.queryHash??_v(s,e);let l=this.get(o);return l||(l=new k3({client:t,queryKey:s,queryHash:o,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Si.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>tM(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>tM(t,n)):e}notify(t){Si.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Si.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Si.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Y3=class{#e;#t;#n;#a;#i;#r;#o;#s;constructor(t={}){this.#e=t.queryCache||new W3,this.#t=t.mutationCache||new G3,this.#n=t.defaultOptions||{},this.#a=new Map,this.#i=new Map,this.#r=0}mount(){this.#r++,this.#r===1&&(this.#o=Mv.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=Bp.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#r--,this.#r===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Fo(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(s.queryHash)?.state.data,d=E3(e,l);if(d!==void 0)return this.#e.build(this,s).setData(d,{...n,manual:!0})}setQueriesData(t,e,n){return Si.batch(()=>this.#e.findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Si.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return Si.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=Si.batch(()=>this.#e.findAll(t).map(o=>o.cancel(n)));return Promise.all(s).then(ha).catch(ha)}invalidateQueries(t,e={}){return Si.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=Si.batch(()=>this.#e.findAll(t).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let l=o.fetch(void 0,n);return n.throwOnError||(l=l.catch(ha)),o.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(s).then(ha)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Fo(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(ha).catch(ha)}fetchInfiniteQuery(t){return t.behavior=cM(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(ha).catch(ha)}ensureInfiniteQueryData(t){return t.behavior=cM(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Bp.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#a.set(El(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#a.values()],n={};return e.forEach(s=>{Ou(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){this.#i.set(El(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(s=>{Ou(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=_v(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===bv&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},$T=P.createContext(void 0),Ln=t=>{const e=P.useContext($T);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},K3=({client:t,children:e})=>(P.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),i.jsx($T.Provider,{value:t,children:e})),WT=P.createContext(!1),X3=()=>P.useContext(WT);WT.Provider;function Q3(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Z3=P.createContext(Q3()),J3=()=>P.useContext(Z3),eD=(t,e,n)=>{const s=n?.state.error&&typeof t.throwOnError=="function"?Sv(t.throwOnError,[n.state.error,n]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||s)&&(e.isReset()||(t.retryOnMount=!1))},tD=t=>{P.useEffect(()=>{t.clearReset()},[t])},nD=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:o})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(o&&t.data===void 0||Sv(n,[t.error,s])),iD=t=>{if(t.suspense){const n=o=>o==="static"?o:Math.max(o??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...o)=>n(s(...o)):n(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},aD=(t,e)=>t.isLoading&&t.isFetching&&!e,sD=(t,e)=>t?.suspense&&e.isPending,uM=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function rD(t,e,n){const s=X3(),o=J3(),l=Ln(),d=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(d);const u=l.getQueryCache().get(d.queryHash);d._optimisticResults=s?"isRestoring":"optimistic",iD(d),eD(d,o,u),tD(o);const h=!l.getQueryCache().get(d.queryHash),[p]=P.useState(()=>new e(l,d)),m=p.getOptimisticResult(d),g=!s&&t.subscribed!==!1;if(P.useSyncExternalStore(P.useCallback(v=>{const C=g?p.subscribe(Si.batchCalls(v)):ha;return p.updateResult(),C},[p,g]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),P.useEffect(()=>{p.setOptions(d)},[d,p]),sD(d,m))throw uM(d,p,o);if(nD({result:m,errorResetBoundary:o,throwOnError:d.throwOnError,query:u,suspense:d.suspense}))throw m.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(d,m),d.experimental_prefetchInRender&&!jl&&aD(m,s)&&(h?uM(d,p,o):u?.promise)?.catch(ha).finally(()=>{p.updateResult()}),d.notifyOnChangeProps?m:p.trackResult(m)}function ct(t,e){return rD(t,B3)}function Rt(t,e){const n=Ln(),[s]=P.useState(()=>new $3(n,t));P.useEffect(()=>{s.setOptions(t)},[s,t]);const o=P.useSyncExternalStore(P.useCallback(d=>s.subscribe(Si.batchCalls(d)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=P.useCallback((d,u)=>{s.mutate(d,u).catch(ha)},[s]);if(o.error&&Sv(s.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:l,mutateAsync:o.mutate}}var Qd={},yx={exports:{}},fM;function Zp(){return fM||(fM=1,(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(yx)),yx.exports}var Zd={},hM;function oD(){if(hM)return Zd;hM=1,Object.defineProperty(Zd,"__esModule",{value:!0}),Zd.default=void 0;var t={items_per_page:"/",jump_to:"",jump_to_confirm:"",page:"",prev_page:"",next_page:"",prev_5:" 5 ",next_5:" 5 ",prev_3:" 3 ",next_3:" 3 ",page_size:""};return Zd.default=t,Zd}var Jd={},eu={},tu={},vx={exports:{}},_x={exports:{}},bx={exports:{}},Sx={exports:{}},pM;function YT(){return pM||(pM=1,(function(t){function e(n){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Sx)),Sx.exports}var Mx={exports:{}},mM;function lD(){return mM||(mM=1,(function(t){var e=YT().default;function n(s,o){if(e(s)!="object"||!s)return s;var l=s[Symbol.toPrimitive];if(l!==void 0){var d=l.call(s,o||"default");if(e(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(s)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Mx)),Mx.exports}var gM;function cD(){return gM||(gM=1,(function(t){var e=YT().default,n=lD();function s(o){var l=n(o,"string");return e(l)=="symbol"?l:l+""}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(bx)),bx.exports}var xM;function dD(){return xM||(xM=1,(function(t){var e=cD();function n(s,o,l){return(o=e(o))in s?Object.defineProperty(s,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[o]=l,s}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(_x)),_x.exports}var yM;function uD(){return yM||(yM=1,(function(t){var e=dD();function n(o,l){var d=Object.keys(o);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(o);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(o,h).enumerable})),d.push.apply(d,u)}return d}function s(o){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?arguments[l]:{};l%2?n(Object(d),!0).forEach(function(u){e(o,u,d[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(d)):n(Object(d)).forEach(function(u){Object.defineProperty(o,u,Object.getOwnPropertyDescriptor(d,u))})}return o}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports})(vx)),vx.exports}var nu={},vM;function fD(){return vM||(vM=1,Object.defineProperty(nu,"__esModule",{value:!0}),nu.commonLocale=void 0,nu.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0}),nu}var _M;function hD(){if(_M)return tu;_M=1;var t=Zp().default;Object.defineProperty(tu,"__esModule",{value:!0}),tu.default=void 0;var e=t(uD()),n=fD(),s=(0,e.default)((0,e.default)({},n.commonLocale),{},{locale:"zh_CN",today:"",now:"",backToToday:"",ok:"",timeSelect:"",dateSelect:"",weekSelect:"",clear:"",week:"",month:"",year:"",previousMonth:" ()",nextMonth:" ()",monthSelect:"",yearSelect:"",decadeSelect:"",previousYear:" (Control)",nextYear:" (Control)",previousDecade:"",nextDecade:"",previousCentury:"",nextCentury:"",yearFormat:"YYYY",cellDateFormat:"D",monthBeforeYear:!1});return tu.default=s,tu}var iu={},bM;function KT(){if(bM)return iu;bM=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.default=void 0;const t={placeholder:"",rangePlaceholder:["",""]};return iu.default=t,iu}var SM;function XT(){if(SM)return eu;SM=1;var t=Zp().default;Object.defineProperty(eu,"__esModule",{value:!0}),eu.default=void 0;var e=t(hD()),n=t(KT());const s={lang:Object.assign({placeholder:"",yearPlaceholder:"",quarterPlaceholder:"",monthPlaceholder:"",weekPlaceholder:"",rangePlaceholder:["",""],rangeYearPlaceholder:["",""],rangeMonthPlaceholder:["",""],rangeQuarterPlaceholder:["",""],rangeWeekPlaceholder:["",""]},e.default),timePickerLocale:Object.assign({},n.default)};return s.lang.ok="",eu.default=s,eu}var MM;function pD(){if(MM)return Jd;MM=1;var t=Zp().default;Object.defineProperty(Jd,"__esModule",{value:!0}),Jd.default=void 0;var e=t(XT());return Jd.default=e.default,Jd}var wM;function mD(){if(wM)return Qd;wM=1;var t=Zp().default;Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.default=void 0;var e=t(oD()),n=t(pD()),s=t(XT()),o=t(KT());const l="${label}${type}",d={locale:"zh-cn",Pagination:e.default,DatePicker:s.default,TimePicker:o.default,Calendar:n.default,global:{placeholder:"",close:""},Table:{filterTitle:"",filterConfirm:"",filterReset:"",filterEmptyText:"",filterCheckAll:"",filterSearchPlaceholder:"",emptyText:"",selectAll:"",selectInvert:"",selectNone:"",selectionAll:"",sortTitle:"",expand:"",collapse:"",triggerDesc:"",triggerAsc:"",cancelSort:""},Modal:{okText:"",cancelText:"",justOkText:""},Tour:{Next:"",Previous:"",Finish:""},Popconfirm:{cancelText:"",okText:""},Transfer:{titles:["",""],searchPlaceholder:"",itemUnit:"",itemsUnit:"",remove:"",selectCurrent:"",removeCurrent:"",selectAll:"",deselectAll:"",removeAll:"",selectInvert:""},Upload:{uploading:"",removeFile:"",uploadError:"",previewFile:"",downloadFile:""},Empty:{description:""},Icon:{icon:""},Text:{edit:"",copy:"",copied:"",expand:"",collapse:""},Form:{optional:"",defaultValidateMessages:{default:"${label}",required:"${label}",enum:"${label}[${enum}]",whitespace:"${label}",date:{format:"${label}",parse:"${label}",invalid:"${label}"},types:{string:l,method:l,array:l,object:l,number:l,date:l,boolean:l,integer:l,float:l,regexp:l,email:l,url:l,hex:l},string:{len:"${label}${len}",min:"${label}${min}",max:"${label}${max}",range:"${label}${min}-${max}"},number:{len:"${label}${len}",min:"${label}${min}",max:"${label}${max}",range:"${label}${min}-${max}"},array:{len:"${len}${label}",min:"${min}${label}",max:"${max}${label}",range:"${label}${min}-${max}"},pattern:{mismatch:"${label}${pattern}"}}},Image:{preview:""},QRCode:{expired:"",refresh:"",scanned:""},ColorPicker:{presetEmpty:"",transparent:"",singleColor:"",gradientColor:""}};return Qd.default=d,Qd}var wx,CM;function gD(){return CM||(CM=1,wx=mD()),wx}var xD=gD();const yD=gR(xD);var _p={exports:{}},vD=_p.exports,TM;function _D(){return TM||(TM=1,(function(t,e){(function(n,s){t.exports=s(_R())})(vD,(function(n){function s(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var o=s(n),l={name:"zh-cn",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),ordinal:function(d,u){return u==="W"?d+"":d+""},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDAhmm",LLLL:"YYYYMDddddAhmm",l:"YYYY/M/D",ll:"YYYYMD",lll:"YYYYMD HH:mm",llll:"YYYYMDdddd HH:mm"},relativeTime:{future:"%s",past:"%s",s:"",m:"1 ",mm:"%d ",h:"1 ",hh:"%d ",d:"1 ",dd:"%d ",M:"1 ",MM:"%d ",y:"1 ",yy:"%d "},meridiem:function(d,u){var h=100*d+u;return h<600?"":h<900?"":h<1100?"":h<1300?"":h<1800?"":""}};return o.default.locale(l,null,!0),l}))})(_p)),_p.exports}_D();function QT(t,e){return function(){return t.apply(e,arguments)}}const{toString:bD}=Object.prototype,{getPrototypeOf:Cv}=Object,{iterator:Jp,toStringTag:ZT}=Symbol,em=(t=>e=>{const n=bD.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Fs=t=>(t=t.toLowerCase(),e=>em(e)===t),tm=t=>e=>typeof e===t,{isArray:ad}=Array,$c=tm("undefined");function Ku(t){return t!==null&&!$c(t)&&t.constructor!==null&&!$c(t.constructor)&&Ca(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const JT=Fs("ArrayBuffer");function SD(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&JT(t.buffer),e}const MD=tm("string"),Ca=tm("function"),ej=tm("number"),Xu=t=>t!==null&&typeof t=="object",wD=t=>t===!0||t===!1,bp=t=>{if(em(t)!=="object")return!1;const e=Cv(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(ZT in t)&&!(Jp in t)},CD=t=>{if(!Xu(t)||Ku(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},TD=Fs("Date"),jD=Fs("File"),ED=Fs("Blob"),AD=Fs("FileList"),RD=t=>Xu(t)&&Ca(t.pipe),DD=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ca(t.append)&&((e=em(t))==="formdata"||e==="object"&&Ca(t.toString)&&t.toString()==="[object FormData]"))},ID=Fs("URLSearchParams"),[OD,PD,LD,ND]=["ReadableStream","Request","Response","Headers"].map(Fs),FD=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Qu(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,o;if(typeof t!="object"&&(t=[t]),ad(t))for(s=0,o=t.length;s<o;s++)e.call(null,t[s],s,t);else{if(Ku(t))return;const l=n?Object.getOwnPropertyNames(t):Object.keys(t),d=l.length;let u;for(s=0;s<d;s++)u=l[s],e.call(null,t[u],u,t)}}function tj(t,e){if(Ku(t))return null;e=e.toLowerCase();const n=Object.keys(t);let s=n.length,o;for(;s-- >0;)if(o=n[s],e===o.toLowerCase())return o;return null}const ml=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,nj=t=>!$c(t)&&t!==ml;function Qy(){const{caseless:t,skipUndefined:e}=nj(this)&&this||{},n={},s=(o,l)=>{const d=t&&tj(n,l)||l;bp(n[d])&&bp(o)?n[d]=Qy(n[d],o):bp(o)?n[d]=Qy({},o):ad(o)?n[d]=o.slice():(!e||!$c(o))&&(n[d]=o)};for(let o=0,l=arguments.length;o<l;o++)arguments[o]&&Qu(arguments[o],s);return n}const zD=(t,e,n,{allOwnKeys:s}={})=>(Qu(e,(o,l)=>{n&&Ca(o)?Object.defineProperty(t,l,{value:QT(o,n),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(t,l,{value:o,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:s}),t),kD=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),BD=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),Object.defineProperty(t.prototype,"constructor",{value:t,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},UD=(t,e,n,s)=>{let o,l,d;const u={};if(e=e||{},t==null)return e;do{for(o=Object.getOwnPropertyNames(t),l=o.length;l-- >0;)d=o[l],(!s||s(d,t,e))&&!u[d]&&(e[d]=t[d],u[d]=!0);t=n!==!1&&Cv(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},HD=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},VD=t=>{if(!t)return null;if(ad(t))return t;let e=t.length;if(!ej(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},qD=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Cv(Uint8Array)),GD=(t,e)=>{const s=(t&&t[Jp]).call(t);let o;for(;(o=s.next())&&!o.done;){const l=o.value;e.call(t,l[0],l[1])}},$D=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},WD=Fs("HTMLFormElement"),YD=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,o){return s.toUpperCase()+o}),jM=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),KD=Fs("RegExp"),ij=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Qu(n,(o,l)=>{let d;(d=e(o,l,t))!==!1&&(s[l]=d||o)}),Object.defineProperties(t,s)},XD=t=>{ij(t,(e,n)=>{if(Ca(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(Ca(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},QD=(t,e)=>{const n={},s=o=>{o.forEach(l=>{n[l]=!0})};return ad(t)?s(t):s(String(t).split(e)),n},ZD=()=>{},JD=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function eI(t){return!!(t&&Ca(t.append)&&t[ZT]==="FormData"&&t[Jp])}const tI=t=>{const e=new Array(10),n=(s,o)=>{if(Xu(s)){if(e.indexOf(s)>=0)return;if(Ku(s))return s;if(!("toJSON"in s)){e[o]=s;const l=ad(s)?[]:{};return Qu(s,(d,u)=>{const h=n(d,o+1);!$c(h)&&(l[u]=h)}),e[o]=void 0,l}}return s};return n(t,0)},nI=Fs("AsyncFunction"),iI=t=>t&&(Xu(t)||Ca(t))&&Ca(t.then)&&Ca(t.catch),aj=((t,e)=>t?setImmediate:e?((n,s)=>(ml.addEventListener("message",({source:o,data:l})=>{o===ml&&l===n&&s.length&&s.shift()()},!1),o=>{s.push(o),ml.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Ca(ml.postMessage)),aI=typeof queueMicrotask<"u"?queueMicrotask.bind(ml):typeof process<"u"&&process.nextTick||aj,sI=t=>t!=null&&Ca(t[Jp]),Ne={isArray:ad,isArrayBuffer:JT,isBuffer:Ku,isFormData:DD,isArrayBufferView:SD,isString:MD,isNumber:ej,isBoolean:wD,isObject:Xu,isPlainObject:bp,isEmptyObject:CD,isReadableStream:OD,isRequest:PD,isResponse:LD,isHeaders:ND,isUndefined:$c,isDate:TD,isFile:jD,isBlob:ED,isRegExp:KD,isFunction:Ca,isStream:RD,isURLSearchParams:ID,isTypedArray:qD,isFileList:AD,forEach:Qu,merge:Qy,extend:zD,trim:FD,stripBOM:kD,inherits:BD,toFlatObject:UD,kindOf:em,kindOfTest:Fs,endsWith:HD,toArray:VD,forEachEntry:GD,matchAll:$D,isHTMLForm:WD,hasOwnProperty:jM,hasOwnProp:jM,reduceDescriptors:ij,freezeMethods:XD,toObjectSet:QD,toCamelCase:YD,noop:ZD,toFiniteNumber:JD,findKey:tj,global:ml,isContextDefined:nj,isSpecCompliantForm:eI,toJSONObject:tI,isAsyncFn:nI,isThenable:iI,setImmediate:aj,asap:aI,isIterable:sI};let qt=class sj extends Error{static from(e,n,s,o,l,d){const u=new sj(e.message,n||e.code,s,o,l);return u.cause=e,u.name=e.name,d&&Object.assign(u,d),u}constructor(e,n,s,o,l){super(e),this.name="AxiosError",this.isAxiosError=!0,n&&(this.code=n),s&&(this.config=s),o&&(this.request=o),l&&(this.response=l,this.status=l.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ne.toJSONObject(this.config),code:this.code,status:this.status}}};qt.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";qt.ERR_BAD_OPTION="ERR_BAD_OPTION";qt.ECONNABORTED="ECONNABORTED";qt.ETIMEDOUT="ETIMEDOUT";qt.ERR_NETWORK="ERR_NETWORK";qt.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";qt.ERR_DEPRECATED="ERR_DEPRECATED";qt.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";qt.ERR_BAD_REQUEST="ERR_BAD_REQUEST";qt.ERR_CANCELED="ERR_CANCELED";qt.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";qt.ERR_INVALID_URL="ERR_INVALID_URL";const rI=null;function Zy(t){return Ne.isPlainObject(t)||Ne.isArray(t)}function rj(t){return Ne.endsWith(t,"[]")?t.slice(0,-2):t}function EM(t,e,n){return t?t.concat(e).map(function(o,l){return o=rj(o),!n&&l?"["+o+"]":o}).join(n?".":""):e}function oI(t){return Ne.isArray(t)&&!t.some(Zy)}const lI=Ne.toFlatObject(Ne,{},null,function(e){return/^is[A-Z]/.test(e)});function nm(t,e,n){if(!Ne.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=Ne.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,y){return!Ne.isUndefined(y[_])});const s=n.metaTokens,o=n.visitor||m,l=n.dots,d=n.indexes,h=(n.Blob||typeof Blob<"u"&&Blob)&&Ne.isSpecCompliantForm(e);if(!Ne.isFunction(o))throw new TypeError("visitor must be a function");function p(b){if(b===null)return"";if(Ne.isDate(b))return b.toISOString();if(Ne.isBoolean(b))return b.toString();if(!h&&Ne.isBlob(b))throw new qt("Blob is not supported. Use a Buffer instead.");return Ne.isArrayBuffer(b)||Ne.isTypedArray(b)?h&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function m(b,_,y){let S=b;if(b&&!y&&typeof b=="object"){if(Ne.endsWith(_,"{}"))_=s?_:_.slice(0,-2),b=JSON.stringify(b);else if(Ne.isArray(b)&&oI(b)||(Ne.isFileList(b)||Ne.endsWith(_,"[]"))&&(S=Ne.toArray(b)))return _=rj(_),S.forEach(function(L,N){!(Ne.isUndefined(L)||L===null)&&e.append(d===!0?EM([_],N,l):d===null?_:_+"[]",p(L))}),!1}return Zy(b)?!0:(e.append(EM(y,_,l),p(b)),!1)}const g=[],v=Object.assign(lI,{defaultVisitor:m,convertValue:p,isVisitable:Zy});function C(b,_){if(!Ne.isUndefined(b)){if(g.indexOf(b)!==-1)throw Error("Circular reference detected in "+_.join("."));g.push(b),Ne.forEach(b,function(S,D){(!(Ne.isUndefined(S)||S===null)&&o.call(e,S,Ne.isString(D)?D.trim():D,_,v))===!0&&C(S,_?_.concat(D):[D])}),g.pop()}}if(!Ne.isObject(t))throw new TypeError("data must be an object");return C(t),e}function AM(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Tv(t,e){this._pairs=[],t&&nm(t,this,e)}const oj=Tv.prototype;oj.append=function(e,n){this._pairs.push([e,n])};oj.toString=function(e){const n=e?function(s){return e.call(this,s,AM)}:AM;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function cI(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function lj(t,e,n){if(!e)return t;const s=n&&n.encode||cI,o=Ne.isFunction(n)?{serialize:n}:n,l=o&&o.serialize;let d;if(l?d=l(e,o):d=Ne.isURLSearchParams(e)?e.toString():new Tv(e,o).toString(s),d){const u=t.indexOf("#");u!==-1&&(t=t.slice(0,u)),t+=(t.indexOf("?")===-1?"?":"&")+d}return t}class RM{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ne.forEach(this.handlers,function(s){s!==null&&e(s)})}}const cj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},dI=typeof URLSearchParams<"u"?URLSearchParams:Tv,uI=typeof FormData<"u"?FormData:null,fI=typeof Blob<"u"?Blob:null,hI={isBrowser:!0,classes:{URLSearchParams:dI,FormData:uI,Blob:fI},protocols:["http","https","file","blob","url","data"]},jv=typeof window<"u"&&typeof document<"u",Jy=typeof navigator=="object"&&navigator||void 0,pI=jv&&(!Jy||["ReactNative","NativeScript","NS"].indexOf(Jy.product)<0),mI=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",gI=jv&&window.location.href||"http://localhost",xI=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:jv,hasStandardBrowserEnv:pI,hasStandardBrowserWebWorkerEnv:mI,navigator:Jy,origin:gI},Symbol.toStringTag,{value:"Module"})),aa={...xI,...hI};function yI(t,e){return nm(t,new aa.classes.URLSearchParams,{visitor:function(n,s,o,l){return aa.isNode&&Ne.isBuffer(n)?(this.append(s,n.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...e})}function vI(t){return Ne.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function _I(t){const e={},n=Object.keys(t);let s;const o=n.length;let l;for(s=0;s<o;s++)l=n[s],e[l]=t[l];return e}function dj(t){function e(n,s,o,l){let d=n[l++];if(d==="__proto__")return!0;const u=Number.isFinite(+d),h=l>=n.length;return d=!d&&Ne.isArray(o)?o.length:d,h?(Ne.hasOwnProp(o,d)?o[d]=[o[d],s]:o[d]=s,!u):((!o[d]||!Ne.isObject(o[d]))&&(o[d]=[]),e(n,s,o[d],l)&&Ne.isArray(o[d])&&(o[d]=_I(o[d])),!u)}if(Ne.isFormData(t)&&Ne.isFunction(t.entries)){const n={};return Ne.forEachEntry(t,(s,o)=>{e(vI(s),o,n,0)}),n}return null}function bI(t,e,n){if(Ne.isString(t))try{return(e||JSON.parse)(t),Ne.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const Zu={transitional:cj,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",o=s.indexOf("application/json")>-1,l=Ne.isObject(e);if(l&&Ne.isHTMLForm(e)&&(e=new FormData(e)),Ne.isFormData(e))return o?JSON.stringify(dj(e)):e;if(Ne.isArrayBuffer(e)||Ne.isBuffer(e)||Ne.isStream(e)||Ne.isFile(e)||Ne.isBlob(e)||Ne.isReadableStream(e))return e;if(Ne.isArrayBufferView(e))return e.buffer;if(Ne.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return yI(e,this.formSerializer).toString();if((u=Ne.isFileList(e))||s.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return nm(u?{"files[]":e}:e,h&&new h,this.formSerializer)}}return l||o?(n.setContentType("application/json",!1),bI(e)):e}],transformResponse:[function(e){const n=this.transitional||Zu.transitional,s=n&&n.forcedJSONParsing,o=this.responseType==="json";if(Ne.isResponse(e)||Ne.isReadableStream(e))return e;if(e&&Ne.isString(e)&&(s&&!this.responseType||o)){const d=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(e,this.parseReviver)}catch(u){if(d)throw u.name==="SyntaxError"?qt.from(u,qt.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:aa.classes.FormData,Blob:aa.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ne.forEach(["delete","get","head","post","put","patch"],t=>{Zu.headers[t]={}});const SI=Ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),MI=t=>{const e={};let n,s,o;return t&&t.split(`
`).forEach(function(d){o=d.indexOf(":"),n=d.substring(0,o).trim().toLowerCase(),s=d.substring(o+1).trim(),!(!n||e[n]&&SI[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},DM=Symbol("internals");function au(t){return t&&String(t).trim().toLowerCase()}function Sp(t){return t===!1||t==null?t:Ne.isArray(t)?t.map(Sp):String(t)}function wI(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const CI=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Cx(t,e,n,s,o){if(Ne.isFunction(s))return s.call(this,e,n);if(o&&(e=n),!!Ne.isString(e)){if(Ne.isString(s))return e.indexOf(s)!==-1;if(Ne.isRegExp(s))return s.test(e)}}function TI(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function jI(t,e){const n=Ne.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(o,l,d){return this[s].call(this,e,o,l,d)},configurable:!0})})}let Ta=class{constructor(e){e&&this.set(e)}set(e,n,s){const o=this;function l(u,h,p){const m=au(h);if(!m)throw new Error("header name must be a non-empty string");const g=Ne.findKey(o,m);(!g||o[g]===void 0||p===!0||p===void 0&&o[g]!==!1)&&(o[g||h]=Sp(u))}const d=(u,h)=>Ne.forEach(u,(p,m)=>l(p,m,h));if(Ne.isPlainObject(e)||e instanceof this.constructor)d(e,n);else if(Ne.isString(e)&&(e=e.trim())&&!CI(e))d(MI(e),n);else if(Ne.isObject(e)&&Ne.isIterable(e)){let u={},h,p;for(const m of e){if(!Ne.isArray(m))throw TypeError("Object iterator must return a key-value pair");u[p=m[0]]=(h=u[p])?Ne.isArray(h)?[...h,m[1]]:[h,m[1]]:m[1]}d(u,n)}else e!=null&&l(n,e,s);return this}get(e,n){if(e=au(e),e){const s=Ne.findKey(this,e);if(s){const o=this[s];if(!n)return o;if(n===!0)return wI(o);if(Ne.isFunction(n))return n.call(this,o,s);if(Ne.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=au(e),e){const s=Ne.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||Cx(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let o=!1;function l(d){if(d=au(d),d){const u=Ne.findKey(s,d);u&&(!n||Cx(s,s[u],u,n))&&(delete s[u],o=!0)}}return Ne.isArray(e)?e.forEach(l):l(e),o}clear(e){const n=Object.keys(this);let s=n.length,o=!1;for(;s--;){const l=n[s];(!e||Cx(this,this[l],l,e,!0))&&(delete this[l],o=!0)}return o}normalize(e){const n=this,s={};return Ne.forEach(this,(o,l)=>{const d=Ne.findKey(s,l);if(d){n[d]=Sp(o),delete n[l];return}const u=e?TI(l):String(l).trim();u!==l&&delete n[l],n[u]=Sp(o),s[u]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return Ne.forEach(this,(s,o)=>{s!=null&&s!==!1&&(n[o]=e&&Ne.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(o=>s.set(o)),s}static accessor(e){const s=(this[DM]=this[DM]={accessors:{}}).accessors,o=this.prototype;function l(d){const u=au(d);s[u]||(jI(o,d),s[u]=!0)}return Ne.isArray(e)?e.forEach(l):l(e),this}};Ta.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ne.reduceDescriptors(Ta.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});Ne.freezeMethods(Ta);function Tx(t,e){const n=this||Zu,s=e||n,o=Ta.from(s.headers);let l=s.data;return Ne.forEach(t,function(u){l=u.call(n,l,o.normalize(),e?e.status:void 0)}),o.normalize(),l}function uj(t){return!!(t&&t.__CANCEL__)}let Ju=class extends qt{constructor(e,n,s){super(e??"canceled",qt.ERR_CANCELED,n,s),this.name="CanceledError",this.__CANCEL__=!0}};function fj(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new qt("Request failed with status code "+n.status,[qt.ERR_BAD_REQUEST,qt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function EI(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function AI(t,e){t=t||10;const n=new Array(t),s=new Array(t);let o=0,l=0,d;return e=e!==void 0?e:1e3,function(h){const p=Date.now(),m=s[l];d||(d=p),n[o]=h,s[o]=p;let g=l,v=0;for(;g!==o;)v+=n[g++],g=g%t;if(o=(o+1)%t,o===l&&(l=(l+1)%t),p-d<e)return;const C=m&&p-m;return C?Math.round(v*1e3/C):void 0}}function RI(t,e){let n=0,s=1e3/e,o,l;const d=(p,m=Date.now())=>{n=m,o=null,l&&(clearTimeout(l),l=null),t(...p)};return[(...p)=>{const m=Date.now(),g=m-n;g>=s?d(p,m):(o=p,l||(l=setTimeout(()=>{l=null,d(o)},s-g)))},()=>o&&d(o)]}const Up=(t,e,n=3)=>{let s=0;const o=AI(50,250);return RI(l=>{const d=l.loaded,u=l.lengthComputable?l.total:void 0,h=d-s,p=o(h),m=d<=u;s=d;const g={loaded:d,total:u,progress:u?d/u:void 0,bytes:h,rate:p||void 0,estimated:p&&u&&m?(u-d)/p:void 0,event:l,lengthComputable:u!=null,[e?"download":"upload"]:!0};t(g)},n)},IM=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},OM=t=>(...e)=>Ne.asap(()=>t(...e)),DI=aa.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,aa.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(aa.origin),aa.navigator&&/(msie|trident)/i.test(aa.navigator.userAgent)):()=>!0,II=aa.hasStandardBrowserEnv?{write(t,e,n,s,o,l,d){if(typeof document>"u")return;const u=[`${t}=${encodeURIComponent(e)}`];Ne.isNumber(n)&&u.push(`expires=${new Date(n).toUTCString()}`),Ne.isString(s)&&u.push(`path=${s}`),Ne.isString(o)&&u.push(`domain=${o}`),l===!0&&u.push("secure"),Ne.isString(d)&&u.push(`SameSite=${d}`),document.cookie=u.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function OI(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function PI(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function hj(t,e,n){let s=!OI(e);return t&&(s||n==!1)?PI(t,e):e}const PM=t=>t instanceof Ta?{...t}:t;function Al(t,e){e=e||{};const n={};function s(p,m,g,v){return Ne.isPlainObject(p)&&Ne.isPlainObject(m)?Ne.merge.call({caseless:v},p,m):Ne.isPlainObject(m)?Ne.merge({},m):Ne.isArray(m)?m.slice():m}function o(p,m,g,v){if(Ne.isUndefined(m)){if(!Ne.isUndefined(p))return s(void 0,p,g,v)}else return s(p,m,g,v)}function l(p,m){if(!Ne.isUndefined(m))return s(void 0,m)}function d(p,m){if(Ne.isUndefined(m)){if(!Ne.isUndefined(p))return s(void 0,p)}else return s(void 0,m)}function u(p,m,g){if(g in e)return s(p,m);if(g in t)return s(void 0,p)}const h={url:l,method:l,data:l,baseURL:d,transformRequest:d,transformResponse:d,paramsSerializer:d,timeout:d,timeoutMessage:d,withCredentials:d,withXSRFToken:d,adapter:d,responseType:d,xsrfCookieName:d,xsrfHeaderName:d,onUploadProgress:d,onDownloadProgress:d,decompress:d,maxContentLength:d,maxBodyLength:d,beforeRedirect:d,transport:d,httpAgent:d,httpsAgent:d,cancelToken:d,socketPath:d,responseEncoding:d,validateStatus:u,headers:(p,m,g)=>o(PM(p),PM(m),g,!0)};return Ne.forEach(Object.keys({...t,...e}),function(m){const g=h[m]||o,v=g(t[m],e[m],m);Ne.isUndefined(v)&&g!==u||(n[m]=v)}),n}const pj=t=>{const e=Al({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:l,headers:d,auth:u}=e;if(e.headers=d=Ta.from(d),e.url=lj(hj(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),u&&d.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Ne.isFormData(n)){if(aa.hasStandardBrowserEnv||aa.hasStandardBrowserWebWorkerEnv)d.setContentType(void 0);else if(Ne.isFunction(n.getHeaders)){const h=n.getHeaders(),p=["content-type","content-length"];Object.entries(h).forEach(([m,g])=>{p.includes(m.toLowerCase())&&d.set(m,g)})}}if(aa.hasStandardBrowserEnv&&(s&&Ne.isFunction(s)&&(s=s(e)),s||s!==!1&&DI(e.url))){const h=o&&l&&II.read(l);h&&d.set(o,h)}return e},LI=typeof XMLHttpRequest<"u",NI=LI&&function(t){return new Promise(function(n,s){const o=pj(t);let l=o.data;const d=Ta.from(o.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:p}=o,m,g,v,C,b;function _(){C&&C(),b&&b(),o.cancelToken&&o.cancelToken.unsubscribe(m),o.signal&&o.signal.removeEventListener("abort",m)}let y=new XMLHttpRequest;y.open(o.method.toUpperCase(),o.url,!0),y.timeout=o.timeout;function S(){if(!y)return;const L=Ta.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),T={data:!u||u==="text"||u==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:L,config:t,request:y};fj(function(E){n(E),_()},function(E){s(E),_()},T),y=null}"onloadend"in y?y.onloadend=S:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(S)},y.onabort=function(){y&&(s(new qt("Request aborted",qt.ECONNABORTED,t,y)),y=null)},y.onerror=function(N){const T=N&&N.message?N.message:"Network Error",j=new qt(T,qt.ERR_NETWORK,t,y);j.event=N||null,s(j),y=null},y.ontimeout=function(){let N=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const T=o.transitional||cj;o.timeoutErrorMessage&&(N=o.timeoutErrorMessage),s(new qt(N,T.clarifyTimeoutError?qt.ETIMEDOUT:qt.ECONNABORTED,t,y)),y=null},l===void 0&&d.setContentType(null),"setRequestHeader"in y&&Ne.forEach(d.toJSON(),function(N,T){y.setRequestHeader(T,N)}),Ne.isUndefined(o.withCredentials)||(y.withCredentials=!!o.withCredentials),u&&u!=="json"&&(y.responseType=o.responseType),p&&([v,b]=Up(p,!0),y.addEventListener("progress",v)),h&&y.upload&&([g,C]=Up(h),y.upload.addEventListener("progress",g),y.upload.addEventListener("loadend",C)),(o.cancelToken||o.signal)&&(m=L=>{y&&(s(!L||L.type?new Ju(null,t,y):L),y.abort(),y=null)},o.cancelToken&&o.cancelToken.subscribe(m),o.signal&&(o.signal.aborted?m():o.signal.addEventListener("abort",m)));const D=EI(o.url);if(D&&aa.protocols.indexOf(D)===-1){s(new qt("Unsupported protocol "+D+":",qt.ERR_BAD_REQUEST,t));return}y.send(l||null)})},FI=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,o;const l=function(p){if(!o){o=!0,u();const m=p instanceof Error?p:this.reason;s.abort(m instanceof qt?m:new Ju(m instanceof Error?m.message:m))}};let d=e&&setTimeout(()=>{d=null,l(new qt(`timeout of ${e}ms exceeded`,qt.ETIMEDOUT))},e);const u=()=>{t&&(d&&clearTimeout(d),d=null,t.forEach(p=>{p.unsubscribe?p.unsubscribe(l):p.removeEventListener("abort",l)}),t=null)};t.forEach(p=>p.addEventListener("abort",l));const{signal:h}=s;return h.unsubscribe=()=>Ne.asap(u),h}},zI=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,o;for(;s<n;)o=s+e,yield t.slice(s,o),s=o},kI=async function*(t,e){for await(const n of BI(t))yield*zI(n,e)},BI=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},LM=(t,e,n,s)=>{const o=kI(t,e);let l=0,d,u=h=>{d||(d=!0,s&&s(h))};return new ReadableStream({async pull(h){try{const{done:p,value:m}=await o.next();if(p){u(),h.close();return}let g=m.byteLength;if(n){let v=l+=g;n(v)}h.enqueue(new Uint8Array(m))}catch(p){throw u(p),p}},cancel(h){return u(h),o.return()}},{highWaterMark:2})},NM=64*1024,{isFunction:Sh}=Ne,UI=(({Request:t,Response:e})=>({Request:t,Response:e}))(Ne.global),{ReadableStream:FM,TextEncoder:zM}=Ne.global,kM=(t,...e)=>{try{return!!t(...e)}catch{return!1}},HI=t=>{t=Ne.merge.call({skipUndefined:!0},UI,t);const{fetch:e,Request:n,Response:s}=t,o=e?Sh(e):typeof fetch=="function",l=Sh(n),d=Sh(s);if(!o)return!1;const u=o&&Sh(FM),h=o&&(typeof zM=="function"?(b=>_=>b.encode(_))(new zM):async b=>new Uint8Array(await new n(b).arrayBuffer())),p=l&&u&&kM(()=>{let b=!1;const _=new n(aa.origin,{body:new FM,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!_}),m=d&&u&&kM(()=>Ne.isReadableStream(new s("").body)),g={stream:m&&(b=>b.body)};o&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!g[b]&&(g[b]=(_,y)=>{let S=_&&_[b];if(S)return S.call(_);throw new qt(`Response type '${b}' is not supported`,qt.ERR_NOT_SUPPORT,y)})});const v=async b=>{if(b==null)return 0;if(Ne.isBlob(b))return b.size;if(Ne.isSpecCompliantForm(b))return(await new n(aa.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(Ne.isArrayBufferView(b)||Ne.isArrayBuffer(b))return b.byteLength;if(Ne.isURLSearchParams(b)&&(b=b+""),Ne.isString(b))return(await h(b)).byteLength},C=async(b,_)=>{const y=Ne.toFiniteNumber(b.getContentLength());return y??v(_)};return async b=>{let{url:_,method:y,data:S,signal:D,cancelToken:L,timeout:N,onDownloadProgress:T,onUploadProgress:j,responseType:E,headers:R,withCredentials:M="same-origin",fetchOptions:I}=pj(b),z=e||fetch;E=E?(E+"").toLowerCase():"text";let V=FI([D,L&&L.toAbortSignal()],N),O=null;const k=V&&V.unsubscribe&&(()=>{V.unsubscribe()});let F;try{if(j&&p&&y!=="get"&&y!=="head"&&(F=await C(R,S))!==0){let ne=new n(_,{method:"POST",body:S,duplex:"half"}),de;if(Ne.isFormData(S)&&(de=ne.headers.get("content-type"))&&R.setContentType(de),ne.body){const[$,X]=IM(F,Up(OM(j)));S=LM(ne.body,NM,$,X)}}Ne.isString(M)||(M=M?"include":"omit");const A=l&&"credentials"in n.prototype,q={...I,signal:V,method:y.toUpperCase(),headers:R.normalize().toJSON(),body:S,duplex:"half",credentials:A?M:void 0};O=l&&new n(_,q);let B=await(l?z(O,I):z(_,q));const W=m&&(E==="stream"||E==="response");if(m&&(T||W&&k)){const ne={};["status","statusText","headers"].forEach(le=>{ne[le]=B[le]});const de=Ne.toFiniteNumber(B.headers.get("content-length")),[$,X]=T&&IM(de,Up(OM(T),!0))||[];B=new s(LM(B.body,NM,$,()=>{X&&X(),k&&k()}),ne)}E=E||"text";let Q=await g[Ne.findKey(g,E)||"text"](B,b);return!W&&k&&k(),await new Promise((ne,de)=>{fj(ne,de,{data:Q,headers:Ta.from(B.headers),status:B.status,statusText:B.statusText,config:b,request:O})})}catch(A){throw k&&k(),A&&A.name==="TypeError"&&/Load failed|fetch/i.test(A.message)?Object.assign(new qt("Network Error",qt.ERR_NETWORK,b,O),{cause:A.cause||A}):qt.from(A,A&&A.code,b,O)}}},VI=new Map,mj=t=>{let e=t&&t.env||{};const{fetch:n,Request:s,Response:o}=e,l=[s,o,n];let d=l.length,u=d,h,p,m=VI;for(;u--;)h=l[u],p=m.get(h),p===void 0&&m.set(h,p=u?new Map:HI(e)),m=p;return p};mj();const Ev={http:rI,xhr:NI,fetch:{get:mj}};Ne.forEach(Ev,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const BM=t=>`- ${t}`,qI=t=>Ne.isFunction(t)||t===null||t===!1;function GI(t,e){t=Ne.isArray(t)?t:[t];const{length:n}=t;let s,o;const l={};for(let d=0;d<n;d++){s=t[d];let u;if(o=s,!qI(s)&&(o=Ev[(u=String(s)).toLowerCase()],o===void 0))throw new qt(`Unknown adapter '${u}'`);if(o&&(Ne.isFunction(o)||(o=o.get(e))))break;l[u||"#"+d]=o}if(!o){const d=Object.entries(l).map(([h,p])=>`adapter ${h} `+(p===!1?"is not supported by the environment":"is not available in the build"));let u=n?d.length>1?`since :
`+d.map(BM).join(`
`):" "+BM(d[0]):"as no adapter specified";throw new qt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return o}const gj={getAdapter:GI,adapters:Ev};function jx(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ju(null,t)}function UM(t){return jx(t),t.headers=Ta.from(t.headers),t.data=Tx.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),gj.getAdapter(t.adapter||Zu.adapter,t)(t).then(function(s){return jx(t),s.data=Tx.call(t,t.transformResponse,s),s.headers=Ta.from(s.headers),s},function(s){return uj(s)||(jx(t),s&&s.response&&(s.response.data=Tx.call(t,t.transformResponse,s.response),s.response.headers=Ta.from(s.response.headers))),Promise.reject(s)})}const xj="1.13.4",im={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{im[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const HM={};im.transitional=function(e,n,s){function o(l,d){return"[Axios v"+xj+"] Transitional option '"+l+"'"+d+(s?". "+s:"")}return(l,d,u)=>{if(e===!1)throw new qt(o(d," has been removed"+(n?" in "+n:"")),qt.ERR_DEPRECATED);return n&&!HM[d]&&(HM[d]=!0,console.warn(o(d," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(l,d,u):!0}};im.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function $I(t,e,n){if(typeof t!="object")throw new qt("options must be an object",qt.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let o=s.length;for(;o-- >0;){const l=s[o],d=e[l];if(d){const u=t[l],h=u===void 0||d(u,l,t);if(h!==!0)throw new qt("option "+l+" must be "+h,qt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new qt("Unknown option "+l,qt.ERR_BAD_OPTION)}}const Mp={assertOptions:$I,validators:im},Hs=Mp.validators;let bl=class{constructor(e){this.defaults=e||{},this.interceptors={request:new RM,response:new RM}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const l=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Al(this.defaults,n);const{transitional:s,paramsSerializer:o,headers:l}=n;s!==void 0&&Mp.assertOptions(s,{silentJSONParsing:Hs.transitional(Hs.boolean),forcedJSONParsing:Hs.transitional(Hs.boolean),clarifyTimeoutError:Hs.transitional(Hs.boolean)},!1),o!=null&&(Ne.isFunction(o)?n.paramsSerializer={serialize:o}:Mp.assertOptions(o,{encode:Hs.function,serialize:Hs.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Mp.assertOptions(n,{baseUrl:Hs.spelling("baseURL"),withXsrfToken:Hs.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let d=l&&Ne.merge(l.common,l[n.method]);l&&Ne.forEach(["delete","get","head","post","put","patch","common"],b=>{delete l[b]}),n.headers=Ta.concat(d,l);const u=[];let h=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(n)===!1||(h=h&&_.synchronous,u.unshift(_.fulfilled,_.rejected))});const p=[];this.interceptors.response.forEach(function(_){p.push(_.fulfilled,_.rejected)});let m,g=0,v;if(!h){const b=[UM.bind(this),void 0];for(b.unshift(...u),b.push(...p),v=b.length,m=Promise.resolve(n);g<v;)m=m.then(b[g++],b[g++]);return m}v=u.length;let C=n;for(;g<v;){const b=u[g++],_=u[g++];try{C=b(C)}catch(y){_.call(this,y);break}}try{m=UM.call(this,C)}catch(b){return Promise.reject(b)}for(g=0,v=p.length;g<v;)m=m.then(p[g++],p[g++]);return m}getUri(e){e=Al(this.defaults,e);const n=hj(e.baseURL,e.url,e.allowAbsoluteUrls);return lj(n,e.params,e.paramsSerializer)}};Ne.forEach(["delete","get","head","options"],function(e){bl.prototype[e]=function(n,s){return this.request(Al(s||{},{method:e,url:n,data:(s||{}).data}))}});Ne.forEach(["post","put","patch"],function(e){function n(s){return function(l,d,u){return this.request(Al(u||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:d}))}}bl.prototype[e]=n(),bl.prototype[e+"Form"]=n(!0)});let WI=class yj{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(l){n=l});const s=this;this.promise.then(o=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](o);s._listeners=null}),this.promise.then=o=>{let l;const d=new Promise(u=>{s.subscribe(u),l=u}).then(o);return d.cancel=function(){s.unsubscribe(l)},d},e(function(l,d,u){s.reason||(s.reason=new Ju(l,d,u),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new yj(function(o){e=o}),cancel:e}}};function YI(t){return function(n){return t.apply(null,n)}}function KI(t){return Ne.isObject(t)&&t.isAxiosError===!0}const e0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(e0).forEach(([t,e])=>{e0[e]=t});function vj(t){const e=new bl(t),n=QT(bl.prototype.request,e);return Ne.extend(n,bl.prototype,e,{allOwnKeys:!0}),Ne.extend(n,e,null,{allOwnKeys:!0}),n.create=function(o){return vj(Al(t,o))},n}const Jn=vj(Zu);Jn.Axios=bl;Jn.CanceledError=Ju;Jn.CancelToken=WI;Jn.isCancel=uj;Jn.VERSION=xj;Jn.toFormData=nm;Jn.AxiosError=qt;Jn.Cancel=Jn.CanceledError;Jn.all=function(e){return Promise.all(e)};Jn.spread=YI;Jn.isAxiosError=KI;Jn.mergeConfig=Al;Jn.AxiosHeaders=Ta;Jn.formToJSON=t=>dj(Ne.isHTMLForm(t)?new FormData(t):t);Jn.getAdapter=gj.getAdapter;Jn.HttpStatusCode=e0;Jn.default=Jn;const{Axios:lV,AxiosError:cV,CanceledError:dV,isCancel:uV,CancelToken:fV,VERSION:hV,all:pV,Cancel:mV,isAxiosError:gV,spread:xV,toFormData:yV,AxiosHeaders:vV,HttpStatusCode:_V,formToJSON:bV,getAdapter:SV,mergeConfig:MV}=Jn,_j="/api/v1",Z=Jn.create({baseURL:_j,timeout:3e4,headers:{"Content-Type":"application/json"}});Z.interceptors.request.use(t=>{const e=localStorage.getItem("access_token");return e&&t.headers&&(t.headers.Authorization=`Bearer ${e}`),t.data instanceof FormData&&(t.headers["Content-Type"]=void 0),t},t=>Promise.reject(t));Z.interceptors.response.use(t=>t,async t=>{if(t.response?.status===401){const e=localStorage.getItem("refresh_token");if(e)try{const n=await Jn.post(`${_j}/auth/refresh`,{refresh_token:e}),{access_token:s,refresh_token:o}=n.data.data;if(localStorage.setItem("access_token",s),localStorage.setItem("refresh_token",o),t.config)return t.config.headers.Authorization=`Bearer ${s}`,Jn(t.config)}catch{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login"}else window.location.href="/login"}return Promise.reject(t)});const Ex={getFeishuLoginUrl:()=>{window.location.href="/api/v1/auth/feishu/login"},getCurrentUser:async()=>(await Z.get("/auth/me")).data.data,refreshToken:async t=>(await Z.post("/auth/refresh",{refresh_token:t})).data.data,logout:async()=>{await Z.post("/auth/logout"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}},Wi={list:async(t,e)=>{const n={};return t&&(n.type=t),e&&(n.product_type=e),(await Z.get("/templates",{params:n})).data.data},get:async t=>(await Z.get(`/templates/${t}`)).data.data,create:async t=>(await Z.post("/templates",t)).data.data,update:async(t,e)=>(await Z.put(`/templates/${t}`,e)).data.data,delete:async t=>{await Z.delete(`/templates/${t}`)},duplicate:async(t,e,n)=>(await Z.post(`/templates/${t}/duplicate`,{new_code:e,new_name:n})).data.data,createProjectFromTemplate:async t=>(await Z.post("/projects/create-from-template",t)).data.data,publish:async t=>(await Z.post(`/templates/${t}/publish`)).data.data,upgrade:async(t,e)=>(await Z.post(`/templates/${t}/upgrade`,e?{version:e}:{})).data.data,revert:async t=>(await Z.post(`/templates/${t}/revert`)).data.data,listVersions:async t=>(await Z.get(`/templates/${t}/versions`)).data.data||[],batchSaveTasks:async(t,e,n)=>(await Z.put(`/templates/${t}/tasks/batch`,{tasks:e,version:n})).data.data};function VM(t){return{...t,manager_name:t.manager_name||t.manager?.name,product_name:t.product_name||t.product?.name}}const Ci={list:async t=>{const n=(await Z.get("/projects",{params:t})).data.data;return{...n,items:(n.items||[]).map(VM)}},get:async t=>{const e=await Z.get(`/projects/${t}`);return VM(e.data.data)},create:async t=>(await Z.post("/projects",t)).data.data,update:async(t,e)=>(await Z.put(`/projects/${t}`,e)).data.data,listTasks:async t=>(await Z.get(`/projects/${t}/tasks?page_size=500`)).data.data?.items||[],updateTaskStatus:async(t,e,n)=>(await Z.put(`/projects/${t}/tasks/${e}/status`,{status:n})).data.data,completeTask:async(t,e)=>(await Z.post(`/projects/${t}/tasks/${e}/complete`)).data.data,delete:async t=>{await Z.delete(`/projects/${t}`)},myTasks:async t=>(await Z.get("/my/tasks",{params:t})).data.data,assignRoles:async(t,e)=>{await Z.post(`/projects/${t}/assign-roles`,{assignments:e})}},Mu={list:async t=>{const e=new URLSearchParams;t?.category&&e.set("category",t.category),t?.search&&e.set("search",t.search);const n=e.toString();return(await Z.get(`/materials${n?`?${n}`:""}`)).data.data},get:async t=>(await Z.get(`/materials/${t}`)).data.data,create:async t=>(await Z.post("/materials",t)).data.data,update:async(t,e)=>(await Z.put(`/materials/${t}`,e)).data.data,listCategories:async()=>(await Z.get("/material-categories")).data.data},ia={list:async t=>{const e=new URLSearchParams;t?.status&&e.set("status",t.status),t?.product_id&&e.set("product_id",t.product_id),t?.keyword&&e.set("keyword",t.keyword),t?.change_type&&e.set("change_type",t.change_type),t?.urgency&&e.set("urgency",t.urgency),t?.page&&e.set("page",t.page.toString()),t?.page_size&&e.set("page_size",t.page_size.toString());const n=e.toString();return(await Z.get(`/ecns${n?`?${n}`:""}`)).data.data},get:async t=>(await Z.get(`/ecns/${t}`)).data.data,create:async t=>(await Z.post("/ecns",t)).data.data,update:async(t,e)=>(await Z.put(`/ecns/${t}`,e)).data.data,submit:async t=>(await Z.post(`/ecns/${t}/submit`,{})).data.data,approve:async(t,e)=>(await Z.post(`/ecns/${t}/approve`,e)).data.data,reject:async(t,e)=>(await Z.post(`/ecns/${t}/reject`,e)).data.data,implement:async t=>(await Z.post(`/ecns/${t}/implement`,{})).data.data,getStats:async()=>(await Z.get("/ecns/stats")).data.data,getMyPending:async()=>(await Z.get("/ecns/my-pending")).data.data,listAffectedItems:async t=>(await Z.get(`/ecns/${t}/affected-items`)).data.data,addAffectedItem:async(t,e)=>(await Z.post(`/ecns/${t}/affected-items`,e)).data.data,updateAffectedItem:async(t,e,n)=>(await Z.put(`/ecns/${t}/affected-items/${e}`,n)).data.data,removeAffectedItem:async(t,e)=>{await Z.delete(`/ecns/${t}/affected-items/${e}`)},listApprovals:async t=>(await Z.get(`/ecns/${t}/approvals`)).data.data,addApprover:async(t,e)=>(await Z.post(`/ecns/${t}/approvers`,e)).data.data,listTasks:async t=>(await Z.get(`/ecns/${t}/tasks`)).data.data,createTask:async(t,e)=>(await Z.post(`/ecns/${t}/tasks`,e)).data.data,updateTask:async(t,e,n)=>(await Z.put(`/ecns/${t}/tasks/${e}`,n)).data.data,applyBOMChanges:async t=>{await Z.post(`/ecns/${t}/apply-bom-changes`,{})},listHistory:async t=>(await Z.get(`/ecns/${t}/history`)).data.data},ls={list:async t=>{const e=new URLSearchParams;t?.category&&e.set("category",t.category),t?.search&&e.set("search",t.search),t?.related_type&&e.set("related_type",t.related_type),t?.related_id&&e.set("related_id",t.related_id),t?.page&&e.set("page",t.page.toString()),t?.page_size&&e.set("page_size",t.page_size.toString());const n=e.toString();return(await Z.get(`/documents${n?`?${n}`:""}`)).data.data},get:async t=>(await Z.get(`/documents/${t}`)).data.data,upload:async(t,e)=>{const n=new FormData;n.append("file",t),n.append("title",e.title),e.category_id&&n.append("category_id",e.category_id),e.description&&n.append("description",e.description),e.related_type&&n.append("related_type",e.related_type),e.related_id&&n.append("related_id",e.related_id);const s=await fetch("/api/v1/documents",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:n});if(!s.ok)throw new Error("Upload failed");return(await s.json()).data},update:async(t,e)=>(await Z.put(`/documents/${t}`,e)).data.data,delete:async t=>{await Z.delete(`/documents/${t}`)},download:async t=>{const e=localStorage.getItem("access_token"),n=await fetch(`/api/v1/documents/${t}/download`,{headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw new Error("Download failed");return n.blob()},release:async t=>(await Z.post(`/documents/${t}/release`,{})).data.data,obsolete:async t=>(await Z.post(`/documents/${t}/obsolete`,{})).data.data,listVersions:async t=>(await Z.get(`/documents/${t}/versions`)).data.data,uploadNewVersion:async(t,e,n)=>{const s=new FormData;s.append("file",e),n&&s.append("change_summary",n);const o=await fetch(`/api/v1/documents/${t}/versions`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`},body:s});if(!o.ok)throw new Error("Upload version failed");return(await o.json()).data},downloadVersion:async(t,e)=>{const n=localStorage.getItem("access_token"),s=await fetch(`/api/v1/documents/${t}/versions/${e}/download`,{headers:{Authorization:`Bearer ${n}`}});if(!s.ok)throw new Error("Download failed");return s.blob()},listCategories:async()=>(await Z.get("/document-categories")).data.data},Zt={list:async(t,e)=>{const n=new URLSearchParams;e?.phase&&n.set("phase",e.phase),e?.bom_type&&n.set("bom_type",e.bom_type),e?.status&&n.set("status",e.status);const s=n.toString();return(await Z.get(`/projects/${t}/boms${s?`?${s}`:""}`)).data.data},create:async(t,e)=>(await Z.post(`/projects/${t}/boms`,e)).data.data,get:async(t,e)=>(await Z.get(`/projects/${t}/boms/${e}`)).data.data,update:async(t,e,n)=>(await Z.put(`/projects/${t}/boms/${e}`,n)).data.data,submit:async(t,e)=>(await Z.post(`/projects/${t}/boms/${e}/submit`,{})).data.data,approve:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/approve`,{comment:n})).data.data,reject:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/reject`,{comment:n})).data.data,freeze:async(t,e)=>(await Z.post(`/projects/${t}/boms/${e}/freeze`,{})).data.data,addItem:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/items`,n)).data.data,batchAddItems:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/items/batch`,{items:n})).data.data,updateItem:async(t,e,n,s)=>(await Z.put(`/projects/${t}/boms/${e}/items/${n}`,s)).data.data,deleteItem:async(t,e,n)=>{await Z.delete(`/projects/${t}/boms/${e}/items/${n}`)},reorderItems:async(t,e,n)=>{await Z.post(`/projects/${t}/boms/${e}/reorder`,{item_ids:n})},exportExcel:async(t,e)=>{const n=await Z.get(`/projects/${t}/boms/${e}/export`,{responseType:"blob"}),s=window.URL.createObjectURL(new Blob([n.data])),o=document.createElement("a");o.href=s,o.download=`BOM_${e}.xlsx`,o.click(),window.URL.revokeObjectURL(s)},importExcel:async(t,e,n)=>{const s=new FormData;return s.append("file",n),(await Z.post(`/projects/${t}/boms/${e}/import`,s,{headers:{"Content-Type":"multipart/form-data"}})).data.data},downloadTemplate:async t=>{const e=t?`?bom_type=${t}`:"",n=await Z.get(`/bom-template${e}`,{responseType:"blob"}),s=window.URL.createObjectURL(new Blob([n.data])),o=document.createElement("a");o.href=s,o.download=`BOM${t?`_${t}`:""}.xlsx`,o.click(),window.URL.revokeObjectURL(s)},convertToMBOM:async(t,e)=>(await Z.post(`/projects/${t}/boms/${e}/convert-to-mbom`,{})).data.data,convertToPBOM:async(t,e)=>(await Z.post(`/projects/${t}/boms/${e}/convert-to-pbom`,{})).data.data,release:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/release`,{release_note:n||""})).data.data,createFrom:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/create-from`,{source_bom_id:e,target_type:n})).data.data,compareBOMs:async(t,e)=>(await Z.get(`/bom-compare?bom1=${t}&bom2=${e}`)).data.data,getCategoryTree:async(t,e)=>(await Z.get(`/projects/${t}/boms/${e}/category-tree`)).data.data,listTemplates:async t=>{const e=new URLSearchParams;t?.category&&e.set("category",t.category),t?.sub_category&&e.set("sub_category",t.sub_category);const n=e.toString();return(await Z.get(`/bom-attr-templates${n?`?${n}`:""}`)).data.data},createTemplate:async t=>(await Z.post("/bom-attr-templates",t)).data.data,updateTemplate:async(t,e)=>(await Z.put(`/bom-attr-templates/${t}`,e)).data.data,deleteTemplate:async t=>{await Z.delete(`/bom-attr-templates/${t}`)},seedTemplates:async()=>{await Z.post("/bom-attr-templates/seed",{})},listRoutes:async t=>(await Z.get(`/projects/${t}/routes`)).data.data,getRoute:async(t,e)=>(await Z.get(`/projects/${t}/routes/${e}`)).data.data,createRoute:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/routes`,n)).data.data,updateRoute:async(t,e,n)=>(await Z.put(`/projects/${t}/routes/${e}`,n)).data.data,createStep:async(t,e,n)=>(await Z.post(`/projects/${t}/routes/${e}/steps`,n)).data.data,updateStep:async(t,e,n,s)=>(await Z.put(`/projects/${t}/routes/${e}/steps/${n}`,s)).data.data,deleteStep:async(t,e,n)=>{await Z.delete(`/projects/${t}/routes/${e}/steps/${n}`)},createStepMaterial:async(t,e,n,s)=>(await Z.post(`/projects/${t}/routes/${e}/steps/${n}/materials`,s)).data.data,deleteStepMaterial:async(t,e,n,s)=>{await Z.delete(`/projects/${t}/routes/${e}/steps/${n}/materials/${s}`)},getBOMPermissions:async t=>(await Z.get(`/projects/${t}/bom-permissions`)).data.data,startEditing:async(t,e)=>(await Z.post(`/projects/${t}/boms/${e}/edit`)).data.data,saveDraft:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/draft`,n)).data.data,getDraft:async(t,e)=>(await Z.get(`/projects/${t}/boms/${e}/draft`)).data.data,discardDraft:async(t,e)=>{await Z.delete(`/projects/${t}/boms/${e}/draft`)},submitECN:async(t,e,n)=>(await Z.post(`/projects/${t}/boms/${e}/ecn`,n)).data.data,searchItems:async t=>(await Z.get("/bom-items/search",{params:t})).data.data||[],searchItemsPaginated:async t=>{const n=(await Z.get("/bom-items/search-paginated",{params:t})).data;return{data:n.data||[],total:n.total||0,page:n.page||1,page_size:n.page_size||20}},bomCostSummary:async()=>(await Z.get("/bom-cost-summary")).data.data||[],globalSearch:async t=>{const n=(await Z.get("/bom-items/global",{params:t})).data;return{data:n.data||[],total:n.total||0,page:n.page||1,page_size:n.page_size||20}}},XI={list:async(t,e)=>{const n=e?`?phase=${e}`:"";return(await Z.get(`/projects/${t}/deliverables${n}`)).data.data},update:async(t,e,n)=>(await Z.put(`/projects/${t}/deliverables/${e}`,n)).data.data},bj={list:async(t,e)=>{const n={};t&&(n.type=t),e&&(n.available="true");const o=(await Z.get("/codenames",{params:n})).data.data;return Array.isArray(o)?o:o?.items||[]}},QI={create:async t=>(await Z.post("/approvals",t)).data.data,list:async t=>(await Z.get("/approvals",{params:t})).data.data,get:async t=>(await Z.get(`/approvals/${t}`)).data.data,approve:async(t,e)=>(await Z.post(`/approvals/${t}/approve`,{comment:e})).data,reject:async(t,e)=>(await Z.post(`/approvals/${t}/reject`,{comment:e})).data},ef={list:async()=>{const t=await Z.get("/users");return t.data.data?.items||t.data.data?.users||[]},search:async t=>{const e=await Z.get("/users/search",{params:{q:t}});return e.data.data?.items||e.data.data||[]},get:async t=>(await Z.get(`/users/${t}`)).data.data},Rs={list:async()=>(await Z.get("/approval-definitions")).data.data,get:async t=>(await Z.get(`/approval-definitions/${t}`)).data.data,create:async t=>(await Z.post("/approval-definitions",t)).data.data,update:async(t,e)=>(await Z.put(`/approval-definitions/${t}`,e)).data.data,delete:async t=>(await Z.delete(`/approval-definitions/${t}`)).data,publish:async t=>(await Z.post(`/approval-definitions/${t}/publish`)).data,unpublish:async t=>(await Z.post(`/approval-definitions/${t}/unpublish`)).data,submit:async(t,e)=>(await Z.post(`/approval-definitions/${t}/submit`,e)).data.data},t0={list:async()=>{const t=await Z.get("/approval-groups");return t.data.data?.items||t.data.data||[]},create:async t=>(await Z.post("/approval-groups",{name:t})).data.data,delete:async t=>(await Z.delete(`/approval-groups/${t}`)).data},Mh={list:async t=>{const e=await Z.get("/approvals",{params:t});return e.data.data?.items||e.data.data||[]},get:async t=>(await Z.get(`/approvals/${t}`)).data.data,approve:async(t,e)=>(await Z.post(`/approvals/${t}/approve`,{comment:e})).data,reject:async(t,e)=>(await Z.post(`/approvals/${t}/reject`,{comment:e})).data},wt={listSuppliers:async t=>(await Z.get("/srm/suppliers",{params:t})).data.data,getSupplier:async t=>(await Z.get(`/srm/suppliers/${t}`)).data.data,createSupplier:async t=>(await Z.post("/srm/suppliers",t)).data.data,updateSupplier:async(t,e)=>(await Z.put(`/srm/suppliers/${t}`,e)).data.data,deleteSupplier:async t=>{await Z.delete(`/srm/suppliers/${t}`)},listContacts:async t=>(await Z.get(`/srm/suppliers/${t}/contacts`)).data.data.items,createContact:async(t,e)=>(await Z.post(`/srm/suppliers/${t}/contacts`,e)).data.data,deleteContact:async(t,e)=>{await Z.delete(`/srm/suppliers/${t}/contacts/${e}`)},listPRs:async t=>(await Z.get("/srm/purchase-requests",{params:t})).data.data,getPR:async t=>(await Z.get(`/srm/purchase-requests/${t}`)).data.data,createPR:async t=>(await Z.post("/srm/purchase-requests",t)).data.data,updatePR:async(t,e)=>(await Z.put(`/srm/purchase-requests/${t}`,e)).data.data,approvePR:async t=>(await Z.post(`/srm/purchase-requests/${t}/approve`)).data.data,createPRFromBOM:async t=>(await Z.post("/srm/purchase-requests/from-bom",t)).data.data,assignSupplier:async(t,e,n)=>(await Z.put(`/srm/purchase-requests/${t}/items/${e}/assign-supplier`,n)).data.data,generatePOs:async t=>(await Z.post(`/srm/purchase-requests/${t}/generate-pos`)).data.data,updatePRItemStatus:async(t,e)=>(await Z.put(`/srm/pr-items/${t}/status`,{status:e})).data.data,createSampling:async(t,e)=>(await Z.post(`/srm/pr-items/${t}/sampling`,e)).data.data,listSampling:async t=>(await Z.get(`/srm/pr-items/${t}/sampling`)).data.data.items,updateSamplingStatus:async(t,e)=>(await Z.put(`/srm/sampling/${t}/status`,{status:e})).data.data,requestSamplingVerify:async(t,e)=>(await Z.post(`/srm/sampling/${t}/request-verify`,e)).data.data,listPOs:async t=>(await Z.get("/srm/purchase-orders",{params:t})).data.data,getPO:async t=>(await Z.get(`/srm/purchase-orders/${t}`)).data.data,createPO:async t=>(await Z.post("/srm/purchase-orders",t)).data.data,updatePO:async(t,e)=>(await Z.put(`/srm/purchase-orders/${t}`,e)).data.data,approvePO:async t=>(await Z.post(`/srm/purchase-orders/${t}/approve`)).data.data,submitPO:async t=>(await Z.post(`/srm/purchase-orders/${t}/submit`)).data.data,deletePO:async t=>{await Z.delete(`/srm/purchase-orders/${t}`)},generatePOsFromBOM:async t=>(await Z.post("/srm/purchase-orders/from-bom",t)).data.data,receivePOItem:async(t,e,n)=>{await Z.post(`/srm/purchase-orders/${t}/items/${e}/receive`,{received_qty:n})},listInspections:async t=>(await Z.get("/srm/inspections",{params:t})).data.data,getInspection:async t=>(await Z.get(`/srm/inspections/${t}`)).data.data,updateInspection:async(t,e)=>(await Z.put(`/srm/inspections/${t}`,e)).data.data,completeInspection:async(t,e)=>(await Z.post(`/srm/inspections/${t}/complete`,e)).data.data,createInspectionFromPO:async t=>(await Z.post("/srm/inspections/from-po",{po_id:t})).data.data,listInventory:async t=>(await Z.get("/srm/inventory",{params:t})).data.data,getInventoryTransactions:async(t,e)=>(await Z.get(`/srm/inventory/${t}/transactions`,{params:e})).data.data,stockIn:async t=>(await Z.post("/srm/inventory/in",t)).data.data,stockOut:async t=>(await Z.post("/srm/inventory/out",t)).data.data,stockAdjust:async t=>(await Z.post("/srm/inventory/adjust",t)).data.data,getSamplingProgress:async t=>(await Z.get("/srm/dashboard/sampling-progress",{params:{project_id:t}})).data.data,listProjects:async t=>(await Z.get("/srm/projects",{params:t})).data.data,getProject:async t=>(await Z.get(`/srm/projects/${t}`)).data.data,getProjectProgress:async t=>(await Z.get(`/srm/projects/${t}/progress`)).data.data,listProjectActivities:async(t,e)=>(await Z.get(`/srm/projects/${t}/activities`,{params:e})).data.data,listActivities:async(t,e,n)=>(await Z.get(`/srm/activities/${t}/${e}`,{params:n})).data.data,listSettlements:async t=>(await Z.get("/srm/settlements",{params:t})).data.data,getSettlement:async t=>(await Z.get(`/srm/settlements/${t}`)).data.data,createSettlement:async t=>(await Z.post("/srm/settlements",t)).data.data,updateSettlement:async(t,e)=>(await Z.put(`/srm/settlements/${t}`,e)).data.data,deleteSettlement:async t=>{await Z.delete(`/srm/settlements/${t}`)},confirmSettlementBuyer:async t=>(await Z.post(`/srm/settlements/${t}/confirm-buyer`)).data.data,confirmSettlementSupplier:async t=>(await Z.post(`/srm/settlements/${t}/confirm-supplier`)).data.data,addSettlementDispute:async(t,e)=>(await Z.post(`/srm/settlements/${t}/disputes`,e)).data.data,updateSettlementDispute:async(t,e,n)=>(await Z.put(`/srm/settlements/${t}/disputes/${e}`,n)).data.data,generateSettlement:async t=>(await Z.post("/srm/settlements/generate",t)).data.data,listCorrectiveActions:async t=>(await Z.get("/srm/corrective-actions",{params:t})).data.data,getCorrectiveAction:async t=>(await Z.get(`/srm/corrective-actions/${t}`)).data.data,createCorrectiveAction:async t=>(await Z.post("/srm/corrective-actions",t)).data.data,updateCorrectiveAction:async(t,e)=>(await Z.put(`/srm/corrective-actions/${t}`,e)).data.data,respondCorrectiveAction:async(t,e)=>(await Z.post(`/srm/corrective-actions/${t}/respond`,e)).data.data,verifyCorrectiveAction:async t=>(await Z.post(`/srm/corrective-actions/${t}/verify`)).data.data,closeCorrectiveAction:async t=>(await Z.post(`/srm/corrective-actions/${t}/close`)).data.data,listEvaluations:async t=>(await Z.get("/srm/evaluations",{params:t})).data.data,getEvaluation:async t=>(await Z.get(`/srm/evaluations/${t}`)).data.data,createEvaluation:async t=>(await Z.post("/srm/evaluations",t)).data.data,updateEvaluation:async(t,e)=>(await Z.put(`/srm/evaluations/${t}`,e)).data.data,submitEvaluation:async t=>(await Z.post(`/srm/evaluations/${t}/submit`)).data.data,approveEvaluation:async t=>(await Z.post(`/srm/evaluations/${t}/approve`)).data.data,autoGenerateEvaluation:async t=>(await Z.post("/srm/evaluations/auto-generate",t)).data.data,getSupplierEvaluationHistory:async t=>(await Z.get(`/srm/evaluations/supplier/${t}`)).data.data},Sj=P.createContext(void 0),ZI=({children:t})=>{const[e,n]=P.useState(null),[s,o]=P.useState(!0),l=P.useCallback(async()=>{if(!localStorage.getItem("access_token")){n(null),o(!1);return}try{const p=await Ex.getCurrentUser();n(p)}catch(p){console.error("Failed to fetch user:",p),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),n(null)}finally{o(!1)}},[]);P.useEffect(()=>{l()},[l]);const d=()=>{Ex.getFeishuLoginUrl()},u=async()=>{try{await Ex.logout()}finally{n(null)}};return i.jsx(Sj.Provider,{value:{user:e,isAuthenticated:!!e,isLoading:s,login:d,logout:u,refreshUser:l},children:t})},sd=()=>{const t=P.useContext(Sj);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t};var JI=Me(Me({},bR),{},{locale:"zh_CN",today:"",now:"",backToToday:"",ok:"",timeSelect:"",dateSelect:"",weekSelect:"",clear:"",week:"",month:"",year:"",previousMonth:" ()",nextMonth:" ()",monthSelect:"",yearSelect:"",decadeSelect:"",previousYear:" (Control)",nextYear:" (Control)",previousDecade:"",nextDecade:"",previousCentury:"",nextCentury:"",yearFormat:"YYYY",cellDateFormat:"D",monthBeforeYear:!1});const Mj={placeholder:"",rangePlaceholder:["",""]},n0={lang:Object.assign({placeholder:"",yearPlaceholder:"",quarterPlaceholder:"",monthPlaceholder:"",weekPlaceholder:"",rangePlaceholder:["",""],rangeYearPlaceholder:["",""],rangeMonthPlaceholder:["",""],rangeQuarterPlaceholder:["",""],rangeWeekPlaceholder:["",""]},JI),timePickerLocale:Object.assign({},Mj)};n0.lang.ok="";const Na="${label}${type}",eO={locale:"zh-cn",Pagination:SR,DatePicker:n0,TimePicker:Mj,Calendar:n0,global:{placeholder:"",close:""},Table:{filterTitle:"",filterConfirm:"",filterReset:"",filterEmptyText:"",filterCheckAll:"",filterSearchPlaceholder:"",emptyText:"",selectAll:"",selectInvert:"",selectNone:"",selectionAll:"",sortTitle:"",expand:"",collapse:"",triggerDesc:"",triggerAsc:"",cancelSort:""},Modal:{okText:"",cancelText:"",justOkText:""},Tour:{Next:"",Previous:"",Finish:""},Popconfirm:{cancelText:"",okText:""},Transfer:{titles:["",""],searchPlaceholder:"",itemUnit:"",itemsUnit:"",remove:"",selectCurrent:"",removeCurrent:"",selectAll:"",deselectAll:"",removeAll:"",selectInvert:""},Upload:{uploading:"",removeFile:"",uploadError:"",previewFile:"",downloadFile:""},Empty:{description:""},Icon:{icon:""},Text:{edit:"",copy:"",copied:"",expand:"",collapse:""},Form:{optional:"",defaultValidateMessages:{default:"${label}",required:"${label}",enum:"${label}[${enum}]",whitespace:"${label}",date:{format:"${label}",parse:"${label}",invalid:"${label}"},types:{string:Na,method:Na,array:Na,object:Na,number:Na,date:Na,boolean:Na,integer:Na,float:Na,regexp:Na,email:Na,url:Na,hex:Na},string:{len:"${label}${len}",min:"${label}${min}",max:"${label}${max}",range:"${label}${min}-${max}"},number:{len:"${label}${len}",min:"${label}${min}",max:"${label}${max}",range:"${label}${min}-${max}"},array:{len:"${len}${label}",min:"${min}${label}",max:"${max}${label}",range:"${label}${min}-${max}"},pattern:{mismatch:"${label}${pattern}"}}},Image:{preview:""},QRCode:{expired:"",refresh:"",scanned:""},ColorPicker:{presetEmpty:"",transparent:"",singleColor:"",gradientColor:""}};var Ax={exports:{}},Rx={};var qM;function tO(){if(qM)return Rx;qM=1;var t=hT();function e(g,v){return g===v&&(g!==0||1/g===1/v)||g!==g&&v!==v}var n=typeof Object.is=="function"?Object.is:e,s=t.useState,o=t.useEffect,l=t.useLayoutEffect,d=t.useDebugValue;function u(g,v){var C=v(),b=s({inst:{value:C,getSnapshot:v}}),_=b[0].inst,y=b[1];return l(function(){_.value=C,_.getSnapshot=v,h(_)&&y({inst:_})},[g,C,v]),o(function(){return h(_)&&y({inst:_}),g(function(){h(_)&&y({inst:_})})},[g]),d(C),C}function h(g){var v=g.getSnapshot;g=g.value;try{var C=v();return!n(g,C)}catch{return!0}}function p(g,v){return v()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:u;return Rx.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:m,Rx}var GM;function nO(){return GM||(GM=1,Ax.exports=tO()),Ax.exports}var $M=nO();const wj=0,Cj=1,Tj=2,WM=3;var YM=Object.prototype.hasOwnProperty;function i0(t,e){var n,s;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((s=t.length)===e.length)for(;s--&&i0(t[s],e[s]););return s===-1}if(!n||typeof t=="object"){s=0;for(n in t)if(YM.call(t,n)&&++s&&!YM.call(e,n)||!(n in e)||!i0(t[n],e[n]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}const Nr=new WeakMap,Fr=()=>{},Yi=Fr(),Hp=Object,hn=t=>t===Yi,Es=t=>typeof t=="function",Wr=(t,e)=>({...t,...e}),jj=t=>Es(t.then),Dx={},wh={},Av="undefined",tf=typeof window!=Av,a0=typeof document!=Av,iO=tf&&"Deno"in window,aO=()=>tf&&typeof window.requestAnimationFrame!=Av,Ej=(t,e)=>{const n=Nr.get(t);return[()=>!hn(e)&&t.get(e)||Dx,s=>{if(!hn(e)){const o=t.get(e);e in wh||(wh[e]=o),n[5](e,Wr(o,s),o||Dx)}},n[6],()=>!hn(e)&&e in wh?wh[e]:!hn(e)&&t.get(e)||Dx]};let s0=!0;const sO=()=>s0,[r0,o0]=tf&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[Fr,Fr],rO=()=>{const t=a0&&document.visibilityState;return hn(t)||t!=="hidden"},oO=t=>(a0&&document.addEventListener("visibilitychange",t),r0("focus",t),()=>{a0&&document.removeEventListener("visibilitychange",t),o0("focus",t)}),lO=t=>{const e=()=>{s0=!0,t()},n=()=>{s0=!1};return r0("online",e),r0("offline",n),()=>{o0("online",e),o0("offline",n)}},cO={isOnline:sO,isVisible:rO},dO={initFocus:oO,initReconnect:lO},KM=!Pn.useId,zc=!tf||iO,uO=t=>aO()?window.requestAnimationFrame(t):setTimeout(t,1),wp=zc?P.useEffect:P.useLayoutEffect,Ix=typeof navigator<"u"&&navigator.connection,XM=!zc&&Ix&&(["slow-2g","2g"].includes(Ix.effectiveType)||Ix.saveData),Ch=new WeakMap,fO=t=>Hp.prototype.toString.call(t),Ox=(t,e)=>t===`[object ${e}]`;let hO=0;const l0=t=>{const e=typeof t,n=fO(t),s=Ox(n,"Date"),o=Ox(n,"RegExp"),l=Ox(n,"Object");let d,u;if(Hp(t)===t&&!s&&!o){if(d=Ch.get(t),d)return d;if(d=++hO+"~",Ch.set(t,d),Array.isArray(t)){for(d="@",u=0;u<t.length;u++)d+=l0(t[u])+",";Ch.set(t,d)}if(l){d="#";const h=Hp.keys(t).sort();for(;!hn(u=h.pop());)hn(t[u])||(d+=u+":"+l0(t[u])+",");Ch.set(t,d)}}else d=s?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return d},Rv=t=>{if(Es(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?l0(t):"",[t,e]};let pO=0;const c0=()=>++pO;async function Aj(...t){const[e,n,s,o]=t,l=Wr({populateCache:!0,throwOnError:!0},typeof o=="boolean"?{revalidate:o}:o||{});let d=l.populateCache;const u=l.rollbackOnError;let h=l.optimisticData;const p=v=>typeof u=="function"?u(v):u!==!1,m=l.throwOnError;if(Es(n)){const v=n,C=[],b=e.keys();for(const _ of b)!/^\$(inf|sub)\$/.test(_)&&v(e.get(_)._k)&&C.push(_);return Promise.all(C.map(g))}return g(n);async function g(v){const[C]=Rv(v);if(!C)return;const[b,_]=Ej(e,C),[y,S,D,L]=Nr.get(e),N=()=>{const k=y[C];return(Es(l.revalidate)?l.revalidate(b().data,v):l.revalidate!==!1)&&(delete D[C],delete L[C],k&&k[0])?k[0](Tj).then(()=>b().data):b().data};if(t.length<3)return N();let T=s,j,E=!1;const R=c0();S[C]=[R,0];const M=!hn(h),I=b(),z=I.data,V=I._c,O=hn(V)?z:V;if(M&&(h=Es(h)?h(O,z):h,_({data:h,_c:O})),Es(T))try{T=T(O)}catch(k){j=k,E=!0}if(T&&jj(T))if(T=await T.catch(k=>{j=k,E=!0}),R!==S[C][0]){if(E)throw j;return T}else E&&M&&p(j)&&(d=!0,_({data:O,_c:Yi}));if(d&&!E)if(Es(d)){const k=d(T,O);_({data:k,error:Yi,_c:Yi})}else _({data:T,error:Yi,_c:Yi});if(S[C][1]=c0(),Promise.resolve(N()).then(()=>{_({_c:Yi})}),E){if(m)throw j;return}return T}}const QM=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},Rj=(t,e)=>{if(!Nr.has(t)){const n=Wr(dO,e),s=Object.create(null),o=Aj.bind(Yi,t);let l=Fr;const d=Object.create(null),u=(m,g)=>{const v=d[m]||[];return d[m]=v,v.push(g),()=>v.splice(v.indexOf(g),1)},h=(m,g,v)=>{t.set(m,g);const C=d[m];if(C)for(const b of C)b(g,v)},p=()=>{if(!Nr.has(t)&&(Nr.set(t,[s,Object.create(null),Object.create(null),Object.create(null),o,h,u]),!zc)){const m=n.initFocus(setTimeout.bind(Yi,QM.bind(Yi,s,wj))),g=n.initReconnect(setTimeout.bind(Yi,QM.bind(Yi,s,Cj)));l=()=>{m&&m(),g&&g(),Nr.delete(t)}}};return p(),[t,o,p,l]}return[t,Nr.get(t)[4]]},mO=(t,e,n,s,o)=>{const l=n.errorRetryCount,d=o.retryCount,u=~~((Math.random()+.5)*(1<<(d<8?d:8)))*n.errorRetryInterval;!hn(l)&&d>l||setTimeout(s,u,o)},gO=i0,[Dv,xO]=Rj(new Map),Dj=Wr({onLoadingSlow:Fr,onSuccess:Fr,onError:Fr,onErrorRetry:mO,onDiscarded:Fr,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:XM?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:XM?5e3:3e3,compare:gO,isPaused:()=>!1,cache:Dv,mutate:xO,fallback:{}},cO),Ij=(t,e)=>{const n=Wr(t,e);if(e){const{use:s,fallback:o}=t,{use:l,fallback:d}=e;s&&l&&(n.use=s.concat(l)),o&&d&&(n.fallback=Wr(o,d))}return n},d0=P.createContext({}),yO=t=>{const{value:e}=t,n=P.useContext(d0),s=Es(e),o=P.useMemo(()=>s?e(n):e,[s,n,e]),l=P.useMemo(()=>s?o:Ij(n,o),[s,n,o]),d=o&&o.provider,u=P.useRef(Yi);d&&!u.current&&(u.current=Rj(d(l.cache||Dv),o));const h=u.current;return h&&(l.cache=h[0],l.mutate=h[1]),wp(()=>{if(h)return h[2]&&h[2](),h[3]},[]),P.createElement(d0.Provider,Wr(t,{value:l}))},vO="$inf$",Oj=tf&&window.__SWR_DEVTOOLS_USE__,_O=Oj?window.__SWR_DEVTOOLS_USE__:[],bO=()=>{Oj&&(window.__SWR_DEVTOOLS_REACT__=Pn)},SO=t=>Es(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],Iv=()=>{const t=P.useContext(d0);return P.useMemo(()=>Wr(Dj,t),[t])},MO=t=>(e,n,s)=>t(e,n&&((...l)=>{const[d]=Rv(e),[,,,u]=Nr.get(Dv);if(d.startsWith(vO))return n(...l);const h=u[d];return hn(h)?n(...l):(delete u[d],h)}),s),wO=_O.concat(MO),CO=t=>function(...n){const s=Iv(),[o,l,d]=SO(n),u=Ij(s,d);let h=t;const{use:p}=u,m=(p||[]).concat(wO);for(let g=m.length;g--;)h=m[g](h);return h(o,l||u.fetcher||null,u)},TO=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const o=s.indexOf(n);o>=0&&(s[o]=s[s.length-1],s.pop())}};bO();const Px=Pn.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),Lx={dedupe:!0},ZM=Promise.resolve(Yi),jO=()=>Fr,EO=(t,e,n)=>{const{cache:s,compare:o,suspense:l,fallbackData:d,revalidateOnMount:u,revalidateIfStale:h,refreshInterval:p,refreshWhenHidden:m,refreshWhenOffline:g,keepPreviousData:v,strictServerPrefetchWarning:C}=n,[b,_,y,S]=Nr.get(s),[D,L]=Rv(t),N=P.useRef(!1),T=P.useRef(!1),j=P.useRef(D),E=P.useRef(e),R=P.useRef(n),M=()=>R.current,I=()=>M().isVisible()&&M().isOnline(),[z,V,O,k]=Ej(s,D),F=P.useRef({}).current,A=hn(d)?hn(n.fallback)?Yi:n.fallback[D]:d,q=(Fe,Dt)=>{for(const te in F){const bt=te;if(bt==="data"){if(!o(Fe[bt],Dt[bt])&&(!hn(Fe[bt])||!o(oe,Dt[bt])))return!1}else if(Dt[bt]!==Fe[bt])return!1}return!0},B=!N.current,W=P.useMemo(()=>{const Fe=z(),Dt=k(),te=nt=>{const G=Wr(nt);return delete G._k,(()=>{if(!D||!e||M().isPaused())return!1;if(B&&!hn(u))return u;const ie=hn(A)?G.data:A;return hn(ie)||h})()?{isValidating:!0,isLoading:!0,...G}:G},bt=te(Fe),It=Fe===Dt?bt:te(Dt);let tt=bt;return[()=>{const nt=te(z());return q(nt,tt)?(tt.data=nt.data,tt.isLoading=nt.isLoading,tt.isValidating=nt.isValidating,tt.error=nt.error,tt):(tt=nt,nt)},()=>It]},[s,D]),Q=$M.useSyncExternalStore(P.useCallback(Fe=>O(D,(Dt,te)=>{q(te,Dt)||Fe()}),[s,D]),W[0],W[1]),ne=b[D]&&b[D].length>0,de=Q.data,$=hn(de)?A&&jj(A)?Px(A):A:de,X=Q.error,le=P.useRef($),oe=v?hn(de)?hn(le.current)?$:le.current:de:$,ue=D&&hn($),Ye=P.useRef(null);!zc&&$M.useSyncExternalStore(jO,()=>(Ye.current=!1,Ye),()=>(Ye.current=!0,Ye));const ae=Ye.current;C&&ae&&!l&&ue&&console.warn(`Missing pre-initiated data for serialized key "${D}" during server-side rendering. Data fetching should be initiated on the server and provided to SWR via fallback data. You can set "strictServerPrefetchWarning: false" to disable this warning.`);const fe=!D||!e||M().isPaused()||ne&&!hn(X)?!1:B&&!hn(u)?u:l?hn($)?!1:h:hn($)||h,pt=hn(Q.isValidating)?fe:Q.isValidating,_t=hn(Q.isLoading)?fe:Q.isLoading,Se=P.useCallback(async Fe=>{const Dt=E.current;if(!D||!Dt||T.current||M().isPaused())return!1;let te,bt,It=!0;const tt=Fe||{},nt=!y[D]||!tt.dedupe,G=()=>KM?!T.current&&D===j.current&&N.current:D===j.current,H={isValidating:!1,isLoading:!1},ie=()=>{V(H)},we=()=>{const ge=y[D];ge&&ge[1]===bt&&delete y[D]},Ce={isValidating:!0};hn(z().data)&&(Ce.isLoading=!0);try{if(nt&&(V(Ce),n.loadingTimeout&&hn(z().data)&&setTimeout(()=>{It&&G()&&M().onLoadingSlow(D,n)},n.loadingTimeout),y[D]=[Dt(L),c0()]),[te,bt]=y[D],te=await te,nt&&setTimeout(we,n.dedupingInterval),!y[D]||y[D][1]!==bt)return nt&&G()&&M().onDiscarded(D),!1;H.error=Yi;const ge=_[D];if(!hn(ge)&&(bt<=ge[0]||bt<=ge[1]||ge[1]===0))return ie(),nt&&G()&&M().onDiscarded(D),!1;const je=z().data;H.data=o(je,te)?je:te,nt&&G()&&M().onSuccess(te,D,n)}catch(ge){we();const je=M(),{shouldRetryOnError:He}=je;je.isPaused()||(H.error=ge,nt&&G()&&(je.onError(ge,D,je),(He===!0||Es(He)&&He(ge))&&(!M().revalidateOnFocus||!M().revalidateOnReconnect||I())&&je.onErrorRetry(ge,D,je,dt=>{const gt=b[D];gt&&gt[0]&&gt[0](WM,dt)},{retryCount:(tt.retryCount||0)+1,dedupe:!0})))}return It=!1,ie(),!0},[D,s]),$e=P.useCallback((...Fe)=>Aj(s,j.current,...Fe),[]);if(wp(()=>{E.current=e,R.current=n,hn(de)||(le.current=de)}),wp(()=>{if(!D)return;const Fe=Se.bind(Yi,Lx);let Dt=0;M().revalidateOnFocus&&(Dt=Date.now()+M().focusThrottleInterval);const bt=TO(D,b,(It,tt={})=>{if(It==wj){const nt=Date.now();M().revalidateOnFocus&&nt>Dt&&I()&&(Dt=nt+M().focusThrottleInterval,Fe())}else if(It==Cj)M().revalidateOnReconnect&&I()&&Fe();else{if(It==Tj)return Se();if(It==WM)return Se(tt)}});return T.current=!1,j.current=D,N.current=!0,V({_k:L}),fe&&(y[D]||(hn($)||zc?Fe():uO(Fe))),()=>{T.current=!0,bt()}},[D]),wp(()=>{let Fe;function Dt(){const bt=Es(p)?p(z().data):p;bt&&Fe!==-1&&(Fe=setTimeout(te,bt))}function te(){!z().error&&(m||M().isVisible())&&(g||M().isOnline())?Se(Lx).then(Dt):Dt()}return Dt(),()=>{Fe&&(clearTimeout(Fe),Fe=-1)}},[p,m,g,D]),P.useDebugValue(oe),l){if(!KM&&zc&&ue)throw new Error("Fallback data is required when using Suspense in SSR.");ue&&(E.current=e,R.current=n,T.current=!1);const Fe=S[D],Dt=!hn(Fe)&&ue?$e(Fe):ZM;if(Px(Dt),!hn(X)&&ue)throw X;const te=ue?Se(Lx):ZM;!hn(oe)&&ue&&(te.status="fulfilled",te.value=!0),Px(te)}return{mutate:$e,get data(){return F.data=!0,oe},get error(){return F.error=!0,X},get isValidating(){return F.isValidating=!0,pt},get isLoading(){return F.isLoading=!0,_t}}},AO=Hp.defineProperty(yO,"defaultValue",{value:Dj}),RO=CO(EO),DO={moneySymbol:"$",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:" ",submit:"",collapsed:"",expand:"",inputPlaceholder:" ",selectPlaceholder:" "},alert:{clear:"",selected:"",item:""},pagination:{total:{range:" ",total:"",item:""}},tableToolBar:{leftPin:"  ",rightPin:"  ",noPin:" ",leftFixedTitle:"  ",rightFixedTitle:"  ",noFixedTitle:" ",reset:" ",columnDisplay:" ",columnSetting:"",fullScreen:"  ",exitFullScreen:"    ",reload:"",density:"",densityDefault:"",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:" "},editableTable:{action:{save:"",cancel:" ",delete:"",add:"   "}},switch:{open:"",close:""}},IO={moneySymbol:"",form:{lightFilter:{more:"Ms",clear:"Netejar",confirm:"Confirmar",itemUnit:"Elements"}},tableForm:{search:"Cercar",reset:"Netejar",submit:"Enviar",collapsed:"Expandir",expand:"Collapsar",inputPlaceholder:"Introduu valor",selectPlaceholder:"Seleccioneu valor"},alert:{clear:"Netejar",selected:"Seleccionat",item:"Article"},pagination:{total:{range:" ",total:"de",item:"articles"}},tableToolBar:{leftPin:"Pin a l'esquerra",rightPin:"Pin a la dreta",noPin:"Sense Pin",leftFixedTitle:"Fixat a l'esquerra",rightFixedTitle:"Fixat a la dreta",noFixedTitle:"Sense fixar",reset:"Reiniciar",columnDisplay:"Mostrar Columna",columnSetting:"Configuraci",fullScreen:"Pantalla Completa",exitFullScreen:"Sortir Pantalla Completa",reload:"Refrescar",density:"Densitat",densityDefault:"Per Defecte",densityLarger:"Llarg",densityMiddle:"Mitj",densitySmall:"Compacte"},stepsForm:{next:"Segent",prev:"Anterior",submit:"Finalizar"},loginForm:{submitText:"Entrar"},editableTable:{action:{save:"Guardar",cancel:"Cancellar",delete:"Eliminar",add:"afegir una fila de dades"}},switch:{open:"obert",close:"tancat"}},OO={moneySymbol:"K",deleteThisLine:"Smazat tento dek",copyThisLine:"Koprovat tento dek",form:{lightFilter:{more:"Vc",clear:"Vymazat",confirm:"Potvrdit",itemUnit:"Poloky"}},tableForm:{search:"Hledat",reset:"Resetovat",submit:"Odeslat",collapsed:"Zvtit",expand:"Zmenit",inputPlaceholder:"Zadejte prosm",selectPlaceholder:"Vyberte prosm"},alert:{clear:"Vymazat",selected:"Vybrno",item:"Poloka"},pagination:{total:{range:" ",total:"z",item:"poloek"}},tableToolBar:{leftPin:"Pipnout doleva",rightPin:"Pipnout doprava",noPin:"Odepnuto",leftFixedTitle:"Fixovno nalevo",rightFixedTitle:"Fixovno napravo",noFixedTitle:"Nefixovno",reset:"Resetovat",columnDisplay:"Zobrazen sloupc",columnSetting:"Nastaven",fullScreen:"Cel obrazovka",exitFullScreen:"Ukonit celou obrazovku",reload:"Obnovit",density:"Hustota",densityDefault:"Vchoz",densityLarger:"Vt",densityMiddle:"Stedn",densitySmall:"Kompaktn"},stepsForm:{next:"Dal",prev:"Pedchoz",submit:"Dokonit"},loginForm:{submitText:"Pihlsit se"},editableTable:{onlyOneLineEditor:"Upravit lze pouze jeden dek",action:{save:"Uloit",cancel:"Zruit",delete:"Vymazat",add:"Pidat dek"}},switch:{open:"Otevt",close:"Zavt"}},PO={moneySymbol:"",form:{lightFilter:{more:"Mehr",clear:"Zurcksetzen",confirm:"Besttigen",itemUnit:"Eintrge"}},tableForm:{search:"Suchen",reset:"Zurcksetzen",submit:"Absenden",collapsed:"Zeige mehr",expand:"Zeige weniger",inputPlaceholder:"Bitte eingeben",selectPlaceholder:"Bitte auswhlen"},alert:{clear:"Zurcksetzen",selected:"Ausgewhlt",item:"Eintrag"},pagination:{total:{range:" ",total:"von",item:"Eintrgen"}},tableToolBar:{leftPin:"Links anheften",rightPin:"Rechts anheften",noPin:"Nicht angeheftet",leftFixedTitle:"Links fixiert",rightFixedTitle:"Rechts fixiert",noFixedTitle:"Nicht fixiert",reset:"Zurcksetzen",columnDisplay:"Angezeigte Reihen",columnSetting:"Einstellungen",fullScreen:"Vollbild",exitFullScreen:"Vollbild verlassen",reload:"Aktualisieren",density:"Abstand",densityDefault:"Standard",densityLarger:"Grer",densityMiddle:"Mittel",densitySmall:"Kompakt"},stepsForm:{next:"Weiter",prev:"Zurck",submit:"Abschlieen"},loginForm:{submitText:"Anmelden"},editableTable:{action:{save:"Retten",cancel:"Abbrechen",delete:"Lschen",add:"Hinzufgen einer Datenzeile"}},switch:{open:"offen",close:"schlieen"}},LO={moneySymbol:"",form:{lightFilter:{more:"More",clear:"Clear",confirm:"Confirm",itemUnit:"Items"}},tableForm:{search:"Query",reset:"Reset",submit:"Submit",collapsed:"Expand",expand:"Collapse",inputPlaceholder:"Please enter",selectPlaceholder:"Please select"},alert:{clear:"Clear",selected:"Selected",item:"Item"},pagination:{total:{range:" ",total:"of",item:"items"}},tableToolBar:{leftPin:"Pin to left",rightPin:"Pin to right",noPin:"Unpinned",leftFixedTitle:"Fixed to the left",rightFixedTitle:"Fixed to the right",noFixedTitle:"Not Fixed",reset:"Reset",columnDisplay:"Column Display",columnSetting:"Table Settings",fullScreen:"Full Screen",exitFullScreen:"Exit Full Screen",reload:"Refresh",density:"Density",densityDefault:"Default",densityLarger:"Larger",densityMiddle:"Middle",densitySmall:"Compact"},stepsForm:{next:"Next",prev:"Previous",submit:"Finish"},loginForm:{submitText:"Login"},editableTable:{onlyOneLineEditor:"Only one line can be edited",onlyAddOneLine:"Only one line can be added",action:{save:"Save",cancel:"Cancel",delete:"Delete",add:"add a row of data"}},switch:{open:"open",close:"close"}},NO={moneySymbol:"$",deleteThisLine:"Delete this line",copyThisLine:"Copy this line",form:{lightFilter:{more:"More",clear:"Clear",confirm:"Confirm",itemUnit:"Items"}},tableForm:{search:"Query",reset:"Reset",submit:"Submit",collapsed:"Expand",expand:"Collapse",inputPlaceholder:"Please enter",selectPlaceholder:"Please select"},alert:{clear:"Clear",selected:"Selected",item:"Item"},pagination:{total:{range:" ",total:"of",item:"items"}},tableToolBar:{leftPin:"Pin to left",rightPin:"Pin to right",noPin:"Unpinned",leftFixedTitle:"Fixed to the left",rightFixedTitle:"Fixed to the right",noFixedTitle:"Not Fixed",reset:"Reset",columnDisplay:"Column Display",columnSetting:"Table Settings",fullScreen:"Full Screen",exitFullScreen:"Exit Full Screen",reload:"Refresh",density:"Density",densityDefault:"Default",densityLarger:"Larger",densityMiddle:"Middle",densitySmall:"Compact"},stepsForm:{next:"Next",prev:"Previous",submit:"Finish"},loginForm:{submitText:"Login"},editableTable:{onlyOneLineEditor:"Only one line can be edited",onlyAddOneLine:"Only one line can be added",action:{save:"Save",cancel:"Cancel",delete:"Delete",add:"add a row of data"}},switch:{open:"open",close:"close"}},FO={moneySymbol:"",form:{lightFilter:{more:"Ms",clear:"Limpiar",confirm:"Confirmar",itemUnit:"artculos"}},tableForm:{search:"Buscar",reset:"Limpiar",submit:"Submit",collapsed:"Expandir",expand:"Colapsar",inputPlaceholder:"Ingrese valor",selectPlaceholder:"Seleccione valor"},alert:{clear:"Limpiar",selected:"Seleccionado",item:"Articulo"},pagination:{total:{range:" ",total:"de",item:"artculos"}},tableToolBar:{leftPin:"Pin a la izquierda",rightPin:"Pin a la derecha",noPin:"Sin Pin",leftFixedTitle:"Fijado a la izquierda",rightFixedTitle:"Fijado a la derecha",noFixedTitle:"Sin Fijar",reset:"Reiniciar",columnDisplay:"Mostrar Columna",columnSetting:"Configuracin",fullScreen:"Pantalla Completa",exitFullScreen:"Salir Pantalla Completa",reload:"Refrescar",density:"Densidad",densityDefault:"Por Defecto",densityLarger:"Largo",densityMiddle:"Medio",densitySmall:"Compacto"},stepsForm:{next:"Siguiente",prev:"Anterior",submit:"Finalizar"},loginForm:{submitText:"Entrar"},editableTable:{action:{save:"Guardar",cancel:"Descartar",delete:"Borrar",add:"aadir una fila de datos"}},switch:{open:"abrir",close:"cerrar"}},zO={moneySymbol:"",form:{lightFilter:{more:"",clear:" ",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:" ",expand:" ",inputPlaceholder:" ",selectPlaceholder:" "},alert:{clear:" ",selected:"",item:""},pagination:{total:{range:" ",total:"",item:""}},tableToolBar:{leftPin:"  ",rightPin:"  ",noPin:" ",leftFixedTitle:"   ",rightFixedTitle:"   ",noFixedTitle:"",reset:"",columnDisplay:" ",columnSetting:"",fullScreen:" ",exitFullScreen:"    ",reload:" ",density:"",densityDefault:" ",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{action:{save:"",cancel:"",delete:"",add:"    "}},switch:{open:"",close:""}},kO={moneySymbol:"",form:{lightFilter:{more:"Plus",clear:"Effacer",confirm:"Confirmer",itemUnit:"Items"}},tableForm:{search:"Rechercher",reset:"Rinitialiser",submit:"Envoyer",collapsed:"Agrandir",expand:"Rduire",inputPlaceholder:"Entrer une valeur",selectPlaceholder:"Slectionner une valeur"},alert:{clear:"Rinitialiser",selected:"Slectionn",item:"Item"},pagination:{total:{range:" ",total:"sur",item:"lments"}},tableToolBar:{leftPin:"pingler  gauche",rightPin:"pingler  gauche",noPin:"Sans pingle",leftFixedTitle:"Fixer  gauche",rightFixedTitle:"Fixer  droite",noFixedTitle:"Non fix",reset:"Rinitialiser",columnDisplay:"Affichage colonne",columnSetting:"Rglages",fullScreen:"Plein cran",exitFullScreen:"Quitter Plein cran",reload:"Rafraichir",density:"Densit",densityDefault:"Par dfaut",densityLarger:"Larger",densityMiddle:"Moyenne",densitySmall:"Compacte"},stepsForm:{next:"Suivante",prev:"Prcdente",submit:"Finaliser"},loginForm:{submitText:"Se connecter"},editableTable:{action:{save:"Sauvegarder",cancel:"Annuler",delete:"Supprimer",add:"ajouter une ligne de donnes"}},switch:{open:"ouvert",close:"prs"}},BO={moneySymbol:"",deleteThisLine:"  ",copyThisLine:"  ",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:" ",selectPlaceholder:" "},alert:{clear:"",selected:"",item:""},pagination:{total:{range:" ",total:"",item:""}},tableToolBar:{leftPin:" ",rightPin:" ",noPin:" ",leftFixedTitle:" ",rightFixedTitle:" ",noFixedTitle:" ",reset:"",columnDisplay:" ",columnSetting:"",fullScreen:" ",exitFullScreen:"  ",reload:"",density:"",densityDefault:" ",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{onlyOneLineEditor:"    ",action:{save:"",cancel:"",delete:"",add:"  "}},switch:{open:"",close:""}},UO={moneySymbol:"kn",form:{lightFilter:{more:"Vie",clear:"Oisti",confirm:"Potvrdi",itemUnit:"Stavke"}},tableForm:{search:"Pretrai",reset:"Poniti",submit:"Potvrdi",collapsed:"Rairi",expand:"Skupi",inputPlaceholder:"Unesite",selectPlaceholder:"Odaberite"},alert:{clear:"Oisti",selected:"Odaberi",item:"stavke"},pagination:{total:{range:" ",total:"od",item:"stavke"}},tableToolBar:{leftPin:"Prikai lijevo",rightPin:"Prikai desno",noPin:"Bez prikaenja",leftFixedTitle:"Fiksiraj lijevo",rightFixedTitle:"Fiksiraj desno",noFixedTitle:"Bez fiksiranja",reset:"Resetiraj",columnDisplay:"Prikaz stupaca",columnSetting:"Postavke",fullScreen:"Puni zaslon",exitFullScreen:"Izai iz punog zaslona",reload:"Ponovno uitaj",density:"Veliina",densityDefault:"Zadano",densityLarger:"Veliko",densityMiddle:"Srednje",densitySmall:"Malo"},stepsForm:{next:"Sljedei",prev:"Prethodni",submit:"Kraj"},loginForm:{submitText:"Prijava"},editableTable:{action:{save:"Spremi",cancel:"Odustani",delete:"Obrii",add:"dodajte red podataka"}},switch:{open:"otvori",close:"zatvori"}},HO={moneySymbol:"RP",form:{lightFilter:{more:"Lebih",clear:"Hapus",confirm:"Konfirmasi",itemUnit:"Unit"}},tableForm:{search:"Cari",reset:"Atur ulang",submit:"Kirim",collapsed:"Lebih sedikit",expand:"Lebih banyak",inputPlaceholder:"Masukkan pencarian",selectPlaceholder:"Pilih"},alert:{clear:"Hapus",selected:"Dipilih",item:"Butir"},pagination:{total:{range:" ",total:"Dari",item:"Butir"}},tableToolBar:{leftPin:"Pin kiri",rightPin:"Pin kanan",noPin:"Tidak ada pin",leftFixedTitle:"Rata kiri",rightFixedTitle:"Rata kanan",noFixedTitle:"Tidak tetap",reset:"Atur ulang",columnDisplay:"Tampilan kolom",columnSetting:"Pengaturan",fullScreen:"Layar penuh",exitFullScreen:"Keluar layar penuh",reload:"Atur ulang",density:"Kerapatan",densityDefault:"Standar",densityLarger:"Lebih besar",densityMiddle:"Sedang",densitySmall:"Rapat"},stepsForm:{next:"Selanjutnya",prev:"Sebelumnya",submit:"Selesai"},loginForm:{submitText:"Login"},editableTable:{action:{save:"simpan",cancel:"batal",delete:"hapus",add:"Tambahkan baris data"}},switch:{open:"buka",close:"tutup"}},VO={moneySymbol:"",form:{lightFilter:{more:"pi",clear:"pulisci",confirm:"conferma",itemUnit:"elementi"}},tableForm:{search:"Filtra",reset:"Pulisci",submit:"Invia",collapsed:"Espandi",expand:"Contrai",inputPlaceholder:"Digita",selectPlaceholder:"Seleziona"},alert:{clear:"Rimuovi",selected:"Selezionati",item:"elementi"},pagination:{total:{range:" ",total:"di",item:"elementi"}},tableToolBar:{leftPin:"Fissa a sinistra",rightPin:"Fissa a destra",noPin:"Ripristina posizione",leftFixedTitle:"Fissato a sinistra",rightFixedTitle:"Fissato a destra",noFixedTitle:"Non fissato",reset:"Ripristina",columnDisplay:"Disposizione colonne",columnSetting:"Impostazioni",fullScreen:"Modalit schermo intero",exitFullScreen:"Esci da modalit schermo intero",reload:"Ricarica",density:"Grandezza tabella",densityDefault:"predefinito",densityLarger:"Grande",densityMiddle:"Media",densitySmall:"Compatta"},stepsForm:{next:"successivo",prev:"precedente",submit:"finisci"},loginForm:{submitText:"Accedi"},editableTable:{action:{save:"salva",cancel:"annulla",delete:"Delete",add:"add a row of data"}},switch:{open:"open",close:"chiudi"}},qO={moneySymbol:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:"",selectPlaceholder:""},alert:{clear:"",selected:"",item:""},pagination:{total:{range:"",total:"/",item:" "}},tableToolBar:{leftPin:"",rightPin:"",noPin:"",leftFixedTitle:"",rightFixedTitle:"",noFixedTitle:"",reset:"",columnDisplay:"",columnSetting:"",fullScreen:"",exitFullScreen:"",reload:"",density:"",densityDefault:"",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{action:{save:"",cancel:"",delete:"",add:""}},switch:{open:"",close:""}},GO={moneySymbol:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:" ",selectPlaceholder:" "},alert:{clear:"",selected:"",item:""},pagination:{total:{range:" ",total:"/ ",item:""}},tableToolBar:{leftPin:" ",rightPin:" ",noPin:" ",leftFixedTitle:" ",rightFixedTitle:" ",noFixedTitle:"",reset:"",columnDisplay:" ",columnSetting:"",fullScreen:" ",exitFullScreen:"  ",reload:" ",density:"",densityDefault:"",densityLarger:" ",densityMiddle:" ",densitySmall:" "},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{action:{save:"",cancel:"",delete:"",add:"  "}},switch:{open:"",close:" "}},$O={moneySymbol:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:"  ",selectPlaceholder:"  "},alert:{clear:"",selected:"",item:""},pagination:{total:{range:" ",total:"",item:""}},tableToolBar:{leftPin:"  ",rightPin:"  ",noPin:"",leftFixedTitle:" ",rightFixedTitle:" ",noFixedTitle:"",reset:"",columnDisplay:" ",columnSetting:"",fullScreen:" ",exitFullScreen:"  ",reload:"",density:"",densityDefault:"",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{action:{save:"",cancel:"",delete:"",add:" "}},switch:{open:"",close:""}},WO={moneySymbol:"RM",form:{lightFilter:{more:"Lebih banyak",clear:"Jelas",confirm:"Mengesahkan",itemUnit:"Item"}},tableForm:{search:"Cari",reset:"Menetapkan semula",submit:"Hantar",collapsed:"Kembang",expand:"Kuncup",inputPlaceholder:"Sila masuk",selectPlaceholder:"Sila pilih"},alert:{clear:"Padam",selected:"Dipilih",item:"Item"},pagination:{total:{range:" ",total:"daripada",item:"item"}},tableToolBar:{leftPin:"Pin ke kiri",rightPin:"Pin ke kanan",noPin:"Tidak pin",leftFixedTitle:"Tetap ke kiri",rightFixedTitle:"Tetap ke kanan",noFixedTitle:"Tidak Tetap",reset:"Menetapkan semula",columnDisplay:"Lajur",columnSetting:"Settings",fullScreen:"Full Screen",exitFullScreen:"Keluar Full Screen",reload:"Muat Semula",density:"Densiti",densityDefault:"Biasa",densityLarger:"Besar",densityMiddle:"Tengah",densitySmall:"Kecil"},stepsForm:{next:"Seterusnya",prev:"Sebelumnya",submit:"Selesai"},loginForm:{submitText:"Log Masuk"},editableTable:{action:{save:"Simpan",cancel:"Membatalkan",delete:"Menghapuskan",add:"tambah baris data"}},switch:{open:"Terbuka",close:"Tutup"}},YO={moneySymbol:"",deleteThisLine:"Verwijder deze regel",copyThisLine:"Kopieer deze regel",form:{lightFilter:{more:"Meer filters",clear:"Wissen",confirm:"Bevestigen",itemUnit:"item"}},tableForm:{search:"Zoeken",reset:"Resetten",submit:"Indienen",collapsed:"Uitvouwen",expand:"Inklappen",inputPlaceholder:"Voer in",selectPlaceholder:"Selecteer"},alert:{clear:"Selectie annuleren",selected:"Geselecteerd",item:"item"},pagination:{total:{range:"Van",total:"items/totaal",item:"items"}},tableToolBar:{leftPin:"Vastzetten aan begin",rightPin:"Vastzetten aan einde",noPin:"Niet vastzetten",leftFixedTitle:"Vastzetten aan de linkerkant",rightFixedTitle:"Vastzetten aan de rechterkant",noFixedTitle:"Niet vastzetten",reset:"Resetten",columnDisplay:"Kolomweergave",columnSetting:"Kolominstellingen",fullScreen:"Volledig scherm",exitFullScreen:"Verlaat volledig scherm",reload:"Vernieuwen",density:"Dichtheid",densityDefault:"Normaal",densityLarger:"Ruim",densityMiddle:"Gemiddeld",densitySmall:"Compact"},stepsForm:{next:"Volgende stap",prev:"Vorige stap",submit:"Indienen"},loginForm:{submitText:"Inloggen"},editableTable:{onlyOneLineEditor:"Slechts n regel tegelijk bewerken",action:{save:"Opslaan",cancel:"Annuleren",delete:"Verwijderen",add:"Een regel toevoegen"}},switch:{open:"Openen",close:"Sluiten"}},KO={moneySymbol:"z",form:{lightFilter:{more:"Wicej",clear:"Wyczy",confirm:"Potwierd",itemUnit:"Ilo"}},tableForm:{search:"Szukaj",reset:"Reset",submit:"Zatwierd",collapsed:"Poka wiecej",expand:"Poka mniej",inputPlaceholder:"Prosz poda",selectPlaceholder:"Prosz wybra"},alert:{clear:"Wyczy",selected:"Wybrane",item:"Wpis"},pagination:{total:{range:" ",total:"z",item:"Wpisw"}},tableToolBar:{leftPin:"Przypnij do lewej",rightPin:"Przypnij do prawej",noPin:"Odepnij",leftFixedTitle:"Przypite do lewej",rightFixedTitle:"Przypite do prawej",noFixedTitle:"Nieprzypite",reset:"Reset",columnDisplay:"Wywietlane wiersze",columnSetting:"Ustawienia",fullScreen:"Peen ekran",exitFullScreen:"Zamknij peen ekran",reload:"Odwie",density:"Odstp",densityDefault:"Standard",densityLarger:"Wiekszy",densityMiddle:"Sredni",densitySmall:"Kompaktowy"},stepsForm:{next:"Weiter",prev:"Zurck",submit:"Abschlieen"},loginForm:{submitText:"Zaloguj si"},editableTable:{action:{save:"Zapisa",cancel:"Anuluj",delete:"Usun",add:"dodawanie wiersza danych"}},switch:{open:"otwiera",close:"zamyka"}},XO={moneySymbol:"R$",form:{lightFilter:{more:"Mais",clear:"Limpar",confirm:"Confirmar",itemUnit:"Itens"}},tableForm:{search:"Filtrar",reset:"Limpar",submit:"Confirmar",collapsed:"Expandir",expand:"Colapsar",inputPlaceholder:"Por favor insira",selectPlaceholder:"Por favor selecione"},alert:{clear:"Limpar",selected:"Selecionado(s)",item:"Item(s)"},pagination:{total:{range:" ",total:"de",item:"itens"}},tableToolBar:{leftPin:"Fixar  esquerda",rightPin:"Fixar  direita",noPin:"Desfixado",leftFixedTitle:"Fixado  esquerda",rightFixedTitle:"Fixado  direita",noFixedTitle:"No fixado",reset:"Limpar",columnDisplay:"Mostrar Coluna",columnSetting:"Configuraes",fullScreen:"Tela Cheia",exitFullScreen:"Sair da Tela Cheia",reload:"Atualizar",density:"Densidade",densityDefault:"Padro",densityLarger:"Largo",densityMiddle:"Mdio",densitySmall:"Compacto"},stepsForm:{next:"Prximo",prev:"Anterior",submit:"Enviar"},loginForm:{submitText:"Entrar"},editableTable:{action:{save:"Salvar",cancel:"Cancelar",delete:"Apagar",add:"adicionar uma linha de dados"}},switch:{open:"abrir",close:"fechar"}},QO={moneySymbol:"RON",deleteThisLine:"terge acest rnd",copyThisLine:"Copiaz acest rnd",form:{lightFilter:{more:"Mai multe filtre",clear:"Cur",confirm:"Confirm",itemUnit:"elemente"}},tableForm:{search:"Caut",reset:"Reseteaz",submit:"Trimite",collapsed:"Extinde",expand:"Restrnge",inputPlaceholder:"Introducei",selectPlaceholder:"Selectai"},alert:{clear:"Anuleaz selecia",selected:"Selectat",item:"elemente"},pagination:{total:{range:"De la",total:"elemente/total",item:"elemente"}},tableToolBar:{leftPin:"Fixeaz la nceput",rightPin:"Fixeaz la sfrit",noPin:"Nu fixa",leftFixedTitle:"Fixeaz n stnga",rightFixedTitle:"Fixeaz n dreapta",noFixedTitle:"Nu fixa",reset:"Reseteaz",columnDisplay:"Afiare coloane",columnSetting:"Setri coloane",fullScreen:"Ecran complet",exitFullScreen:"Iei din ecran complet",reload:"Rencarc",density:"Densitate",densityDefault:"Normal",densityLarger:"Larg",densityMiddle:"Mediu",densitySmall:"Compact"},stepsForm:{next:"Pasul urmtor",prev:"Pasul anterior",submit:"Trimite"},loginForm:{submitText:"Autentificare"},editableTable:{onlyOneLineEditor:"Se poate edita doar un rnd simultan",action:{save:"Salveaz",cancel:"Anuleaz",delete:"terge",add:"Adaug un rnd"}},switch:{open:"Deschide",close:"nchide"}},ZO={moneySymbol:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:" ",selectPlaceholder:" "},alert:{clear:"",selected:"",item:""},pagination:{total:{range:" ",total:"",item:""}},tableToolBar:{leftPin:" ",rightPin:" ",noPin:"",leftFixedTitle:" ",rightFixedTitle:" ",noFixedTitle:" ",reset:"",columnDisplay:" ",columnSetting:"",fullScreen:" ",exitFullScreen:"   ",reload:"",density:"",densityDefault:" ",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{action:{save:"",cancel:"",delete:"",add:"  "}},switch:{open:"    ",close:" :"}},JO={moneySymbol:"",deleteThisLine:"Odstrni tento riadok",copyThisLine:"Skoprujte tento riadok",form:{lightFilter:{more:"Viac",clear:"Vyisti",confirm:"Potvrte",itemUnit:"Poloky"}},tableForm:{search:"Vyhlada",reset:"Resetova",submit:"Odosla",collapsed:"Rozbali",expand:"Zbali",inputPlaceholder:"Prosm, zadajte",selectPlaceholder:"Prosm, vyberte"},alert:{clear:"Vyisti",selected:"Vybran",item:"Poloka"},pagination:{total:{range:" ",total:"z",item:"poloiek"}},tableToolBar:{leftPin:"Pripn vavo",rightPin:"Pripn vpravo",noPin:"Odopnut",leftFixedTitle:"Fixovan na avo",rightFixedTitle:"Fixovan na pravo",noFixedTitle:"Nefixovan",reset:"Resetova",columnDisplay:"Zobrazenie stpcov",columnSetting:"Nastavenia",fullScreen:"Cel obrazovka",exitFullScreen:"Ukoni cel obrazovku",reload:"Obnovi",density:"Hustota",densityDefault:"Predvolen",densityLarger:"Vie",densityMiddle:"Stredn",densitySmall:"Kompaktn"},stepsForm:{next:"alie",prev:"Predchdzajce",submit:"Potvrdi"},loginForm:{submitText:"Prihlsi sa"},editableTable:{onlyOneLineEditor:"Upravova mono iba jeden riadok",action:{save:"Uloi",cancel:"Zrui",delete:"Odstrni",add:"prida riadok dajov"}},switch:{open:"otvori",close:"zavrie"}},eP={moneySymbol:"RSD",form:{lightFilter:{more:"Vie",clear:"Oisti",confirm:"Potvrdi",itemUnit:"Stavke"}},tableForm:{search:"Pronai",reset:"Resetuj",submit:"Poalji",collapsed:"Proiri",expand:"Skupi",inputPlaceholder:"Molimo unesite",selectPlaceholder:"Molimo odaberite"},alert:{clear:"Oisti",selected:"Odabrano",item:"Stavka"},pagination:{total:{range:" ",total:"od",item:"stavki"}},tableToolBar:{leftPin:"Zakai levo",rightPin:"Zakai desno",noPin:"Nije zakaeno",leftFixedTitle:"Fiksirano levo",rightFixedTitle:"Fiksirano desno",noFixedTitle:"Nije fiksirano",reset:"Resetuj",columnDisplay:"Prikaz kolona",columnSetting:"Podeavanja",fullScreen:"Pun ekran",exitFullScreen:"Zatvori pun ekran",reload:"Osvei",density:"Veliina",densityDefault:"Podrazumevana",densityLarger:"Vea",densityMiddle:"Srednja",densitySmall:"Kompaktna"},stepsForm:{next:"Dalje",prev:"Nazad",submit:"Gotovo"},loginForm:{submitText:"Prijavi se"},editableTable:{action:{save:"Sauvaj",cancel:"Poniti",delete:"Obrii",add:"dodajte red podataka"}},switch:{open:"",close:""}},tP={moneySymbol:"SEK",deleteThisLine:"Radera denna rad",copyThisLine:"Kopiera denna rad",form:{lightFilter:{more:"Fler filter",clear:"Rensa",confirm:"Bekrfta",itemUnit:"objekt"}},tableForm:{search:"Sk",reset:"terstll",submit:"Skicka",collapsed:"Expandera",expand:"Fll ihop",inputPlaceholder:"Vnligen ange",selectPlaceholder:"Vnligen vlj"},alert:{clear:"Avbryt val",selected:"Vald",item:"objekt"},pagination:{total:{range:"Frn",total:"objekt/totalt",item:"objekt"}},tableToolBar:{leftPin:"Fst till vnster",rightPin:"Fst till hger",noPin:"Inte fst",leftFixedTitle:"Fst till vnster",rightFixedTitle:"Fst till hger",noFixedTitle:"Inte fst",reset:"terstll",columnDisplay:"Kolumnvisning",columnSetting:"Kolumninstllningar",fullScreen:"Fullskrm",exitFullScreen:"Avsluta fullskrm",reload:"Ladda om",density:"Tthet",densityDefault:"Normal",densityLarger:"Ls",densityMiddle:"Medium",densitySmall:"Kompakt"},stepsForm:{next:"Nsta steg",prev:"Fregende steg",submit:"Skicka"},loginForm:{submitText:"Logga in"},editableTable:{onlyOneLineEditor:"Endast en rad kan redigeras t gngen",action:{save:"Spara",cancel:"Avbryt",delete:"Radera",add:"Lgg till en rad"}},switch:{open:"ppna",close:"Stng"}},nP={moneySymbol:"",deleteThisLine:"",copyThisLine:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:"",selectPlaceholder:""},alert:{clear:"",selected:"",item:""},pagination:{total:{range:" ",total:"",item:""}},tableToolBar:{leftPin:"",rightPin:"",noPin:"",leftFixedTitle:"",rightFixedTitle:"",noFixedTitle:"",reset:"",columnDisplay:"",columnSetting:"",fullScreen:"",exitFullScreen:"",reload:"",density:"",densityDefault:"",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{onlyOneLineEditor:"",action:{save:"",cancel:"",delete:"",add:""}},switch:{open:"",close:""}},iP={moneySymbol:"",form:{lightFilter:{more:"Daha Fazla",clear:"Temizle",confirm:"Onayla",itemUnit:"eler"}},tableForm:{search:"Filtrele",reset:"Sfrla",submit:"Gnder",collapsed:"Daha fazla",expand:"Daha az",inputPlaceholder:"Filtrelemek iin bir deer girin",selectPlaceholder:"Filtrelemek iin bir deer sein"},alert:{clear:"Temizle",selected:"Seili",item:"e"},pagination:{total:{range:" ",total:"Toplam",item:"e"}},tableToolBar:{leftPin:"Sola sabitle",rightPin:"Saa sabitle",noPin:"Sabitlemeyi kaldr",leftFixedTitle:"Sola sabitlendi",rightFixedTitle:"Saa sabitlendi",noFixedTitle:"Sabitlenmedi",reset:"Sfrla",columnDisplay:"Kolon Grnm",columnSetting:"Ayarlar",fullScreen:"Tam Ekran",exitFullScreen:"Tam Ekrandan k",reload:"Yenile",density:"Kalnlk",densityDefault:"Varsaylan",densityLarger:"Byk",densityMiddle:"Orta",densitySmall:"Kk"},stepsForm:{next:"Sradaki",prev:"nceki",submit:"Gnder"},loginForm:{submitText:"Giri Yap"},editableTable:{action:{save:"Kaydet",cancel:"Vazge",delete:"Sil",add:"foegje in rige gegevens ta"}},switch:{open:"ak",close:"kapatmak"}},aP={moneySymbol:"",deleteThisLine:" ",copyThisLine:" ",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:" ",selectPlaceholder:" "},alert:{clear:"",selected:"",item:""},pagination:{total:{range:" ",total:"",item:""}},tableToolBar:{leftPin:" ",rightPin:" ",noPin:"",leftFixedTitle:" ",rightFixedTitle:" ",noFixedTitle:" ",reset:"",columnDisplay:" ",columnSetting:"",fullScreen:" ",exitFullScreen:"   ",reload:"",density:"",densityDefault:" ",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{onlyOneLineEditor:"      ",action:{save:"",cancel:"",delete:"",add:" "}},switch:{open:"",close:""}},sP={moneySymbol:"UZS",form:{lightFilter:{more:"Yana",clear:"Tozalash",confirm:"OK",itemUnit:"Pozitsiyalar"}},tableForm:{search:"Qidirish",reset:"Qayta tiklash",submit:"Yuborish",collapsed:"Yigish",expand:"Kengaytirish",inputPlaceholder:"Qiymatni kiriting",selectPlaceholder:"Qiymatni tanlang"},alert:{clear:"Tozalash",selected:"Tanlangan",item:"elementlar"},pagination:{total:{range:" ",total:"dan",item:"elementlar"}},tableToolBar:{leftPin:"Chapga mahkamlash",rightPin:"Ongga mahkamlash",noPin:"Mahkamlashni olib tashlash",leftFixedTitle:"Chapga mahkamlangan",rightFixedTitle:"Ongga mahkamlangan",noFixedTitle:"Mahkamlashsiz",reset:"Qayta tiklash",columnDisplay:"Ustunni korsatish",columnSetting:"Sozlamalar",fullScreen:"Toliq ekran",exitFullScreen:"Toliq ekrandan chiqish",reload:"Yangilash",density:"Olcham",densityDefault:"Standart",densityLarger:"Katta",densityMiddle:"Ortacha",densitySmall:"Kichik"},stepsForm:{next:"Keyingi",prev:"Oldingi",submit:"Tugatish"},loginForm:{submitText:"Kirish"},editableTable:{action:{save:"Saqlash",cancel:"Bekor qilish",delete:"Ochirish",add:"malumotlar qatorini qoshish"}},switch:{open:"Ochish",close:"Yopish"}},rP={moneySymbol:"",form:{lightFilter:{more:"Nhiu hn",clear:"Trong",confirm:"Xc nhn",itemUnit:"Mc"}},tableForm:{search:"Tm kim",reset:"Lm li",submit:"Gi i",collapsed:"M rng",expand:"Thu gn",inputPlaceholder:"nhp d liu",selectPlaceholder:"Vui lng chn"},alert:{clear:"Xa",selected:" chn",item:"mc"},pagination:{total:{range:" ",total:"trn",item:"mt hng"}},tableToolBar:{leftPin:"Ghim tri",rightPin:"Ghim phi",noPin:"B ghim",leftFixedTitle:"C nh tri",rightFixedTitle:"C nh phi",noFixedTitle:"Cha c nh",reset:"Lm li",columnDisplay:"Ct hin th",columnSetting:"Cu hnh",fullScreen:"Ch  ton mn hnh",exitFullScreen:"Thot ch  ton mn hnh",reload:"Lm mi",density:"Mt  hin th",densityDefault:"Mc nh",densityLarger:"Mc nh",densityMiddle:"Trung bnh",densitySmall:"Cht"},stepsForm:{next:"Sau",prev:"Trc",submit:"Kt thc"},loginForm:{submitText:"ng nhp"},editableTable:{action:{save:"Cu",cancel:"Hy",delete:"Xa",add:"thm mt hng d liu"}},switch:{open:"m",close:"ng"}},oP={moneySymbol:"",deleteThisLine:"",copyThisLine:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:"",selectPlaceholder:""},alert:{clear:"",selected:"",item:""},pagination:{total:{range:"",total:"/",item:""}},tableToolBar:{leftPin:"",rightPin:"",noPin:"",leftFixedTitle:"",rightFixedTitle:"",noFixedTitle:"",reset:"",columnDisplay:"",columnSetting:"",fullScreen:"",exitFullScreen:"",reload:"",density:"",densityDefault:"",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{onlyOneLineEditor:"",action:{save:"",cancel:"",delete:"",add:""}},switch:{open:"",close:""}},lP={moneySymbol:"HK$",deleteThisLine:"",copyThisLine:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:"",selectPlaceholder:""},alert:{clear:"",selected:"",item:""},pagination:{total:{range:"",total:"/",item:""}},tableToolBar:{leftPin:"",rightPin:"",noPin:"",leftFixedTitle:"",rightFixedTitle:"",noFixedTitle:"",reset:"",columnDisplay:"",columnSetting:"",fullScreen:"",exitFullScreen:"",reload:"",density:"",densityDefault:"",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{onlyOneLineEditor:"",action:{save:"",cancel:"",delete:"",add:""}},switch:{open:"",close:""}},cP={moneySymbol:"NT$",deleteThisLine:"",copyThisLine:"",form:{lightFilter:{more:"",clear:"",confirm:"",itemUnit:""}},tableForm:{search:"",reset:"",submit:"",collapsed:"",expand:"",inputPlaceholder:"",selectPlaceholder:""},alert:{clear:"",selected:"",item:""},pagination:{total:{range:"",total:"/",item:""}},tableToolBar:{leftPin:"",rightPin:"",noPin:"",leftFixedTitle:"",rightFixedTitle:"",noFixedTitle:"",reset:"",columnDisplay:"",columnSetting:"",fullScreen:"",exitFullScreen:"",reload:"",density:"",densityDefault:"",densityLarger:"",densityMiddle:"",densitySmall:""},stepsForm:{next:"",prev:"",submit:""},loginForm:{submitText:""},editableTable:{onlyOneLineEditor:"",action:{save:"",cancel:"",delete:"",add:""}},switch:{open:"",close:""}};var vn=function(e,n){return{getMessage:function(o,l){var d=MR(n,o.replace(/\[(\d+)\]/g,".$1").split("."))||"";if(d)return d;var u=e.replace("_","-");if(u==="zh-CN")return l;var h=Vp["zh-CN"];return h?h.getMessage(o,l):l},locale:e}},dP=vn("mn_MN",$O),uP=vn("ar_EG",DO),Ov=vn("zh_CN",oP),fP=vn("en_US",NO),hP=vn("en_GB",LO),pP=vn("vi_VN",rP),mP=vn("it_IT",VO),gP=vn("ja_JP",qO),xP=vn("es_ES",FO),yP=vn("ca_ES",IO),vP=vn("ru_RU",ZO),_P=vn("sr_RS",eP),bP=vn("ms_MY",WO),SP=vn("zh_TW",cP),MP=vn("zh_HK",lP),wP=vn("fr_FR",kO),CP=vn("pt_BR",XO),TP=vn("ko_KR",GO),jP=vn("id_ID",HO),EP=vn("de_DE",PO),AP=vn("fa_IR",zO),RP=vn("tr_TR",iP),DP=vn("pl_PL",KO),IP=vn("hr_",UO),OP=vn("th_TH",nP),PP=vn("cs_cz",OO),LP=vn("sk_SK",JO),NP=vn("he_IL",BO),FP=vn("uk_UA",aP),zP=vn("uz_UZ",sP),kP=vn("nl_NL",YO),BP=vn("ro_RO",QO),UP=vn("sv_SE",tP),Vp={"mn-MN":dP,"ar-EG":uP,"zh-CN":Ov,"en-US":fP,"en-GB":hP,"vi-VN":pP,"it-IT":mP,"ja-JP":gP,"es-ES":xP,"ca-ES":yP,"ru-RU":vP,"sr-RS":_P,"ms-MY":bP,"zh-TW":SP,"zh-HK":MP,"fr-FR":wP,"pt-BR":CP,"ko-KR":TP,"id-ID":jP,"de-DE":EP,"fa-IR":AP,"tr-TR":RP,"pl-PL":DP,"hr-HR":IP,"th-TH":OP,"cs-CZ":PP,"sk-SK":LP,"he-IL":NP,"uk-UA":FP,"uz-UZ":zP,"nl-NL":kP,"ro-RO":BP,"sv-SE":UP},HP=Object.keys(Vp),VP=function(e){var n=(e||"zh-CN").toLocaleLowerCase();return HP.find(function(s){var o=s.toLocaleLowerCase();return o.includes(n)})};function Xi(t,e){qP(t)&&(t="100%");var n=GP(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function Th(t){return Math.min(1,Math.max(0,t))}function qP(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function GP(t){return typeof t=="string"&&t.indexOf("%")!==-1}function Pj(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function jh(t){return t<=1?"".concat(Number(t)*100,"%"):t}function gl(t){return t.length===1?"0"+t:String(t)}function $P(t,e,n){return{r:Xi(t,255)*255,g:Xi(e,255)*255,b:Xi(n,255)*255}}function JM(t,e,n){t=Xi(t,255),e=Xi(e,255),n=Xi(n,255);var s=Math.max(t,e,n),o=Math.min(t,e,n),l=0,d=0,u=(s+o)/2;if(s===o)d=0,l=0;else{var h=s-o;switch(d=u>.5?h/(2-s-o):h/(s+o),s){case t:l=(e-n)/h+(e<n?6:0);break;case e:l=(n-t)/h+2;break;case n:l=(t-e)/h+4;break}l/=6}return{h:l,s:d,l:u}}function Nx(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function WP(t,e,n){var s,o,l;if(t=Xi(t,360),e=Xi(e,100),n=Xi(n,100),e===0)o=n,l=n,s=n;else{var d=n<.5?n*(1+e):n+e-n*e,u=2*n-d;s=Nx(u,d,t+1/3),o=Nx(u,d,t),l=Nx(u,d,t-1/3)}return{r:s*255,g:o*255,b:l*255}}function ew(t,e,n){t=Xi(t,255),e=Xi(e,255),n=Xi(n,255);var s=Math.max(t,e,n),o=Math.min(t,e,n),l=0,d=s,u=s-o,h=s===0?0:u/s;if(s===o)l=0;else{switch(s){case t:l=(e-n)/u+(e<n?6:0);break;case e:l=(n-t)/u+2;break;case n:l=(t-e)/u+4;break}l/=6}return{h:l,s:h,v:d}}function YP(t,e,n){t=Xi(t,360)*6,e=Xi(e,100),n=Xi(n,100);var s=Math.floor(t),o=t-s,l=n*(1-e),d=n*(1-o*e),u=n*(1-(1-o)*e),h=s%6,p=[n,d,l,l,u,n][h],m=[u,n,n,d,l,l][h],g=[l,l,u,n,n,d][h];return{r:p*255,g:m*255,b:g*255}}function tw(t,e,n,s){var o=[gl(Math.round(t).toString(16)),gl(Math.round(e).toString(16)),gl(Math.round(n).toString(16))];return s&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function KP(t,e,n,s,o){var l=[gl(Math.round(t).toString(16)),gl(Math.round(e).toString(16)),gl(Math.round(n).toString(16)),gl(XP(s))];return o&&l[0].startsWith(l[0].charAt(1))&&l[1].startsWith(l[1].charAt(1))&&l[2].startsWith(l[2].charAt(1))&&l[3].startsWith(l[3].charAt(1))?l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0)+l[3].charAt(0):l.join("")}function XP(t){return Math.round(parseFloat(t)*255).toString(16)}function nw(t){return Ua(t)/255}function Ua(t){return parseInt(t,16)}function QP(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var u0={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function ZP(t){var e={r:0,g:0,b:0},n=1,s=null,o=null,l=null,d=!1,u=!1;return typeof t=="string"&&(t=tL(t)),typeof t=="object"&&(Tr(t.r)&&Tr(t.g)&&Tr(t.b)?(e=$P(t.r,t.g,t.b),d=!0,u=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Tr(t.h)&&Tr(t.s)&&Tr(t.v)?(s=jh(t.s),o=jh(t.v),e=YP(t.h,s,o),d=!0,u="hsv"):Tr(t.h)&&Tr(t.s)&&Tr(t.l)&&(s=jh(t.s),l=jh(t.l),e=WP(t.h,s,l),d=!0,u="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=Pj(n),{ok:d,format:t.format||u,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var JP="[-\\+]?\\d+%?",eL="[-\\+]?\\d*\\.\\d+%?",Po="(?:".concat(eL,")|(?:").concat(JP,")"),Fx="[\\s|\\(]+(".concat(Po,")[,|\\s]+(").concat(Po,")[,|\\s]+(").concat(Po,")\\s*\\)?"),zx="[\\s|\\(]+(".concat(Po,")[,|\\s]+(").concat(Po,")[,|\\s]+(").concat(Po,")[,|\\s]+(").concat(Po,")\\s*\\)?"),js={CSS_UNIT:new RegExp(Po),rgb:new RegExp("rgb"+Fx),rgba:new RegExp("rgba"+zx),hsl:new RegExp("hsl"+Fx),hsla:new RegExp("hsla"+zx),hsv:new RegExp("hsv"+Fx),hsva:new RegExp("hsva"+zx),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function tL(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(u0[t])t=u0[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=js.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=js.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=js.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=js.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=js.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=js.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=js.hex8.exec(t),n?{r:Ua(n[1]),g:Ua(n[2]),b:Ua(n[3]),a:nw(n[4]),format:e?"name":"hex8"}:(n=js.hex6.exec(t),n?{r:Ua(n[1]),g:Ua(n[2]),b:Ua(n[3]),format:e?"name":"hex"}:(n=js.hex4.exec(t),n?{r:Ua(n[1]+n[1]),g:Ua(n[2]+n[2]),b:Ua(n[3]+n[3]),a:nw(n[4]+n[4]),format:e?"name":"hex8"}:(n=js.hex3.exec(t),n?{r:Ua(n[1]+n[1]),g:Ua(n[2]+n[2]),b:Ua(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function Tr(t){return!!js.CSS_UNIT.exec(String(t))}var nL=(function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var s;if(e instanceof t)return e;typeof e=="number"&&(e=QP(e)),this.originalInput=e;var o=ZP(e);this.originalInput=e,this.r=o.r,this.g=o.g,this.b=o.b,this.a=o.a,this.roundA=Math.round(100*this.a)/100,this.format=(s=n.format)!==null&&s!==void 0?s:o.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=o.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,s,o,l=e.r/255,d=e.g/255,u=e.b/255;return l<=.03928?n=l/12.92:n=Math.pow((l+.055)/1.055,2.4),d<=.03928?s=d/12.92:s=Math.pow((d+.055)/1.055,2.4),u<=.03928?o=u/12.92:o=Math.pow((u+.055)/1.055,2.4),.2126*n+.7152*s+.0722*o},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=Pj(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=ew(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=ew(this.r,this.g,this.b),n=Math.round(e.h*360),s=Math.round(e.s*100),o=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(s,"%, ").concat(o,"%)"):"hsva(".concat(n,", ").concat(s,"%, ").concat(o,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=JM(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=JM(this.r,this.g,this.b),n=Math.round(e.h*360),s=Math.round(e.s*100),o=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(s,"%, ").concat(o,"%)"):"hsla(".concat(n,", ").concat(s,"%, ").concat(o,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),tw(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),KP(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),s=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(s,")"):"rgba(".concat(e,", ").concat(n,", ").concat(s,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(Xi(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(Xi(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+tw(this.r,this.g,this.b,!1),n=0,s=Object.entries(u0);n<s.length;n++){var o=s[n],l=o[0],d=o[1];if(e===d)return l}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var s=!1,o=this.a<1&&this.a>=0,l=!n&&o&&(e.startsWith("hex")||e==="name");return l?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(s=this.toRgbString()),e==="prgb"&&(s=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(s=this.toHexString()),e==="hex3"&&(s=this.toHexString(!0)),e==="hex4"&&(s=this.toHex8String(!0)),e==="hex8"&&(s=this.toHex8String()),e==="name"&&(s=this.toName()),e==="hsl"&&(s=this.toHslString()),e==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=Th(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=Th(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=Th(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=Th(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),s=(n.h+e)%360;return n.h=s<0?360+s:s,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var s=this.toRgb(),o=new t(e).toRgb(),l=n/100,d={r:(o.r-s.r)*l+s.r,g:(o.g-s.g)*l+s.g,b:(o.b-s.b)*l+s.b,a:(o.a-s.a)*l+s.a};return new t(d)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var s=this.toHsl(),o=360/n,l=[this];for(s.h=(s.h-(o*e>>1)+720)%360;--e;)s.h=(s.h+o)%360,l.push(new t(s));return l},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),s=n.h,o=n.s,l=n.v,d=[],u=1/e;e--;)d.push(new t({h:s,s:o,v:l})),l=(l+u)%1;return d},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),s=new t(e).toRgb(),o=n.a+s.a*(1-n.a);return new t({r:(n.r*n.a+s.r*s.a*(1-n.a))/o,g:(n.g*n.a+s.g*s.a*(1-n.a))/o,b:(n.b*n.a+s.b*s.a*(1-n.a))/o,a:o})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),s=n.h,o=[this],l=360/e,d=1;d<e;d++)o.push(new t({h:(s+d*l)%360,s:n.s,l:n.l}));return o},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t})(),kx,Pu={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911",colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff7875",colorInfo:"#1677ff",colorTextBase:"#000",colorBgBase:"#fff",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInQuint:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:4,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,"blue-1":"#e6f4ff","blue-2":"#bae0ff","blue-3":"#91caff","blue-4":"#69b1ff","blue-5":"#4096ff","blue-6":"#1677ff","blue-7":"#0958d9","blue-8":"#003eb3","blue-9":"#002c8c","blue-10":"#001d66","purple-1":"#f9f0ff","purple-2":"#efdbff","purple-3":"#d3adf7","purple-4":"#b37feb","purple-5":"#9254de","purple-6":"#722ed1","purple-7":"#531dab","purple-8":"#391085","purple-9":"#22075e","purple-10":"#120338","cyan-1":"#e6fffb","cyan-2":"#b5f5ec","cyan-3":"#87e8de","cyan-4":"#5cdbd3","cyan-5":"#36cfc9","cyan-6":"#13c2c2","cyan-7":"#08979c","cyan-8":"#006d75","cyan-9":"#00474f","cyan-10":"#002329","green-1":"#f6ffed","green-2":"#d9f7be","green-3":"#b7eb8f","green-4":"#95de64","green-5":"#73d13d","green-6":"#52c41a","green-7":"#389e0d","green-8":"#237804","green-9":"#135200","green-10":"#092b00","magenta-1":"#fff0f6","magenta-2":"#ffd6e7","magenta-3":"#ffadd2","magenta-4":"#ff85c0","magenta-5":"#f759ab","magenta-6":"#eb2f96","magenta-7":"#c41d7f","magenta-8":"#9e1068","magenta-9":"#780650","magenta-10":"#520339","pink-1":"#fff0f6","pink-2":"#ffd6e7","pink-3":"#ffadd2","pink-4":"#ff85c0","pink-5":"#f759ab","pink-6":"#eb2f96","pink-7":"#c41d7f","pink-8":"#9e1068","pink-9":"#780650","pink-10":"#520339","red-1":"#fff1f0","red-2":"#ffccc7","red-3":"#ffa39e","red-4":"#ff7875","red-5":"#ff4d4f","red-6":"#f5222d","red-7":"#cf1322","red-8":"#a8071a","red-9":"#820014","red-10":"#5c0011","orange-1":"#fff7e6","orange-2":"#ffe7ba","orange-3":"#ffd591","orange-4":"#ffc069","orange-5":"#ffa940","orange-6":"#fa8c16","orange-7":"#d46b08","orange-8":"#ad4e00","orange-9":"#873800","orange-10":"#612500","yellow-1":"#feffe6","yellow-2":"#ffffb8","yellow-3":"#fffb8f","yellow-4":"#fff566","yellow-5":"#ffec3d","yellow-6":"#fadb14","yellow-7":"#d4b106","yellow-8":"#ad8b00","yellow-9":"#876800","yellow-10":"#614700","volcano-1":"#fff2e8","volcano-2":"#ffd8bf","volcano-3":"#ffbb96","volcano-4":"#ff9c6e","volcano-5":"#ff7a45","volcano-6":"#fa541c","volcano-7":"#d4380d","volcano-8":"#ad2102","volcano-9":"#871400","volcano-10":"#610b00","geekblue-1":"#f0f5ff","geekblue-2":"#d6e4ff","geekblue-3":"#adc6ff","geekblue-4":"#85a5ff","geekblue-5":"#597ef7","geekblue-6":"#2f54eb","geekblue-7":"#1d39c4","geekblue-8":"#10239e","geekblue-9":"#061178","geekblue-10":"#030852","gold-1":"#fffbe6","gold-2":"#fff1b8","gold-3":"#ffe58f","gold-4":"#ffd666","gold-5":"#ffc53d","gold-6":"#faad14","gold-7":"#d48806","gold-8":"#ad6800","gold-9":"#874d00","gold-10":"#613400","lime-1":"#fcffe6","lime-2":"#f4ffb8","lime-3":"#eaff8f","lime-4":"#d3f261","lime-5":"#bae637","lime-6":"#a0d911","lime-7":"#7cb305","lime-8":"#5b8c00","lime-9":"#3f6600","lime-10":"#254000",colorText:"rgba(0, 0, 0, 0.88)",colorTextSecondary:"rgba(0, 0, 0, 0.65)",colorTextTertiary:"rgba(0, 0, 0, 0.45)",colorTextQuaternary:"rgba(0, 0, 0, 0.25)",colorFill:"rgba(0, 0, 0, 0.15)",colorFillSecondary:"rgba(0, 0, 0, 0.06)",colorFillTertiary:"rgba(0, 0, 0, 0.04)",colorFillQuaternary:"rgba(0, 0, 0, 0.02)",colorBgLayout:"hsl(220,23%,97%)",colorBgContainer:"#ffffff",colorBgElevated:"#ffffff",colorBgSpotlight:"rgba(0, 0, 0, 0.85)",colorBorder:"#d9d9d9",colorBorderSecondary:"#f0f0f0",colorPrimaryBg:"#e6f4ff",colorPrimaryBgHover:"#bae0ff",colorPrimaryBorder:"#91caff",colorPrimaryBorderHover:"#69b1ff",colorPrimaryHover:"#4096ff",colorPrimaryActive:"#0958d9",colorPrimaryTextHover:"#4096ff",colorPrimaryText:"#1677ff",colorPrimaryTextActive:"#0958d9",colorSuccessBg:"#f6ffed",colorSuccessBgHover:"#d9f7be",colorSuccessBorder:"#b7eb8f",colorSuccessBorderHover:"#95de64",colorSuccessHover:"#95de64",colorSuccessActive:"#389e0d",colorSuccessTextHover:"#73d13d",colorSuccessText:"#52c41a",colorSuccessTextActive:"#389e0d",colorErrorBg:"#fff2f0",colorErrorBgHover:"#fff1f0",colorErrorBorder:"#ffccc7",colorErrorBorderHover:"#ffa39e",colorErrorHover:"#ffa39e",colorErrorActive:"#d9363e",colorErrorTextHover:"#ff7875",colorErrorText:"#ff4d4f",colorErrorTextActive:"#d9363e",colorWarningBg:"#fffbe6",colorWarningBgHover:"#fff1b8",colorWarningBorder:"#ffe58f",colorWarningBorderHover:"#ffd666",colorWarningHover:"#ffd666",colorWarningActive:"#d48806",colorWarningTextHover:"#ffc53d",colorWarningText:"#faad14",colorWarningTextActive:"#d48806",colorInfoBg:"#e6f4ff",colorInfoBgHover:"#bae0ff",colorInfoBorder:"#91caff",colorInfoBorderHover:"#69b1ff",colorInfoHover:"#69b1ff",colorInfoActive:"#0958d9",colorInfoTextHover:"#4096ff",colorInfoText:"#1677ff",colorInfoTextActive:"#0958d9",colorBgMask:"rgba(0, 0, 0, 0.45)",colorWhite:"#fff",sizeXXL:48,sizeXL:32,sizeLG:24,sizeMD:20,sizeMS:16,size:16,sizeSM:12,sizeXS:8,sizeXXS:4,controlHeightSM:24,controlHeightXS:16,controlHeightLG:40,motionDurationFast:"0.1s",motionDurationMid:"0.2s",motionDurationSlow:"0.3s",fontSizes:[12,14,16,20,24,30,38,46,56,68],lineHeights:[1.6666666666666667,1.5714285714285714,1.5,1.4,1.3333333333333333,1.2666666666666666,1.2105263157894737,1.173913043478261,1.1428571428571428,1.1176470588235294],lineWidthBold:2,borderRadiusXS:1,borderRadiusSM:4,borderRadiusLG:8,borderRadiusOuter:4,colorLink:"#1677ff",colorLinkHover:"#69b1ff",colorLinkActive:"#0958d9",colorFillContent:"rgba(0, 0, 0, 0.06)",colorFillContentHover:"rgba(0, 0, 0, 0.15)",colorFillAlter:"rgba(0, 0, 0, 0.02)",colorBgContainerDisabled:"rgba(0, 0, 0, 0.04)",colorBorderBg:"#ffffff",colorSplit:"rgba(5, 5, 5, 0.06)",colorTextPlaceholder:"rgba(0, 0, 0, 0.25)",colorTextDisabled:"rgba(0, 0, 0, 0.25)",colorTextHeading:"rgba(0, 0, 0, 0.88)",colorTextLabel:"rgba(0, 0, 0, 0.65)",colorTextDescription:"rgba(0, 0, 0, 0.45)",colorTextLightSolid:"#fff",colorHighlight:"#ff7875",colorBgTextHover:"rgba(0, 0, 0, 0.06)",colorBgTextActive:"rgba(0, 0, 0, 0.15)",colorIcon:"rgba(0, 0, 0, 0.45)",colorIconHover:"rgba(0, 0, 0, 0.88)",colorErrorOutline:"rgba(255, 38, 5, 0.06)",colorWarningOutline:"rgba(255, 215, 5, 0.1)",fontSizeSM:12,fontSizeLG:16,fontSizeXL:20,fontSizeHeading1:38,fontSizeHeading2:30,fontSizeHeading3:24,fontSizeHeading4:20,fontSizeHeading5:16,fontSizeIcon:12,lineHeight:1.5714285714285714,lineHeightLG:1.5,lineHeightSM:1.6666666666666667,lineHeightHeading1:1.2105263157894737,lineHeightHeading2:1.2666666666666666,lineHeightHeading3:1.3333333333333333,lineHeightHeading4:1.4,lineHeightHeading5:1.5,controlOutlineWidth:2,controlInteractiveSize:16,controlItemBgHover:"rgba(0, 0, 0, 0.04)",controlItemBgActive:"#e6f4ff",controlItemBgActiveHover:"#bae0ff",controlItemBgActiveDisabled:"rgba(0, 0, 0, 0.15)",controlTmpOutline:"rgba(0, 0, 0, 0.02)",controlOutline:"rgba(5, 145, 255, 0.1)",fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:4,paddingXS:8,paddingSM:12,padding:16,paddingMD:20,paddingLG:24,paddingXL:32,paddingContentHorizontalLG:24,paddingContentVerticalLG:16,paddingContentHorizontal:16,paddingContentVertical:12,paddingContentHorizontalSM:16,paddingContentVerticalSM:8,marginXXS:4,marginXS:8,marginSM:12,margin:16,marginMD:20,marginLG:24,marginXL:32,marginXXL:48,boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.03),0 1px 6px -1px rgba(0, 0, 0, 0.02),0 2px 4px 0 rgba(0, 0, 0, 0.02)",boxShadowSecondary:"0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05)",screenXS:480,screenXSMin:480,screenXSMax:479,screenSM:576,screenSMMin:576,screenSMMax:575,screenMD:768,screenMDMin:768,screenMDMax:767,screenLG:992,screenLGMin:992,screenLGMax:991,screenXL:1200,screenXLMin:1200,screenXLMax:1199,screenXXL:1600,screenXXLMin:1600,screenXXLMax:1599,boxShadowPopoverArrow:"3px 3px 7px rgba(0, 0, 0, 0.1)",boxShadowCard:"0 1px 2px -2px rgba(0, 0, 0, 0.16),0 3px 6px 0 rgba(0, 0, 0, 0.12),0 5px 12px 4px rgba(0, 0, 0, 0.09)",boxShadowDrawerRight:"-6px 0 16px 0 rgba(0, 0, 0, 0.08),-3px 0 6px -4px rgba(0, 0, 0, 0.12),-9px 0 28px 8px rgba(0, 0, 0, 0.05)",boxShadowDrawerLeft:"6px 0 16px 0 rgba(0, 0, 0, 0.08),3px 0 6px -4px rgba(0, 0, 0, 0.12),9px 0 28px 8px rgba(0, 0, 0, 0.05)",boxShadowDrawerUp:"0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05)",boxShadowDrawerDown:"0 -6px 16px 0 rgba(0, 0, 0, 0.08),0 -3px 6px -4px rgba(0, 0, 0, 0.12),0 -9px 28px 8px rgba(0, 0, 0, 0.05)",boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)",_tokenKey:"19w80ff",_hashId:"css-dev-only-do-not-override-i2zu9q"},Lj=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=3735928559^n,o=1103547991^n,l=0,d;l<e.length;l++)d=e.charCodeAt(l),s=Math.imul(s^d,2654435761),o=Math.imul(o^d,1597334677);return s=Math.imul(s^s>>>16,2246822507)^Math.imul(o^o>>>13,3266489909),o=Math.imul(o^o>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),4294967296*(2097151&o)+(s>>>0)},Pv=wR(function(t){return t}),Nj={theme:Pv,token:Me(Me({},Pu),Gs===null||Gs===void 0||(kx=Gs.defaultAlgorithm)===null||kx===void 0?void 0:kx.call(Gs,Gs===null||Gs===void 0?void 0:Gs.defaultSeed)),hashId:"pro-".concat(Lj(JSON.stringify(Pu)))},iL=function(){return Nj};const aL=Object.freeze(Object.defineProperty({__proto__:null,defaultToken:Pu,emptyTheme:Pv,hashCode:Lj,token:Nj,useToken:iL},Symbol.toStringTag,{value:"Module"}));var ss=function(e,n){return new nL(e).setAlpha(n).toRgbString()},sL=function(){return typeof Gs>"u"||!Gs?aL:Gs},Lu=sL(),rL=Lu.useToken,Bx=function(e){return{boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none"}};function fs(t,e){var n,s=P.useContext(Is),o=s.token,l=o===void 0?{}:o,d=P.useContext(Is),u=d.hashed,h=rL(),p=h.token,m=h.hashId,g=P.useContext(Is);g.theme;var v=P.useContext(Qi.ConfigContext),C=v.getPrefixCls,b=v.csp;return l.layout||(l=Me({},p)),l.proComponentsCls=(n=l.proComponentsCls)!==null&&n!==void 0?n:".".concat(C("pro")),l.antCls=".".concat(C()),{wrapSSR:CR({token:l,path:[t],nonce:b?.nonce,layer:{name:"antd-pro"}},function(){return e(l)}),hashId:u?m:""}}var oL=function(e,n){var s,o,l,d,u,h=Me({},e);return Me(Me({bgLayout:"linear-gradient(".concat(n.colorBgContainer,", ").concat(n.colorBgLayout," 28%)"),colorTextAppListIcon:n.colorTextSecondary,appListIconHoverBgColor:h==null||(s=h.sider)===null||s===void 0?void 0:s.colorBgMenuItemSelected,colorBgAppListIconHover:ss(n.colorTextBase,.04),colorTextAppListIconHover:n.colorTextBase},h),{},{header:Me({colorBgHeader:ss(n.colorBgElevated,.6),colorBgScrollHeader:ss(n.colorBgElevated,.8),colorHeaderTitle:n.colorText,colorBgMenuItemHover:ss(n.colorTextBase,.03),colorBgMenuItemSelected:"transparent",colorBgMenuElevated:(h==null||(o=h.header)===null||o===void 0?void 0:o.colorBgHeader)!=="rgba(255, 255, 255, 0.6)"?(l=h.header)===null||l===void 0?void 0:l.colorBgHeader:n.colorBgElevated,colorTextMenuSelected:ss(n.colorTextBase,.95),colorBgRightActionsItemHover:ss(n.colorTextBase,.03),colorTextRightActionsItem:n.colorTextTertiary,heightLayoutHeader:56,colorTextMenu:n.colorTextSecondary,colorTextMenuSecondary:n.colorTextTertiary,colorTextMenuTitle:n.colorText,colorTextMenuActive:n.colorText},h.header),sider:Me({paddingInlineLayoutMenu:8,paddingBlockLayoutMenu:0,colorBgCollapsedButton:n.colorBgElevated,colorTextCollapsedButtonHover:n.colorTextSecondary,colorTextCollapsedButton:ss(n.colorTextBase,.25),colorMenuBackground:"transparent",colorMenuItemDivider:ss(n.colorTextBase,.06),colorBgMenuItemHover:ss(n.colorTextBase,.03),colorBgMenuItemSelected:ss(n.colorTextBase,.04),colorTextMenuItemHover:n.colorText,colorTextMenuSelected:ss(n.colorTextBase,.95),colorTextMenuActive:n.colorText,colorTextMenu:n.colorTextSecondary,colorTextMenuSecondary:n.colorTextTertiary,colorTextMenuTitle:n.colorText,colorTextSubMenuSelected:ss(n.colorTextBase,.95)},h.sider),pageContainer:Me({colorBgPageContainer:"transparent",paddingInlinePageContainerContent:((d=h.pageContainer)===null||d===void 0?void 0:d.marginInlinePageContainerContent)||40,paddingBlockPageContainerContent:((u=h.pageContainer)===null||u===void 0?void 0:u.marginBlockPageContainerContent)||32,colorBgPageContainerFixed:n.colorBgElevated},h.pageContainer)})},lL=function(){for(var e={},n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];for(var l=s.length,d,u=0;u<l;u+=1)for(d in s[u])s[u].hasOwnProperty(d)&&(Ml(e[d])==="object"&&Ml(s[u][d])==="object"&&e[d]!==void 0&&e[d]!==null&&!Array.isArray(e[d])&&!Array.isArray(s[u][d])?e[d]=Me(Me({},e[d]),s[u][d]):e[d]=s[u][d]);return e},cL=["locale","getPrefixCls"],dL=["locale","theme"],uL=function(e){var n={};if(Object.keys(e||{}).forEach(function(s){e[s]!==void 0&&(n[s]=e[s])}),!(Object.keys(n).length<1))return n},kc=function(){var e,n;return!(typeof process<"u"&&(((e="production")===null||e===void 0?void 0:e.toUpperCase())==="TEST"||((n="production")===null||n===void 0?void 0:n.toUpperCase())==="DEV"))},Wc=Pn.createContext({intl:Me(Me({},Ov),{},{locale:"default"}),valueTypeMap:{},theme:Pv,hashed:!0,dark:!1,token:Pu});Wc.Consumer;var fL=function(){var e=Iv(),n=e.cache;return P.useEffect(function(){return function(){n.clear()}},[]),null},hL=function(e){var n,s=e.children,o=e.dark,l=e.valueTypeMap,d=e.autoClearCache,u=d===void 0?!1:d,h=e.token,p=e.prefixCls,m=e.intl,g=P.useContext(Qi.ConfigContext),v=g.locale,C=g.getPrefixCls,b=Wa(g,cL),_=(n=Lu.useToken)===null||n===void 0?void 0:n.call(Lu),y=P.useContext(Wc),S=p?".".concat(p):".".concat(C(),"-pro"),D="."+C(),L="".concat(S),N=P.useMemo(function(){return oL(h||{},_.token||Pu)},[h,_.token]),T=P.useMemo(function(){var A,q=v?.locale,B=VP(q),W=m??(q&&((A=y.intl)===null||A===void 0?void 0:A.locale)==="default"?Vp[B]:y.intl||Vp[B]);return Me(Me({},y),{},{dark:o??y.dark,token:lL(y.token,_.token,{proComponentsCls:S,antCls:D,themeId:_.theme.id,layout:N}),intl:W||Ov})},[v?.locale,y,o,_.token,_.theme.id,S,D,N,m]),j=Me(Me({},T.token||{}),{},{proComponentsCls:S}),E=TR(_.theme,[_.token,j??{}],{salt:L,override:j}),R=Qn(E,2),M=R[0],I=R[1],z=P.useMemo(function(){return!(e.hashed===!1||y.hashed===!1)},[y.hashed,e.hashed]),V=P.useMemo(function(){return e.hashed===!1||y.hashed===!1||kc()===!1?"":_.hashId?_.hashId:I},[I,y.hashed,e.hashed]);P.useEffect(function(){lt.locale(v?.locale||"zh-cn")},[v?.locale]);var O=P.useMemo(function(){return Me(Me({},b.theme),{},{hashId:V,hashed:z&&kc()})},[b.theme,V,z,kc()]),k=P.useMemo(function(){return Me(Me({},T),{},{valueTypeMap:l||T?.valueTypeMap,token:M,theme:_.theme,hashed:z,hashId:V})},[T,l,M,_.theme,z,V]),F=P.useMemo(function(){return i.jsx(Qi,Me(Me({},b),{},{theme:O,children:i.jsx(Wc.Provider,{value:k,children:i.jsxs(i.Fragment,{children:[u&&i.jsx(fL,{}),s]})})}))},[b,O,k,u,s]);return u?i.jsx(AO,{value:{provider:function(){return new Map}},children:F}):F},pL=function(e){var n=e.needDeps,s=e.dark,o=e.token,l=P.useContext(Wc),d=P.useContext(Qi.ConfigContext),u=d.locale,h=d.theme,p=Wa(d,dL),m=n&&l.hashId!==void 0&&Object.keys(e).sort().join("-")==="children-needDeps";if(m)return i.jsx(i.Fragment,{children:e.children});var g=function(){var b=s??l.dark;return b&&!Array.isArray(h?.algorithm)?[h?.algorithm,Lu.darkAlgorithm].filter(Boolean):b&&Array.isArray(h?.algorithm)?[].concat(Vc(h?.algorithm||[]),[Lu.darkAlgorithm]).filter(Boolean):h?.algorithm},v=Me(Me({},p),{},{locale:u||eO,theme:uL(Me(Me({},h),{},{algorithm:g()}))});return i.jsx(Qi,Me(Me({},v),{},{children:i.jsx(hL,Me(Me({},e),{},{token:o}))}))};Wc.displayName="ProProvider";var Is=Wc,mL=(function(t){jR(n,t);var e=ER(n);function n(){var s;pT(this,n);for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];return s=e.call.apply(e,[this].concat(l)),he(AR(s),"state",{hasError:!1,errorInfo:""}),s}return mT(n,[{key:"componentDidCatch",value:function(o,l){console.log(o,l)}},{key:"render",value:function(){return this.state.hasError?i.jsx(RR,{status:"error",title:"Something went wrong.",extra:this.state.errorInfo}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(o){return{hasError:!0,errorInfo:o.message}}}]),n})(Pn.Component),Fj=function(e){var n={};if(Object.keys(e||{}).forEach(function(s){e[s]!==void 0&&(n[s]=e[s])}),!(Object.keys(n).length<1))return n},gL=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,iw=function(e){return e==="*"||e==="x"||e==="X"},aw=function(e){var n=parseInt(e,10);return isNaN(n)?e:n},xL=function(e,n){return Ml(e)!==Ml(n)?[String(e),String(n)]:[e,n]},yL=function(e,n){if(iw(e)||iw(n))return 0;var s=xL(aw(e),aw(n)),o=Qn(s,2),l=o[0],d=o[1];return l>d?1:l<d?-1:0},vL=function(e,n){for(var s=0;s<Math.max(e.length,n.length);s++){var o=yL(e[s]||"0",n[s]||"0");if(o!==0)return o}return 0},sw=function(e){var n,s=e.match(gL);return s==null||(n=s.shift)===null||n===void 0||n.call(s),s},Lv=function(e,n){var s=sw(e),o=sw(n),l=s.pop(),d=o.pop(),u=vL(s,o);return u!==0?u:l||d?l?-1:1:0},zj=function(){var e;return typeof process>"u"?qc:((e=process)===null||e===void 0||(e=e.env)===null||e===void 0?void 0:e.ANTD_VERSION)||qc},kj=function(e,n){var s=Lv(zj(),"4.23.0")>-1?{open:e,onOpenChange:n}:{visible:e,onVisibleChange:n};return Fj(s)};function Bj(t){if(Lv(zj(),"5.6.0")<0)return t;var e={colorGroupTitle:"groupTitleColor",radiusItem:"itemBorderRadius",radiusSubMenuItem:"subMenuItemBorderRadius",colorItemText:"itemColor",colorItemTextHover:"itemHoverColor",colorItemTextHoverHorizontal:"horizontalItemHoverColor",colorItemTextSelected:"itemSelectedColor",colorItemTextSelectedHorizontal:"horizontalItemSelectedColor",colorItemTextDisabled:"itemDisabledColor",colorDangerItemText:"dangerItemColor",colorDangerItemTextHover:"dangerItemHoverColor",colorDangerItemTextSelected:"dangerItemSelectedColor",colorDangerItemBgActive:"dangerItemActiveBg",colorDangerItemBgSelected:"dangerItemSelectedBg",colorItemBg:"itemBg",colorItemBgHover:"itemHoverBg",colorSubItemBg:"subMenuItemBg",colorItemBgActive:"itemActiveBg",colorItemBgSelected:"itemSelectedBg",colorItemBgSelectedHorizontal:"horizontalItemSelectedBg",colorActiveBarWidth:"activeBarWidth",colorActiveBarHeight:"activeBarHeight",colorActiveBarBorderSize:"activeBarBorderWidth"},n=Me({},t);return Object.keys(e).forEach(function(s){n[s]!==void 0&&(n[e[s]]=n[s],delete n[s])}),n}var _L=function(e){var n=P.useRef(null);return n.current=e,P.useCallback(function(){for(var s,o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];return(s=n.current)===null||s===void 0?void 0:s.call.apply(s,[n].concat(Vc(l)))},[])};function bL(t,e){var n=_L(t),s=P.useRef(),o=P.useCallback(function(){s.current&&(clearTimeout(s.current),s.current=null)},[]),l=P.useCallback(Op(Oo().mark(function d(){var u,h,p,m=arguments;return Oo().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:for(u=m.length,h=new Array(u),p=0;p<u;p++)h[p]=m[p];{v.next=3;break}case 3:return o(),v.abrupt("return",new Promise(function(C){s.current=setTimeout(Op(Oo().mark(function b(){return Oo().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.t0=C,y.next=3,n.apply(void 0,h);case 3:return y.t1=y.sent,(0,y.t0)(y.t1),y.abrupt("return");case 6:case"end":return y.stop()}},b)})),e)}));case 5:case"end":return v.stop()}},d)})),[n,o,e]);return P.useEffect(function(){return o},[o]),{run:l,cancel:o}}var SL=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,Nv=function(){return typeof window<"u"&&typeof window.document<"u"&&typeof window.matchMedia<"u"&&!SL};function ML(t,e){var n=typeof t.pageName=="string"?t.title:e;P.useEffect(function(){Nv()&&n&&(document.title=n)},[t.title,n])}function wL(t){return/\w.(png|jpg|jpeg|svg|webp|gif|bmp)$/i.test(t)}var Fv=function(e){if(!e||!e.startsWith("http"))return!1;try{var n=new URL(e);return!!n}catch{return!1}};function hc(t){var e=typeof window>"u",n=P.useState(function(){return e?!1:window.matchMedia(t).matches}),s=Qn(n,2),o=s[0],l=s[1];return P.useLayoutEffect(function(){if(!e){var d=window.matchMedia(t),u=function(p){return l(p.matches)};return d.addListener(u),function(){return d.removeListener(u)}}},[t]),o}var Ro={xs:{maxWidth:575,matchMedia:"(max-width: 575px)"},sm:{minWidth:576,maxWidth:767,matchMedia:"(min-width: 576px) and (max-width: 767px)"},md:{minWidth:768,maxWidth:991,matchMedia:"(min-width: 768px) and (max-width: 991px)"},lg:{minWidth:992,maxWidth:1199,matchMedia:"(min-width: 992px) and (max-width: 1199px)"},xl:{minWidth:1200,maxWidth:1599,matchMedia:"(min-width: 1200px) and (max-width: 1599px)"},xxl:{minWidth:1600,matchMedia:"(min-width: 1600px)"}},CL=function(){var e=void 0;if(typeof window>"u")return e;var n=Object.keys(Ro).find(function(s){var o=Ro[s].matchMedia;return!!window.matchMedia(o).matches});return e=n,e},TL=function(){var e=hc(Ro.md.matchMedia),n=hc(Ro.lg.matchMedia),s=hc(Ro.xxl.matchMedia),o=hc(Ro.xl.matchMedia),l=hc(Ro.sm.matchMedia),d=hc(Ro.xs.matchMedia),u=P.useState(CL()),h=Qn(u,2),p=h[0],m=h[1];return P.useEffect(function(){if(s){m("xxl");return}if(o){m("xl");return}if(n){m("lg");return}if(e){m("md");return}if(l){m("sm");return}if(d){m("xs");return}m("md")},[e,n,s,o,l,d]),p},rw=P.createContext({});const Ai=Math.round;function Ux(t,e){const n=t.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],s=n.map(o=>parseFloat(o));for(let o=0;o<3;o+=1)s[o]=e(s[o]||0,n[o]||"",o);return n[3]?s[3]=n[3].includes("%")?s[3]/100:s[3]:s[3]=1,s}const ow=(t,e,n)=>n===0?t:t/100;function su(t,e){const n=e||255;return t>n?n:t<0?0:t}class Oc{constructor(e){he(this,"isValid",!0),he(this,"r",0),he(this,"g",0),he(this,"b",0),he(this,"a",1),he(this,"_h",void 0),he(this,"_s",void 0),he(this,"_l",void 0),he(this,"_v",void 0),he(this,"_max",void 0),he(this,"_min",void 0),he(this,"_brightness",void 0);function n(s){return s[0]in e&&s[1]in e&&s[2]in e}if(e)if(typeof e=="string"){let o=function(l){return s.startsWith(l)};const s=e.trim();/^#?[A-F\d]{3,8}$/i.test(s)?this.fromHexString(s):o("rgb")?this.fromRgbString(s):o("hsl")?this.fromHslString(s):(o("hsv")||o("hsb"))&&this.fromHsvString(s)}else if(e instanceof Oc)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(n("rgb"))this.r=su(e.r),this.g=su(e.g),this.b=su(e.b),this.a=typeof e.a=="number"?su(e.a,1):1;else if(n("hsl"))this.fromHsl(e);else if(n("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const n=this.toHsv();return n.h=e,this._c(n)}getLuminance(){function e(l){const d=l/255;return d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4)}const n=e(this.r),s=e(this.g),o=e(this.b);return .2126*n+.7152*s+.0722*o}getHue(){if(typeof this._h>"u"){const e=this.getMax()-this.getMin();e===0?this._h=0:this._h=Ai(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){const n=this.getHue(),s=this.getSaturation();let o=this.getLightness()-e/100;return o<0&&(o=0),this._c({h:n,s,l:o,a:this.a})}lighten(e=10){const n=this.getHue(),s=this.getSaturation();let o=this.getLightness()+e/100;return o>1&&(o=1),this._c({h:n,s,l:o,a:this.a})}mix(e,n=50){const s=this._c(e),o=n/100,l=u=>(s[u]-this[u])*o+this[u],d={r:Ai(l("r")),g:Ai(l("g")),b:Ai(l("b")),a:Ai(l("a")*100)/100};return this._c(d)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const n=this._c(e),s=this.a+n.a*(1-this.a),o=l=>Ai((this[l]*this.a+n[l]*n.a*(1-this.a))/s);return this._c({r:o("r"),g:o("g"),b:o("b"),a:s})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const n=(this.r||0).toString(16);e+=n.length===2?n:"0"+n;const s=(this.g||0).toString(16);e+=s.length===2?s:"0"+s;const o=(this.b||0).toString(16);if(e+=o.length===2?o:"0"+o,typeof this.a=="number"&&this.a>=0&&this.a<1){const l=Ai(this.a*255).toString(16);e+=l.length===2?l:"0"+l}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),n=Ai(this.getSaturation()*100),s=Ai(this.getLightness()*100);return this.a!==1?`hsla(${e},${n}%,${s}%,${this.a})`:`hsl(${e},${n}%,${s}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,n,s){const o=this.clone();return o[e]=su(n,s),o}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const n=e.replace("#","");function s(o,l){return parseInt(n[o]+n[l||o],16)}n.length<6?(this.r=s(0),this.g=s(1),this.b=s(2),this.a=n[3]?s(3)/255:1):(this.r=s(0,1),this.g=s(2,3),this.b=s(4,5),this.a=n[6]?s(6,7)/255:1)}fromHsl({h:e,s:n,l:s,a:o}){if(this._h=e%360,this._s=n,this._l=s,this.a=typeof o=="number"?o:1,n<=0){const v=Ai(s*255);this.r=v,this.g=v,this.b=v}let l=0,d=0,u=0;const h=e/60,p=(1-Math.abs(2*s-1))*n,m=p*(1-Math.abs(h%2-1));h>=0&&h<1?(l=p,d=m):h>=1&&h<2?(l=m,d=p):h>=2&&h<3?(d=p,u=m):h>=3&&h<4?(d=m,u=p):h>=4&&h<5?(l=m,u=p):h>=5&&h<6&&(l=p,u=m);const g=s-p/2;this.r=Ai((l+g)*255),this.g=Ai((d+g)*255),this.b=Ai((u+g)*255)}fromHsv({h:e,s:n,v:s,a:o}){this._h=e%360,this._s=n,this._v=s,this.a=typeof o=="number"?o:1;const l=Ai(s*255);if(this.r=l,this.g=l,this.b=l,n<=0)return;const d=e/60,u=Math.floor(d),h=d-u,p=Ai(s*(1-n)*255),m=Ai(s*(1-n*h)*255),g=Ai(s*(1-n*(1-h))*255);switch(u){case 0:this.g=g,this.b=p;break;case 1:this.r=m,this.b=p;break;case 2:this.r=p,this.b=g;break;case 3:this.r=p,this.g=m;break;case 4:this.r=g,this.g=p;break;default:this.g=p,this.b=m;break}}fromHsvString(e){const n=Ux(e,ow);this.fromHsv({h:n[0],s:n[1],v:n[2],a:n[3]})}fromHslString(e){const n=Ux(e,ow);this.fromHsl({h:n[0],s:n[1],l:n[2],a:n[3]})}fromRgbString(e){const n=Ux(e,(s,o)=>o.includes("%")?Ai(s/100*255):s);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}}var Eh=2,lw=.16,jL=.05,EL=.05,AL=.15,Uj=5,Hj=4,RL=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function cw(t,e,n){var s;return Math.round(t.h)>=60&&Math.round(t.h)<=240?s=n?Math.round(t.h)-Eh*e:Math.round(t.h)+Eh*e:s=n?Math.round(t.h)+Eh*e:Math.round(t.h)-Eh*e,s<0?s+=360:s>=360&&(s-=360),s}function dw(t,e,n){if(t.h===0&&t.s===0)return t.s;var s;return n?s=t.s-lw*e:e===Hj?s=t.s+lw:s=t.s+jL*e,s>1&&(s=1),n&&e===Uj&&s>.1&&(s=.1),s<.06&&(s=.06),Math.round(s*100)/100}function uw(t,e,n){var s;return n?s=t.v+EL*e:s=t.v-AL*e,s=Math.max(0,Math.min(1,s)),Math.round(s*100)/100}function DL(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],s=new Oc(t),o=s.toHsv(),l=Uj;l>0;l-=1){var d=new Oc({h:cw(o,l,!0),s:dw(o,l,!0),v:uw(o,l,!0)});n.push(d)}n.push(s);for(var u=1;u<=Hj;u+=1){var h=new Oc({h:cw(o,u),s:dw(o,u),v:uw(o,u)});n.push(h)}return e.theme==="dark"?RL.map(function(p){var m=p.index,g=p.amount;return new Oc(e.backgroundColor||"#141414").mix(n[m],g).toHexString()}):n.map(function(p){return p.toHexString()})}var f0=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];f0.primary=f0[5];var IL=["isLoading","pastDelay","timedOut","error","retry"],OL=function(e){e.isLoading,e.pastDelay,e.timedOut,e.error,e.retry;var n=Wa(e,IL);return i.jsx("div",{style:{paddingBlockStart:100,textAlign:"center"},children:i.jsx(tn,Me({size:"large"},n))})},zv=P.createContext({});function PL(t){return t.replace(/-(.)/g,function(e,n){return n.toUpperCase()})}function h0(t,e){gT(t,"[@ant-design/icons] ".concat(e))}function fw(t){return Ml(t)==="object"&&typeof t.name=="string"&&typeof t.theme=="string"&&(Ml(t.icon)==="object"||typeof t.icon=="function")}function hw(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(t).reduce(function(e,n){var s=t[n];return n==="class"?(e.className=s,delete e.class):(delete e[n],e[PL(n)]=s),e},{})}function p0(t,e,n){return n?Pn.createElement(t.tag,Me(Me({key:e},hw(t.attrs)),n),(t.children||[]).map(function(s,o){return p0(s,"".concat(e,"-").concat(t.tag,"-").concat(o))})):Pn.createElement(t.tag,Me({key:e},hw(t.attrs)),(t.children||[]).map(function(s,o){return p0(s,"".concat(e,"-").concat(t.tag,"-").concat(o))}))}function Vj(t){return DL(t)[0]}function qj(t){return t?Array.isArray(t)?t:[t]:[]}var LL={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},NL=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Gj=function(e){var n=P.useContext(zv),s=n.csp,o=n.prefixCls,l=n.layer,d=NL;o&&(d=d.replace(/anticon/g,o)),l&&(d="@layer ".concat(l,` {
`).concat(d,`
}`)),P.useEffect(function(){var u=e.current,h=DR(u);IR(d,"@ant-design-icons",{prepend:!l,csp:s,attachTo:h})},[])},FL=["icon","className","onClick","style","primaryColor","secondaryColor"],Du={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function zL(t){var e=t.primaryColor,n=t.secondaryColor;Du.primaryColor=e,Du.secondaryColor=n||Vj(e),Du.calculated=!!n}function kL(){return Me({},Du)}var rd=function(e){var n=e.icon,s=e.className,o=e.onClick,l=e.style,d=e.primaryColor,u=e.secondaryColor,h=Wa(e,FL),p=P.useRef(),m=Du;if(d&&(m={primaryColor:d,secondaryColor:u||Vj(d)}),Gj(p),h0(fw(n),"icon should be icon definiton, but got ".concat(n)),!fw(n))return null;var g=n;return g&&typeof g.icon=="function"&&(g=Me(Me({},g),{},{icon:g.icon(m.primaryColor,m.secondaryColor)})),p0(g.icon,"svg-".concat(g.name),Me(Me({className:s,onClick:o,style:l,"data-icon":g.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},h),{},{ref:p}))};rd.displayName="IconReact";rd.getTwoToneColors=kL;rd.setTwoToneColors=zL;function $j(t){var e=qj(t),n=Qn(e,2),s=n[0],o=n[1];return rd.setTwoToneColors({primaryColor:s,secondaryColor:o})}function BL(){var t=rd.getTwoToneColors();return t.calculated?[t.primaryColor,t.secondaryColor]:t.primaryColor}var UL=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];$j(f0.primary);var nf=P.forwardRef(function(t,e){var n=t.className,s=t.icon,o=t.spin,l=t.rotate,d=t.tabIndex,u=t.onClick,h=t.twoToneColor,p=Wa(t,UL),m=P.useContext(zv),g=m.prefixCls,v=g===void 0?"anticon":g,C=m.rootClassName,b=mn(C,v,he(he({},"".concat(v,"-").concat(s.name),!!s.name),"".concat(v,"-spin"),!!o||s.name==="loading"),n),_=d;_===void 0&&u&&(_=-1);var y=l?{msTransform:"rotate(".concat(l,"deg)"),transform:"rotate(".concat(l,"deg)")}:void 0,S=qj(h),D=Qn(S,2),L=D[0],N=D[1];return P.createElement("span",Gc({role:"img","aria-label":s.name},p,{ref:e,tabIndex:_,onClick:u,className:b}),P.createElement(rd,{icon:s,primaryColor:L,secondaryColor:N,style:y}))});nf.displayName="AntdIcon";nf.getTwoToneColor=BL;nf.setTwoToneColor=$j;var HL=function(e,n){return P.createElement(nf,Gc({},e,{ref:n,icon:OR}))},VL=P.forwardRef(HL),qL=function(e,n){return P.createElement(nf,Gc({},e,{ref:n,icon:PR}))},GL=P.forwardRef(qL),$L=["className","component","viewBox","spin","rotate","tabIndex","onClick","children"],Wj=P.forwardRef(function(t,e){var n=t.className,s=t.component,o=t.viewBox,l=t.spin,d=t.rotate,u=t.tabIndex,h=t.onClick,p=t.children,m=Wa(t,$L),g=P.useRef(),v=LR(g,e);h0(!!(s||p),"Should have `component` prop or `children`."),Gj(g);var C=P.useContext(zv),b=C.prefixCls,_=b===void 0?"anticon":b,y=C.rootClassName,S=mn(y,_,he({},"".concat(_,"-spin"),!!l&&!!s),n),D=mn(he({},"".concat(_,"-spin"),!!l)),L=d?{msTransform:"rotate(".concat(d,"deg)"),transform:"rotate(".concat(d,"deg)")}:void 0,N=Me(Me({},LL),{},{className:D,style:L,viewBox:o});o||delete N.viewBox;var T=function(){return s?P.createElement(s,N,p):p?(h0(!!o||P.Children.count(p)===1&&P.isValidElement(p)&&P.Children.only(p).type==="use","Make sure that you provide correct `viewBox` prop (default `0 0 1024 1024`) to the icon."),P.createElement("svg",Gc({},N,{viewBox:o}),p)):null},j=u;return j===void 0&&h&&(j=-1),P.createElement("span",Gc({role:"img"},m,{ref:v,tabIndex:j,onClick:h,className:S}),T())});Wj.displayName="AntdIcon";var WL=["type","children"],Yj=new Set;function YL(t){return!!(typeof t=="string"&&t.length&&!Yj.has(t))}function qp(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t[e];if(YL(n)){var s=document.createElement("script");s.setAttribute("src",n),s.setAttribute("data-namespace",n),t.length>e+1&&(s.onload=function(){qp(t,e+1)},s.onerror=function(){qp(t,e+1)}),Yj.add(n),document.body.appendChild(s)}}function Kj(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.scriptUrl,n=t.extraCommonProps,s=n===void 0?{}:n;e&&typeof document<"u"&&typeof window<"u"&&typeof document.createElement=="function"&&(Array.isArray(e)?qp(e.reverse()):qp([e]));var o=P.forwardRef(function(l,d){var u=l.type,h=l.children,p=Wa(l,WL),m=null;return l.type&&(m=P.createElement("use",{xlinkHref:"#".concat(u)})),h&&(m=h),P.createElement(Wj,Gc({},s,p,{ref:d}),m)});return o.displayName="Iconfont",o}var KL=function(e){return he({},e.componentCls,{marginBlock:0,marginBlockStart:48,marginBlockEnd:24,marginInline:0,paddingBlock:0,paddingInline:16,textAlign:"center","&-list":{marginBlockEnd:8,color:e.colorTextSecondary,"&-link":{color:e.colorTextSecondary,textDecoration:e.linkDecoration},"*:not(:last-child)":{marginInlineEnd:8},"&:hover":{color:e.colorPrimary}},"&-copyright":{fontSize:"14px",color:e.colorText}})};function XL(t){return fs("ProLayoutFooter",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[KL(n)]})}var QL=function(e){var n=e.className,s=e.prefixCls,o=e.links,l=e.copyright,d=e.style,u=P.useContext(Qi.ConfigContext),h=u.getPrefixCls(s||"pro-global-footer"),p=XL(h),m=p.wrapSSR,g=p.hashId;return(o==null||o===!1||Array.isArray(o)&&o.length===0)&&(l==null||l===!1)?null:m(i.jsxs("div",{className:mn(h,g,n),style:d,children:[o&&i.jsx("div",{className:"".concat(h,"-list ").concat(g).trim(),children:o.map(function(v){return i.jsx("a",{className:"".concat(h,"-list-link ").concat(g).trim(),title:v.key,target:v.blankTarget?"_blank":"_self",href:v.href,rel:"noreferrer",children:v.title},v.key)})}),l&&i.jsx("div",{className:"".concat(h,"-copyright ").concat(g).trim(),children:l})]}))},ZL=wl.Footer,JL=function(e){var n=e.links,s=e.copyright,o=e.style,l=e.className,d=e.prefixCls;return i.jsx(ZL,{className:l,style:Me({padding:0},o),children:i.jsx(QL,{links:n,prefixCls:d,copyright:s===!1?null:i.jsxs(P.Fragment,{children:[i.jsx(VL,{})," ",s]})})})},pw=function t(e){return(e||[]).reduce(function(n,s){if(s.key&&n.push(s.key),s.children||s.routes){var o=n.concat(t(s.children||s.routes)||[]);return o}return n},[])};function am(t){return t.map(function(e){var n=e.children||[],s=Me({},e);if(!s.children&&s.routes&&(s.children=s.routes),!s.name||s.hideInMenu)return null;if(s&&s!==null&&s!==void 0&&s.children){if(!s.hideChildrenInMenu&&n.some(function(o){return o&&o.name&&!o.hideInMenu}))return Me(Me({},e),{},{children:am(n)});delete s.children}return delete s.routes,s}).filter(function(e){return e})}var eN=function(){return i.jsx("svg",{width:"1em",height:"1em",viewBox:"0 0 12 12",fill:"currentColor","aria-hidden":"true",children:i.jsx("path",{d:"M0 0h3v3H0V0zm4.5 0h3v3h-3V0zM9 0h3v3H9V0zM0 4.5h3v3H0v-3zm4.503 0h3v3h-3v-3zM9 4.5h3v3H9v-3zM0 9h3v3H0V9zm4.503 0h3v3h-3V9zM9 9h3v3H9V9z"})})},tN=function t(e){var n=e.appList,s=e.baseClassName,o=e.hashId,l=e.itemClick;return i.jsx("div",{className:"".concat(s,"-content ").concat(o).trim(),children:i.jsx("ul",{className:"".concat(s,"-content-list ").concat(o).trim(),children:n?.map(function(d,u){var h;return d!=null&&(h=d.children)!==null&&h!==void 0&&h.length?i.jsxs("div",{className:"".concat(s,"-content-list-item-group ").concat(o).trim(),children:[i.jsx("div",{className:"".concat(s,"-content-list-item-group-title ").concat(o).trim(),children:d.title}),i.jsx(t,{hashId:o,itemClick:l,appList:d?.children,baseClassName:s})]},u):i.jsx("li",{className:"".concat(s,"-content-list-item ").concat(o).trim(),onClick:function(m){m.stopPropagation(),l?.(d)},children:i.jsxs("a",{href:l?void 0:d.url,target:d.target,rel:"noreferrer",children:[kv(d.icon),i.jsxs("div",{children:[i.jsx("div",{children:d.title}),d.desc?i.jsx("span",{children:d.desc}):null]})]})},u)})})})},nN=function(e,n){if(e&&typeof e=="string"&&Fv(e))return i.jsx("img",{src:e,alt:"logo"});if(typeof e=="function")return e();if(e&&typeof e=="string")return i.jsx("div",{id:"avatarLogo",children:e});if(!e&&n&&typeof n=="string"){var s=n.substring(0,1);return i.jsx("div",{id:"avatarLogo",children:s})}return e},iN=function t(e){var n=e.appList,s=e.baseClassName,o=e.hashId,l=e.itemClick;return i.jsx("div",{className:"".concat(s,"-content ").concat(o).trim(),children:i.jsx("ul",{className:"".concat(s,"-content-list ").concat(o).trim(),children:n?.map(function(d,u){var h;return d!=null&&(h=d.children)!==null&&h!==void 0&&h.length?i.jsxs("div",{className:"".concat(s,"-content-list-item-group ").concat(o).trim(),children:[i.jsx("div",{className:"".concat(s,"-content-list-item-group-title ").concat(o).trim(),children:d.title}),i.jsx(t,{hashId:o,itemClick:l,appList:d?.children,baseClassName:s})]},u):i.jsx("li",{className:"".concat(s,"-content-list-item ").concat(o).trim(),onClick:function(m){m.stopPropagation(),l?.(d)},children:i.jsxs("a",{href:l?"javascript:;":d.url,target:d.target,rel:"noreferrer",children:[nN(d.icon,d.title),i.jsx("div",{children:i.jsx("div",{children:d.title})})]})},u)})})})},aN=function(e){return{"&-content":{maxHeight:"calc(100vh - 48px)",overflow:"auto","&-list":{boxSizing:"content-box",maxWidth:656,marginBlock:0,marginInline:0,paddingBlock:0,paddingInline:0,listStyle:"none","&-item":{position:"relative",display:"inline-block",width:328,height:72,paddingInline:16,paddingBlock:16,verticalAlign:"top",listStyleType:"none",transition:"transform 0.2s cubic-bezier(0.333, 0, 0, 1)",borderRadius:e.borderRadius,"&-group":{marginBottom:16,"&-title":{margin:"16px 0 8px 12px",fontWeight:600,color:"rgba(0, 0, 0, 0.88)",fontSize:16,opacity:.85,lineHeight:1.5,"&:first-child":{marginTop:12}}},"&:hover":{backgroundColor:e.colorBgTextHover},"* div":Bx?.(e),a:{display:"flex",height:"100%",fontSize:12,textDecoration:"none","& > img":{width:40,height:40},"& > div":{marginInlineStart:14,color:e.colorTextHeading,fontSize:14,lineHeight:"22px",whiteSpace:"nowrap",textOverflow:"ellipsis"},"& > div > span":{color:e.colorTextSecondary,fontSize:12,lineHeight:"20px"}}}}}}},sN=function(e){return{"&-content":{maxHeight:"calc(100vh - 48px)",overflow:"auto","&-list":{boxSizing:"border-box",maxWidth:376,marginBlock:0,marginInline:0,paddingBlock:0,paddingInline:0,listStyle:"none","&-item":{position:"relative",display:"inline-block",width:104,height:104,marginBlock:8,marginInline:8,paddingInline:24,paddingBlock:24,verticalAlign:"top",listStyleType:"none",transition:"transform 0.2s cubic-bezier(0.333, 0, 0, 1)",borderRadius:e.borderRadius,"&-group":{marginBottom:16,"&-title":{margin:"16px 0 8px 12px",fontWeight:600,color:"rgba(0, 0, 0, 0.88)",fontSize:16,opacity:.85,lineHeight:1.5,"&:first-child":{marginTop:12}}},"&:hover":{backgroundColor:e.colorBgTextHover},a:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",fontSize:12,textDecoration:"none","& > #avatarLogo":{width:40,height:40,margin:"0 auto",color:e.colorPrimary,fontSize:22,lineHeight:"40px",textAlign:"center",backgroundImage:"linear-gradient(180deg, #E8F0FB 0%, #F6F8FC 100%)",borderRadius:e.borderRadius},"& > img":{width:40,height:40},"& > div":{marginBlockStart:5,marginInlineStart:0,color:e.colorTextHeading,fontSize:14,lineHeight:"22px",whiteSpace:"nowrap",textOverflow:"ellipsis"},"& > div > span":{color:e.colorTextSecondary,fontSize:12,lineHeight:"20px"}}}}}}},rN=function(e){var n,s,o,l,d;return he({},e.componentCls,{"&-icon":{display:"inline-flex",alignItems:"center",justifyContent:"center",paddingInline:4,paddingBlock:0,fontSize:14,lineHeight:"14px",height:28,width:28,cursor:"pointer",color:(n=e.layout)===null||n===void 0?void 0:n.colorTextAppListIcon,borderRadius:e.borderRadius,"&:hover":{color:(s=e.layout)===null||s===void 0?void 0:s.colorTextAppListIconHover,backgroundColor:(o=e.layout)===null||o===void 0?void 0:o.colorBgAppListIconHover},"&-active":{color:(l=e.layout)===null||l===void 0?void 0:l.colorTextAppListIconHover,backgroundColor:(d=e.layout)===null||d===void 0?void 0:d.colorBgAppListIconHover}},"&-item-title":{marginInlineStart:"16px",marginInlineEnd:"8px",marginBlockStart:0,marginBlockEnd:"12px",fontWeight:600,color:"rgba(0, 0, 0, 0.88)",fontSize:16,opacity:.85,lineHeight:1.5,"&:first-child":{marginBlockStart:12}},"&-popover":he({},"".concat(e.antCls,"-popover-arrow"),{display:"none"}),"&-simple":sN(e),"&-default":aN(e)})};function oN(t){return fs("AppsLogoComponents",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[rN(n)]})}var kv=function(e){return typeof e=="string"?i.jsx("img",{width:"auto",height:22,src:e,alt:"logo"}):typeof e=="function"?e():e},Bv=function(e){var n,s=e.appList,o=e.appListRender,l=e.prefixCls,d=l===void 0?"ant-pro":l,u=e.onItemClick,h=Pn.useRef(null),p=Pn.useRef(null),m="".concat(d,"-layout-apps"),g=oN(m),v=g.wrapSSR,C=g.hashId,b=P.useState(!1),_=Qn(b,2),y=_[0],S=_[1],D=function(E){u?.(E,p)},L=P.useMemo(function(){var j=s?.some(function(E){return!(E!=null&&E.desc)});return j?i.jsx(iN,{hashId:C,appList:s,itemClick:u?D:void 0,baseClassName:"".concat(m,"-simple")}):i.jsx(tN,{hashId:C,appList:s,itemClick:u?D:void 0,baseClassName:"".concat(m,"-default")})},[s,m,C]);if(!(e!=null&&(n=e.appList)!==null&&n!==void 0&&n.length))return null;var N=o?o(e?.appList,L):L,T=kj(void 0,function(j){return S(j)});return v(i.jsxs(i.Fragment,{children:[i.jsx("div",{ref:h,onClick:function(E){E.stopPropagation(),E.preventDefault()}}),i.jsx(NR,Me(Me({placement:"bottomRight",trigger:["click"],zIndex:9999,arrow:!1},T),{},{overlayClassName:"".concat(m,"-popover ").concat(C).trim(),content:N,getPopupContainer:function(){return h.current||document.body},children:i.jsx("span",{ref:p,onClick:function(E){E.stopPropagation()},className:mn("".concat(m,"-icon"),C,he({},"".concat(m,"-icon-active"),y)),children:i.jsx(eN,{})})}))]}))};function lN(){return i.jsx("svg",{width:"1em",height:"1em",viewBox:"0 0 12 12",fill:"currentColor","aria-hidden":"true",children:i.jsx("path",{d:"M6.432 7.967a.448.448 0 01-.318.133h-.228a.46.46 0 01-.318-.133L2.488 4.85a.305.305 0 010-.43l.427-.43a.293.293 0 01.42 0L6 6.687l2.665-2.699a.299.299 0 01.426 0l.42.431a.305.305 0 010 .43L6.432 7.967z"})})}var cN=function(e){var n,s,o;return he({},e.componentCls,{position:"absolute",insetBlockStart:"18px",zIndex:"101",width:"24px",height:"24px",fontSize:["14px","16px"],textAlign:"center",borderRadius:"40px",insetInlineEnd:"-13px",transition:"transform 0.3s",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:(n=e.layout)===null||n===void 0||(n=n.sider)===null||n===void 0?void 0:n.colorTextCollapsedButton,backgroundColor:(s=e.layout)===null||s===void 0||(s=s.sider)===null||s===void 0?void 0:s.colorBgCollapsedButton,boxShadow:"0 2px 8px -2px rgba(0,0,0,0.05), 0 1px 4px -1px rgba(25,15,15,0.07), 0 0 1px 0 rgba(0,0,0,0.08)","&:hover":{color:(o=e.layout)===null||o===void 0||(o=o.sider)===null||o===void 0?void 0:o.colorTextCollapsedButtonHover,boxShadow:"0 4px 16px -4px rgba(0,0,0,0.05), 0 2px 8px -2px rgba(25,15,15,0.07), 0 1px 2px 0 rgba(0,0,0,0.08)"},".anticon":{fontSize:"14px"},"& > svg":{transition:"transform  0.3s",transform:"rotate(90deg)"},"&-collapsed":{"& > svg":{transform:"rotate(-90deg)"}}})};function dN(t){return fs("SiderMenuCollapsedIcon",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[cN(n)]})}var uN=["isMobile","collapsed"],fN=function(e){var n=e.isMobile,s=e.collapsed,o=Wa(e,uN),l=dN(e.className),d=l.wrapSSR,u=l.hashId;return n&&s?null:d(i.jsx("div",Me(Me({},o),{},{className:mn(e.className,u,he(he({},"".concat(e.className,"-collapsed"),s),"".concat(e.className,"-is-mobile"),n)),children:i.jsx(lN,{})})))},Xj={navTheme:"light",layout:"side",contentWidth:"Fluid",fixedHeader:!1,fixSiderbar:!0,iconfontUrl:"",colorPrimary:"#1677FF",splitMenus:!1},hN=function(e,n){var s,o,l=n.includes("horizontal")?(s=e.layout)===null||s===void 0?void 0:s.header:(o=e.layout)===null||o===void 0?void 0:o.sider;return Me(Me(he({},"".concat(e.componentCls),he(he(he(he(he(he(he(he(he({background:"transparent",color:l?.colorTextMenu,border:"none"},"".concat(e.componentCls,"-menu-item"),{transition:"none !important"}),"".concat(e.componentCls,"-submenu-has-icon"),he({},"> ".concat(e.antCls,"-menu-sub"),{paddingInlineStart:10})),"".concat(e.antCls,"-menu-title-content"),{width:"100%",height:"100%",display:"inline-flex"}),"".concat(e.antCls,"-menu-title-content"),{"&:first-child":{width:"100%"}}),"".concat(e.componentCls,"-item-icon"),{display:"flex",alignItems:"center"}),"&&-collapsed",he(he(he({},"".concat(e.antCls,`-menu-item, 
        `).concat(e.antCls,"-menu-item-group > ").concat(e.antCls,"-menu-item-group-list > ").concat(e.antCls,`-menu-item, 
        `).concat(e.antCls,"-menu-item-group > ").concat(e.antCls,"-menu-item-group-list > ").concat(e.antCls,"-menu-submenu > ").concat(e.antCls,`-menu-submenu-title, 
        `).concat(e.antCls,"-menu-submenu > ").concat(e.antCls,"-menu-submenu-title"),{paddingInline:"0 !important",marginBlock:"4px !important"}),"".concat(e.antCls,"-menu-item-group > ").concat(e.antCls,"-menu-item-group-list > ").concat(e.antCls,"-menu-submenu-selected > ").concat(e.antCls,`-menu-submenu-title, 
        `).concat(e.antCls,"-menu-submenu-selected > ").concat(e.antCls,"-menu-submenu-title"),{backgroundColor:l?.colorBgMenuItemSelected,borderRadius:e.borderRadiusLG}),"".concat(e.componentCls,"-group"),he({},"".concat(e.antCls,"-menu-item-group-title"),{paddingInline:0}))),"&-item-title",he(he(he(he(he({display:"flex",flexDirection:"row",alignItems:"center",gap:e.marginXS},"".concat(e.componentCls,"-item-text"),{maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden",wordBreak:"break-all",whiteSpace:"nowrap"}),"&-collapsed",he(he({minWidth:40,height:40},"".concat(e.componentCls,"-item-icon"),{height:"16px",width:"16px",lineHeight:"16px !important",".anticon":{lineHeight:"16px !important",height:"16px"}}),"".concat(e.componentCls,"-item-text-has-icon"),{display:"none !important"})),"&-collapsed-level-0",{flexDirection:"column",justifyContent:"center"}),"&".concat(e.componentCls,"-group-item-title"),{gap:e.marginXS,height:18,overflow:"hidden"}),"&".concat(e.componentCls,"-item-collapsed-show-title"),he({lineHeight:"16px",gap:0},"&".concat(e.componentCls,"-item-title-collapsed"),he(he({display:"flex"},"".concat(e.componentCls,"-item-icon"),{height:"16px",width:"16px",lineHeight:"16px !important",".anticon":{lineHeight:"16px!important",height:"16px"}}),"".concat(e.componentCls,"-item-text"),{opacity:"1 !important",display:"inline !important",textAlign:"center",fontSize:12,height:12,lineHeight:"12px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",margin:0,padding:0,marginBlockStart:4})))),"&-group",he({},"".concat(e.antCls,"-menu-item-group-title"),{fontSize:12,color:e.colorTextLabel,".anticon":{marginInlineEnd:8}})),"&-group-divider",{color:e.colorTextSecondary,fontSize:12,lineHeight:20})),n.includes("horizontal")?{}:he({},"".concat(e.antCls,"-menu-submenu").concat(e.antCls,"-menu-submenu-popup"),he({},"".concat(e.componentCls,"-item-title"),{alignItems:"flex-start"}))),{},he({},"".concat(e.antCls,"-menu-submenu-popup"),{backgroundColor:"rgba(255, 255, 255, 0.42)","-webkit-backdrop-filter":"blur(8px)",backdropFilter:"blur(8px)"}))};function pN(t,e){return fs("ProLayoutBaseMenu"+e,function(n){var s=Me(Me({},n),{},{componentCls:".".concat(t)});return[hN(s,e||"inline")]})}var mw=function(e){var n=P.useState(e.collapsed),s=Qn(n,2),o=s[0],l=s[1],d=P.useState(!1),u=Qn(d,2),h=u[0],p=u[1];return P.useEffect(function(){p(!1),setTimeout(function(){l(e.collapsed)},400)},[e.collapsed]),e.disable?e.children:i.jsx(rn,{title:e.title,open:o&&e.collapsed?h:!1,placement:"right",onOpenChange:p,children:e.children})},Qj=Kj({scriptUrl:Xj.iconfontUrl}),gw=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"icon-",s=arguments.length>2?arguments[2]:void 0;if(typeof e=="string"&&e!==""){if(Fv(e)||wL(e))return i.jsx("img",{width:16,src:e,alt:"icon",className:s},e);if(e.startsWith(n))return i.jsx(Qj,{type:e})}return e},xw=function(e){if(e&&typeof e=="string"){var n=e.substring(0,1).toUpperCase();return n}return null},mN=mT(function t(e){var n=this;pT(this,t),he(this,"props",void 0),he(this,"getNavMenuItems",function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0;return s.map(function(d){return n.getSubMenuOrItem(d,o,l)}).filter(function(d){return d}).flat(1)}),he(this,"getSubMenuOrItem",function(s,o,l){var d=n.props,u=d.subMenuItemRender,h=d.baseClassName,p=d.prefixCls,m=d.collapsed,g=d.menu,v=d.iconPrefixes,C=d.layout,b=g?.type==="group"&&C!=="top",_=n.props.token,y=n.getIntlName(s),S=s?.children||s?.routes,D=b&&o===0?"group":void 0;if(Array.isArray(S)&&S.length>0){var L,N,T,j,E,R=o===0||b&&o===1,M=gw(s.icon,v,"".concat(h,"-icon ").concat((L=n.props)===null||L===void 0?void 0:L.hashId)),I=m&&R?xw(y):null,z=i.jsxs("div",{className:mn("".concat(h,"-item-title"),(N=n.props)===null||N===void 0?void 0:N.hashId,he(he(he(he({},"".concat(h,"-item-title-collapsed"),m),"".concat(h,"-item-title-collapsed-level-").concat(l),m),"".concat(h,"-group-item-title"),D==="group"),"".concat(h,"-item-collapsed-show-title"),g?.collapsedShowTitle&&m)),children:[D==="group"&&m?null:R&&M?i.jsx("span",{className:"".concat(h,"-item-icon ").concat((T=n.props)===null||T===void 0?void 0:T.hashId).trim(),children:M}):I,i.jsx("span",{className:mn("".concat(h,"-item-text"),(j=n.props)===null||j===void 0?void 0:j.hashId,he({},"".concat(h,"-item-text-has-icon"),D!=="group"&&R&&(M||I))),children:y})]}),V=u?u(Me(Me({},s),{},{isUrl:!1}),z,n.props):z;if(b&&o===0&&n.props.collapsed&&!g.collapsedShowGroupTitle)return n.getNavMenuItems(S,o+1,o);var O=n.getNavMenuItems(S,o+1,b&&o===0&&n.props.collapsed?o:o+1);return[{type:D,key:s.key||s.path,label:V,onClick:b?void 0:s.onTitleClick,children:O,className:mn(he(he(he({},"".concat(h,"-group"),D==="group"),"".concat(h,"-submenu"),D!=="group"),"".concat(h,"-submenu-has-icon"),D!=="group"&&R&&M))},b&&o===0?{type:"divider",prefixCls:p,className:"".concat(h,"-divider"),key:(s.key||s.path)+"-group-divider",style:{padding:0,borderBlockEnd:0,margin:n.props.collapsed?"4px":"6px 16px",marginBlockStart:n.props.collapsed?4:8,borderColor:_==null||(E=_.layout)===null||E===void 0||(E=E.sider)===null||E===void 0?void 0:E.colorMenuItemDivider}}:void 0].filter(Boolean)}return{className:"".concat(h,"-menu-item"),disabled:s.disabled,key:s.key||s.path,onClick:s.onTitleClick,label:n.getMenuItemPath(s,o,l)}}),he(this,"getIntlName",function(s){var o=s.name,l=s.locale,d=n.props,u=d.menu,h=d.formatMessage,p=o;return l&&u?.locale!==!1&&(p=h?.({id:l,defaultMessage:o})),n.props.menuTextRender?n.props.menuTextRender(s,p,n.props):p}),he(this,"getMenuItemPath",function(s,o,l){var d,u,h,p,m=n.conversionPath(s.path||"/"),g=n.props,v=g.location,C=v===void 0?{pathname:"/"}:v,b=g.isMobile,_=g.onCollapse,y=g.menuItemRender,S=g.iconPrefixes,D=n.getIntlName(s),L=n.props,N=L.baseClassName,T=L.menu,j=L.collapsed,E=T?.type==="group",R=o===0||E&&o===1,M=R?gw(s.icon,S,"".concat(N,"-icon ").concat((d=n.props)===null||d===void 0?void 0:d.hashId)):null,I=j&&R?xw(D):null,z=i.jsxs("div",{className:mn("".concat(N,"-item-title"),(u=n.props)===null||u===void 0?void 0:u.hashId,he(he(he({},"".concat(N,"-item-title-collapsed"),j),"".concat(N,"-item-title-collapsed-level-").concat(l),j),"".concat(N,"-item-collapsed-show-title"),T?.collapsedShowTitle&&j)),children:[i.jsx("span",{className:"".concat(N,"-item-icon ").concat((h=n.props)===null||h===void 0?void 0:h.hashId).trim(),style:{display:I===null&&!M?"none":""},children:M||i.jsx("span",{className:"anticon",children:I})}),i.jsx("span",{className:mn("".concat(N,"-item-text"),(p=n.props)===null||p===void 0?void 0:p.hashId,he({},"".concat(N,"-item-text-has-icon"),R&&(M||I))),children:D})]},m),V=Fv(m);if(V){var O,k,F;z=i.jsxs("span",{onClick:function(){var B,W;(B=window)===null||B===void 0||(W=B.open)===null||W===void 0||W.call(B,m,"_blank")},className:mn("".concat(N,"-item-title"),(O=n.props)===null||O===void 0?void 0:O.hashId,he(he(he(he({},"".concat(N,"-item-title-collapsed"),j),"".concat(N,"-item-title-collapsed-level-").concat(l),j),"".concat(N,"-item-link"),!0),"".concat(N,"-item-collapsed-show-title"),T?.collapsedShowTitle&&j)),children:[i.jsx("span",{className:"".concat(N,"-item-icon ").concat((k=n.props)===null||k===void 0?void 0:k.hashId).trim(),style:{display:I===null&&!M?"none":""},children:M||i.jsx("span",{className:"anticon",children:I})}),i.jsx("span",{className:mn("".concat(N,"-item-text"),(F=n.props)===null||F===void 0?void 0:F.hashId,he({},"".concat(N,"-item-text-has-icon"),R&&(M||I))),children:D})]},m)}if(y){var A=Me(Me({},s),{},{isUrl:V,itemPath:m,isMobile:b,replace:m===C.pathname,onClick:function(){return _&&_(!0)},children:void 0});return o===0?i.jsx(mw,{collapsed:j,title:D,disable:s.disabledTooltip,children:y(A,z,n.props)}):y(A,z,n.props)}return o===0?i.jsx(mw,{collapsed:j,title:D,disable:s.disabledTooltip,children:z}):z}),he(this,"conversionPath",function(s){return s&&s.indexOf("http")===0?s:"/".concat(s||"").replace(/\/+/g,"/")}),this.props=e}),gN=function(e,n){var s=n.layout,o=n.collapsed,l={};return e&&!o&&["side","mix"].includes(s||"mix")&&(l={openKeys:e}),l},Zj=function(e){var n=e.mode,s=e.className,o=e.handleOpenChange,l=e.style,d=e.menuData,u=e.prefixCls,h=e.menu,p=e.matchMenuKeys,m=e.iconfontUrl,g=e.selectedKeys,v=e.onSelect,C=e.menuRenderType,b=e.openKeys,_=P.useContext(Is),y=_.dark,S=_.token,D="".concat(u,"-base-menu-").concat(n),L=P.useRef([]),N=Au(h?.defaultOpenAll),T=Qn(N,2),j=T[0],E=T[1],R=Au(function(){return h!=null&&h.defaultOpenAll?pw(d)||[]:b===!1?!1:[]},{value:b===!1?void 0:b,onChange:o}),M=Qn(R,2),I=M[0],z=M[1],V=Au([],{value:g,onChange:v?function(de){v&&de&&v(de)}:void 0}),O=Qn(V,2),k=O[0],F=O[1];P.useEffect(function(){h!=null&&h.defaultOpenAll||b===!1||p&&(z(p),F(p))},[p.join("-")]),P.useEffect(function(){m&&(Qj=Kj({scriptUrl:m}))},[m]),P.useEffect(function(){if(p.join("-")!==(k||[]).join("-")&&F(p),!j&&b!==!1&&p.join("-")!==(I||[]).join("-")){var de=p;h?.autoClose===!1&&(de=Array.from(new Set([].concat(Vc(p),Vc(I||[]))))),z(de)}else h!=null&&h.ignoreFlatMenu&&j?z(pw(d)):E(!1)},[p.join("-")]);var A=P.useMemo(function(){return gN(I,e)},[I&&I.join(","),e.layout,e.collapsed]),q=pN(D,n),B=q.wrapSSR,W=q.hashId,Q=P.useMemo(function(){return new mN(Me(Me({},e),{},{token:S,menuRenderType:C,baseClassName:D,hashId:W}))},[e,S,C,D,W]);if(h!=null&&h.loading)return i.jsx("div",{style:n!=null&&n.includes("inline")?{padding:24}:{marginBlockStart:16},children:i.jsx(FR,{active:!0,title:!1,paragraph:{rows:n!=null&&n.includes("inline")?6:1}})});e.openKeys===!1&&!e.handleOpenChange&&(L.current=p);var ne=e.postMenuData?e.postMenuData(d):d;return ne&&ne?.length<1?null:B(P.createElement(gv,Me(Me({},A),{},{_internalDisableMenuItemTitleTooltip:!0,key:"Menu",mode:n,inlineIndent:16,defaultOpenKeys:L.current,theme:y?"dark":"light",selectedKeys:k,style:Me({backgroundColor:"transparent",border:"none"},l),className:mn(s,W,D,he(he({},"".concat(D,"-horizontal"),n==="horizontal"),"".concat(D,"-collapsed"),e.collapsed)),items:Q.getNavMenuItems(ne,0,0),onOpenChange:function($){e.collapsed||z($)}},e.menuProps)))};function xN(t,e){var n=e.stylish,s=e.proLayoutCollapsedWidth;return fs("ProLayoutSiderMenuStylish",function(o){var l=Me(Me({},o),{},{componentCls:".".concat(t),proLayoutCollapsedWidth:s});return n?[he({},"div".concat(o.proComponentsCls,"-layout"),he({},"".concat(l.componentCls),n?.(l)))]:[]})}var yN=["title","render"],vN=Pn.memo(function(t){return i.jsx(i.Fragment,{children:t.children})}),_N=wl.Sider,yw=wl._InternalSiderContext,bN=yw===void 0?{Provider:vN}:yw,Uv=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"menuHeaderRender",s=e.logo,o=e.title,l=e.layout,d=e[n];if(d===!1)return null;var u=kv(s),h=i.jsx("h1",{children:o??"Ant Design Pro"});return d?d(u,e.collapsed?null:h,e):e.isMobile?null:l==="mix"&&n==="menuHeaderRender"?!1:e.collapsed?i.jsx("a",{children:u},"title"):i.jsxs("a",{children:[u,h]},"title")},vw=function(e){var n,s=e.collapsed,o=e.originCollapsed,l=e.fixSiderbar,d=e.menuFooterRender,u=e.onCollapse,h=e.theme,p=e.siderWidth,m=e.isMobile,g=e.onMenuHeaderClick,v=e.breakpoint,C=v===void 0?"lg":v,b=e.style,_=e.layout,y=e.menuExtraRender,S=y===void 0?!1:y,D=e.links,L=e.menuContentRender,N=e.collapsedButtonRender,T=e.prefixCls,j=e.avatarProps,E=e.rightContentRender,R=e.actionsRender,M=e.onOpenChange,I=e.stylish,z=e.logoStyle,V=P.useContext(Is),O=V.hashId,k=P.useMemo(function(){return!(m||_==="mix")},[m,_]),F="".concat(T,"-sider"),A=64,q=xN("".concat(F,".").concat(F,"-stylish"),{stylish:I,proLayoutCollapsedWidth:A}),B=mn("".concat(F),O,he(he(he(he(he(he(he({},"".concat(F,"-fixed"),l),"".concat(F,"-fixed-mix"),_==="mix"&&!m&&l),"".concat(F,"-collapsed"),e.collapsed),"".concat(F,"-layout-").concat(_),_&&!m),"".concat(F,"-light"),h!=="dark"),"".concat(F,"-mix"),_==="mix"&&!m),"".concat(F,"-stylish"),!!I)),W=Uv(e),Q=S&&S(e),ne=P.useMemo(function(){return L!==!1&&P.createElement(Zj,Me(Me({},e),{},{key:"base-menu",mode:s&&!m?"vertical":"inline",handleOpenChange:M,style:{width:"100%"},className:"".concat(F,"-menu ").concat(O).trim()}))},[F,O,L,M,e]),de=(D||[]).map(function(_t,Se){return{className:"".concat(F,"-link"),label:_t,key:Se}}),$=P.useMemo(function(){return L?L(e,ne):ne},[L,ne,e]),X=P.useMemo(function(){if(!j)return null;var _t=j.title,Se=j.render,$e=Wa(j,yN),jt=i.jsxs("div",{className:"".concat(F,"-actions-avatar"),children:[$e!=null&&$e.src||$e!=null&&$e.srcSet||$e.icon||$e.children?i.jsx(Pi,Me({size:28},$e)):null,j.title&&!s&&i.jsx("span",{children:_t})]});return Se?Se(j,jt,e):jt},[j,F,s]),le=P.useMemo(function(){return R?i.jsx(Be,{align:"center",size:4,direction:s?"vertical":"horizontal",className:mn(["".concat(F,"-actions-list"),s&&"".concat(F,"-actions-list-collapsed"),O]),children:[R?.(e)].flat(1).map(function(_t,Se){return i.jsx("div",{className:"".concat(F,"-actions-list-item ").concat(O).trim(),children:_t},Se)})}):null},[R,F,s]),oe=P.useMemo(function(){return i.jsx(Bv,{onItemClick:e.itemClick,appListRender:e.appListRender,appList:e.appList,prefixCls:e.prefixCls})},[e.appList,e.appListRender,e.prefixCls]),ue=P.useMemo(function(){if(N===!1)return null;var _t=i.jsx(fN,{isMobile:m,collapsed:o,className:"".concat(F,"-collapsed-button"),onClick:function(){u?.(!o)}});return N?N(s,_t):_t},[N,m,o,F,s,u]),Ye=P.useMemo(function(){return!X&&!le?null:i.jsxs("div",{className:mn("".concat(F,"-actions"),O,s&&"".concat(F,"-actions-collapsed")),children:[X,le]})},[le,X,F,s,O]),ae=P.useMemo(function(){var _t;return e!=null&&(_t=e.menu)!==null&&_t!==void 0&&_t.hideMenuWhenCollapsed&&s?"".concat(F,"-hide-menu-collapsed"):null},[F,s,e==null||(n=e.menu)===null||n===void 0?void 0:n.hideMenuWhenCollapsed]),fe=d&&d?.(e),pt=i.jsxs(i.Fragment,{children:[W&&i.jsxs("div",{className:mn([mn("".concat(F,"-logo"),O,he({},"".concat(F,"-logo-collapsed"),s))]),onClick:k?g:void 0,id:"logo",style:z,children:[W,oe]}),Q&&i.jsx("div",{className:mn(["".concat(F,"-extra"),!W&&"".concat(F,"-extra-no-logo"),O]),children:Q}),i.jsx("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden"},children:$}),i.jsxs(bN.Provider,{value:{},children:[D?i.jsx("div",{className:"".concat(F,"-links ").concat(O).trim(),children:i.jsx(gv,{inlineIndent:16,className:"".concat(F,"-link-menu ").concat(O).trim(),selectedKeys:[],openKeys:[],theme:h,mode:"inline",items:de})}):null,k&&i.jsxs(i.Fragment,{children:[Ye,!le&&E?i.jsx("div",{className:mn("".concat(F,"-actions"),O,he({},"".concat(F,"-actions-collapsed"),s)),children:E?.(e)}):null]}),fe&&i.jsx("div",{className:mn(["".concat(F,"-footer"),O,he({},"".concat(F,"-footer-collapsed"),s)]),children:fe})]})]});return q.wrapSSR(i.jsxs(i.Fragment,{children:[l&&!m&&!ae&&i.jsx("div",{style:Me({width:s?A:p,overflow:"hidden",flex:"0 0 ".concat(s?A:p,"px"),maxWidth:s?A:p,minWidth:s?A:p,transition:"all 0.2s ease 0s"},b)}),i.jsxs(_N,{collapsible:!0,trigger:null,collapsed:s,breakpoint:C===!1?void 0:C,onCollapse:function(Se){m||u?.(Se)},collapsedWidth:A,style:b,theme:h,width:p,className:mn(B,O,ae),children:[ae?i.jsx("div",{className:"".concat(F,"-hide-when-collapsed ").concat(O).trim(),style:{height:"100%",width:"100%",opacity:ae?0:1},children:pt}):pt,ue]})]}))},SN=function(e){var n,s,o,l,d;return he({},e.componentCls,{"&-header-actions":{display:"flex",height:"100%",alignItems:"center","&-item":{display:"inline-flex",alignItems:"center",justifyContent:"center",paddingBlock:0,paddingInline:2,color:(n=e.layout)===null||n===void 0||(n=n.header)===null||n===void 0?void 0:n.colorTextRightActionsItem,fontSize:"16px",cursor:"pointer",borderRadius:e.borderRadius,"> *":{paddingInline:6,paddingBlock:6,borderRadius:e.borderRadius,"&:hover":{backgroundColor:(s=e.layout)===null||s===void 0||(s=s.header)===null||s===void 0?void 0:s.colorBgRightActionsItemHover}}},"&-avatar":{display:"inline-flex",alignItems:"center",justifyContent:"center",paddingInlineStart:e.padding,paddingInlineEnd:e.padding,cursor:"pointer",color:(o=e.layout)===null||o===void 0||(o=o.header)===null||o===void 0?void 0:o.colorTextRightActionsItem,"> div":{height:"44px",color:(l=e.layout)===null||l===void 0||(l=l.header)===null||l===void 0?void 0:l.colorTextRightActionsItem,paddingInline:8,paddingBlock:8,cursor:"pointer",display:"flex",alignItems:"center",lineHeight:"44px",borderRadius:e.borderRadius,"&:hover":{backgroundColor:(d=e.layout)===null||d===void 0||(d=d.header)===null||d===void 0?void 0:d.colorBgRightActionsItemHover}}}}})};function MN(t){return fs("ProLayoutRightContent",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[SN(n)]})}var wN=["rightContentRender","avatarProps","actionsRender","headerContentRender"],CN=["title","render"],Jj=function(e){var n=e.rightContentRender,s=e.avatarProps,o=e.actionsRender;e.headerContentRender;var l=Wa(e,wN),d=P.useContext(Qi.ConfigContext),u=d.getPrefixCls,h="".concat(u(),"-pro-global-header"),p=MN(h),m=p.wrapSSR,g=p.hashId,v=P.useState("auto"),C=Qn(v,2),b=C[0],_=C[1],y=P.useMemo(function(){if(!s)return null;var N=s.title,T=s.render,j=Wa(s,CN),E=[j!=null&&j.src||j!=null&&j.srcSet||j.icon||j.children?P.createElement(Pi,Me(Me({},j),{},{size:28,key:"avatar"})):null,N?i.jsx("span",{style:{marginInlineStart:8},children:N},"name"):void 0];return T?T(s,i.jsx("div",{children:E}),l):i.jsx("div",{children:E})},[s]),S=o||y?function(N){var T=o&&o?.(N);return!T&&!y?null:Array.isArray(T)?m(i.jsxs("div",{className:"".concat(h,"-header-actions ").concat(g).trim(),children:[T.filter(Boolean).map(function(j,E){var R=!1;if(Pn.isValidElement(j)){var M;R=!!(j!=null&&(M=j.props)!==null&&M!==void 0&&M["aria-hidden"])}return i.jsx("div",{className:mn("".concat(h,"-header-actions-item ").concat(g),he({},"".concat(h,"-header-actions-hover"),!R)),children:j},E)}),y&&i.jsx("span",{className:"".concat(h,"-header-actions-avatar ").concat(g).trim(),children:y})]})):m(i.jsxs("div",{className:"".concat(h,"-header-actions ").concat(g).trim(),children:[T,y&&i.jsx("span",{className:"".concat(h,"-header-actions-avatar ").concat(g).trim(),children:y})]}))}:void 0,D=bL((function(){var N=Op(Oo().mark(function T(j){return Oo().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:_(j);case 1:case"end":return R.stop()}},T)}));return function(T){return N.apply(this,arguments)}})(),160),L=S||n;return i.jsx("div",{className:"".concat(h,"-right-content ").concat(g).trim(),style:{minWidth:b,height:"100%"},children:i.jsx("div",{style:{height:"100%"},children:i.jsx(zR,{onResize:function(T){var j=T.width;D.run(j)},children:L?i.jsx("div",{style:{display:"flex",alignItems:"center",height:"100%",justifyContent:"flex-end"},children:L(Me(Me({},l),{},{rightContentSize:b}))}):null})})})},TN=function(e){var n,s;return he({},e.componentCls,{position:"relative",width:"100%",height:"100%",backgroundColor:"transparent",".anticon":{color:"inherit"},"&-main":{display:"flex",height:"100%",paddingInlineStart:"16px","&-left":he({display:"flex",alignItems:"center"},"".concat(e.proComponentsCls,"-layout-apps-icon"),{marginInlineEnd:16,marginInlineStart:-8})},"&-wide":{maxWidth:1152,margin:"0 auto"},"&-logo":{position:"relative",display:"flex",height:"100%",alignItems:"center",overflow:"hidden","> *:first-child":{display:"flex",alignItems:"center",minHeight:"22px",fontSize:"22px"},"> *:first-child > img":{display:"inline-block",height:"32px",verticalAlign:"middle"},"> *:first-child > h1":{display:"inline-block",marginBlock:0,marginInline:0,lineHeight:"24px",marginInlineStart:6,fontWeight:"600",fontSize:"16px",color:(n=e.layout)===null||n===void 0||(n=n.header)===null||n===void 0?void 0:n.colorHeaderTitle,verticalAlign:"top"}},"&-menu":{minWidth:0,display:"flex",alignItems:"center",paddingInline:6,paddingBlock:6,lineHeight:"".concat(Math.max((((s=e.layout)===null||s===void 0||(s=s.header)===null||s===void 0?void 0:s.heightLayoutHeader)||56)-12,40),"px")}})};function jN(t){return fs("ProLayoutTopNavHeader",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[TN(n)]})}var eE=function(e){var n,s,o,l,d,u,h,p=P.useRef(null),m=e.onMenuHeaderClick,g=e.contentWidth,v=e.rightContentRender,C=e.className,b=e.style,_=e.headerContentRender,y=e.layout,S=e.actionsRender,D=P.useContext(Qi.ConfigContext),L=D.getPrefixCls,N=P.useContext(Is),T=N.dark,j="".concat(e.prefixCls||L("pro"),"-top-nav-header"),E=jN(j),R=E.wrapSSR,M=E.hashId,I=void 0;e.menuHeaderRender!==void 0?I="menuHeaderRender":(y==="mix"||y==="top")&&(I="headerTitleRender");var z=Uv(Me(Me({},e),{},{collapsed:!1}),I),V=P.useContext(Is),O=V.token,k=P.useMemo(function(){var F,A,q,B,W,Q,ne,de,$,X,le,oe,ue,Ye=i.jsx(Qi,{theme:{hashed:kc(),components:{Layout:{headerBg:"transparent",bodyBg:"transparent"},Menu:Me({},Bj({colorItemBg:((F=O.layout)===null||F===void 0||(F=F.header)===null||F===void 0?void 0:F.colorBgHeader)||"transparent",colorSubItemBg:((A=O.layout)===null||A===void 0||(A=A.header)===null||A===void 0?void 0:A.colorBgHeader)||"transparent",radiusItem:O.borderRadius,colorItemBgSelected:((q=O.layout)===null||q===void 0||(q=q.header)===null||q===void 0?void 0:q.colorBgMenuItemSelected)||O?.colorBgTextHover,itemHoverBg:((B=O.layout)===null||B===void 0||(B=B.header)===null||B===void 0?void 0:B.colorBgMenuItemHover)||O?.colorBgTextHover,colorItemBgSelectedHorizontal:((W=O.layout)===null||W===void 0||(W=W.header)===null||W===void 0?void 0:W.colorBgMenuItemSelected)||O?.colorBgTextHover,colorActiveBarWidth:0,colorActiveBarHeight:0,colorActiveBarBorderSize:0,colorItemText:((Q=O.layout)===null||Q===void 0||(Q=Q.header)===null||Q===void 0?void 0:Q.colorTextMenu)||O?.colorTextSecondary,colorItemTextHoverHorizontal:((ne=O.layout)===null||ne===void 0||(ne=ne.header)===null||ne===void 0?void 0:ne.colorTextMenuActive)||O?.colorText,colorItemTextSelectedHorizontal:((de=O.layout)===null||de===void 0||(de=de.header)===null||de===void 0?void 0:de.colorTextMenuSelected)||O?.colorTextBase,horizontalItemBorderRadius:4,colorItemTextHover:(($=O.layout)===null||$===void 0||($=$.header)===null||$===void 0?void 0:$.colorTextMenuActive)||"rgba(0, 0, 0, 0.85)",horizontalItemHoverBg:((X=O.layout)===null||X===void 0||(X=X.header)===null||X===void 0?void 0:X.colorBgMenuItemHover)||"rgba(0, 0, 0, 0.04)",colorItemTextSelected:((le=O.layout)===null||le===void 0||(le=le.header)===null||le===void 0?void 0:le.colorTextMenuSelected)||"rgba(0, 0, 0, 1)",popupBg:O?.colorBgElevated,subMenuItemBg:O?.colorBgElevated,darkSubMenuItemBg:"transparent",darkPopupBg:O?.colorBgElevated}))},token:{colorBgElevated:((oe=O.layout)===null||oe===void 0||(oe=oe.header)===null||oe===void 0?void 0:oe.colorBgHeader)||"transparent"}},children:i.jsx(Zj,Me(Me(Me({theme:T?"dark":"light"},e),{},{className:"".concat(j,"-base-menu ").concat(M).trim()},e.menuProps),{},{style:Me({width:"100%"},(ue=e.menuProps)===null||ue===void 0?void 0:ue.style),collapsed:!1,menuRenderType:"header",mode:"horizontal"}))});return _?_(e,Ye):Ye},[(n=O.layout)===null||n===void 0||(n=n.header)===null||n===void 0?void 0:n.colorBgHeader,(s=O.layout)===null||s===void 0||(s=s.header)===null||s===void 0?void 0:s.colorBgMenuItemSelected,(o=O.layout)===null||o===void 0||(o=o.header)===null||o===void 0?void 0:o.colorBgMenuItemHover,(l=O.layout)===null||l===void 0||(l=l.header)===null||l===void 0?void 0:l.colorTextMenu,(d=O.layout)===null||d===void 0||(d=d.header)===null||d===void 0?void 0:d.colorTextMenuActive,(u=O.layout)===null||u===void 0||(u=u.header)===null||u===void 0?void 0:u.colorTextMenuSelected,(h=O.layout)===null||h===void 0||(h=h.header)===null||h===void 0?void 0:h.colorBgMenuElevated,O.borderRadius,O?.colorBgTextHover,O?.colorTextSecondary,O?.colorText,O?.colorTextBase,O.colorBgElevated,T,e,j,M,_]);return R(i.jsx("div",{className:mn(j,M,C,he({},"".concat(j,"-light"),!0)),style:b,children:i.jsxs("div",{ref:p,className:mn("".concat(j,"-main"),M,he({},"".concat(j,"-wide"),g==="Fixed"&&y==="top")),children:[z&&i.jsxs("div",{className:mn("".concat(j,"-main-left ").concat(M)),onClick:m,children:[i.jsx(Bv,Me({},e)),i.jsx("div",{className:"".concat(j,"-logo ").concat(M).trim(),id:"logo",children:z},"logo")]}),i.jsx("div",{style:{flex:1},className:"".concat(j,"-menu ").concat(M).trim(),children:k}),(v||S||e.avatarProps)&&i.jsx(Jj,Me(Me({rightContentRender:v},e),{},{prefixCls:j}))]})}))},EN=function(e){var n,s,o;return he({},e.componentCls,he(he(he(he({position:"relative",background:"transparent",display:"flex",alignItems:"center",marginBlock:0,marginInline:16,height:((n=e.layout)===null||n===void 0||(n=n.header)===null||n===void 0?void 0:n.heightLayoutHeader)||56,boxSizing:"border-box","> a":{height:"100%"}},"".concat(e.proComponentsCls,"-layout-apps-icon"),{marginInlineEnd:16}),"&-collapsed-button",{minHeight:"22px",color:(s=e.layout)===null||s===void 0||(s=s.header)===null||s===void 0?void 0:s.colorHeaderTitle,fontSize:"18px",marginInlineEnd:"16px"}),"&-logo",{position:"relative",marginInlineEnd:"16px",a:{display:"flex",alignItems:"center",height:"100%",minHeight:"22px",fontSize:"20px"},img:{height:"28px"},h1:{height:"32px",marginBlock:0,marginInline:0,marginInlineStart:8,fontWeight:"600",color:((o=e.layout)===null||o===void 0||(o=o.header)===null||o===void 0?void 0:o.colorHeaderTitle)||e.colorTextHeading,fontSize:"18px",lineHeight:"32px"},"&-mix":{display:"flex",alignItems:"center"}}),"&-logo-mobile",{minWidth:"24px",marginInlineEnd:0}))};function AN(t){return fs("ProLayoutGlobalHeader",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[EN(n)]})}var RN=function(e,n){return e===!1?null:e?e(n,null):n},DN=function(e){var n=e.isMobile,s=e.logo,o=e.collapsed,l=e.onCollapse,d=e.rightContentRender,u=e.menuHeaderRender,h=e.onMenuHeaderClick,p=e.className,m=e.style,g=e.layout,v=e.children,C=e.splitMenus,b=e.menuData,_=e.prefixCls,y=P.useContext(Qi.ConfigContext),S=y.getPrefixCls,D=y.direction,L="".concat(_||S("pro"),"-global-header"),N=AN(L),T=N.wrapSSR,j=N.hashId,E=mn(p,L,j);if(g==="mix"&&!n&&C){var R=(b||[]).map(function(V){return Me(Me({},V),{},{children:void 0,routes:void 0})}),M=am(R);return i.jsx(eE,Me(Me({mode:"horizontal"},e),{},{splitMenus:!1,menuData:M}))}var I=mn("".concat(L,"-logo"),j,he(he(he({},"".concat(L,"-logo-rtl"),D==="rtl"),"".concat(L,"-logo-mix"),g==="mix"),"".concat(L,"-logo-mobile"),n)),z=i.jsx("span",{className:I,children:i.jsx("a",{children:kv(s)})},"logo");return T(i.jsxs("div",{className:E,style:Me({},m),children:[n&&i.jsx("span",{className:"".concat(L,"-collapsed-button ").concat(j).trim(),onClick:function(){l?.(!o)},children:i.jsx(GL,{})}),n&&RN(u,z),g==="mix"&&!n&&i.jsxs(i.Fragment,{children:[i.jsx(Bv,Me({},e)),i.jsx("div",{className:I,onClick:h,children:Uv(Me(Me({},e),{},{collapsed:!1}),"headerTitleRender")})]}),i.jsx("div",{style:{flex:1},children:v}),(d||e.actionsRender||e.avatarProps)&&i.jsx(Jj,Me({rightContentRender:d},e))]}))},IN=function(e){var n,s,o,l;return he({},"".concat(e.proComponentsCls,"-layout"),he({},"".concat(e.antCls,"-layout-header").concat(e.componentCls),{height:((n=e.layout)===null||n===void 0||(n=n.header)===null||n===void 0?void 0:n.heightLayoutHeader)||56,lineHeight:"".concat(((s=e.layout)===null||s===void 0||(s=s.header)===null||s===void 0?void 0:s.heightLayoutHeader)||56,"px"),zIndex:19,width:"100%",paddingBlock:0,paddingInline:0,borderBlockEnd:"1px solid ".concat(e.colorSplit),backgroundColor:((o=e.layout)===null||o===void 0||(o=o.header)===null||o===void 0?void 0:o.colorBgHeader)||"rgba(255, 255, 255, 0.4)",WebkitBackdropFilter:"blur(8px)",backdropFilter:"blur(8px)",transition:"background-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1)","&-fixed-header":{position:"fixed",insetBlockStart:0,width:"100%",zIndex:100,insetInlineEnd:0},"&-fixed-header-scroll":{backgroundColor:((l=e.layout)===null||l===void 0||(l=l.header)===null||l===void 0?void 0:l.colorBgScrollHeader)||"rgba(255, 255, 255, 0.8)"},"&-header-actions":{display:"flex",alignItems:"center",fontSize:"16",cursor:"pointer","& &-item":{paddingBlock:0,paddingInline:8,"&:hover":{color:e.colorText}}},"&-header-realDark":{boxShadow:"0 2px 8px 0 rgba(0, 0, 0, 65%)"},"&-header-actions-header-action":{transition:"width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1)"}}))};function ON(t){return fs("ProLayoutHeader",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[IN(n)]})}function PN(t,e){var n=e.stylish,s=e.proLayoutCollapsedWidth;return fs("ProLayoutHeaderStylish",function(o){var l=Me(Me({},o),{},{componentCls:".".concat(t),proLayoutCollapsedWidth:s});return n?[he({},"div".concat(o.proComponentsCls,"-layout"),he({},"".concat(l.componentCls),n?.(l)))]:[]})}var _w=wl.Header,LN=function(e){var n,s,o,l=e.isMobile,d=e.fixedHeader,u=e.className,h=e.style,p=e.collapsed,m=e.prefixCls,g=e.onCollapse,v=e.layout,C=e.headerRender,b=e.headerContentRender,_=P.useContext(Is),y=_.token,S=P.useContext(Qi.ConfigContext),D=P.useState(!1),L=Qn(D,2),N=L[0],T=L[1],j=d||v==="mix",E=P.useCallback(function(){var F=v==="top",A=am(e.menuData||[]),q=i.jsx(DN,Me(Me({onCollapse:g},e),{},{menuData:A,children:b&&b(e,null)}));return F&&!l&&(q=i.jsx(eE,Me(Me({mode:"horizontal",onCollapse:g},e),{},{menuData:A}))),C&&typeof C=="function"?C(e,q):q},[b,C,l,v,g,e]);P.useEffect(function(){var F,A=(S==null||(F=S.getTargetContainer)===null||F===void 0?void 0:F.call(S))||document.body,q=function(){var W,Q=A.scrollTop;return Q>(((W=y.layout)===null||W===void 0||(W=W.header)===null||W===void 0?void 0:W.heightLayoutHeader)||56)&&!N?(T(!0),!0):(N&&T(!1),!1)};if(j&&!(typeof window>"u"))return A.addEventListener("scroll",q,{passive:!0}),function(){A.removeEventListener("scroll",q)}},[(n=y.layout)===null||n===void 0||(n=n.header)===null||n===void 0?void 0:n.heightLayoutHeader,j,N]);var R=v==="top",M="".concat(m,"-layout-header"),I=ON(M),z=I.wrapSSR,V=I.hashId,O=PN("".concat(M,".").concat(M,"-stylish"),{proLayoutCollapsedWidth:64,stylish:e.stylish}),k=mn(u,V,M,he(he(he(he(he(he(he({},"".concat(M,"-fixed-header"),j),"".concat(M,"-fixed-header-scroll"),N),"".concat(M,"-mix"),v==="mix"),"".concat(M,"-fixed-header-action"),!p),"".concat(M,"-top-menu"),R),"".concat(M,"-header"),!0),"".concat(M,"-stylish"),!!e.stylish));return v==="side"&&!l?null:O.wrapSSR(z(i.jsx(i.Fragment,{children:i.jsxs(Qi,{theme:{hashed:kc(),components:{Layout:{headerBg:"transparent",bodyBg:"transparent"}}},children:[j&&i.jsx(_w,{style:Me({height:((s=y.layout)===null||s===void 0||(s=s.header)===null||s===void 0?void 0:s.heightLayoutHeader)||56,lineHeight:"".concat(((o=y.layout)===null||o===void 0||(o=o.header)===null||o===void 0?void 0:o.heightLayoutHeader)||56,"px"),backgroundColor:"transparent",zIndex:19},h)}),i.jsx(_w,{className:k,style:h,children:E()})]})})))};const NN={"app.setting.pagestyle":"Page style setting","app.setting.pagestyle.dark":"Dark Menu style","app.setting.pagestyle.light":"Light Menu style","app.setting.pagestyle.realdark":"Dark style (Beta)","app.setting.content-width":"Content Width","app.setting.content-width.fixed":"Fixed","app.setting.content-width.fluid":"Fluid","app.setting.themecolor":"Theme Color","app.setting.themecolor.dust":"Dust Red","app.setting.themecolor.volcano":"Volcano","app.setting.themecolor.sunset":"Sunset Orange","app.setting.themecolor.cyan":"Cyan","app.setting.themecolor.green":"Polar Green","app.setting.themecolor.techBlue":"Tech Blue (default)","app.setting.themecolor.daybreak":"Daybreak Blue","app.setting.themecolor.geekblue":"Geek Blue","app.setting.themecolor.purple":"Golden Purple","app.setting.sidermenutype":"SideMenu Type","app.setting.sidermenutype-sub":"Classic","app.setting.sidermenutype-group":"Grouping","app.setting.navigationmode":"Navigation Mode","app.setting.regionalsettings":"Regional Settings","app.setting.regionalsettings.header":"Header","app.setting.regionalsettings.menu":"Menu","app.setting.regionalsettings.footer":"Footer","app.setting.regionalsettings.menuHeader":"Menu Header","app.setting.sidemenu":"Side Menu Layout","app.setting.topmenu":"Top Menu Layout","app.setting.mixmenu":"Mix Menu Layout","app.setting.splitMenus":"Split Menus","app.setting.fixedheader":"Fixed Header","app.setting.fixedsidebar":"Fixed Sidebar","app.setting.fixedsidebar.hint":"Works on Side Menu Layout","app.setting.hideheader":"Hidden Header when scrolling","app.setting.hideheader.hint":"Works when Hidden Header is enabled","app.setting.othersettings":"Other Settings","app.setting.weakmode":"Weak Mode","app.setting.copy":"Copy Setting","app.setting.loading":"Loading theme","app.setting.copyinfo":"copy successplease replace defaultSettings in src/models/setting.js","app.setting.production.hint":"Setting panel shows in development environment only, please manually modify"},FN=Me({},NN),zN={"app.setting.pagestyle":"Impostazioni di stile","app.setting.pagestyle.dark":"Tema scuro","app.setting.pagestyle.light":"Tema chiaro","app.setting.content-width":"Largezza contenuto","app.setting.content-width.fixed":"Fissa","app.setting.content-width.fluid":"Fluida","app.setting.themecolor":"Colore del tema","app.setting.themecolor.dust":"Rosso polvere","app.setting.themecolor.volcano":"Vulcano","app.setting.themecolor.sunset":"Arancione tramonto","app.setting.themecolor.cyan":"Ciano","app.setting.themecolor.green":"Verde polare","app.setting.themecolor.techBlue":"Tech Blu (default)","app.setting.themecolor.daybreak":"Blu cielo mattutino","app.setting.themecolor.geekblue":"Blu geek","app.setting.themecolor.purple":"Viola dorato","app.setting.navigationmode":"Modalit di navigazione","app.setting.sidemenu":"Menu laterale","app.setting.topmenu":"Menu in testata","app.setting.mixmenu":"Menu misto","app.setting.splitMenus":"Menu divisi","app.setting.fixedheader":"Testata fissa","app.setting.fixedsidebar":"Menu laterale fisso","app.setting.fixedsidebar.hint":"Solo se selezionato Menu laterale","app.setting.hideheader":"Nascondi testata durante lo scorrimento","app.setting.hideheader.hint":"Solo se abilitato Nascondi testata durante lo scorrimento","app.setting.othersettings":"Altre impostazioni","app.setting.weakmode":"Inverti colori","app.setting.copy":"Copia impostazioni","app.setting.loading":"Carico tema...","app.setting.copyinfo":"Impostazioni copiate con successo! Incolla il contenuto in config/defaultSettings.js","app.setting.production.hint":"Questo pannello  visibile solo durante lo sviluppo. Le impostazioni devono poi essere modificate manulamente"},kN=Me({},zN),BN={"app.setting.pagestyle":" ","app.setting.pagestyle.dark":" ","app.setting.pagestyle.light":" ","app.setting.content-width":" ","app.setting.content-width.fixed":"","app.setting.content-width.fluid":"","app.setting.themecolor":" ","app.setting.themecolor.dust":"Dust Red","app.setting.themecolor.volcano":"Volcano","app.setting.themecolor.sunset":"Sunset Orange","app.setting.themecolor.cyan":"Cyan","app.setting.themecolor.green":"Polar Green","app.setting.themecolor.techBlue":"Tech Blu (default)","app.setting.themecolor.daybreak":"Daybreak Blue","app.setting.themecolor.geekblue":"Geek Blue","app.setting.themecolor.purple":"Golden Purple","app.setting.navigationmode":" ","app.setting.regionalsettings":" ","app.setting.regionalsettings.header":"","app.setting.regionalsettings.menu":"","app.setting.regionalsettings.footer":"","app.setting.regionalsettings.menuHeader":" ","app.setting.sidemenu":"  ","app.setting.topmenu":"  ","app.setting.mixmenu":" ","app.setting.splitMenus":" ","app.setting.fixedheader":" ","app.setting.fixedsidebar":" ","app.setting.fixedsidebar.hint":"'  '   ","app.setting.hideheader":"   ","app.setting.hideheader.hint":"'  '   ","app.setting.othersettings":" ","app.setting.weakmode":" ","app.setting.copy":" ","app.setting.loading":"  ","app.setting.copyinfo":" . src/models/settings.js  defaultSettings  .","app.setting.production.hint":"    .   ."},UN=Me({},BN),HN={"app.setting.pagestyle":"","app.setting.pagestyle.dark":"","app.setting.pagestyle.light":"","app.setting.pagestyle.realdark":"()","app.setting.content-width":"","app.setting.content-width.fixed":"","app.setting.content-width.fluid":"","app.setting.themecolor":"","app.setting.themecolor.dust":"","app.setting.themecolor.volcano":"","app.setting.themecolor.sunset":"","app.setting.themecolor.cyan":"","app.setting.themecolor.green":"","app.setting.themecolor.techBlue":"","app.setting.themecolor.daybreak":"","app.setting.themecolor.geekblue":"","app.setting.themecolor.purple":"","app.setting.navigationmode":"","app.setting.sidermenutype":"","app.setting.sidermenutype-sub":"","app.setting.sidermenutype-group":"","app.setting.regionalsettings":"","app.setting.regionalsettings.header":"","app.setting.regionalsettings.menu":"","app.setting.regionalsettings.footer":"","app.setting.regionalsettings.menuHeader":"","app.setting.sidemenu":"","app.setting.topmenu":"","app.setting.mixmenu":"","app.setting.splitMenus":"","app.setting.fixedheader":" Header","app.setting.fixedsidebar":"","app.setting.fixedsidebar.hint":"","app.setting.hideheader":" Header","app.setting.hideheader.hint":" Header ","app.setting.othersettings":"","app.setting.weakmode":"","app.setting.copy":"","app.setting.loading":"","app.setting.copyinfo":" src/defaultSettings.js ","app.setting.production.hint":""},VN=Me({},HN),qN={"app.setting.pagestyle":"","app.setting.pagestyle.dark":"","app.setting.pagestyle.realdark":"()","app.setting.pagestyle.light":"","app.setting.content-width":"","app.setting.content-width.fixed":"","app.setting.content-width.fluid":"","app.setting.themecolor":"","app.setting.themecolor.dust":"","app.setting.themecolor.volcano":"","app.setting.themecolor.sunset":"","app.setting.themecolor.cyan":"","app.setting.themecolor.green":"","app.setting.themecolor.techBlue":"","app.setting.themecolor.daybreak":"","app.setting.themecolor.geekblue":"","app.setting.themecolor.purple":"","app.setting.navigationmode":"","app.setting.sidemenu":"","app.setting.topmenu":"","app.setting.mixmenu":"","app.setting.splitMenus":"","app.setting.fixedheader":" Header","app.setting.fixedsidebar":"","app.setting.fixedsidebar.hint":"","app.setting.hideheader":" Header","app.setting.hideheader.hint":" Header ","app.setting.othersettings":"","app.setting.weakmode":"","app.setting.copy":"","app.setting.loading":"","app.setting.copyinfo":" src/defaultSettings.js ","app.setting.production.hint":""},GN=Me({},qN);var bw={"zh-CN":VN,"zh-TW":GN,"en-US":FN,"it-IT":kN,"ko-KR":UN},$N=function(){if(!Nv())return"zh-CN";var e=window.localStorage.getItem("umi_locale");return e||window.g_locale||navigator.language},WN=function(){var e=$N();return bw[e]||bw["zh-CN"]},Vs={},Sw;function YN(){if(Sw)return Vs;Sw=1,Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.TokenData=void 0,Vs.parse=g,Vs.compile=v,Vs.match=_,Vs.pathToRegexp=y,Vs.stringify=N;const t="/",e=E=>E,n=/^[$_\p{ID_Start}]$/u,s=/^[$\u200c\u200d\p{ID_Continue}]$/u,o="https://git.new/pathToRegexpError",l={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function d(E){return E.replace(/[{}()\[\]+?!:*]/g,"\\$&")}function u(E){return E.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}function*h(E){const R=[...E];let M=0;function I(){let z="";if(n.test(R[++M]))for(z+=R[M];s.test(R[++M]);)z+=R[M];else if(R[M]==='"'){let V=M;for(;M<R.length;){if(R[++M]==='"'){M++,V=0;break}R[M]==="\\"?z+=R[++M]:z+=R[M]}if(V)throw new TypeError(`Unterminated quote at ${V}: ${o}`)}if(!z)throw new TypeError(`Missing parameter name at ${M}: ${o}`);return z}for(;M<R.length;){const z=R[M],V=l[z];if(V)yield{type:V,index:M++,value:z};else if(z==="\\")yield{type:"ESCAPED",index:M++,value:R[M++]};else if(z===":"){const O=I();yield{type:"PARAM",index:M,value:O}}else if(z==="*"){const O=I();yield{type:"WILDCARD",index:M,value:O}}else yield{type:"CHAR",index:M,value:R[M++]}}return{type:"END",index:M,value:""}}class p{constructor(R){this.tokens=R}peek(){if(!this._peek){const R=this.tokens.next();this._peek=R.value}return this._peek}tryConsume(R){const M=this.peek();if(M.type===R)return this._peek=void 0,M.value}consume(R){const M=this.tryConsume(R);if(M!==void 0)return M;const{type:I,index:z}=this.peek();throw new TypeError(`Unexpected ${I} at ${z}, expected ${R}: ${o}`)}text(){let R="",M;for(;M=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)R+=M;return R}}class m{constructor(R){this.tokens=R}}Vs.TokenData=m;function g(E,R={}){const{encodePath:M=e}=R,I=new p(h(E));function z(O){const k=[];for(;;){const F=I.text();F&&k.push({type:"text",value:M(F)});const A=I.tryConsume("PARAM");if(A){k.push({type:"param",name:A});continue}const q=I.tryConsume("WILDCARD");if(q){k.push({type:"wildcard",name:q});continue}if(I.tryConsume("{")){k.push({type:"group",tokens:z("}")});continue}return I.consume(O),k}}const V=z("END");return new m(V)}function v(E,R={}){const{encode:M=encodeURIComponent,delimiter:I=t}=R,z=E instanceof m?E:g(E,R),V=C(z.tokens,I,M);return function(k={}){const[F,...A]=V(k);if(A.length)throw new TypeError(`Missing parameters: ${A.join(", ")}`);return F}}function C(E,R,M){const I=E.map(z=>b(z,R,M));return z=>{const V=[""];for(const O of I){const[k,...F]=O(z);V[0]+=k,V.push(...F)}return V}}function b(E,R,M){if(E.type==="text")return()=>[E.value];if(E.type==="group"){const z=C(E.tokens,R,M);return V=>{const[O,...k]=z(V);return k.length?[""]:[O]}}const I=M||e;return E.type==="wildcard"&&M!==!1?z=>{const V=z[E.name];if(V==null)return["",E.name];if(!Array.isArray(V)||V.length===0)throw new TypeError(`Expected "${E.name}" to be a non-empty array`);return[V.map((O,k)=>{if(typeof O!="string")throw new TypeError(`Expected "${E.name}/${k}" to be a string`);return I(O)}).join(R)]}:z=>{const V=z[E.name];if(V==null)return["",E.name];if(typeof V!="string")throw new TypeError(`Expected "${E.name}" to be a string`);return[I(V)]}}function _(E,R={}){const{decode:M=decodeURIComponent,delimiter:I=t}=R,{regexp:z,keys:V}=y(E,R),O=V.map(k=>M===!1?e:k.type==="param"?M:F=>F.split(I).map(M));return function(F){const A=z.exec(F);if(!A)return!1;const q=A[0],B=Object.create(null);for(let W=1;W<A.length;W++){if(A[W]===void 0)continue;const Q=V[W-1],ne=O[W-1];B[Q.name]=ne(A[W])}return{path:q,params:B}}}function y(E,R={}){const{delimiter:M=t,end:I=!0,sensitive:z=!1,trailing:V=!0}=R,O=[],k=[],F=z?"":"i",q=(Array.isArray(E)?E:[E]).map(Q=>Q instanceof m?Q:g(Q,R));for(const{tokens:Q}of q)for(const ne of S(Q,0,[])){const de=D(ne,M,O);k.push(de)}let B=`^(?:${k.join("|")})`;return V&&(B+=`(?:${u(M)}$)?`),B+=I?"$":`(?=${u(M)}|$)`,{regexp:new RegExp(B,F),keys:O}}function*S(E,R,M){if(R===E.length)return yield M;const I=E[R];if(I.type==="group"){const z=M.slice();for(const V of S(I.tokens,0,z))yield*S(E,R+1,V)}else M.push(I);yield*S(E,R+1,M)}function D(E,R,M){let I="",z="",V=!0;for(let O=0;O<E.length;O++){const k=E[O];if(k.type==="text"){I+=u(k.value),z+=k.value,V||(V=k.value.includes(R));continue}if(k.type==="param"||k.type==="wildcard"){if(!V&&!z)throw new TypeError(`Missing text after "${k.name}": ${o}`);k.type==="param"?I+=`(${L(R,V?"":z)}+)`:I+="([\\s\\S]+)",M.push(k),z="",V=!1;continue}}return I}function L(E,R){return R.length<2?E.length<2?`[^${u(E+R)}]`:`(?:(?!${u(E)})[^${u(R)}])`:E.length<2?`(?:(?!${u(R)})[^${u(E)}])`:`(?:(?!${u(R)}|${u(E)})[\\s\\S])`}function N(E){return E.tokens.map(function R(M,I,z){if(M.type==="text")return d(M.value);if(M.type==="group")return`{${M.tokens.map(R).join("")}}`;const O=T(M.name)&&j(z[I+1])?M.name:JSON.stringify(M.name);if(M.type==="param")return`:${O}`;if(M.type==="wildcard")return`*${O}`;throw new TypeError(`Unexpected token: ${M}`)}).join("")}function T(E){const[R,...M]=E;return n.test(R)?M.every(I=>s.test(I)):!1}function j(E){return E?.type!=="text"?!0:!s.test(E.value[0])}return Vs}var m0=YN(),KN=function(e,n,s){if(s){var o=Vc(s.keys()).find(function(d){try{return d.startsWith("http")?!1:m0.match(d)(e)}catch(u){return console.log("key",d,u),!1}});if(o)return s.get(o)}if(n){var l=Object.keys(n).find(function(d){try{return d!=null&&d.startsWith("http")?!1:m0.match(d)(e)}catch(u){return console.log("key",d,u),!1}});if(l)return n[l]}return{path:""}},Mw=function(e,n){var s=e.pathname,o=s===void 0?"/":s,l=e.breadcrumb,d=e.breadcrumbMap,u=e.formatMessage,h=e.title,p=e.menu,m=p===void 0?{locale:!1}:p,g=n?"":h||"",v=KN(o,l,d);if(!v)return{title:g,id:"",pageName:g};var C=v.name;return m.locale!==!1&&v.locale&&u&&(C=u({id:v.locale||"",defaultMessage:v.name})),C?h?{title:"".concat(C," - ").concat(h),id:v.locale||"",pageName:C}:{title:C,id:v.locale||"",pageName:C}:{title:g,id:v.locale||"",pageName:g}},$i={},ww;function XN(){if(ww)return $i;ww=1;function t(b){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},t(b)}Object.defineProperty($i,"__esModule",{value:!0}),$i.pathToRegexp=$i.tokensToRegexp=$i.regexpToFunction=$i.match=$i.tokensToFunction=$i.compile=$i.parse=void 0;function e(b){for(var _=[],y=0;y<b.length;){var S=b[y];if(S==="*"||S==="+"||S==="?"){_.push({type:"MODIFIER",index:y,value:b[y++]});continue}if(S==="\\"){_.push({type:"ESCAPED_CHAR",index:y++,value:b[y++]});continue}if(S==="{"){_.push({type:"OPEN",index:y,value:b[y++]});continue}if(S==="}"){_.push({type:"CLOSE",index:y,value:b[y++]});continue}if(S===":"){for(var D="",L=y+1;L<b.length;){var N=b.charCodeAt(L);if(N>=48&&N<=57||N>=65&&N<=90||N>=97&&N<=122||N===95){D+=b[L++];continue}break}if(!D)throw new TypeError("Missing parameter name at "+y);_.push({type:"NAME",index:y,value:D}),y=L;continue}if(S==="("){var T=1,j="",L=y+1;if(b[L]==="?")throw new TypeError('Pattern cannot start with "?" at '+L);for(;L<b.length;){if(b[L]==="\\"){j+=b[L++]+b[L++];continue}if(b[L]===")"){if(T--,T===0){L++;break}}else if(b[L]==="("&&(T++,b[L+1]!=="?"))throw new TypeError("Capturing groups are not allowed at "+L);j+=b[L++]}if(T)throw new TypeError("Unbalanced pattern at "+y);if(!j)throw new TypeError("Missing pattern at "+y);_.push({type:"PATTERN",index:y,value:j}),y=L;continue}_.push({type:"CHAR",index:y,value:b[y++]})}return _.push({type:"END",index:y,value:""}),_}function n(b,_){_===void 0&&(_={});for(var y=e(b),S=_.prefixes,D=S===void 0?"./":S,L="[^"+u(_.delimiter||"/#?")+"]+?",N=[],T=0,j=0,E="",R=function(ne){if(j<y.length&&y[j].type===ne)return y[j++].value},M=function(ne){var de=R(ne);if(de!==void 0)return de;var $=y[j],X=$.type,le=$.index;throw new TypeError("Unexpected "+X+" at "+le+", expected "+ne)},I=function(){for(var ne="",de;de=R("CHAR")||R("ESCAPED_CHAR");)ne+=de;return ne};j<y.length;){var z=R("CHAR"),V=R("NAME"),O=R("PATTERN");if(V||O){var k=z||"";D.indexOf(k)===-1&&(E+=k,k=""),E&&(N.push(E),E=""),N.push({name:V||T++,prefix:k,suffix:"",pattern:O||L,modifier:R("MODIFIER")||""});continue}var F=z||R("ESCAPED_CHAR");if(F){E+=F;continue}E&&(N.push(E),E="");var A=R("OPEN");if(A){var k=I(),q=R("NAME")||"",B=R("PATTERN")||"",W=I();M("CLOSE"),N.push({name:q||(B?T++:""),pattern:q&&!B?L:B,prefix:k,suffix:W,modifier:R("MODIFIER")||""});continue}M("END")}return N}$i.parse=n;function s(b,_){return o(n(b,_),_)}$i.compile=s;function o(b,_){_===void 0&&(_={});var y=h(_),S=_.encode,D=S===void 0?function(j){return j}:S,L=_.validate,N=L===void 0?!0:L,T=b.map(function(j){if(t(j)==="object")return new RegExp("^(?:"+j.pattern+")$",y)});return function(j){for(var E="",R=0;R<b.length;R++){var M=b[R];if(typeof M=="string"){E+=M;continue}var I=j?j[M.name]:void 0,z=M.modifier==="?"||M.modifier==="*",V=M.modifier==="*"||M.modifier==="+";if(Array.isArray(I)){if(!V)throw new TypeError('Expected "'+M.name+'" to not repeat, but got an array');if(I.length===0){if(z)continue;throw new TypeError('Expected "'+M.name+'" to not be empty')}for(var O=0;O<I.length;O++){var k=D(I[O],M);if(N&&!T[R].test(k))throw new TypeError('Expected all "'+M.name+'" to match "'+M.pattern+'", but got "'+k+'"');E+=M.prefix+k+M.suffix}continue}if(typeof I=="string"||typeof I=="number"){var k=D(String(I),M);if(N&&!T[R].test(k))throw new TypeError('Expected "'+M.name+'" to match "'+M.pattern+'", but got "'+k+'"');E+=M.prefix+k+M.suffix;continue}if(!z){var F=V?"an array":"a string";throw new TypeError('Expected "'+M.name+'" to be '+F)}}return E}}$i.tokensToFunction=o;function l(b,_){var y=[],S=C(b,y,_);return d(S,y,_)}$i.match=l;function d(b,_,y){y===void 0&&(y={});var S=y.decode,D=S===void 0?function(L){return L}:S;return function(L){var N=b.exec(L);if(!N)return!1;for(var T=N[0],j=N.index,E=Object.create(null),R=function(z){if(N[z]===void 0)return"continue";var V=_[z-1];V.modifier==="*"||V.modifier==="+"?E[V.name]=N[z].split(V.prefix+V.suffix).map(function(O){return D(O,V)}):E[V.name]=D(N[z],V)},M=1;M<N.length;M++)R(M);return{path:T,index:j,params:E}}}$i.regexpToFunction=d;function u(b){return b.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function h(b){return b&&b.sensitive?"":"i"}function p(b,_){if(!_)return b;var y=b.source.match(/\((?!\?)/g);if(y)for(var S=0;S<y.length;S++)_.push({name:S,prefix:"",suffix:"",modifier:"",pattern:""});return b}function m(b,_,y){var S=b.map(function(D){return C(D,_,y).source});return new RegExp("(?:"+S.join("|")+")",h(y))}function g(b,_,y){return v(n(b,y),_,y)}function v(b,_,y){y===void 0&&(y={});for(var S=y.strict,D=S===void 0?!1:S,L=y.start,N=L===void 0?!0:L,T=y.end,j=T===void 0?!0:T,E=y.encode,R=E===void 0?function(Q){return Q}:E,M="["+u(y.endsWith||"")+"]|$",I="["+u(y.delimiter||"/#?")+"]",z=N?"^":"",V=0,O=b;V<O.length;V++){var k=O[V];if(typeof k=="string")z+=u(R(k));else{var F=u(R(k.prefix)),A=u(R(k.suffix));if(k.pattern)if(_&&_.push(k),F||A)if(k.modifier==="+"||k.modifier==="*"){var q=k.modifier==="*"?"?":"";z+="(?:"+F+"((?:"+k.pattern+")(?:"+A+F+"(?:"+k.pattern+"))*)"+A+")"+q}else z+="(?:"+F+"("+k.pattern+")"+A+")"+k.modifier;else z+="("+k.pattern+")"+k.modifier;else z+="(?:"+F+A+")"+k.modifier}}if(j)D||(z+=I+"?"),z+=y.endsWith?"(?="+M+")":"$";else{var B=b[b.length-1],W=typeof B=="string"?I.indexOf(B[B.length-1])>-1:B===void 0;D||(z+="(?:"+I+"(?="+M+"))?"),W||(z+="(?="+I+"|"+M+")")}return new RegExp(z,h(y))}$i.tokensToRegexp=v;function C(b,_,y){return b instanceof RegExp?p(b,_):Array.isArray(b)?m(b,_,y):g(b,_,y)}return $i.pathToRegexp=C,$i}var Cp=XN();function Qs(t,e){return e>>>t|e<<32-t}function QN(t,e,n){return t&e^~t&n}function ZN(t,e,n){return t&e^t&n^e&n}function JN(t){return Qs(2,t)^Qs(13,t)^Qs(22,t)}function eF(t){return Qs(6,t)^Qs(11,t)^Qs(25,t)}function tF(t){return Qs(7,t)^Qs(18,t)^t>>>3}function nF(t){return Qs(17,t)^Qs(19,t)^t>>>10}function iF(t,e){return t[e&15]+=nF(t[e+14&15])+t[e+9&15]+tF(t[e+1&15])}var aF=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],$n,ta,bi,sF="0123456789abcdef";function Cw(t,e){var n=(t&65535)+(e&65535),s=(t>>16)+(e>>16)+(n>>16);return s<<16|n&65535}function rF(){$n=new Array(8),ta=new Array(2),bi=new Array(64),ta[0]=ta[1]=0,$n[0]=1779033703,$n[1]=3144134277,$n[2]=1013904242,$n[3]=2773480762,$n[4]=1359893119,$n[5]=2600822924,$n[6]=528734635,$n[7]=1541459225}function g0(){var t,e,n,s,o,l,d,u,h,p,m=new Array(16);t=$n[0],e=$n[1],n=$n[2],s=$n[3],o=$n[4],l=$n[5],d=$n[6],u=$n[7];for(var g=0;g<16;g++)m[g]=bi[(g<<2)+3]|bi[(g<<2)+2]<<8|bi[(g<<2)+1]<<16|bi[g<<2]<<24;for(var v=0;v<64;v++)h=u+eF(o)+QN(o,l,d)+aF[v],v<16?h+=m[v]:h+=iF(m,v),p=JN(t)+ZN(t,e,n),u=d,d=l,l=o,o=Cw(s,h),s=n,n=e,e=t,t=Cw(h,p);$n[0]+=t,$n[1]+=e,$n[2]+=n,$n[3]+=s,$n[4]+=o,$n[5]+=l,$n[6]+=d,$n[7]+=u}function oF(t,e){var n,s,o=0;s=ta[0]>>3&63;var l=e&63;for((ta[0]+=e<<3)<e<<3&&ta[1]++,ta[1]+=e>>29,n=0;n+63<e;n+=64){for(var d=s;d<64;d++)bi[d]=t.charCodeAt(o++);g0(),s=0}for(var u=0;u<l;u++)bi[u]=t.charCodeAt(o++)}function lF(){var t=ta[0]>>3&63;if(bi[t++]=128,t<=56)for(var e=t;e<56;e++)bi[e]=0;else{for(var n=t;n<64;n++)bi[n]=0;g0();for(var s=0;s<56;s++)bi[s]=0}bi[56]=ta[1]>>>24&255,bi[57]=ta[1]>>>16&255,bi[58]=ta[1]>>>8&255,bi[59]=ta[1]&255,bi[60]=ta[0]>>>24&255,bi[61]=ta[0]>>>16&255,bi[62]=ta[0]>>>8&255,bi[63]=ta[0]&255,g0()}function cF(){for(var t=new String,e=0;e<8;e++)for(var n=28;n>=0;n-=4)t+=sF.charAt($n[e]>>>n&15);return t}function dF(t){return rF(),oF(t,t.length),lF(),cF()}var uF=["pro_layout_parentKeys","children","icon","flatMenu","indexRoute","routes"];function Yc(t){"@babel/helpers - typeof";return Yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yc(t)}function fF(t,e){return mF(t)||pF(t,e)||Vv(t,e)||hF()}function hF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pF(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var s,o,l,d,u=[],h=!0,p=!1;try{if(l=(n=n.call(t)).next,e!==0)for(;!(h=(s=l.call(n)).done)&&(u.push(s.value),u.length!==e);h=!0);}catch(m){p=!0,o=m}finally{try{if(!h&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(p)throw o}}return u}}function mF(t){if(Array.isArray(t))return t}function gF(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Vv(t))||e){n&&(t=n);var s=0,o=function(){};return{s:o,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(p){throw p},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l,d=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return d=p.done,p},e:function(p){u=!0,l=p},f:function(){try{d||n.return==null||n.return()}finally{if(u)throw l}}}}function xF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yF(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,tE(s.key),s)}}function vF(t,e,n){return e&&yF(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function _F(t,e,n){return e=Fu(e),bF(t,Hv()?Reflect.construct(e,n||[],Fu(t).constructor):e.apply(t,n))}function bF(t,e){if(e&&(Yc(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SF(t)}function SF(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MF(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nu(t,e)}function x0(t){var e=typeof Map=="function"?new Map:void 0;return x0=function(s){if(s===null||!CF(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(s))return e.get(s);e.set(s,o)}function o(){return wF(s,arguments,Fu(this).constructor)}return o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Nu(o,s)},x0(t)}function wF(t,e,n){if(Hv())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,e);var o=new(t.bind.apply(t,s));return n&&Nu(o,n.prototype),o}function Hv(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hv=function(){return!!t})()}function CF(t){try{return Function.toString.call(t).indexOf("[native code]")!==-1}catch{return typeof t=="function"}}function Nu(t,e){return Nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},Nu(t,e)}function Fu(t){return Fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fu(t)}function y0(t){return EF(t)||jF(t)||Vv(t)||TF()}function TF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vv(t,e){if(t){if(typeof t=="string")return v0(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v0(t,e):void 0}}function jF(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function EF(t){if(Array.isArray(t))return v0(t)}function v0(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,s=Array(e);n<e;n++)s[n]=t[n];return s}function AF(t,e){if(t==null)return{};var n,s,o=RF(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(s=0;s<l.length;s++)n=l[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function RF(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function Tw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,s)}return n}function mi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Tw(Object(n),!0).forEach(function(s){DF(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tw(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function DF(t,e,n){return(e=tE(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tE(t){var e=IF(t,"string");return Yc(e)=="symbol"?e:e+""}function IF(t,e){if(Yc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Yc(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ga="routes";function af(t){return t.split("?")[0].split("#")[0]}var qv=function(e){if(!e.startsWith("http"))return!1;try{var n=new URL(e);return!!n}catch{return!1}},OF=function(e){var n=e.path;if(!n||n==="/")try{return"/".concat(dF(JSON.stringify(e)))}catch{}return n&&af(n)},PF=function(e,n){var s=e.name,o=e.locale;return"locale"in e&&o===!1||!s?!1:e.locale||"".concat(n,".").concat(s)},nE=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"/";return e.endsWith("/*")?e.replace("/*","/"):(e||n).startsWith("/")||qv(e)?e:"/".concat(n,"/").concat(e).replace(/\/\//g,"/").replace(/\/\//g,"/")},LF=function(e,n){var s=e.menu,o=s===void 0?{}:s,l=e.indexRoute,d=e.path,u=d===void 0?"":d,h=e.children||[],p=o.name,m=p===void 0?e.name:p,g=o.icon,v=g===void 0?e.icon:g,C=o.hideChildren,b=C===void 0?e.hideChildren:C,_=o.flatMenu,y=_===void 0?e.flatMenu:_,S=l&&Object.keys(l).join(",")!=="redirect"?[mi({path:u,menu:o},l)].concat(h||[]):h,D=mi({},e);if(m&&(D.name=m),v&&(D.icon=v),S&&S.length){if(b)return delete D.children,D;var L=Gv(mi(mi({},n),{},{data:S}),e);if(y)return L;delete D[Ga]}return D},Sl=function(e){return Array.isArray(e)&&e.length>0};function Gv(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{path:"/"},n=t.data,s=t.formatMessage,o=t.parentName,l=t.locale;return!n||!Array.isArray(n)?[]:n.filter(function(d){return d?Sl(d.children)||d.path||d.originPath||d.layout?!0:(d.redirect||d.unaccessible,!1):!1}).filter(function(d){var u,h;return!(d==null||(u=d.menu)===null||u===void 0)&&u.name||d?.flatMenu||!(d==null||(h=d.menu)===null||h===void 0)&&h.flatMenu?!0:d.menu!==!1}).map(function(d){var u=mi(mi({},d),{},{path:d.path||d.originPath});return!u.children&&u[Ga]&&(u.children=u[Ga],delete u[Ga]),u.unaccessible&&delete u.name,u.path==="*"&&(u.path="."),u.path==="/*"&&(u.path="."),!u.path&&u.originPath&&(u.path=u.originPath),u}).map(function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{path:"/"},u=d.children||d[Ga]||[],h=nE(d.path,e?e.path:"/"),p=d.name,m=PF(d,o||"menu"),g=m!==!1&&l!==!1&&s&&m?s({id:m,defaultMessage:p}):p,v=e.pro_layout_parentKeys,C=v===void 0?[]:v;e.children,e.icon,e.flatMenu,e.indexRoute,e.routes;var b=AF(e,uF),_=new Set([].concat(y0(C),y0(d.parentKeys||[])));e.key&&_.add(e.key);var y=mi(mi(mi({},b),{},{menu:void 0},d),{},{path:h,locale:m,key:d.key||OF(mi(mi({},d),{},{path:h})),pro_layout_parentKeys:Array.from(_).filter(function(D){return D&&D!=="/"})});if(g?y.name=g:delete y.name,y.menu===void 0&&delete y.menu,Sl(u)){var S=Gv(mi(mi({},t),{},{data:u,parentName:m||""}),y);Sl(S)&&(y.children=S)}return LF(y,t)}).flat(1)}var iE=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.filter(function(n){return n&&(n.name||Sl(n.children))&&!n.hideInMenu&&!n.redirect}).map(function(n){var s=mi({},n),o=s.children||n[Ga]||[];if(delete s[Ga],Sl(o)&&!s.hideChildrenInMenu&&o.some(function(d){return d&&!!d.name})){var l=iE(o);if(l.length)return mi(mi({},s),{},{children:l})}return mi({},n)}).filter(function(n){return n})},NF=(function(t){function e(){return xF(this,e),_F(this,e,arguments)}return MF(e,t),vF(e,[{key:"get",value:function(s){var o;try{var l=gF(this.entries()),d;try{for(l.s();!(d=l.n()).done;){var u=fF(d.value,2),h=u[0],p=u[1],m=af(h);if(!qv(h)&&Cp.pathToRegexp(m,[]).test(s)){o=p;break}}}catch(g){l.e(g)}finally{l.f()}}catch{o=void 0}return o}}])})(x0(Map)),FF=function(e){var n=new NF,s=function(l,d){l.forEach(function(u){var h=u.children||u[Ga]||[];Sl(h)&&s(h,u);var p=nE(u.path,d?d.path:"/");n.set(af(p),u)})};return s(e),n},aE=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.map(function(n){var s=n.children||n[Ga];if(Sl(s)){var o=aE(s);if(o.length)return mi({},n)}var l=mi({},n);return delete l[Ga],delete l.children,l}).filter(function(n){return n})},zF=function(e,n,s,o){var l=Gv({data:y0(e).map(function(h){return mi({},h)}),formatMessage:s,locale:n}),d=o?aE(l):iE(l),u=FF(l);return{breadcrumb:u,menuData:d}};function zu(t){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zu(t)}function jw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,s)}return n}function ru(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jw(Object(n),!0).forEach(function(s){kF(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jw(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function kF(t,e,n){return(e=BF(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BF(t){var e=UF(t,"string");return zu(e)=="symbol"?e:e+""}function UF(t,e){if(zu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(zu(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sE=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n={};return e.forEach(function(s){var o=ru({},s);if(!(!o||!o.key)){!o.children&&o[Ga]&&(o.children=o[Ga],delete o[Ga]);var l=o.children||[];n[af(o.path||o.key||"/")]=ru({},o),n[o.key||o.path||"/"]=ru({},o),l&&(n=ru(ru({},n),sE(l)))}}),n},HF=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;return e.filter(function(o){if(o==="/"&&n==="/")return!0;if(o!=="/"&&o!=="/*"&&o&&!qv(o)){var l=af(o);try{if(s&&Cp.pathToRegexp("".concat(l)).test(n)||Cp.pathToRegexp("".concat(l),[]).test(n)||Cp.pathToRegexp("".concat(l,"/(.*)")).test(n))return!0}catch{}}return!1}).sort(function(o,l){return o===n?10:l===n?-10:o.substr(1).split("/").length-l.substr(1).split("/").length})},VF=function(e,n,s,o){var l=sE(n),d=Object.keys(l),u=HF(d,e,o);return!u||u.length<1?[]:u.map(function(h){var p=l[h]||{pro_layout_parentKeys:"",key:""},m=new Map,g=(p.pro_layout_parentKeys||[]).map(function(v){return m.has(v)?null:(m.set(v,!0),l[v])}).filter(function(v){return v});return p.key&&g.push(p),g}).flat(1)},qF=function(e){var n=P.useContext(Is),s=n.hashId,o=e.style,l=e.prefixCls,d=e.children,u=e.hasPageContainer,h=u===void 0?0:u,p=mn("".concat(l,"-content"),s,he(he({},"".concat(l,"-has-header"),e.hasHeader),"".concat(l,"-content-has-page-container"),h>0)),m=e.ErrorBoundary||mL;return e.ErrorBoundary===!1?i.jsx(wl.Content,{className:p,style:o,children:d}):i.jsx(m,{children:i.jsx(wl.Content,{className:p,style:o,children:d})})},GF=function(){return i.jsxs("svg",{width:"1em",height:"1em",viewBox:"0 0 200 200",children:[i.jsxs("defs",{children:[i.jsxs("linearGradient",{x1:"62.1023273%",y1:"0%",x2:"108.19718%",y2:"37.8635764%",id:"linearGradient-1",children:[i.jsx("stop",{stopColor:"#4285EB",offset:"0%"}),i.jsx("stop",{stopColor:"#2EC7FF",offset:"100%"})]}),i.jsxs("linearGradient",{x1:"69.644116%",y1:"0%",x2:"54.0428975%",y2:"108.456714%",id:"linearGradient-2",children:[i.jsx("stop",{stopColor:"#29CDFF",offset:"0%"}),i.jsx("stop",{stopColor:"#148EFF",offset:"37.8600687%"}),i.jsx("stop",{stopColor:"#0A60FF",offset:"100%"})]}),i.jsxs("linearGradient",{x1:"69.6908165%",y1:"-12.9743587%",x2:"16.7228981%",y2:"117.391248%",id:"linearGradient-3",children:[i.jsx("stop",{stopColor:"#FA816E",offset:"0%"}),i.jsx("stop",{stopColor:"#F74A5C",offset:"41.472606%"}),i.jsx("stop",{stopColor:"#F51D2C",offset:"100%"})]}),i.jsxs("linearGradient",{x1:"68.1279872%",y1:"-35.6905737%",x2:"30.4400914%",y2:"114.942679%",id:"linearGradient-4",children:[i.jsx("stop",{stopColor:"#FA8E7D",offset:"0%"}),i.jsx("stop",{stopColor:"#F74A5C",offset:"51.2635191%"}),i.jsx("stop",{stopColor:"#F51D2C",offset:"100%"})]})]}),i.jsx("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",children:i.jsx("g",{transform:"translate(-20.000000, -20.000000)",children:i.jsx("g",{transform:"translate(20.000000, 20.000000)",children:i.jsxs("g",{children:[i.jsxs("g",{fillRule:"nonzero",children:[i.jsxs("g",{children:[i.jsx("path",{d:"M91.5880863,4.17652823 L4.17996544,91.5127728 C-0.519240605,96.2081146 -0.519240605,103.791885 4.17996544,108.487227 L91.5880863,195.823472 C96.2872923,200.518814 103.877304,200.518814 108.57651,195.823472 L145.225487,159.204632 C149.433969,154.999611 149.433969,148.181924 145.225487,143.976903 C141.017005,139.771881 134.193707,139.771881 129.985225,143.976903 L102.20193,171.737352 C101.032305,172.906015 99.2571609,172.906015 98.0875359,171.737352 L28.285908,101.993122 C27.1162831,100.824459 27.1162831,99.050775 28.285908,97.8821118 L98.0875359,28.1378823 C99.2571609,26.9692191 101.032305,26.9692191 102.20193,28.1378823 L129.985225,55.8983314 C134.193707,60.1033528 141.017005,60.1033528 145.225487,55.8983314 C149.433969,51.69331 149.433969,44.8756232 145.225487,40.6706018 L108.58055,4.05574592 C103.862049,-0.537986846 96.2692618,-0.500797906 91.5880863,4.17652823 Z",fill:"url(#linearGradient-1)"}),i.jsx("path",{d:"M91.5880863,4.17652823 L4.17996544,91.5127728 C-0.519240605,96.2081146 -0.519240605,103.791885 4.17996544,108.487227 L91.5880863,195.823472 C96.2872923,200.518814 103.877304,200.518814 108.57651,195.823472 L145.225487,159.204632 C149.433969,154.999611 149.433969,148.181924 145.225487,143.976903 C141.017005,139.771881 134.193707,139.771881 129.985225,143.976903 L102.20193,171.737352 C101.032305,172.906015 99.2571609,172.906015 98.0875359,171.737352 L28.285908,101.993122 C27.1162831,100.824459 27.1162831,99.050775 28.285908,97.8821118 L98.0875359,28.1378823 C100.999864,25.6271836 105.751642,20.541824 112.729652,19.3524487 C117.915585,18.4685261 123.585219,20.4140239 129.738554,25.1889424 C125.624663,21.0784292 118.571995,14.0340304 108.58055,4.05574592 C103.862049,-0.537986846 96.2692618,-0.500797906 91.5880863,4.17652823 Z",fill:"url(#linearGradient-2)"})]}),i.jsx("path",{d:"M153.685633,135.854579 C157.894115,140.0596 164.717412,140.0596 168.925894,135.854579 L195.959977,108.842726 C200.659183,104.147384 200.659183,96.5636133 195.960527,91.8688194 L168.690777,64.7181159 C164.472332,60.5180858 157.646868,60.5241425 153.435895,64.7316526 C149.227413,68.936674 149.227413,75.7543607 153.435895,79.9593821 L171.854035,98.3623765 C173.02366,99.5310396 173.02366,101.304724 171.854035,102.473387 L153.685633,120.626849 C149.47715,124.83187 149.47715,131.649557 153.685633,135.854579 Z",fill:"url(#linearGradient-3)"})]}),i.jsx("ellipse",{fill:"url(#linearGradient-4)",cx:"100.519339",cy:"100.436681",rx:"23.6001926",ry:"23.580786"})]})})})})]})},Ew=new kR("antBadgeLoadingCircle",{"0%":{display:"none",opacity:0,overflow:"hidden"},"80%":{overflow:"hidden"},"100%":{display:"unset",opacity:1}}),$F=function(e){var n,s,o,l,d,u,h,p,m,g,v,C;return he({},"".concat(e.proComponentsCls,"-layout"),he(he(he({},"".concat(e.antCls,"-layout-sider").concat(e.componentCls),{background:((n=e.layout)===null||n===void 0||(n=n.sider)===null||n===void 0?void 0:n.colorMenuBackground)||"transparent"}),e.componentCls,he(he(he(he(he(he(he(he(he({position:"relative",boxSizing:"border-box","&-menu":{position:"relative",zIndex:10,minHeight:"100%"}},"& ".concat(e.antCls,"-layout-sider-children"),{position:"relative",display:"flex",flexDirection:"column",height:"100%",paddingInline:(s=e.layout)===null||s===void 0||(s=s.sider)===null||s===void 0?void 0:s.paddingInlineLayoutMenu,paddingBlock:(o=e.layout)===null||o===void 0||(o=o.sider)===null||o===void 0?void 0:o.paddingBlockLayoutMenu,borderInlineEnd:"1px solid ".concat(e.colorSplit),marginInlineEnd:-1}),"".concat(e.antCls,"-menu"),he(he({},"".concat(e.antCls,"-menu-item-group-title"),{fontSize:e.fontSizeSM,paddingBottom:4}),"".concat(e.antCls,"-menu-item:not(").concat(e.antCls,"-menu-item-selected):hover"),{color:(l=e.layout)===null||l===void 0||(l=l.sider)===null||l===void 0?void 0:l.colorTextMenuItemHover})),"&-logo",{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",paddingInline:12,paddingBlock:16,color:(d=e.layout)===null||d===void 0||(d=d.sider)===null||d===void 0?void 0:d.colorTextMenu,cursor:"pointer",borderBlockEnd:"1px solid ".concat((u=e.layout)===null||u===void 0||(u=u.sider)===null||u===void 0?void 0:u.colorMenuItemDivider),"> a":{display:"flex",alignItems:"center",justifyContent:"center",minHeight:22,fontSize:22,"> img":{display:"inline-block",height:22,verticalAlign:"middle"},"> h1":{display:"inline-block",height:22,marginBlock:0,marginInlineEnd:0,marginInlineStart:6,color:(h=e.layout)===null||h===void 0||(h=h.sider)===null||h===void 0?void 0:h.colorTextMenuTitle,animationName:Ew,animationDuration:".4s",animationTimingFunction:"ease",fontWeight:600,fontSize:16,lineHeight:"22px",verticalAlign:"middle"}},"&-collapsed":he({flexDirection:"column-reverse",margin:0,padding:12},"".concat(e.proComponentsCls,"-layout-apps-icon"),{marginBlockEnd:8,fontSize:16,transition:"font-size 0.2s ease-in-out,color 0.2s ease-in-out"})}),"&-actions",{display:"flex",alignItems:"center",justifyContent:"space-between",marginBlock:4,marginInline:0,color:(p=e.layout)===null||p===void 0||(p=p.sider)===null||p===void 0?void 0:p.colorTextMenu,"&-collapsed":{flexDirection:"column-reverse",paddingBlock:0,paddingInline:8,fontSize:16,transition:"font-size 0.3s ease-in-out"},"&-list":{color:(m=e.layout)===null||m===void 0||(m=m.sider)===null||m===void 0?void 0:m.colorTextMenuSecondary,"&-collapsed":{marginBlockEnd:8,animationName:"none"},"&-item":{paddingInline:6,paddingBlock:6,lineHeight:"16px",fontSize:16,cursor:"pointer",borderRadius:e.borderRadius,"&:hover":{background:e.colorBgTextHover}}},"&-avatar":{fontSize:14,paddingInline:8,paddingBlock:8,display:"flex",alignItems:"center",gap:e.marginXS,borderRadius:e.borderRadius,"& *":{cursor:"pointer"},"&:hover":{background:e.colorBgTextHover}}}),"&-hide-menu-collapsed",{insetInlineStart:"-".concat(e.proLayoutCollapsedWidth-12,"px"),position:"absolute"}),"&-extra",{marginBlockEnd:16,marginBlock:0,marginInline:16,"&-no-logo":{marginBlockStart:16}}),"&-links",{width:"100%",ul:{height:"auto"}}),"&-link-menu",{border:"none",boxShadow:"none",background:"transparent"}),"&-footer",{color:(g=e.layout)===null||g===void 0||(g=g.sider)===null||g===void 0?void 0:g.colorTextMenuSecondary,paddingBlockEnd:16,fontSize:e.fontSize,animationName:Ew,animationDuration:".4s",animationTimingFunction:"ease"})),"".concat(e.componentCls).concat(e.componentCls,"-fixed"),{position:"fixed",insetBlockStart:0,insetInlineStart:0,zIndex:"100",height:"100%","&-mix":{height:"calc(100% - ".concat(((v=e.layout)===null||v===void 0||(v=v.header)===null||v===void 0?void 0:v.heightLayoutHeader)||56,"px)"),insetBlockStart:"".concat(((C=e.layout)===null||C===void 0||(C=C.header)===null||C===void 0?void 0:C.heightLayoutHeader)||56,"px")}}))};function WF(t,e){var n=e.proLayoutCollapsedWidth;return fs("ProLayoutSiderMenu",function(s){var o=Me(Me({},s),{},{componentCls:".".concat(t),proLayoutCollapsedWidth:n});return[$F(o)]})}var Aw=function(e){var n,s=e.isMobile,o=e.siderWidth,l=e.collapsed,d=e.onCollapse,u=e.style,h=e.className,p=e.hide,m=e.prefixCls,g=e.getContainer,v=P.useContext(Is),C=v.token;P.useEffect(function(){s===!0&&d?.(!0)},[s]);var b=xT(e,["className","style"]),_=Pn.useContext(Qi.ConfigContext),y=_.direction,S=WF("".concat(m,"-sider"),{proLayoutCollapsedWidth:64}),D=S.wrapSSR,L=S.hashId,N=mn("".concat(m,"-sider"),h,L);if(p)return null;var T=kj(!l,function(){return d?.(!0)});return D(s?i.jsx(ci,Me(Me({placement:y==="rtl"?"right":"left",className:mn("".concat(m,"-drawer-sider"),h)},T),{},{style:Me({padding:0,height:"100vh"},u),onClose:function(){d?.(!0)},maskClosable:!0,closable:!1,getContainer:g||!1,width:o,styles:{body:{height:"100vh",padding:0,display:"flex",flexDirection:"row",backgroundColor:(n=C.layout)===null||n===void 0||(n=n.sider)===null||n===void 0?void 0:n.colorMenuBackground}},children:i.jsx(vw,Me(Me({},b),{},{isMobile:!0,className:N,collapsed:s?!1:l,splitMenus:!1,originCollapsed:l}))})):i.jsx(vw,Me(Me({className:N,originCollapsed:l},b),{},{style:u})))},YF=function(){var e;return typeof process>"u"?qc:((e=process)===null||e===void 0||(e=e.env)===null||e===void 0?void 0:e.ANTD_VERSION)||qc},KF=function(e){var n,s,o,l,d,u,h,p,m,g,v,C,b,_,y,S,D,L,N,T,j,E,R,M,I,z,V,O,k,F,A,q;return(n=YF())!==null&&n!==void 0&&n.startsWith("5")?{}:he(he(he({},e.componentCls,he(he({width:"100%",height:"100%"},"".concat(e.proComponentsCls,"-base-menu"),(j={color:(s=e.layout)===null||s===void 0||(s=s.sider)===null||s===void 0?void 0:s.colorTextMenu},he(he(he(he(he(he(he(he(he(he(j,"".concat(e.antCls,"-menu-sub"),{backgroundColor:"transparent!important",color:(o=e.layout)===null||o===void 0||(o=o.sider)===null||o===void 0?void 0:o.colorTextMenu}),"& ".concat(e.antCls,"-layout"),{backgroundColor:"transparent",width:"100%"}),"".concat(e.antCls,"-menu-submenu-expand-icon, ").concat(e.antCls,"-menu-submenu-arrow"),{color:"inherit"}),"&".concat(e.antCls,"-menu"),he(he({color:(l=e.layout)===null||l===void 0||(l=l.sider)===null||l===void 0?void 0:l.colorTextMenu},"".concat(e.antCls,"-menu-item"),{"*":{transition:"none !important"}}),"".concat(e.antCls,"-menu-item a"),{color:"inherit"})),"&".concat(e.antCls,"-menu-inline"),he({},"".concat(e.antCls,"-menu-selected::after,").concat(e.antCls,"-menu-item-selected::after"),{display:"none"})),"".concat(e.antCls,"-menu-sub ").concat(e.antCls,"-menu-inline"),{backgroundColor:"transparent!important"}),"".concat(e.antCls,`-menu-item:active, 
        `).concat(e.antCls,"-menu-submenu-title:active"),{backgroundColor:"transparent!important"}),"&".concat(e.antCls,"-menu-light"),he({},"".concat(e.antCls,`-menu-item:hover, 
            `).concat(e.antCls,`-menu-item-active,
            `).concat(e.antCls,`-menu-submenu-active, 
            `).concat(e.antCls,"-menu-submenu-title:hover"),he({color:(d=e.layout)===null||d===void 0||(d=d.sider)===null||d===void 0?void 0:d.colorTextMenuActive,borderRadius:e.borderRadius},"".concat(e.antCls,"-menu-submenu-arrow"),{color:(u=e.layout)===null||u===void 0||(u=u.sider)===null||u===void 0?void 0:u.colorTextMenuActive}))),"&".concat(e.antCls,"-menu:not(").concat(e.antCls,"-menu-horizontal)"),he(he({},"".concat(e.antCls,"-menu-item-selected"),{backgroundColor:(h=e.layout)===null||h===void 0||(h=h.sider)===null||h===void 0?void 0:h.colorBgMenuItemSelected,borderRadius:e.borderRadius}),"".concat(e.antCls,`-menu-item:hover, 
            `).concat(e.antCls,`-menu-item-active,
            `).concat(e.antCls,"-menu-submenu-title:hover"),he({color:(p=e.layout)===null||p===void 0||(p=p.sider)===null||p===void 0?void 0:p.colorTextMenuActive,borderRadius:e.borderRadius,backgroundColor:"".concat((m=e.layout)===null||m===void 0||(m=m.header)===null||m===void 0?void 0:m.colorBgMenuItemHover," !important")},"".concat(e.antCls,"-menu-submenu-arrow"),{color:(g=e.layout)===null||g===void 0||(g=g.sider)===null||g===void 0?void 0:g.colorTextMenuActive}))),"".concat(e.antCls,"-menu-item-selected"),{color:(v=e.layout)===null||v===void 0||(v=v.sider)===null||v===void 0?void 0:v.colorTextMenuSelected}),he(he(he(he(he(j,"".concat(e.antCls,"-menu-submenu-selected"),{color:(C=e.layout)===null||C===void 0||(C=C.sider)===null||C===void 0?void 0:C.colorTextMenuSelected}),"&".concat(e.antCls,"-menu:not(").concat(e.antCls,"-menu-inline) ").concat(e.antCls,"-menu-submenu-open"),{color:(b=e.layout)===null||b===void 0||(b=b.sider)===null||b===void 0?void 0:b.colorTextMenuSelected}),"&".concat(e.antCls,"-menu-vertical"),he({},"".concat(e.antCls,"-menu-submenu-selected"),{borderRadius:e.borderRadius,color:(_=e.layout)===null||_===void 0||(_=_.sider)===null||_===void 0?void 0:_.colorTextMenuSelected})),"".concat(e.antCls,"-menu-submenu:hover > ").concat(e.antCls,"-menu-submenu-title > ").concat(e.antCls,"-menu-submenu-arrow"),{color:(y=e.layout)===null||y===void 0||(y=y.sider)===null||y===void 0?void 0:y.colorTextMenuActive}),"&".concat(e.antCls,"-menu-horizontal"),he(he(he(he({},"".concat(e.antCls,`-menu-item:hover,
          `).concat(e.antCls,`-menu-submenu:hover,
          `).concat(e.antCls,`-menu-item-active,
          `).concat(e.antCls,"-menu-submenu-active"),{borderRadius:4,transition:"none",color:(S=e.layout)===null||S===void 0||(S=S.header)===null||S===void 0?void 0:S.colorTextMenuActive,backgroundColor:"".concat((D=e.layout)===null||D===void 0||(D=D.header)===null||D===void 0?void 0:D.colorBgMenuItemHover," !important")}),"".concat(e.antCls,`-menu-item-open,
          `).concat(e.antCls,`-menu-submenu-open,
          `).concat(e.antCls,`-menu-item-selected,
          `).concat(e.antCls,"-menu-submenu-selected"),he({backgroundColor:(L=e.layout)===null||L===void 0||(L=L.header)===null||L===void 0?void 0:L.colorBgMenuItemSelected,borderRadius:e.borderRadius,transition:"none",color:"".concat((N=e.layout)===null||N===void 0||(N=N.header)===null||N===void 0?void 0:N.colorTextMenuSelected," !important")},"".concat(e.antCls,"-menu-submenu-arrow"),{color:"".concat((T=e.layout)===null||T===void 0||(T=T.header)===null||T===void 0?void 0:T.colorTextMenuSelected," !important")})),"> ".concat(e.antCls,"-menu-item, > ").concat(e.antCls,"-menu-submenu"),{paddingInline:16,marginInline:4}),"> ".concat(e.antCls,"-menu-item::after, > ").concat(e.antCls,"-menu-submenu::after"),{display:"none"})))),"".concat(e.proComponentsCls,"-top-nav-header-base-menu"),he(he({},"&".concat(e.antCls,"-menu"),he({color:(E=e.layout)===null||E===void 0||(E=E.header)===null||E===void 0?void 0:E.colorTextMenu},"".concat(e.antCls,"-menu-item a"),{color:"inherit"})),"&".concat(e.antCls,"-menu-light"),he(he({},"".concat(e.antCls,`-menu-item:hover, 
            `).concat(e.antCls,`-menu-item-active,
            `).concat(e.antCls,`-menu-submenu-active, 
            `).concat(e.antCls,"-menu-submenu-title:hover"),he({color:(R=e.layout)===null||R===void 0||(R=R.header)===null||R===void 0?void 0:R.colorTextMenuActive,borderRadius:e.borderRadius,transition:"none",backgroundColor:(M=e.layout)===null||M===void 0||(M=M.header)===null||M===void 0?void 0:M.colorBgMenuItemSelected},"".concat(e.antCls,"-menu-submenu-arrow"),{color:(I=e.layout)===null||I===void 0||(I=I.header)===null||I===void 0?void 0:I.colorTextMenuActive})),"".concat(e.antCls,"-menu-item-selected"),{color:(z=e.layout)===null||z===void 0||(z=z.header)===null||z===void 0?void 0:z.colorTextMenuSelected,borderRadius:e.borderRadius,backgroundColor:(V=e.layout)===null||V===void 0||(V=V.header)===null||V===void 0?void 0:V.colorBgMenuItemSelected})))),"".concat(e.antCls,"-menu-sub").concat(e.antCls,"-menu-inline"),{backgroundColor:"transparent!important"}),"".concat(e.antCls,"-menu-submenu-popup"),he(he(he(he({backgroundColor:"rgba(255, 255, 255, 0.42)","-webkit-backdrop-filter":"blur(8px)",backdropFilter:"blur(8px)"},"".concat(e.antCls,"-menu"),he({background:"transparent !important",backgroundColor:"transparent !important"},"".concat(e.antCls,`-menu-item:active, 
        `).concat(e.antCls,"-menu-submenu-title:active"),{backgroundColor:"transparent!important"})),"".concat(e.antCls,"-menu-item-selected"),{color:(O=e.layout)===null||O===void 0||(O=O.sider)===null||O===void 0?void 0:O.colorTextMenuSelected}),"".concat(e.antCls,"-menu-submenu-selected"),{color:(k=e.layout)===null||k===void 0||(k=k.sider)===null||k===void 0?void 0:k.colorTextMenuSelected}),"".concat(e.antCls,"-menu:not(").concat(e.antCls,"-menu-horizontal)"),he(he({},"".concat(e.antCls,"-menu-item-selected"),{backgroundColor:"rgba(0, 0, 0, 0.04)",borderRadius:e.borderRadius,color:(F=e.layout)===null||F===void 0||(F=F.sider)===null||F===void 0?void 0:F.colorTextMenuSelected}),"".concat(e.antCls,`-menu-item:hover, 
          `).concat(e.antCls,`-menu-item-active,
          `).concat(e.antCls,"-menu-submenu-title:hover"),he({color:(A=e.layout)===null||A===void 0||(A=A.sider)===null||A===void 0?void 0:A.colorTextMenuActive,borderRadius:e.borderRadius},"".concat(e.antCls,"-menu-submenu-arrow"),{color:(q=e.layout)===null||q===void 0||(q=q.sider)===null||q===void 0?void 0:q.colorTextMenuActive}))))},XF=function(e){var n,s,o,l;return he(he({},"".concat(e.antCls,"-layout"),{backgroundColor:"transparent !important"}),e.componentCls,he(he(he(he({},"& ".concat(e.antCls,"-layout"),{display:"flex",backgroundColor:"transparent",width:"100%"}),"".concat(e.componentCls,"-content"),{display:"flex",flexDirection:"column",width:"100%",backgroundColor:((n=e.layout)===null||n===void 0||(n=n.pageContainer)===null||n===void 0?void 0:n.colorBgPageContainer)||"transparent",position:"relative",paddingBlock:(s=e.layout)===null||s===void 0||(s=s.pageContainer)===null||s===void 0?void 0:s.paddingBlockPageContainerContent,paddingInline:(o=e.layout)===null||o===void 0||(o=o.pageContainer)===null||o===void 0?void 0:o.paddingInlinePageContainerContent,"&-has-page-container":{padding:0}}),"".concat(e.componentCls,"-container"),{width:"100%",display:"flex",flexDirection:"column",minWidth:0,minHeight:0,backgroundColor:"transparent"}),"".concat(e.componentCls,"-bg-list"),{pointerEvents:"none",position:"fixed",overflow:"hidden",insetBlockStart:0,insetInlineStart:0,zIndex:0,height:"100%",width:"100%",background:(l=e.layout)===null||l===void 0?void 0:l.bgLayout}))};function QF(t){return fs("ProLayout",function(e){var n=Me(Me({},e),{},{componentCls:".".concat(t)});return[XF(n),KF(n)]})}function ZF(t){if(!t||t==="/")return["/"];var e=t.split("/").filter(function(n){return n});return e.map(function(n,s){return"/".concat(e.slice(0,s+1).join("/"))})}var JF=function(){var e;return typeof process>"u"?qc:((e=process)===null||e===void 0||(e=e.env)===null||e===void 0?void 0:e.ANTD_VERSION)||qc},ez=function(e,n,s){var o=e,l=o.breadcrumbName,d=o.title,u=o.path,h=s.findIndex(function(p){return p.linkPath===e.path})===s.length-1;return h?i.jsx("span",{children:d||l}):i.jsx("span",{onClick:u?function(){return location.href=u}:void 0,children:d||l})},tz=function(e,n){var s=n.formatMessage,o=n.menu;return e.locale&&s&&o?.locale!==!1?s({id:e.locale,defaultMessage:e.name}):e.name},nz=function(e,n){var s=e.get(n);if(!s){var o=Array.from(e.keys())||[],l=o.find(function(d){try{return d!=null&&d.startsWith("http")?!1:m0.match(d.replace("?",""))(n)}catch(u){return console.log("path",d,u),!1}});l&&(s=e.get(l))}return s||{path:""}},iz=function(e){var n=e.location,s=e.breadcrumbMap;return{location:n,breadcrumbMap:s}},az=function(e,n,s){var o=ZF(e?.pathname),l=o.map(function(d){var u=nz(n,d),h=tz(u,s),p=u.hideInBreadcrumb;return h&&!p?{linkPath:d,breadcrumbName:h,title:h,component:u.component}:{linkPath:"",breadcrumbName:"",title:""}}).filter(function(d){return d&&d.linkPath});return l},sz=function(e){var n=iz(e),s=n.location,o=n.breadcrumbMap;return s&&s.pathname&&o?az(s,o,e):[]},rz=function(e,n){var s=e.breadcrumbRender,o=e.itemRender,l=n.breadcrumbProps||{},d=l.minLength,u=d===void 0?2:d,h=sz(e),p=function(v){for(var C=o||ez,b=arguments.length,_=new Array(b>1?b-1:0),y=1;y<b;y++)_[y-1]=arguments[y];return C?.apply(void 0,[Me(Me({},v),{},{path:v.linkPath||v.path})].concat(_))},m=h;return s&&(m=s(m||[])||void 0),(m&&m.length<u||s===!1)&&(m=void 0),Lv(JF(),"5.3.0")>-1?{items:m,itemRender:p}:{routes:m,itemRender:p}};function oz(t){return Vc(t).reduce(function(e,n){var s=Qn(n,2),o=s[0],l=s[1];return e[o]=l,e},{})}var lz=function t(e,n,s,o){var l=zF(e,n?.locale||!1,s,!0),d=l.menuData,u=l.breadcrumb;return o?t(o(d),n,s,void 0):{breadcrumb:oz(u),breadcrumbMap:u,menuData:d}},cz=function(e){var n=P.useState({}),s=Qn(n,2),o=s[0],l=s[1];return P.useEffect(function(){l(Fj({layout:Ml(e.layout)!=="object"?e.layout:void 0,navTheme:e.navTheme,menuRender:e.menuRender,footerRender:e.footerRender,menuHeaderRender:e.menuHeaderRender,headerRender:e.headerRender,fixSiderbar:e.fixSiderbar}))},[e.layout,e.navTheme,e.menuRender,e.footerRender,e.menuHeaderRender,e.headerRender,e.fixSiderbar]),o},dz=["id","defaultMessage"],uz=["fixSiderbar","navTheme","layout"],Rw=0,fz=function(e,n){var s;return e.headerRender===!1||e.pure?null:i.jsx(LN,Me(Me({matchMenuKeys:n},e),{},{stylish:(s=e.stylish)===null||s===void 0?void 0:s.header}))},hz=function(e){return e.footerRender===!1||e.pure?null:e.footerRender?e.footerRender(Me({},e),i.jsx(JL,{})):null},pz=function(e,n){var s,o=e.layout,l=e.isMobile,d=e.selectedKeys,u=e.openKeys,h=e.splitMenus,p=e.suppressSiderWhenMenuEmpty,m=e.menuRender;if(e.menuRender===!1||e.pure)return null;var g=e.menuData;if(h&&(u!==!1||o==="mix")&&!l){var v=d||n,C=Qn(v,1),b=C[0];if(b){var _;g=((_=e.menuData)===null||_===void 0||(_=_.find(function(L){return L.key===b}))===null||_===void 0?void 0:_.children)||[]}else g=[]}var y=am(g||[]);if(y&&y?.length<1&&(h||p))return null;if(o==="top"&&!l){var S;return i.jsx(Aw,Me(Me({matchMenuKeys:n},e),{},{hide:!0,stylish:(S=e.stylish)===null||S===void 0?void 0:S.sider}))}var D=i.jsx(Aw,Me(Me({matchMenuKeys:n},e),{},{menuData:y,stylish:(s=e.stylish)===null||s===void 0?void 0:s.sider}));return m?m(e,D):D},mz=function(e,n){var s=n.pageTitleRender,o=Mw(e);if(s===!1)return{title:n.title||"",id:"",pageName:""};if(s){var l=s(e,o.title,o);if(typeof l=="string")return Mw(Me(Me({},o),{},{title:l}));gT(typeof l=="string","pro-layout: renderPageTitle return value should be a string")}return o},gz=function(e,n,s){return e?n?64:s:0},xz=function(e){var n,s,o,l,d,u,h,p,m,g,v,C,b,_,y=e||{},S=y.children,D=y.onCollapse,L=y.location,N=L===void 0?{pathname:"/"}:L,T=y.contentStyle,j=y.route,E=y.defaultCollapsed,R=y.style,M=y.siderWidth,I=y.menu,z=y.siderMenuType,V=y.isChildrenLayout,O=y.menuDataRender,k=y.actionRef,F=y.bgLayoutImgList,A=y.formatMessage,q=y.loading,B=P.useMemo(function(){return M||(e.layout==="mix"?215:256)},[e.layout,M]),W=P.useContext(Qi.ConfigContext),Q=(n=e.prefixCls)!==null&&n!==void 0?n:W.getPrefixCls("pro"),ne=Au(!1,{value:I?.loading,onChange:I?.onLoadingChange}),de=Qn(ne,2),$=de[0],X=de[1],le=P.useState(function(){return Rw+=1,"pro-layout-".concat(Rw)}),oe=Qn(le,1),ue=oe[0],Ye=P.useCallback(function(jn){var Vt=jn.id,ca=jn.defaultMessage,Ea=Wa(jn,dz);if(A)return A(Me({id:Vt,defaultMessage:ca},Ea));var ps=WN();return ps[Vt]?ps[Vt]:ca},[A]),ae=RO([ue,I?.params],(function(){var jn=Op(Oo().mark(function Vt(ca){var Ea,ps,ms,gs;return Oo().wrap(function(da){for(;;)switch(da.prev=da.next){case 0:return ps=Qn(ca,2),ms=ps[1],X(!0),da.next=4,I==null||(Ea=I.request)===null||Ea===void 0?void 0:Ea.call(I,ms||{},j?.children||j?.routes||[]);case 4:return gs=da.sent,X(!1),da.abrupt("return",gs);case 7:case"end":return da.stop()}},Vt)}));return function(Vt){return jn.apply(this,arguments)}})(),{revalidateOnFocus:!1,shouldRetryOnError:!1,revalidateOnReconnect:!1}),fe=ae.data,pt=ae.mutate,_t=ae.isLoading;P.useEffect(function(){X(_t)},[_t]);var Se=Iv(),$e=Se.cache;P.useEffect(function(){return function(){$e instanceof Map&&$e.delete(ue)}},[]);var jt=P.useMemo(function(){return lz(fe||j?.children||j?.routes||[],I,Ye,O)},[Ye,I,O,fe,j?.children,j?.routes]),Fe=jt||{},Dt=Fe.breadcrumb,te=Fe.breadcrumbMap,bt=Fe.menuData,It=bt===void 0?[]:bt;k&&I!==null&&I!==void 0&&I.request&&(k.current={reload:function(){pt()}});var tt=P.useMemo(function(){return VF(N.pathname||"/",It||[])},[N.pathname,It]),nt=P.useMemo(function(){return Array.from(new Set(tt.map(function(jn){return jn.key||jn.path||""})))},[tt]),G=tt[tt.length-1]||{},H=cz(G),ie=Me(Me({},e),H),we=ie.fixSiderbar;ie.navTheme;var Ce=ie.layout,ge=Wa(ie,uz),je=TL(),He=P.useMemo(function(){return(je==="sm"||je==="xs")&&!e.disableMobile},[je,e.disableMobile]),dt=Ce!=="top"&&!He,gt=Au(function(){return E!==void 0?E:!!(He||je==="md")},{value:e.collapsed,onChange:D}),We=Qn(gt,2),qe=We[0],at=We[1],ot=xT(Me(Me(Me({prefixCls:Q},e),{},{siderWidth:B},H),{},{formatMessage:Ye,breadcrumb:Dt,menu:Me(Me({},I),{},{type:z||I?.type,loading:$}),layout:Ce}),["className","style","breadcrumbRender"]),st=mz(Me(Me({pathname:N.pathname},ot),{},{breadcrumbMap:te}),e),it=rz(Me(Me({},ot),{},{breadcrumbRender:e.breadcrumbRender,breadcrumbMap:te}),e),re=pz(Me(Me({},ot),{},{menuData:It,onCollapse:at,isMobile:He,collapsed:qe}),nt),rt=fz(Me(Me({},ot),{},{children:null,hasSiderMenu:!!re,menuData:It,isMobile:He,collapsed:qe,onCollapse:at}),nt),Ze=hz(Me({isMobile:He,collapsed:qe},ot)),ht=P.useContext(rw),Ke=ht.isChildrenLayout,Ue=V!==void 0?V:Ke,Je="".concat(Q,"-layout"),ye=QF(Je),ut=ye.wrapSSR,Et=ye.hashId,si=mn(e.className,Et,"ant-design-pro",Je,he(he(he(he(he({},"screen-".concat(je),je),"".concat(Je,"-top-menu"),Ce==="top"),"".concat(Je,"-is-children"),Ue),"".concat(Je,"-fix-siderbar"),we),"".concat(Je,"-").concat(Ce),Ce)),la=gz(!!dt,qe,B),hs={position:"relative"};(Ue||T&&T.minHeight)&&(hs.minHeight=0),P.useEffect(function(){var jn;(jn=e.onPageChange)===null||jn===void 0||jn.call(e,e.location)},[N.pathname,(s=N.pathname)===null||s===void 0?void 0:s.search]);var or=P.useState(!1),be=Qn(or,2),et=be[0],ze=be[1],Qe=P.useState(0),Ht=Qn(Qe,2),Gt=Ht[0],dn=Ht[1];ML(st,e.title||!1);var gn=P.useContext(Is),yt=gn.token,an=P.useMemo(function(){return F&&F.length>0?F?.map(function(jn,Vt){return i.jsx("img",{src:jn.src,style:Me({position:"absolute"},jn)},Vt)}):null},[F]);return ut(i.jsx(rw.Provider,{value:Me(Me({},ot),{},{breadcrumb:it,menuData:It,isMobile:He,collapsed:qe,hasPageContainer:Gt,setHasPageContainer:dn,isChildrenLayout:!0,title:st.pageName,hasSiderMenu:!!re,hasHeader:!!rt,siderWidth:la,hasFooter:!!Ze,hasFooterToolbar:et,setHasFooterToolbar:ze,pageTitleInfo:st,matchMenus:tt,matchMenuKeys:nt,currentMenu:G}),children:e.pure?i.jsx(i.Fragment,{children:S}):i.jsxs("div",{className:si,children:[an||(o=yt.layout)!==null&&o!==void 0&&o.bgLayout?i.jsx("div",{className:mn("".concat(Je,"-bg-list"),Et),children:an}):null,i.jsxs(wl,{style:Me({minHeight:"100%",flexDirection:re?"row":void 0},R),children:[i.jsx(Qi,{theme:{hashed:kc(),token:{controlHeightLG:((l=yt.layout)===null||l===void 0||(l=l.sider)===null||l===void 0?void 0:l.menuHeight)||yt?.controlHeightLG},components:{Menu:Bj({colorItemBg:((d=yt.layout)===null||d===void 0||(d=d.sider)===null||d===void 0?void 0:d.colorMenuBackground)||"transparent",colorSubItemBg:((u=yt.layout)===null||u===void 0||(u=u.sider)===null||u===void 0?void 0:u.colorMenuBackground)||"transparent",radiusItem:yt.borderRadius,colorItemBgSelected:((h=yt.layout)===null||h===void 0||(h=h.sider)===null||h===void 0?void 0:h.colorBgMenuItemSelected)||yt?.colorBgTextHover,colorItemBgHover:((p=yt.layout)===null||p===void 0||(p=p.sider)===null||p===void 0?void 0:p.colorBgMenuItemHover)||yt?.colorBgTextHover,colorItemBgActive:((m=yt.layout)===null||m===void 0||(m=m.sider)===null||m===void 0?void 0:m.colorBgMenuItemActive)||yt?.colorBgTextActive,colorItemBgSelectedHorizontal:((g=yt.layout)===null||g===void 0||(g=g.sider)===null||g===void 0?void 0:g.colorBgMenuItemSelected)||yt?.colorBgTextHover,colorActiveBarWidth:0,colorActiveBarHeight:0,colorActiveBarBorderSize:0,colorItemText:((v=yt.layout)===null||v===void 0||(v=v.sider)===null||v===void 0?void 0:v.colorTextMenu)||yt?.colorTextSecondary,colorItemTextHover:((C=yt.layout)===null||C===void 0||(C=C.sider)===null||C===void 0?void 0:C.colorTextMenuItemHover)||"rgba(0, 0, 0, 0.85)",colorItemTextSelected:((b=yt.layout)===null||b===void 0||(b=b.sider)===null||b===void 0?void 0:b.colorTextMenuSelected)||"rgba(0, 0, 0, 1)",popupBg:yt?.colorBgElevated,subMenuItemBg:yt?.colorBgElevated,darkSubMenuItemBg:"transparent",darkPopupBg:yt?.colorBgElevated})}},children:re}),i.jsxs("div",{style:hs,className:"".concat(Je,"-container ").concat(Et).trim(),children:[rt,i.jsx(qF,Me(Me({hasPageContainer:Gt,isChildrenLayout:Ue},ge),{},{hasHeader:!!rt,prefixCls:Je,style:T,children:q?i.jsx(OL,{}):S})),Ze,et&&i.jsx("div",{className:"".concat(Je,"-has-footer"),style:{height:64,marginBlockStart:(_=yt.layout)===null||_===void 0||(_=_.pageContainer)===null||_===void 0?void 0:_.paddingBlockPageContainerContent}})]})]})]})}))},yz=function(e){var n=e.colorPrimary,s=e.navTheme!==void 0?{dark:e.navTheme==="realDark"}:{};return i.jsx(Qi,{theme:n?{token:{colorPrimary:n}}:void 0,children:i.jsx(pL,Me(Me({},s),{},{token:e.token,prefixCls:e.prefixCls,children:i.jsx(xz,Me(Me({logo:i.jsx(GF,{})},Xj),{},{location:Nv()?window.location:void 0},e))}))})};const Dw=640;function Tn(){const[t,e]=P.useState(()=>typeof window<"u"&&window.innerWidth<Dw);return P.useEffect(()=>{const n=window.matchMedia(`(max-width: ${Dw-1}px)`),s=o=>e(o.matches);return n.addEventListener("change",s),e(n.matches),()=>n.removeEventListener("change",s)},[]),t}const vz={"/dashboard":"","/my-tasks":"","/projects":"","/approvals":"","/materials":"","/material-search":"","/templates":"","/roles":"","/bom-management":"BOM","/bom-ecn":"BOM ECN","/documents":"","/ecn":"ECN","/srm":"SRM","/srm/suppliers":"","/srm/purchase-requests":"","/srm/purchase-orders":"","/srm/inspections":"","/srm/inventory":"","/srm/settlements":"","/srm/corrective-actions":"8D","/srm/evaluations":"","/srm/equipment":""},Hx=[{path:"/dashboard",label:"",icon:i.jsx(wT,{})},{path:"/projects",label:"",icon:i.jsx(Iu,{})},{path:"/bom-management",label:"BOM",icon:i.jsx(xv,{})},{path:"/my-tasks",label:"",icon:i.jsx(Lp,{})},{path:"/__my__",label:"",icon:i.jsx(wi,{})}],rE=[{title:"",items:[{path:"/bom-management",label:"BOM",icon:i.jsx(xv,{})},{path:"/bom-ecn",label:"BOM ECN",icon:i.jsx(Gr,{})},{path:"/templates",label:"",icon:i.jsx(yT,{})},{path:"/ecn",label:"ECN",icon:i.jsx(Gr,{})}]},{title:"",items:[{path:"/srm",label:"SRM",icon:i.jsx(zo,{})},{path:"/srm/suppliers",label:"",icon:i.jsx(vT,{})},{path:"/srm/purchase-requests",label:"",icon:i.jsx(Gu,{})},{path:"/srm/purchase-orders",label:"",icon:i.jsx(zo,{})},{path:"/srm/inspections",label:"",icon:i.jsx(_T,{})},{path:"/srm/inventory",label:"",icon:i.jsx(yv,{})},{path:"/srm/settlements",label:"",icon:i.jsx(bT,{})},{path:"/srm/evaluations",label:"",icon:i.jsx(ST,{})}]},{title:"",items:[{path:"/material-search",label:"",icon:i.jsx(MT,{})},{path:"/materials",label:"",icon:i.jsx(Ps,{})},{path:"/roles",label:"",icon:i.jsx(Pp,{})}]}],_z=rE.flatMap(t=>t.items.map(e=>e.path)),bz=()=>{const t=Ni(),e=xR(),[n]=Xp(),{user:s,logout:o,isLoading:l}=sd(),d=Tn(),u=n.get("embed")==="1";Pn.useEffect(()=>{if(u){const g=e.pathname;g.includes("my-tasks")?document.title="nimo ":g.includes("approval")?document.title="nimo ":document.title="nimo PLM"}},[u,e.pathname]);const h=P.useMemo(()=>[{path:"/dashboard",name:"",icon:i.jsx(wT,{})},{path:"/my-tasks",name:"",icon:i.jsx(Lp,{})},{path:"/projects",name:"",icon:i.jsx(Iu,{})},{path:"/bom-management",name:"BOM",icon:i.jsx(xv,{})},{path:"/bom-ecn",name:"BOM ECN",icon:i.jsx(Gr,{})},{path:"/material-search",name:"",icon:i.jsx(MT,{})},{path:"/materials",name:"",icon:i.jsx(Ps,{})},{path:"/templates",name:"",icon:i.jsx(yT,{})},{path:"/approvals",name:"",icon:i.jsx(Cl,{})},{path:"/documents",name:"",icon:i.jsx(BR,{})},{path:"/ecn",name:"ECN",icon:i.jsx(Gr,{})},{path:"/roles",name:"",icon:i.jsx(Pp,{})},{path:"/srm",name:"SRM ",icon:i.jsx(zo,{}),children:[{path:"/srm",name:"",icon:i.jsx(UR,{})},{path:"/srm/suppliers",name:"",icon:i.jsx(vT,{})},{path:"/srm/purchase-requests",name:"",icon:i.jsx(Gu,{})},{path:"/srm/purchase-orders",name:"",icon:i.jsx(zo,{})},{path:"/srm/inspections",name:"",icon:i.jsx(_T,{})},{path:"/srm/inventory",name:"",icon:i.jsx(yv,{})},{path:"/srm/settlements",name:"",icon:i.jsx(bT,{})},{path:"/srm/corrective-actions",name:"8D",icon:i.jsx(Np,{})},{path:"/srm/evaluations",name:"",icon:i.jsx(ST,{})},{path:"/srm/equipment",name:"",icon:i.jsx(Np,{})}]}],[]);if(l)return i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsx(tn,{size:"large",tip:"..."})});if(u)return i.jsx("div",{style:{padding:"16px",background:"#fff",minHeight:"100vh"},children:i.jsx(fx,{})});if(d){const g=e.pathname,v=g==="/__my__",C=!v&&!Hx.some(y=>y.path!=="/__my__"&&y.path===g)&&!_z.includes(g);let b=v?"":vz[g]||"nimo PLM";g.startsWith("/projects/")&&g!=="/projects"&&(b=""),g.startsWith("/templates/")&&g!=="/templates"&&(b="");let _="";return v?_="/__my__":g.startsWith("/bom-management")?_="/bom-management":_=Hx.find(y=>y.path!=="/__my__"&&y.path!=="/bom-management"&&g.startsWith(y.path))?.path||"",i.jsxs("div",{className:"mobile-content",children:[i.jsxs("div",{className:"mobile-header",children:[C?i.jsx("div",{className:"mobile-header-back",onClick:()=>t(-1),children:i.jsx(Ls,{})}):i.jsx("div",{className:"mobile-header-action"}),i.jsx("div",{className:"mobile-header-title",children:b}),i.jsx("div",{className:"mobile-header-action",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(Pi,{size:28,src:s?.avatar_url,style:{background:"#1677ff",fontSize:12},children:s?.name?.[0]})})]}),v?i.jsxs("div",{style:{padding:"0 0 16px"},children:[i.jsxs("div",{style:{background:"#fff",padding:"20px 16px",display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[i.jsx(Pi,{size:48,src:s?.avatar_url,style:{background:"#1677ff",fontSize:20},children:s?.name?.[0]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:17,fontWeight:600},children:s?.name||""}),i.jsx("div",{style:{fontSize:13,color:"#999"},children:s?.email||""})]})]}),i.jsxs("div",{style:{background:"#fff",marginBottom:8},children:[i.jsxs("div",{className:"mobile-my-menu-item",onClick:()=>t("/my-tasks"),children:[i.jsx(Lp,{style:{fontSize:20,color:"#1677ff"}}),i.jsx("span",{style:{flex:1},children:""}),i.jsx(Oi,{style:{fontSize:12,color:"#ccc"}})]}),i.jsxs("div",{className:"mobile-my-menu-item",onClick:()=>t("/approvals"),children:[i.jsx(Cl,{style:{fontSize:20,color:"#faad14"}}),i.jsx("span",{style:{flex:1},children:""}),i.jsx(Oi,{style:{fontSize:12,color:"#ccc"}})]})]}),i.jsx("div",{style:{background:"#fff",marginBottom:8},children:rE.map(y=>i.jsxs("div",{children:[i.jsx("div",{className:"mobile-my-group-title",children:y.title}),y.items.map(S=>i.jsxs("div",{className:"mobile-my-menu-item",onClick:()=>t(S.path),children:[i.jsx("span",{style:{fontSize:20,color:"#666"},children:S.icon}),i.jsx("span",{style:{flex:1},children:S.label}),i.jsx(Oi,{style:{fontSize:12,color:"#ccc"}})]},S.path))]},y.title))}),i.jsx("div",{style:{background:"#fff"},children:i.jsxs("div",{className:"mobile-my-menu-item",style:{color:"#ff4d4f",justifyContent:"center"},onClick:()=>{o(),t("/login")},children:[i.jsx($1,{style:{fontSize:20}}),i.jsx("span",{children:""})]})})]}):i.jsx(fx,{}),i.jsx("div",{className:"mobile-bottom-nav",children:Hx.map(y=>i.jsxs("div",{className:`mobile-bottom-nav-item ${_===y.path?"active":""}`,onClick:()=>{y.path==="/__my__"?t("/__my__"):t(y.path)},children:[y.icon,i.jsx("span",{children:y.label})]},y.path))})]})}const p=e.pathname,m={title:"nimo PLM",logo:"/logo.svg",layout:"mix",splitMenus:!1,fixedHeader:!0,fixSiderbar:!0,contentWidth:"Fluid",route:{path:"/",routes:h},location:{pathname:p},menuItemRender:(g,v)=>i.jsx("div",{onClick:()=>g.path&&t(g.path),children:v}),avatarProps:{src:s?.avatar_url,size:"small",title:s?.name,render:(g,v)=>i.jsx(CT,{menu:{items:[{key:"profile",icon:i.jsx(wi,{}),label:""},{type:"divider"},{key:"logout",icon:i.jsx($1,{}),label:"",onClick:()=>{o(),t("/login")}}]},children:v})},actionsRender:()=>[i.jsxs(Be,{children:[i.jsx("span",{style:{color:"#fff"},children:s?.name}),i.jsx(Pi,{src:s?.avatar_url,size:"small",children:s?.name?.[0]})]},"user")],token:{header:{colorBgHeader:"#001529",colorHeaderTitle:"#fff",colorTextMenu:"rgba(255,255,255,0.75)",colorTextMenuSecondary:"rgba(255,255,255,0.65)",colorTextMenuSelected:"#fff",colorBgMenuItemSelected:"#1890ff",colorTextMenuActive:"#fff",colorTextRightActionsItem:"rgba(255,255,255,0.85)"},sider:{colorMenuBackground:"#fff",colorTextMenu:"rgba(0,0,0,0.85)",colorTextMenuSelected:"#1890ff",colorBgMenuItemSelected:"#e6f7ff"}}};return i.jsx(yz,{...m,children:i.jsx(fx,{})})},{Title:Sz,Text:Iw}=An,Mz=()=>{const t=Ni(),[e]=Xp(),{login:n,isAuthenticated:s,refreshUser:o}=sd();return P.useEffect(()=>{const l=e.get("access_token"),d=e.get("refresh_token");l&&d&&(localStorage.setItem("access_token",l),localStorage.setItem("refresh_token",d),o().then(()=>{me.success(""),t("/dashboard",{replace:!0})}))},[e,o,t]),P.useEffect(()=>{s&&t("/dashboard",{replace:!0})},[s,t]),i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:i.jsx(Mt,{style:{width:400,textAlign:"center",borderRadius:8,boxShadow:"0 4px 20px rgba(0,0,0,0.15)"},children:i.jsxs(Be,{direction:"vertical",size:"large",style:{width:"100%"},children:[i.jsxs("div",{children:[i.jsx("img",{src:"/logo.svg",alt:"nimo PLM",style:{width:80,height:80,marginBottom:16}}),i.jsx(Sz,{level:2,style:{margin:0},children:"nimo PLM"}),i.jsx(Iw,{type:"secondary",children:""})]}),i.jsx(J,{type:"primary",size:"large",icon:i.jsx(HR,{}),onClick:n,style:{width:"100%",height:48,fontSize:16,background:"#3370ff",borderColor:"#3370ff"},children:""}),i.jsx(Iw,{type:"secondary",style:{fontSize:12},children:""})]})})})};function $v({onTaskUpdate:t,onProjectUpdate:e,onMyTaskUpdate:n,enabled:s=!0}){const o=P.useRef(null),l=P.useRef(void 0),d=P.useRef(t),u=P.useRef(e),h=P.useRef(n),p=Ln();P.useEffect(()=>{d.current=t},[t]),P.useEffect(()=>{u.current=e},[e]),P.useEffect(()=>{h.current=n},[n]);const m=P.useCallback(()=>{const g=localStorage.getItem("access_token");if(!g)return;o.current&&o.current.close();const C=`${window.location.origin}/api/v1/sse/events?token=${encodeURIComponent(g)}`,b=new EventSource(C);o.current=b,b.addEventListener("connected",()=>{console.log("[SSE] Connected")}),b.addEventListener("task_update",_=>{try{const y=JSON.parse(_.data);d.current?.(y)}catch(y){console.error("[SSE] Failed to parse task_update event:",y)}}),b.addEventListener("project_update",_=>{try{const y=JSON.parse(_.data);u.current?.(y)}catch(y){console.error("[SSE] Failed to parse project_update event:",y)}}),b.addEventListener("my_task_update",_=>{try{const y=JSON.parse(_.data);h.current?.(y)}catch(y){console.error("[SSE] Failed to parse my_task_update event:",y)}}),b.onerror=()=>{console.warn("[SSE] Connection error, reconnecting in 3s..."),b.close(),o.current=null,l.current=setTimeout(()=>{s&&m()},3e3)}},[s]);P.useEffect(()=>{const g=()=>{document.visibilityState==="visible"&&(console.log("[SSE] Page visible, invalidating queries"),p.invalidateQueries())},v=()=>{console.log("[SSE] Window focused, invalidating queries"),p.invalidateQueries()};return document.addEventListener("visibilitychange",g),window.addEventListener("focus",v),()=>{document.removeEventListener("visibilitychange",g),window.removeEventListener("focus",v)}},[p]),P.useEffect(()=>(s&&m(),()=>{o.current&&(o.current.close(),o.current=null),l.current&&clearTimeout(l.current)}),[m,s])}const{Title:wz,Text:ou}=An,Cz={concept:"purple",evt:"blue",dvt:"cyan",pvt:"orange",mp:"green"},Vx=[{id:"1",type:"bom_review",title:"EVT BOM v1.1 ",project:"nimo Air 2",priority:"high",dueDate:"2026-02-08",icon:i.jsx(Cl,{style:{color:"#faad14"}})},{id:"2",type:"task_due",title:" ",project:"nimo Air 2",priority:"medium",dueDate:"2026-02-10",icon:i.jsx(er,{style:{color:"#1890ff"}})},{id:"3",type:"gate_review",title:"G1 ",project:"nimo Pro",priority:"high",dueDate:"2026-02-12",icon:i.jsx(VR,{style:{color:"#ff4d4f"}})},{id:"4",type:"task_due",title:"BOM  ",project:"nimo Lite",priority:"low",dueDate:"2026-02-15",icon:i.jsx(er,{style:{color:"#1890ff"}})}],Tz={low:"default",medium:"blue",high:"orange",urgent:"red"},jz=()=>{const{user:t}=sd(),e=Ni(),n=Ln();$v({onTaskUpdate:Pn.useCallback(()=>{n.invalidateQueries({queryKey:["projects"]})},[n]),onProjectUpdate:Pn.useCallback(()=>{n.invalidateQueries({queryKey:["projects"]})},[n])});const{data:s,isLoading:o}=ct({queryKey:["projects"],queryFn:()=>Ci.list({page_size:50})}),l=s?.items||[],d=l.filter(p=>p.status==="active"),u=l.filter(p=>p.status==="completed"),h={totalProjects:l.length,activeProjects:d.length,completedProjects:u.length,pendingTodos:Vx.length};return i.jsxs("div",{style:{padding:24},children:[i.jsxs("div",{style:{marginBottom:24},children:[i.jsx(wz,{level:3,style:{margin:0},children:" "}),i.jsxs(ou,{type:"secondary",children:[" ",t?.name," ",lt().format("YYYYMD dddd")]})]}),i.jsxs(kr,{gutter:[16,16],style:{marginBottom:24},children:[i.jsx(ni,{xs:24,sm:12,lg:6,children:i.jsx(Mt,{hoverable:!0,onClick:()=>e("/projects"),children:i.jsx(na,{title:"",value:h.activeProjects,prefix:i.jsx(Iu,{style:{color:"#1890ff"}}),suffix:i.jsxs(ou,{type:"secondary",style:{fontSize:14},children:["/ ",h.totalProjects]})})})}),i.jsx(ni,{xs:24,sm:12,lg:6,children:i.jsx(Mt,{hoverable:!0,children:i.jsx(na,{title:"",value:h.pendingTodos,prefix:i.jsx(Cl,{style:{color:"#faad14"}}),valueStyle:{color:h.pendingTodos>0?"#faad14":void 0}})})}),i.jsx(ni,{xs:24,sm:12,lg:6,children:i.jsx(Mt,{hoverable:!0,children:i.jsx(na,{title:"",value:h.completedProjects,prefix:i.jsx(ra,{style:{color:"#52c41a"}})})})}),i.jsx(ni,{xs:24,sm:12,lg:6,children:i.jsx(Mt,{hoverable:!0,onClick:()=>e("/materials"),children:i.jsx(na,{title:"",value:"",prefix:i.jsx(Ps,{style:{color:"#722ed1"}}),valueStyle:{fontSize:16}})})})]}),i.jsxs(kr,{gutter:[16,16],children:[i.jsx(ni,{xs:24,lg:12,children:i.jsx(Mt,{title:i.jsxs(Be,{children:[i.jsx(Cl,{}),i.jsx("span",{children:""}),i.jsx(Ii,{count:Vx.length,style:{backgroundColor:"#faad14"}})]}),extra:i.jsx(J,{type:"link",size:"small",children:""}),children:i.jsx(wa,{dataSource:Vx,renderItem:p=>i.jsx(wa.Item,{style:{cursor:"pointer",padding:"10px 0"},actions:[i.jsx(_e,{color:Tz[p.priority],children:p.priority==="high"?"":p.priority==="medium"?"":""},"priority")],children:i.jsx(wa.Item.Meta,{avatar:p.icon,title:p.title,description:i.jsxs(Be,{size:8,children:[i.jsx(_e,{style:{fontSize:11},children:p.project}),i.jsxs(ou,{type:"secondary",style:{fontSize:12},children:[": ",p.dueDate]})]})})})})})}),i.jsx(ni,{xs:24,lg:12,children:i.jsx(Mt,{title:i.jsxs(Be,{children:[i.jsx(Iu,{}),i.jsx("span",{children:""})]}),extra:i.jsxs(J,{type:"link",size:"small",onClick:()=>e("/projects"),children:[" ",i.jsx(Oi,{})]}),children:o?i.jsx("div",{style:{textAlign:"center",padding:40},children:"..."}):l.length===0?i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE}):i.jsx(wa,{dataSource:l.slice(0,6),renderItem:p=>i.jsx(wa.Item,{style:{cursor:"pointer",padding:"10px 0"},onClick:()=>e(`/projects/${p.id}`),actions:[i.jsx(Oi,{style:{color:"#ccc"}},"go")],children:i.jsxs("div",{style:{width:"100%",paddingRight:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[i.jsxs(Be,{children:[i.jsx(ou,{strong:!0,children:p.name}),i.jsx(ou,{code:!0,style:{fontSize:11},children:p.code})]}),i.jsx(_e,{color:Cz[p.phase?.toLowerCase()]||"default",children:p.phase?.toUpperCase()})]}),i.jsx(Mi,{percent:p.progress,size:"small",strokeColor:p.progress>=80?"#52c41a":p.progress>=50?"#1890ff":p.progress>=20?"#faad14":"#ff4d4f"})]})})})})})]})]})},{Title:wV}=An,ko=({value:t,onChange:e,mode:n="single",placeholder:s="",style:o})=>{const{data:l=[],isLoading:d}=ct({queryKey:["users"],queryFn:ef.list,staleTime:3e5}),u=l.map(h=>({label:i.jsxs(Be,{size:8,children:[i.jsx(Pi,{size:"small",src:h.avatar_url,icon:i.jsx(wi,{}),children:h.name?.[0]}),i.jsx("span",{children:h.name}),h.email&&i.jsx("span",{style:{color:"#999",fontSize:12},children:h.email})]}),value:h.id,searchLabel:`${h.name} ${h.email||""}`}));return i.jsx(Xe,{showSearch:!0,allowClear:!0,loading:d,placeholder:s,style:o,value:t||void 0,onChange:h=>{e&&e(h)},mode:n==="multiple"?"multiple":void 0,filterOption:(h,p)=>(p?.searchLabel||"").toLowerCase().includes(h.toLowerCase()),options:u,notFoundContent:d?"...":"",optionLabelProp:"label"})},{Title:Ow,Text:lu}=An,Pw={CONCEPT:"purple",EVT:"blue",DVT:"cyan",PVT:"orange",MP:"green"},Ez=()=>{const{user:t}=sd(),e=Ni(),n=Ln(),{message:s,modal:o}=Ya.useApp(),l=Tn(),[d,u]=P.useState(null),[h,p]=P.useState(!1),[m,g]=P.useState(!1),[v,C]=P.useState([]),[b,_]=P.useState(!1),[y]=ee.useForm(),[S]=ee.useForm(),{data:D,isLoading:L}=ct({queryKey:["templates"],queryFn:()=>Wi.list()}),N=P.useMemo(()=>{if(!D)return[];const W=new Map;for(const ne of D){const de=ne.base_code||ne.code||ne.id;W.has(de)||W.set(de,[]),W.get(de).push(ne)}const Q=[];for(const[,ne]of W){const de=ne.reduce(($,X)=>{const le=parseFloat(String(X.version))||0,oe=parseFloat(String($.version))||0;return le>oe?X:$});Q.push(de)}return Q},[D]),T=W=>!W||(W.product_type?.toLowerCase()||"")==="platform"?"platform":"product",j={:"WG",:"CX",:"ZX",:"XR",:"MH",:"HY",:"XH",:"TS",:"YG",:"ZW",:"QL",:"ZQ",:"XW",:"BH",:"QiL",:"FH",:"KP",:"JT",:"TJ",:"HM"},E=(W,Q)=>Q==="platform"&&j[W]||W;P.useEffect(()=>{if(h&&d){const W=T(d);_(!0),bj.list(W,!0).then(Q=>{const ne=[...Q].sort((de,$)=>(de.generation||0)-($.generation||0));if(C(ne),ne.length>0){const de=ne[0],$=new Date().getFullYear(),X=E(de.codename,W),le=W==="platform"?"PLT":"PRD";y.setFieldsValue({codename_id:de.id,project_name:de.codename,project_code:`${le}-${X}-${$}`})}}).catch(()=>{s.warning(""),C([])}).finally(()=>_(!1))}},[h,d]);const R=W=>{const Q=v.find(ne=>ne.id===W);if(Q){const ne=T(d),de=new Date().getFullYear(),$=E(Q.codename,ne),X=ne==="platform"?"PLT":"PRD";y.setFieldsValue({project_name:Q.codename,project_code:`${X}-${$}-${de}`})}},M=W=>T(d)==="platform"?`Gen ${W.generation}: ${W.codename}  ${W.description||W.theme}`:`${W.codename}  ${W.theme}`,I=W=>W.version?`v${W.version}`:"-",z=W=>W?new Date(W).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",V=async()=>{try{const W=await S.validateFields();await Wi.create({name:W.name,description:W.description,product_type:W.product_type}),s.success(""),n.invalidateQueries({queryKey:["templates"]}),g(!1),S.resetFields()}catch(W){if(W?.errorFields)return;s.error(W?.response?.data?.message||"")}},O=W=>{W.status==="published"?o.confirm({title:"",content:i.jsxs("div",{children:[i.jsx("p",{style:{color:"#ff4d4f",fontWeight:"bold"},children:" "}),i.jsxs("p",{children:["",W.name," v",W.version,""]})]}),okText:"",okType:"danger",cancelText:"",onOk:async()=>{try{await Wi.delete(W.id),s.success(""),n.invalidateQueries({queryKey:["templates"]})}catch(ne){s.error(ne?.response?.data?.message||"")}}}):o.confirm({title:"",content:`${W.name}`,okText:"",okType:"danger",cancelText:"",onOk:async()=>{try{await Wi.delete(W.id),s.success(""),n.invalidateQueries({queryKey:["templates"]})}catch(ne){s.error(ne?.response?.data?.message||"")}}})},k=W=>{o.confirm({title:"",content:` v${W.version||1} `,okText:"",okType:"primary",cancelText:"",onOk:async()=>{try{await Wi.publish(W.id),s.success(""),n.invalidateQueries({queryKey:["templates"]})}catch(Q){s.error(Q?.response?.data?.message||"")}}})},F=[{title:"",dataIndex:"code",key:"code",width:150,render:W=>i.jsx(lu,{code:!0,children:W})},{title:"",dataIndex:"name",key:"name",width:250,render:(W,Q)=>i.jsx("a",{onClick:()=>e(`/templates/${Q.id}`),children:Q.version?`${W} v${Q.version}`:W})},{title:"",dataIndex:"version",key:"version",width:100,render:(W,Q)=>I(Q)},{title:"",dataIndex:"status",key:"status",width:100,render:W=>W==="published"?i.jsx(_e,{color:"green",children:""}):i.jsx(_e,{color:"orange",children:""})},{title:"",dataIndex:"product_type",key:"product_type",width:120,render:W=>W||"-"},{title:"",dataIndex:"phases",key:"phases",width:200,render:W=>i.jsx(Be,{size:4,wrap:!0,children:W?.map(Q=>i.jsx(_e,{color:Pw[Q],children:Q},Q))})},{title:"",dataIndex:"estimated_days",key:"estimated_days",width:100,render:W=>`${W}`},{title:"",dataIndex:"published_at",key:"published_at",width:160,render:W=>z(W)},{title:"",dataIndex:"is_active",key:"is_active",width:80,render:W=>i.jsx(Ii,{status:W?"success":"default",text:W?"":""})},{title:"",key:"action",width:380,render:(W,Q)=>{const ne=Q.status==="published",de=!ne,$=de&&!!Q.parent_template_id;return i.jsxs(Be,{size:"small",children:[de&&i.jsxs(i.Fragment,{children:[i.jsx(J,{type:"link",size:"small",icon:i.jsx($u,{}),onClick:()=>e(`/templates/${Q.id}`),children:""}),i.jsx(J,{type:"link",size:"small",icon:i.jsx(Tl,{}),style:{color:"#52c41a"},onClick:()=>k(Q),children:""})]}),ne&&i.jsx(J,{type:"link",size:"small",icon:i.jsx(rr,{}),onClick:()=>e(`/templates/${Q.id}`),children:""}),i.jsx(J,{type:"link",size:"small",icon:i.jsx(TT,{}),disabled:de,onClick:()=>{u(Q),p(!0)},children:""}),$&&i.jsx(Bn,{title:"",description:"",onConfirm:async()=>{try{await Wi.revert(Q.id),s.success(""),n.invalidateQueries({queryKey:["templates"]})}catch(X){s.error(X?.response?.data?.message||"")}},okText:"",cancelText:"",children:i.jsx(J,{type:"link",size:"small",icon:i.jsx(jT,{}),style:{color:"#faad14"},children:""})}),i.jsx(J,{type:"link",size:"small",danger:!0,icon:i.jsx(Zn,{}),onClick:()=>O(Q),children:""})]})}}],A=async()=>{try{const W=await y.validateFields(),Q=await Wi.createProjectFromTemplate({template_id:d.id,project_name:W.project_name,project_code:W.project_code,start_date:W.start_date.format("YYYY-MM-DD"),pm_user_id:W.pm_user_id||t.id,skip_weekends:W.skip_weekends,codename_id:W.codename_id});s.success(""),n.invalidateQueries({queryKey:["projects"]}),p(!1),y.resetFields(),e(`/projects/${Q.id}`)}catch{s.error("")}},q=T(d)==="platform",B=i.jsxs(i.Fragment,{children:[i.jsx(Nt,{title:"",open:m,onCancel:()=>{g(!1),S.resetFields()},onOk:V,okText:"",cancelText:"",width:500,children:i.jsxs(ee,{form:S,layout:"vertical",style:{marginTop:16},children:[i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(Pe.TextArea,{rows:3,placeholder:""})}),i.jsx(ee.Item,{name:"product_type",label:"",children:i.jsx(Xe,{placeholder:"",allowClear:!0,options:[{value:"platform",label:" (Platform)"},{value:"product",label:" (Product)"}]})})]})}),i.jsxs(Nt,{title:` - ${d?.name}${d?.version?` v${d.version}`:""}`,open:h,onCancel:()=>{p(!1),y.resetFields(),C([])},onOk:A,okText:"",width:600,children:[i.jsxs(ee,{form:y,layout:"vertical",style:{marginTop:16},children:[i.jsx(ee.Item,{name:"codename_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",loading:b,onChange:R,notFoundContent:b?i.jsx(tn,{size:"small"}):"",options:v.map(W=>({value:W.id,label:M(W)}))})}),i.jsx(ee.Item,{name:"project_code",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:q?"PLT-WG-2026":"PRD-Nova-2026",disabled:!0})}),i.jsx(ee.Item,{name:"project_name",label:"",children:i.jsx(Pe,{disabled:!0,placeholder:""})}),i.jsx(ee.Item,{name:"start_date",label:"",rules:[{required:!0,message:""}],children:i.jsx(qa,{style:{width:"100%"}})}),i.jsx(ee.Item,{name:"pm_user_id",label:"",rules:[{required:!0,message:""}],initialValue:t?.id,children:i.jsx(ko,{mode:"single",placeholder:"",style:{width:"100%"}})}),i.jsx(ee.Item,{name:"skip_weekends",label:"",initialValue:!0,children:i.jsx(Xe,{options:[{value:!0,label:" - "},{value:!1,label:" - "}]})})]}),i.jsx("div",{style:{background:"#f5f5f5",padding:12,borderRadius:4},children:i.jsxs(lu,{type:"secondary",children:["",d?.name,d?.version?` v${d.version}`:""," ",d?.estimated_days," "]})})]})]});return l?i.jsxs("div",{style:{padding:12},children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:i.jsx(Ow,{level:5,style:{margin:0},children:""})}),L?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:N.map(W=>i.jsx(Mt,{size:"small",style:{cursor:"pointer"},onClick:()=>e(`/templates/${W.id}`),bodyStyle:{padding:12},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsx(lu,{code:!0,style:{fontSize:11},children:W.code}),i.jsx("div",{style:{marginTop:4},children:i.jsxs(lu,{strong:!0,children:[W.name," ",W.version?`v${W.version}`:""]})}),i.jsxs("div",{style:{marginTop:6,display:"flex",flexWrap:"wrap",gap:4,alignItems:"center"},children:[i.jsx(_e,{color:W.status==="published"?"green":"orange",style:{margin:0},children:W.status==="published"?"":""}),W.product_type&&i.jsx(_e,{style:{margin:0},children:W.product_type})]}),i.jsx("div",{style:{marginTop:6,display:"flex",flexWrap:"wrap",gap:4},children:W.phases?.map(Q=>i.jsx(_e,{color:Pw[Q],style:{margin:0,fontSize:11},children:Q},Q))}),W.estimated_days!=null&&i.jsxs(lu,{type:"secondary",style:{fontSize:12,marginTop:4,display:"block"},children:[": ",W.estimated_days,""]})]}),i.jsx(Oi,{style:{color:"#bbb",marginTop:4,flexShrink:0}})]})},W.id))}),i.jsx(J,{type:"primary",shape:"circle",icon:i.jsx(Yt,{}),size:"large",onClick:()=>g(!0),style:{position:"fixed",right:20,bottom:20,width:52,height:52,zIndex:100,boxShadow:"0 4px 12px rgba(0,0,0,0.2)"}}),B]}):i.jsxs("div",{style:{padding:24},children:[i.jsxs(Mt,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx(Be,{size:"middle",align:"center",children:i.jsx(Ow,{level:4,style:{margin:0},children:""})}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>g(!0),children:""})]}),i.jsx(sn,{columns:F,dataSource:N,rowKey:"id",loading:L,pagination:!1,scroll:{x:1500}})]}),B]})},Vn={getForm:async(t,e)=>{try{return(await Z.get(`/projects/${t}/tasks/${e}/form`)).data.data}catch{return null}},upsertForm:async(t,e,n)=>(await Z.put(`/projects/${t}/tasks/${e}/form`,n)).data.data,getSubmission:async(t,e)=>{try{return(await Z.get(`/projects/${t}/tasks/${e}/form/submission`)).data.data}catch{return null}},completeMyTask:async(t,e)=>{await Z.post(`/my/tasks/${t}/complete`,{form_data:e})},confirmTask:async(t,e)=>{await Z.post(`/projects/${t}/tasks/${e}/confirm`)},rejectTask:async(t,e,n)=>{await Z.post(`/projects/${t}/tasks/${e}/reject`,{reason:n})},getTemplateTaskForms:async t=>{try{return(await Z.get(`/templates/${t}/task-forms`)).data.data||[]}catch{return[]}},saveTemplateTaskForm:async(t,e)=>{await Z.post(`/templates/${t}/task-forms`,e)},uploadFile:async t=>{const e=new FormData;return e.append("files",t),(await Z.post("/upload",e)).data.data[0]},saveDraft:async(t,e)=>{await Z.put(`/my/tasks/${t}/form-draft`,{form_data:e})},getDraft:async t=>{try{return(await Z.get(`/my/tasks/${t}/form-draft`)).data.data}catch{return null}},parseBOM:async t=>{const e=new FormData;return e.append("file",t),(await Z.post("/bom/parse",e,{headers:{"Content-Type":"multipart/form-data"}})).data.data}},tr={electronic:"",structural:"",optical:"",packaging:"",tooling:"",consumable:""},Yr={component:"",pcb:"PCB",connector:"",cable:"",structural_part:"",fastener:"",light_engine:"",waveguide:"",lens:"",lightguide:"",box:"",document:"/",cushion:"/",mold:"",fixture:"/",consumable:""},Kc={electronic:["component","pcb","connector","cable"],structural:["structural_part","fastener"],optical:["light_engine","waveguide","lens","lightguide"],packaging:["box","document","cushion"],tooling:["mold","fixture"],consumable:["consumable"]},ku=["electronic","structural","optical"],Bu=["packaging","tooling","consumable"],oE=[...ku,...Bu],xl=["name","quantity","unit","supplier","unit_price","extended_cost","notes"],{Text:Fa}=An;function Az(t,e){return{bom_type:t.bom_type||e,visible_categories:Array.isArray(t.visible_categories)?t.visible_categories:[],category_config:t.category_config||{},show_route_editor:t.show_route_editor,editable_scrap_rate:t.editable_scrap_rate,show_freeze_button:t.show_freeze_button}}const Rz=({bomType:t,config:e,onChange:n})=>{const s=P.useMemo(()=>Az(e,t),[e,t]),[o,l]=P.useState([]),[d,u]=P.useState(!1),[h,p]=P.useState([...s.visible_categories]),m=P.useRef(s);m.current=s;const g=P.useMemo(()=>t==="EBOM"?ku:t==="PBOM"?Bu:oE,[t]);P.useEffect(()=>{if(s.visible_categories.length===0){l([]);return}let j=!1;return(async()=>{u(!0);try{const R=s.visible_categories.map(I=>Zt.listTemplates({category:I}).catch(()=>[])),M=await Promise.all(R);j||l(M.flat())}catch{}finally{j||u(!1)}})(),()=>{j=!0}},[s.visible_categories]),P.useEffect(()=>{if(o.length===0)return;const j=m.current;if(j.visible_categories.length===0)return;let E=!1;const R={...j.category_config};for(const M of j.visible_categories){const I=R[M];if(!I)continue;const z=I.enabled_sub_categories||[];let V=!1;const O={...I.field_order};for(const k of z)if(!O[k]||O[k].length===0){const F=o.filter(A=>A.category===M&&A.sub_category===k&&!xl.includes(A.field_key));F.length>0&&(O[k]=F.sort((A,q)=>A.sort_order-q.sort_order).map(A=>A.field_key),V=!0)}V&&(R[M]={...I,field_order:O},E=!0)}E&&n({...j,category_config:R})},[o]);const v=P.useMemo(()=>{const j=new Map;for(const E of o){const R=`${E.category}::${E.sub_category}`;j.has(R)||j.set(R,{category:E.category,sub_category:E.sub_category,fields:[]}),j.get(R).fields.push(E)}for(const E of j.values())E.fields.sort((R,M)=>R.sort_order-M.sort_order);return j},[o]),C=P.useCallback(j=>s.category_config[j]||{enabled_sub_categories:[],sub_category_order:[],field_order:{}},[s.category_config]),b=P.useCallback(j=>{const E={...s.category_config};for(const R of s.visible_categories)j.includes(R)||delete E[R];for(const R of j)if(!s.visible_categories.includes(R)){const M=Kc[R]||[],I={};for(const z of M){const V=o.filter(O=>O.category===R&&O.sub_category===z&&!xl.includes(O.field_key));V.length>0&&(I[z]=V.sort((O,k)=>O.sort_order-k.sort_order).map(O=>O.field_key))}E[R]={enabled_sub_categories:[...M],sub_category_order:[...M],field_order:I},p(z=>z.includes(R)?z:[...z,R])}n({...s,visible_categories:j,category_config:E})},[s,n,o]),_=P.useCallback((j,E,R)=>{const M=C(j);if(R){const I=[...M.enabled_sub_categories,E],z=M.sub_category_order.includes(E)?[...M.sub_category_order]:[...M.sub_category_order,E],V=o.filter(k=>k.category===j&&k.sub_category===E&&!xl.includes(k.field_key)),O={...M.field_order};V.length>0&&(O[E]=V.sort((k,F)=>k.sort_order-F.sort_order).map(k=>k.field_key)),n({...s,category_config:{...s.category_config,[j]:{...M,enabled_sub_categories:I,sub_category_order:z,field_order:O}}})}else{const I=M.enabled_sub_categories.filter(V=>V!==E),z={...M.field_order};delete z[E],n({...s,category_config:{...s.category_config,[j]:{...M,enabled_sub_categories:I,field_order:z}}})}},[s,C,n,o]),y=P.useCallback((j,E,R,M)=>{const I=C(j),z=I.field_order[E]||[];let V;M?V=[...z,R]:V=z.filter(O=>O!==R),n({...s,category_config:{...s.category_config,[j]:{...I,field_order:{...I.field_order,[E]:V}}}})},[s,C,n]),S=P.useCallback((j,E,R,M)=>{const I=C(j),z=[...I.field_order[E]||[]],V=z.indexOf(R);if(V<0)return;const O=M==="up"?V-1:V+1;O<0||O>=z.length||([z[V],z[O]]=[z[O],z[V]],n({...s,category_config:{...s.category_config,[j]:{...I,field_order:{...I.field_order,[E]:z}}}}))},[s,C,n]),D=P.useCallback((j,E,R)=>{const M=C(j),I=[...M.sub_category_order],z=I.indexOf(E);if(z<0)return;const V=R==="up"?z-1:z+1;V<0||V>=I.length||([I[z],I[V]]=[I[V],I[z]],n({...s,category_config:{...s.category_config,[j]:{...M,sub_category_order:I}}}))},[s,C,n]),L=(j,E)=>{const R=`${j}::${E}`,M=v.get(R),z=C(j).field_order[E]||[];if(!M||M.fields.length===0)return i.jsx("div",{style:{padding:"4px 0 4px 24px"},children:i.jsx(Fa,{type:"secondary",style:{fontSize:12},children:""})});const V=M.fields.filter(k=>!xl.includes(k.field_key));if(V.length===0)return i.jsx("div",{style:{padding:"4px 0 4px 24px"},children:i.jsx(Fa,{type:"secondary",style:{fontSize:12},children:""})});const O=[...V].sort((k,F)=>k.sort_order-F.sort_order);return i.jsx("div",{style:{padding:"4px 0 4px 24px"},children:O.map(k=>{const F=z.includes(k.field_key),A=z.indexOf(k.field_key);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"2px 0",borderBottom:"1px solid #f5f5f5"},children:[i.jsx(pa,{checked:F,onChange:q=>{q.stopPropagation(),y(j,E,k.field_key,q.target.checked)}}),i.jsxs(Fa,{style:{flex:1,fontSize:13},children:[k.field_name,k.unit&&i.jsxs(Fa,{type:"secondary",style:{fontSize:11,marginLeft:4},children:["(",k.unit,")"]}),k.required&&i.jsx(Fa,{type:"danger",style:{fontSize:11,marginLeft:2},children:"*"})]}),i.jsx(Fa,{type:"secondary",style:{fontSize:11,width:40,textAlign:"center"},children:k.field_type}),F&&i.jsxs("span",{style:{display:"inline-flex",gap:2},children:[i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(Ru,{style:{fontSize:10}}),disabled:A===0,onClick:q=>{q.stopPropagation(),S(j,E,k.field_key,"up")},style:{width:20,height:20,padding:0}})}),i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(No,{style:{fontSize:10}}),disabled:A===z.length-1,onClick:q=>{q.stopPropagation(),S(j,E,k.field_key,"down")},style:{width:20,height:20,padding:0}})})]})]},k.field_key)})})},N=j=>{const E=Kc[j]||[],R=C(j),M=R.enabled_sub_categories;return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:2},children:E.map(I=>{const z=M.includes(I),V=R.sub_category_order.indexOf(I);return i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"4px 0",background:z?"#fafafa":"transparent",borderRadius:4,paddingLeft:4},children:[i.jsx(pa,{checked:z,onChange:O=>{O.stopPropagation(),_(j,I,O.target.checked)}}),i.jsx(Fa,{style:{flex:1,fontSize:13,fontWeight:z?500:400},children:Yr[I]||I}),z&&V>=0&&i.jsxs("span",{style:{display:"inline-flex",gap:2,marginRight:4},children:[i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(Ru,{style:{fontSize:10}}),disabled:V<=0,onClick:O=>{O.stopPropagation(),D(j,I,"up")},style:{width:20,height:20,padding:0}})}),i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(No,{style:{fontSize:10}}),disabled:V<0||V===R.sub_category_order.length-1,onClick:O=>{O.stopPropagation(),D(j,I,"down")},style:{width:20,height:20,padding:0}})})]})]}),z&&L(j,I)]},I)})})},T=s.visible_categories.filter(j=>g.includes(j)).map(j=>({key:j,label:i.jsx(Fa,{strong:!0,style:{fontSize:13},children:tr[j]||j}),children:N(j)}));return i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{children:[i.jsx(Fa,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:""}),i.jsx(pa.Group,{value:s.visible_categories,onChange:j=>b(j),style:{display:"flex",flexWrap:"wrap",gap:8},children:g.map(j=>i.jsx(pa,{value:j,children:tr[j]||j},j))})]}),s.visible_categories.length>0&&i.jsx("div",{children:d?i.jsxs("div",{style:{textAlign:"center",padding:16},children:[i.jsx(tn,{size:"small"}),i.jsx(Fa,{type:"secondary",style:{marginLeft:8,fontSize:12},children:"..."})]}):i.jsx(i.Fragment,{children:T.length>0?i.jsx(qR,{size:"small",items:T,activeKey:h,onChange:j=>p(j),style:{background:"#fff"}}):i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE})})}),t==="PBOM"&&i.jsx("div",{style:{borderTop:"1px solid #f0f0f0",paddingTop:8},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Br,{size:"small",checked:!!s.show_route_editor,onChange:j=>n({...s,show_route_editor:j})}),i.jsx(Fa,{style:{fontSize:13},children:""})]})}),t==="MBOM"&&i.jsxs("div",{style:{borderTop:"1px solid #f0f0f0",paddingTop:8,display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Br,{size:"small",checked:!!s.editable_scrap_rate,onChange:j=>n({...s,editable_scrap_rate:j})}),i.jsx(Fa,{style:{fontSize:13},children:""})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Br,{size:"small",checked:!!s.show_freeze_button,onChange:j=>n({...s,show_freeze_button:j})}),i.jsx(Fa,{style:{fontSize:13},children:"/"})]})]})]})},Dz=[{id:"",code:"project_manager",name:"",sort_order:1},{id:"",code:"hardware_engineer",name:"",sort_order:2},{id:"",code:"software_engineer",name:"",sort_order:3},{id:"",code:"mechanical_engineer",name:"",sort_order:4},{id:"",code:"quality_engineer",name:"",sort_order:5},{id:"",code:"reviewer",name:"",sort_order:6}],lE=Dz.map(t=>({code:t.code,label:t.name})),Wv={list:async()=>(await Z.get("/task-roles")).data.data?.items||[]},{Title:Iz,Text:Gn}=An,Ah=["CONCEPT","EVT","DVT","PVT","MP"],Oz={CONCEPT:"purple",EVT:"blue",DVT:"cyan",PVT:"orange",MP:"green"},Pz={CONCEPT:"Concept",EVT:"EVT",DVT:"DVT",PVT:"PVT",MP:"MP"},Lw=[{value:"MILESTONE",label:""},{value:"TASK",label:""},{value:"SUBTASK",label:""}],Nw=({value:t,onChange:e,placeholder:n,style:s,readOnly:o})=>{const[l,d]=P.useState(!1),[u,h]=P.useState(t),p=P.useRef(null);return P.useEffect(()=>{h(t)},[t]),P.useEffect(()=>{l&&p.current?.focus()},[l]),o?i.jsx("div",{style:{padding:"1px 7px",minHeight:24,lineHeight:"24px",...s},children:t||i.jsx("span",{style:{color:"#bfbfbf"},children:"-"})}):l?i.jsx(Pe,{ref:p,size:"small",value:u,placeholder:n,style:{...s,minWidth:80},onChange:m=>h(m.target.value),onBlur:()=>{d(!1),u!==t&&e(u)},onPressEnter:()=>{d(!1),u!==t&&e(u)}}):i.jsx("div",{onClick:()=>d(!0),style:{cursor:"pointer",padding:"1px 7px",borderRadius:4,minHeight:24,lineHeight:"24px",border:"1px solid transparent",...s},onMouseEnter:m=>{m.currentTarget.style.borderColor="#d9d9d9"},onMouseLeave:m=>{m.currentTarget.style.borderColor="transparent"},children:t||i.jsx("span",{style:{color:"#bfbfbf"},children:n||""})})},qx=({value:t,onChange:e,options:n,placeholder:s,allowClear:o,style:l,readOnly:d})=>{const[u,h]=P.useState(!1),p=P.useRef(null);if(P.useEffect(()=>{u&&setTimeout(()=>p.current?.focus(),50)},[u]),d){const g=n.find(v=>v.value===t)?.label||t;return i.jsx("div",{style:{padding:"1px 7px",minHeight:24,lineHeight:"24px",...l},children:t?g:i.jsx("span",{style:{color:"#bfbfbf"},children:"-"})})}if(u)return i.jsx(Xe,{ref:p,size:"small",value:t||void 0,placeholder:s,options:n,allowClear:o,style:{minWidth:100,...l},onChange:g=>{e(g||""),h(!1)},onBlur:()=>h(!1),open:!0});const m=n.find(g=>g.value===t)?.label||t;return i.jsx("div",{onClick:()=>h(!0),style:{cursor:"pointer",padding:"1px 7px",borderRadius:4,minHeight:24,lineHeight:"24px",border:"1px solid transparent",...l},onMouseEnter:g=>{g.currentTarget.style.borderColor="#d9d9d9"},onMouseLeave:g=>{g.currentTarget.style.borderColor="transparent"},children:t?m:i.jsx("span",{style:{color:"#bfbfbf"},children:s||""})})},Lz=({value:t,onChange:e,min:n=0,style:s,readOnly:o})=>{const[l,d]=P.useState(!1),u=P.useRef(null);return P.useEffect(()=>{l&&u.current?.focus()},[l]),o?i.jsx("div",{style:{padding:"1px 7px",minHeight:24,lineHeight:"24px",textAlign:"center",...s},children:t}):l?i.jsx(en,{ref:u,size:"small",value:t,min:n,style:{width:70,...s},onChange:h=>{h!==null&&h!==t&&e(h)},onBlur:()=>d(!1),onPressEnter:()=>d(!1)}):i.jsx("div",{onClick:()=>d(!0),style:{cursor:"pointer",padding:"1px 7px",borderRadius:4,minHeight:24,lineHeight:"24px",border:"1px solid transparent",textAlign:"center",...s},onMouseEnter:h=>{h.currentTarget.style.borderColor="#d9d9d9"},onMouseLeave:h=>{h.currentTarget.style.borderColor="transparent"},children:t})};function Nz(t){const e=new Map,n=[];t.forEach(l=>{l.parent_task_code?(e.has(l.parent_task_code)||e.set(l.parent_task_code,[]),e.get(l.parent_task_code).push(l)):n.push(l)});const s=[],o=(l,d)=>{l._depth=d,s.push(l);const u=e.get(l.task_code)||[];u.sort((h,p)=>(h.sort_order||0)-(p.sort_order||0)),u.forEach(h=>o(h,d+1))};return n.forEach(l=>o(l,0)),s}const Fz=()=>{const{id:t}=td(),e=Ni(),{user:n}=sd(),s=Ln(),{message:o,modal:l}=Ya.useApp(),[d,u]=P.useState([]),[h,p]=P.useState(""),[m,g]=P.useState(!1),[v,C]=P.useState(!1),[b,_]=P.useState(!1),[y,S]=P.useState({}),[D,L]=P.useState(!1),[N,T]=P.useState(!1),[j,E]=P.useState(""),[R,M]=P.useState(!1),[I,z]=P.useState(!1),[V,O]=P.useState(!1),[k,F]=P.useState([]),[A,q]=P.useState(!1),[B]=ee.useForm(),[W,Q]=P.useState(!1),[ne,de]=P.useState(null),[$,X]=P.useState([]),[le,oe]=P.useState(!1),[ue,Ye]=P.useState({}),ae=P.useRef(null),{data:fe,isLoading:pt,isError:_t}=ct({queryKey:["template",t],queryFn:()=>Wi.get(t),enabled:!!t}),{data:Se=[]}=ct({queryKey:["template-versions",t],queryFn:()=>Wi.listVersions(t),enabled:!!t}),{data:$e}=ct({queryKey:["approval-definitions"],queryFn:()=>Rs.list()}),{data:jt=[]}=ct({queryKey:["task-roles"],queryFn:()=>Wv.list()}),Fe=P.useMemo(()=>jt.map(be=>({value:be.code,label:be.name})),[jt]);P.useEffect(()=>{t&&Vn.getTemplateTaskForms(t).then(be=>{const et={};for(const ze of be)try{et[ze.task_code]=typeof ze.fields=="string"?JSON.parse(ze.fields):ze.fields}catch{et[ze.task_code]=[]}Ye(et)})},[t]);const Dt=P.useMemo(()=>$e?.groups?$e.groups.flatMap(be=>be.definitions.filter(et=>et.status==="published").map(et=>({...et,group_name:be.name}))):[],[$e]),te=fe?.status==="published",bt=!te,It=P.useMemo(()=>{if(!fe||Se.length===0)return!0;const be=Se.reduce((ze,Qe)=>{const Ht=parseFloat(String(Qe.version))||0;return Ht>ze?Ht:ze},0);return(parseFloat(String(fe.version))||0)>=be},[fe,Se]),tt=te&&!It,nt=bt&&!!fe?.parent_template_id;P.useEffect(()=>{if(fe){p(fe.name);const be=(fe.tasks||[]).map((et,ze)=>({...et,phase:(et.phase||"").toUpperCase(),_key:et.id||`existing-${ze}`,_depends_on:(et.dependencies||[]).map(Qe=>Qe.depends_on_task_code)}));u(be),C(!1)}},[fe]),P.useEffect(()=>{m&&ae.current?.focus()},[m]);const G=P.useCallback(()=>{C(!0)},[]),H=P.useCallback((be,et,ze)=>{tt||(u(Qe=>Qe.map(Ht=>{if(Ht._key!==be)return Ht;const Gt={...Ht,[et]:ze};return et==="parent_task_code"&&(ze?Gt.task_type="SUBTASK":Ht.task_type==="SUBTASK"&&(Gt.task_type="TASK")),Gt})),G())},[G,tt]),ie=P.useCallback(be=>{tt||(u(et=>et.filter(ze=>ze._key!==be)),G())},[G,tt]),we=P.useCallback(be=>{if(tt)return;const et=d.filter(yt=>yt.phase===be),ze=et.length>0?Math.max(...et.map(yt=>yt.sort_order)):0,Qe=be==="CONCEPT"?"CON":be,Ht=d.filter(yt=>yt.phase===be&&yt.task_type!=="SUBTASK").map(yt=>{const an=yt.task_code?.match(/-(\d+)$/);return an?parseInt(an[1],10):0}),Gt=Ht.length>0?Math.max(...Ht)+1:1,dn=`${Qe}-${String(Gt).padStart(3,"0")}`,gn={_key:`new-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,task_code:dn,name:"",phase:be,task_type:"TASK",parent_task_code:"",default_assignee_role:"",estimated_days:1,is_critical:!1,requires_approval:!1,auto_create_feishu_task:!1,feishu_approval_code:"",sort_order:ze+1};u(yt=>[...yt,gn]),G()},[d,G,tt]),Ce=P.useCallback(be=>{if(tt)return;const ze=d.filter(an=>an.parent_task_code===be.task_code).map(an=>{const jn=an.task_code?.match(/-(\d+)$/);return jn?parseInt(jn[1],10):0}),Qe=ze.length>0?Math.max(...ze)+1:1,Ht=`${be.task_code}-${String(Qe).padStart(2,"0")}`,Gt=d.filter(an=>an.phase===be.phase),dn=Gt.length>0?Math.max(...Gt.map(an=>an.sort_order)):0,gn=`new-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,yt={_key:gn,task_code:Ht,name:"",phase:be.phase,task_type:"SUBTASK",parent_task_code:be.task_code,default_assignee_role:be.default_assignee_role||"",estimated_days:1,is_critical:!1,requires_approval:!1,auto_create_feishu_task:!1,feishu_approval_code:"",sort_order:dn+1};u(an=>[...an,yt]),G(),setTimeout(()=>{const an=document.querySelector(`[data-task-key="${gn}"] .editable-name-trigger`);an&&an.click()},100)},[d,G,tt]),ge=P.useCallback((be,et)=>{tt||(u(ze=>{const Qe=ze.findIndex(Vt=>Vt._key===be);if(Qe<0)return ze;const Gt=ze[Qe].phase,dn=ze.map((Vt,ca)=>Vt.phase===Gt?ca:-1).filter(Vt=>Vt>=0),gn=dn.indexOf(Qe);let yt;if(et==="up"){if(gn<=0)return ze;yt=dn[gn-1]}else{if(gn>=dn.length-1)return ze;yt=dn[gn+1]}const an=[...ze],jn=an[Qe].sort_order;return an[Qe]={...an[Qe],sort_order:an[yt].sort_order},an[yt]={...an[yt],sort_order:jn},[an[Qe],an[yt]]=[an[yt],an[Qe]],an}),G())},[G,tt]),je=P.useMemo(()=>{const be={};for(const et of Ah)be[et]=d.filter(ze=>ze.phase===et&&(ze.task_type==="MILESTONE"||ze.task_type==="TASK")).map(ze=>({value:ze.task_code,label:`${ze.task_code} - ${ze.name||"()"}`}));return be},[d]),He=P.useMemo(()=>{const be={};for(const et of Ah)be[et]=d.filter(ze=>ze.phase===et).map(ze=>({value:ze.task_code,label:`${ze.task_code} - ${ze.name||"()"}`}));return be},[d]),dt=P.useMemo(()=>{const be={};for(const et of Ah){const ze=d.filter(Qe=>Qe.phase===et).sort((Qe,Ht)=>Qe.sort_order-Ht.sort_order);be[et]=Nz(ze)}return be},[d]),gt=()=>d.map((be,et)=>({task_code:be.task_code,name:be.name,phase:be.phase,task_type:be.task_type,parent_task_code:be.parent_task_code||"",default_assignee_role:be.default_assignee_role||"",estimated_days:be.estimated_days,is_critical:be.is_critical,requires_approval:be.requires_approval,auto_create_feishu_task:be.auto_create_feishu_task||!1,feishu_approval_code:be.feishu_approval_code||"",sort_order:et,description:be.description||"",depends_on:be._depends_on||[],is_locked:be.is_locked||!1})),We=async()=>{if(!(!t||tt)){if(te&&It){E(""),T(!0);return}_(!0);try{const be=gt();await Wi.batchSaveTasks(t,be),o.success(""),C(!1),s.invalidateQueries({queryKey:["template",t]}),s.invalidateQueries({queryKey:["templates"]})}catch(be){o.error(be?.response?.data?.message||"")}finally{_(!1)}}},qe=async()=>{if(!t||!fe||!j.trim())return;const be=parseFloat(String(fe.version))||0,et=parseFloat(j.trim());if(isNaN(et)||et<=be){o.error(` ${fe.version}`);return}M(!0);try{const ze=await Wi.upgrade(t,j.trim()),Qe=gt();await Wi.batchSaveTasks(ze.id,Qe);for(const[Ht,Gt]of Object.entries(ue))Gt&&Gt.length>0&&await Vn.saveTemplateTaskForm(ze.id,{task_code:Ht,name:"",fields:Gt});h!==fe.name&&await Wi.update(ze.id,{name:h.trim()}),o.success(` v${j.trim()}`),s.invalidateQueries({queryKey:["templates"]}),T(!1),e(`/templates/${ze.id}`)}catch(ze){o.error(ze?.response?.data?.message||"")}finally{M(!1)}},at=()=>{t&&l.confirm({title:"",content:"",okText:"",okType:"danger",cancelText:"",onOk:async()=>{try{const be=await Wi.revert(t);o.success(""),s.invalidateQueries({queryKey:["templates"]}),e(`/templates/${be.id}`)}catch(be){o.error(be?.response?.data?.message||"")}}})},ot=async()=>{if(!(!t||!h.trim())){try{await Wi.update(t,{name:h.trim()}),o.success(""),s.invalidateQueries({queryKey:["template",t]}),s.invalidateQueries({queryKey:["templates"]})}catch{o.error("")}g(!1)}},st=()=>{!t||!fe||l.confirm({title:"",content:` v${fe.version||1} `,okText:"",okType:"primary",cancelText:"",onOk:async()=>{L(!0);try{await Wi.publish(t),o.success(""),s.invalidateQueries({queryKey:["template",t]}),s.invalidateQueries({queryKey:["template-versions",t]}),s.invalidateQueries({queryKey:["templates"]})}catch(be){o.error(be?.response?.data?.message||"")}finally{L(!1)}}})},it={:"WG",:"CX",:"ZX",:"XR",:"MH",:"HY",:"XH",:"TS",:"YG",:"ZW",:"QL",:"ZQ",:"XW",:"BH",:"QiL",:"FH",:"KP",:"JT",:"TJ",:"HM"},re=()=>!fe||(fe.product_type?.toLowerCase()||"")==="platform"?"platform":"product",rt=(be,et)=>et==="platform"&&it[be]||be,Ze=be=>re()==="platform"?`Gen ${be.generation}: ${be.codename}  ${be.description||be.theme}`:`${be.codename}  ${be.theme}`,ht=be=>{const et=k.find(ze=>ze.id===be);if(et){const ze=re(),Qe=new Date().getFullYear(),Ht=rt(et.codename,ze),Gt=ze==="platform"?"PLT":"PRD";B.setFieldsValue({project_name:et.codename,project_code:`${Gt}-${Ht}-${Qe}`})}};P.useEffect(()=>{if(V&&fe){const be=re();q(!0),bj.list(be,!0).then(et=>{const ze=[...et].sort((Qe,Ht)=>(Qe.generation||0)-(Ht.generation||0));if(F(ze),ze.length>0){const Qe=ze[0],Ht=new Date().getFullYear(),Gt=rt(Qe.codename,be),dn=be==="platform"?"PLT":"PRD";B.setFieldsValue({codename_id:Qe.id,project_name:Qe.codename,project_code:`${dn}-${Gt}-${Ht}`})}}).catch(()=>{o.warning(""),F([])}).finally(()=>q(!1))}},[V,fe]);const Ke=async()=>{try{const be=await B.validateFields(),et=be.pm_user_id||n.id,ze=await Wi.createProjectFromTemplate({template_id:t,project_name:be.project_name,project_code:be.project_code,start_date:be.start_date.format("YYYY-MM-DD"),pm_user_id:et,skip_weekends:be.skip_weekends,codename_id:be.codename_id,role_assignments:{pm:et}});o.success(""),s.invalidateQueries({queryKey:["projects"]}),O(!1),B.resetFields(),e(`/projects/${ze.id}`)}catch{o.error("")}},Ue=[{value:"text",label:""},{value:"textarea",label:""},{value:"number",label:""},{value:"select",label:""},{value:"date",label:""},{value:"file",label:""},{value:"checkbox",label:""},{value:"user",label:""},{value:"role_assignment",label:""},{value:"ebom_control",label:"EBOM"},{value:"pbom_control",label:"PBOM"},{value:"mbom_control",label:"MBOM"},{value:"cmf",label:"CMF"},{value:"tooling_list",label:""},{value:"consumable_list",label:""},{value:"procurement_control",label:""}],Je=be=>{de(be);const et=ue[be.task_code]||[];X(et.length>0?et.map(ze=>({...ze})):[]),Q(!0)},ye=()=>{const be=$.length+1;X([...$,{key:`field_${be}`,label:"",type:"text",required:!1}])},ut=(be,et)=>{X(ze=>ze.map((Qe,Ht)=>Ht===be?{...Qe,...et}:Qe))},Et=be=>{X(et=>et.filter((ze,Qe)=>Qe!==be))},si=(be,et)=>{if(et==="up"&&be===0||et==="down"&&be===$.length-1)return;const ze=[...$],Qe=et==="up"?be-1:be+1;[ze[be],ze[Qe]]=[ze[Qe],ze[be]],X(ze)},la=async()=>{if(!(!t||!ne)){oe(!0);try{await Vn.saveTemplateTaskForm(t,{task_code:ne.task_code,name:"",fields:$}),Ye(be=>({...be,[ne.task_code]:$})),o.success(""),Q(!1)}catch{o.error("")}finally{oe(!1)}}},hs=be=>be?new Date(be).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";if(pt)return i.jsx("div",{style:{padding:24,textAlign:"center",marginTop:100},children:i.jsx(tn,{size:"large",tip:"..."})});if(_t||!fe)return i.jsxs("div",{style:{padding:24,textAlign:"center",marginTop:100},children:[i.jsx(Gn,{type:"danger",children:""}),i.jsx("br",{}),i.jsx(J,{type:"link",onClick:()=>e("/templates"),children:""})]});const or=re()==="platform";return i.jsxs("div",{style:{padding:24},children:[bt&&i.jsx(Ur,{message:"",type:"warning",showIcon:!0,banner:!0,style:{marginBottom:16}}),tt&&i.jsx(Ur,{message:"",type:"info",showIcon:!0,banner:!0,style:{marginBottom:16}}),i.jsx(Mt,{style:{marginBottom:16},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs(Be,{size:"middle",align:"center",children:[i.jsx(J,{icon:i.jsx(Ls,{}),onClick:()=>e("/templates"),type:"text"}),i.jsxs("div",{children:[m&&!tt?i.jsxs(Be,{children:[i.jsx(Pe,{ref:ae,value:h,onChange:be=>p(be.target.value),onPressEnter:ot,style:{fontSize:20,fontWeight:600,width:300}}),i.jsx(J,{icon:i.jsx(ET,{}),size:"small",type:"primary",onClick:ot}),i.jsx(J,{icon:i.jsx(Wu,{}),size:"small",onClick:()=>{g(!1),p(fe.name)}})]}):i.jsx(Be,{align:"center",children:i.jsxs(Iz,{level:4,style:{margin:0,cursor:tt?"default":"pointer"},onClick:()=>!tt&&g(!0),children:[h,!tt&&i.jsx($u,{style:{fontSize:14,marginLeft:8,color:"#999"}})]})}),i.jsxs(Be,{size:"small",style:{marginTop:4},children:[i.jsxs(_e,{color:"blue",children:["v",fe.version||1]}),bt?i.jsx(_e,{color:"orange",children:""}):i.jsx(_e,{color:"green",children:""}),fe.product_type&&i.jsx(_e,{children:fe.product_type}),i.jsxs(Gn,{type:"secondary",style:{fontSize:12},children:[fe.tasks?.length||d.length,"    ",fe.estimated_days," "]}),te&&fe.published_at&&i.jsxs(Gn,{type:"secondary",style:{fontSize:12},children:["  ",hs(fe.published_at)]})]})]})]}),i.jsxs(Be,{children:[i.jsx(J,{icon:i.jsx(Fp,{}),onClick:()=>z(!0),children:""}),bt&&i.jsx(J,{type:"primary",icon:i.jsx(Tl,{}),loading:D,onClick:st,style:{backgroundColor:"#52c41a",borderColor:"#52c41a"},children:""}),te&&i.jsx(J,{icon:i.jsx(TT,{}),onClick:()=>O(!0),children:""}),nt&&i.jsx(J,{icon:i.jsx(jT,{}),danger:!0,onClick:at,children:""}),!tt&&i.jsx(Ii,{dot:v,offset:[-4,4],children:i.jsx(J,{type:v?"primary":"default",icon:i.jsx(AT,{}),loading:b,onClick:We,children:te?"":""})})]})]})}),i.jsx(Mt,{title:"",bodyStyle:{padding:0},style:tt?{background:"#fafafa"}:void 0,children:Ah.filter(be=>fe.phases?.includes(be)||(dt[be]?.length||0)>0).map(be=>{const et=dt[be]||[],ze=y[be]||!1;return i.jsxs("div",{style:{borderBottom:"1px solid #f0f0f0"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"#fafafa",cursor:"pointer",userSelect:"none"},onClick:()=>S(Qe=>({...Qe,[be]:!Qe[be]})),children:[i.jsxs(Be,{children:[ze?i.jsx(No,{style:{fontSize:10}}):i.jsx(Ru,{style:{fontSize:10}}),i.jsx(_e,{color:Oz[be],style:{margin:0},children:Pz[be]}),i.jsxs(Gn,{type:"secondary",style:{fontSize:12},children:[et.length," "]})]}),!tt&&i.jsx(J,{type:"link",size:"small",icon:i.jsx(Yt,{}),onClick:Qe=>{Qe.stopPropagation(),we(be),S(Ht=>({...Ht,[be]:!1}))},children:""})]}),!ze&&i.jsxs("div",{children:[et.length>0&&i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 16px",background:"#f5f5f5",fontSize:12,color:"#8c8c8c",fontWeight:500,borderBottom:"1px solid #f0f0f0"},children:[!tt&&i.jsx("div",{style:{width:40}}),i.jsx("div",{style:{width:120,flexShrink:0},children:""}),i.jsx("div",{style:{flex:1,minWidth:150},children:""}),i.jsx("div",{style:{width:100,flexShrink:0},children:""}),i.jsx("div",{style:{width:150,flexShrink:0},children:""}),i.jsx("div",{style:{width:150,flexShrink:0},children:""}),i.jsx("div",{style:{width:120,flexShrink:0},children:""}),i.jsx("div",{style:{width:70,flexShrink:0,textAlign:"center"},children:"()"}),i.jsx("div",{style:{width:60,flexShrink:0,textAlign:"center"},children:""}),i.jsx("div",{style:{width:200,flexShrink:0,textAlign:"center"},children:""}),i.jsx("div",{style:{width:90,flexShrink:0,textAlign:"center"},children:tt?"":""})]}),et.map(Qe=>{const Ht=Qe.task_type==="MILESTONE",Gt=!!Qe.is_locked,dn=!!Qe.parent_task_code,gn=Qe._depth||0,yt=Qe.task_type==="MILESTONE"||Qe.task_type==="TASK",an=dn?Lw.filter(Vt=>Vt.value!=="MILESTONE"):Lw,jn=je[Qe.phase]||[];return i.jsxs("div",{"data-task-key":Qe._key,style:{display:"flex",alignItems:"center",padding:"4px 16px",borderBottom:"1px solid #f0f0f0",background:tt?"#f9f9f9":gn>0?"#fcfcfc":Ht?"#f6f8fa":"white",fontWeight:Ht?600:400,fontSize:13,minHeight:40,paddingLeft:16+gn*24},children:[!tt&&i.jsxs("div",{style:{width:40,display:"flex",flexDirection:"column",alignItems:"center",gap:0},children:[i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(Ru,{style:{fontSize:10}}),style:{height:16,width:24,padding:0},onClick:()=>ge(Qe._key,"up")})}),i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(No,{style:{fontSize:10}}),style:{height:16,width:24,padding:0},onClick:()=>ge(Qe._key,"down")})})]}),i.jsxs("div",{style:{width:120,flexShrink:0},children:[gn>0&&i.jsxs("span",{style:{color:"#bfbfbf",marginRight:4,fontSize:12,fontFamily:"monospace"},children:[" ".repeat(gn-1),""]}),i.jsx(Nw,{value:Qe.task_code,onChange:Vt=>H(Qe._key,"task_code",Vt),placeholder:"",style:{fontFamily:"monospace",fontSize:12,display:"inline-block"},readOnly:tt||Gt})]}),i.jsx("div",{className:"editable-name-trigger",style:{flex:1,minWidth:150,display:"flex",alignItems:"center",gap:4},children:i.jsx(Nw,{value:Qe.name,onChange:Vt=>H(Qe._key,"name",Vt),placeholder:"",style:Ht?{fontWeight:600}:void 0,readOnly:tt||Gt})}),i.jsx("div",{style:{width:100,flexShrink:0},children:i.jsx(qx,{value:Qe.task_type,onChange:Vt=>H(Qe._key,"task_type",Vt),options:an,readOnly:tt||dn||Gt})}),i.jsx("div",{style:{width:150,flexShrink:0},children:i.jsx(qx,{value:Qe.parent_task_code||"",onChange:Vt=>H(Qe._key,"parent_task_code",Vt),options:[{value:"",label:""},...jn.filter(Vt=>Vt.value!==Qe.task_code)],placeholder:"",allowClear:!0,readOnly:tt||Gt})}),i.jsx("div",{style:{width:150,flexShrink:0},children:tt||Gt?i.jsx("div",{style:{padding:"1px 7px",minHeight:24,lineHeight:"24px",fontSize:12},children:Qe._depends_on&&Qe._depends_on.length>0?Qe._depends_on.join(", "):i.jsx("span",{style:{color:"#bfbfbf"},children:"-"})}):i.jsx(Xe,{mode:"multiple",size:"small",style:{width:"100%"},placeholder:"",value:Qe._depends_on||[],onChange:Vt=>H(Qe._key,"_depends_on",Vt),maxTagCount:1,options:(He[Qe.phase]||[]).filter(Vt=>Vt.value!==Qe.task_code&&!d.find(ca=>ca.task_code===Vt.value&&ca.parent_task_code===Qe.task_code))})}),i.jsx("div",{style:{width:120,flexShrink:0},children:i.jsx(qx,{value:Qe.default_assignee_role||"",onChange:Vt=>H(Qe._key,"default_assignee_role",Vt),options:Fe,placeholder:"",allowClear:!0,readOnly:tt||Gt})}),i.jsx("div",{style:{width:70,flexShrink:0,textAlign:"center"},children:i.jsx(Lz,{value:Qe.estimated_days,onChange:Vt=>H(Qe._key,"estimated_days",Vt),min:1,readOnly:tt||Gt})}),i.jsx("div",{style:{width:60,flexShrink:0,textAlign:"center"},children:i.jsx(Br,{size:"small",checked:Qe.is_critical,disabled:tt||Gt,onChange:Vt=>H(Qe._key,"is_critical",Vt)})}),i.jsxs("div",{style:{width:200,flexShrink:0,display:"flex",alignItems:"center",gap:4},children:[i.jsx(Br,{size:"small",checked:Qe.requires_approval,disabled:tt||Gt,onChange:Vt=>H(Qe._key,"requires_approval",Vt)}),Qe.requires_approval&&i.jsx(Xe,{size:"small",style:{flex:1,fontSize:12},value:Qe.feishu_approval_code||void 0,onChange:Vt=>H(Qe._key,"feishu_approval_code",Vt),placeholder:"",allowClear:!0,disabled:tt||Gt,options:Dt.map(Vt=>({value:Vt.id,label:`${Vt.name}`}))})]}),tt?ue[Qe.task_code]?.length?i.jsx("div",{style:{width:90,flexShrink:0,textAlign:"center"},children:i.jsx(rn,{title:`(${ue[Qe.task_code].length})`,children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(W1,{}),style:{color:"#52c41a"},onClick:()=>Je(Qe)})})}):null:Gt?i.jsx("div",{style:{width:90,flexShrink:0,textAlign:"center"},children:i.jsx(rn,{title:"",children:i.jsx(Uy,{style:{color:"#999"}})})}):i.jsx("div",{style:{width:90,flexShrink:0,textAlign:"center"},children:i.jsxs(Be,{size:0,children:[i.jsx(rn,{title:ue[Qe.task_code]?.length?`(${ue[Qe.task_code].length})`:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(W1,{}),style:{color:ue[Qe.task_code]?.length?"#52c41a":"#999"},onClick:()=>Je(Qe)})}),yt&&i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",size:"small",icon:i.jsx(Yt,{}),style:{color:"#1890ff"},onClick:()=>Ce(Qe)})}),i.jsx(Bn,{title:"",onConfirm:()=>ie(Qe._key),okText:"",cancelText:"",children:i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{})})})]})})]},Qe._key)}),et.length===0&&i.jsx("div",{style:{padding:"16px",textAlign:"center",color:"#bfbfbf",fontSize:13},children:tt?"":'""'})]})]},be)})}),i.jsx(ci,{title:"",placement:"right",width:380,open:I,onClose:()=>z(!1),children:Se.length===0?i.jsx(Gn,{type:"secondary",children:""}):i.jsx(Il,{items:Se.map(be=>{const et=be.id===t,ze=be.status==="published";return{color:ze?"green":"gray",children:i.jsxs("div",{style:{padding:"8px 12px",borderRadius:6,background:et?"#e6f7ff":"#fafafa",border:et?"1px solid #91d5ff":"1px solid #f0f0f0",cursor:et?"default":"pointer",marginBottom:4},onClick:()=>{et||(e(`/templates/${be.id}`),z(!1))},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[i.jsxs(Be,{size:4,children:[i.jsxs(Gn,{strong:!0,children:["v",be.version]}),ze?i.jsx(_e,{color:"green",style:{margin:0},children:""}):i.jsx(_e,{color:"orange",style:{margin:0},children:""})]}),et&&i.jsx(_e,{color:"blue",style:{margin:0},children:""})]}),i.jsxs("div",{children:[i.jsxs(Gn,{type:"secondary",style:{fontSize:12},children:[be.task_count," "]}),be.published_at&&i.jsxs(Gn,{type:"secondary",style:{fontSize:12,marginLeft:8},children:[" ",hs(be.published_at)]}),!be.published_at&&be.created_at&&i.jsxs(Gn,{type:"secondary",style:{fontSize:12,marginLeft:8},children:[" ",hs(be.created_at)]})]})]})}})})}),i.jsxs(Nt,{title:`${tt?"":""} - ${ne?.name||ne?.task_code||""}`,open:W,onCancel:()=>{Q(!1),de(null),X([])},onOk:tt?void 0:la,confirmLoading:le,okText:"",cancelText:tt?"":"",footer:tt?i.jsx(J,{onClick:()=>{Q(!1),de(null),X([])},children:""}):void 0,width:720,destroyOnClose:!0,children:[i.jsx("div",{style:{marginBottom:12},children:i.jsx(Gn,{type:"secondary",children:""})}),$.length===0?i.jsx("div",{style:{textAlign:"center",padding:"24px 0",color:"#999"},children:""}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:$.map((be,et)=>i.jsxs(Mt,{size:"small",bodyStyle:{padding:"8px 12px"},children:[i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"flex-start",flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:1,minWidth:120},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:""}),i.jsx(Pe,{size:"small",placeholder:"",value:be.label,onChange:ze=>ut(et,{label:ze.target.value})})]}),i.jsxs("div",{style:{width:120},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:"Key"}),i.jsx(Pe,{size:"small",placeholder:"field_key",value:be.key,onChange:ze=>ut(et,{key:ze.target.value})})]}),i.jsxs("div",{style:{width:110},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:""}),i.jsx(Xe,{size:"small",style:{width:"100%"},value:be.type,onChange:ze=>ut(et,{type:ze}),options:Ue})]}),i.jsxs("div",{style:{width:60,textAlign:"center"},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:""}),i.jsx(Br,{size:"small",checked:be.required,onChange:ze=>ut(et,{required:ze})})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2,paddingTop:18},children:[i.jsx(J,{type:"text",size:"small",icon:i.jsx(Ru,{style:{fontSize:10}}),onClick:()=>si(et,"up"),disabled:et===0}),i.jsx(J,{type:"text",size:"small",icon:i.jsx(No,{style:{fontSize:10}}),onClick:()=>si(et,"down"),disabled:et===$.length-1}),i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{}),onClick:()=>Et(et)})]})]}),be.type==="select"&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:""}),i.jsx(Pe,{size:"small",placeholder:"1,2,3",value:(be.options||[]).join(","),onChange:ze=>ut(et,{options:ze.target.value.split(",").map(Qe=>Qe.trim()).filter(Boolean)})})]}),be.type==="file"&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:" .pdf,.doc"}),i.jsx(Pe,{size:"small",placeholder:".pdf,.doc,.xlsx",value:be.accept||"",onChange:ze=>ut(et,{accept:ze.target.value})})]}),["ebom_control","pbom_control","mbom_control"].includes(be.type)&&i.jsxs("div",{style:{marginTop:8},children:[i.jsxs(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:4},children:[be.type==="ebom_control"?"EBOM":be.type==="pbom_control"?"PBOM":"MBOM"," "]}),i.jsx(Rz,{bomType:be.type==="ebom_control"?"EBOM":be.type==="pbom_control"?"PBOM":"MBOM",config:be.config||{},onChange:ze=>ut(et,{config:ze})})]}),be.type==="cmf"&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:"EBOM"}),i.jsx(Xe,{size:"small",style:{width:"100%"},placeholder:"BOM",value:be.source_task_code||void 0,onChange:ze=>ut(et,{source_task_code:ze}),allowClear:!0,options:d.filter(ze=>(ue[ze.task_code]||[]).some(Ht=>["bom_upload","ebom_control","pbom_control","mbom_control"].includes(Ht.type))).map(ze=>({value:ze.task_code,label:`${ze.name} (${ze.task_code})`}))}),i.jsx("div",{style:{marginTop:4,padding:"4px 8px",background:"#f6ffed",borderRadius:4},children:i.jsx(Gn,{type:"secondary",style:{fontSize:11},children:"CMFEBOM"})})]}),be.type==="procurement_control"&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:""}),i.jsx(Xe,{size:"small",style:{width:"100%"},placeholder:"",value:be.source_task_code||void 0,onChange:ze=>{ut(et,{source_task_code:ze,source_field_keys:[]})},allowClear:!0,options:d.filter(ze=>(ue[ze.task_code]||[]).some(Ht=>["tooling_list","consumable_list","bom_upload","ebom_control","pbom_control","mbom_control"].includes(Ht.type))).map(ze=>({value:ze.task_code,label:`${ze.name} (${ze.task_code})`}))}),be.source_task_code&&i.jsxs("div",{style:{marginTop:4},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:""}),i.jsx(Xe,{size:"small",mode:"multiple",style:{width:"100%"},placeholder:"",value:be.source_field_keys||[],onChange:ze=>ut(et,{source_field_keys:ze}),options:(ue[be.source_task_code]||[]).filter(ze=>["tooling_list","consumable_list","bom_upload","ebom_control","pbom_control","mbom_control"].includes(ze.type)).map(ze=>({value:ze.key,label:`${ze.label} (${ze.type})`}))})]}),i.jsxs("div",{style:{marginTop:4},children:[i.jsx(Gn,{type:"secondary",style:{fontSize:11,display:"block",marginBottom:2},children:"BOM="}),i.jsx(Xe,{size:"small",mode:"multiple",style:{width:"100%",marginBottom:4},placeholder:"///",value:be.bom_categories||[],onChange:ze=>ut(et,{bom_categories:ze}),options:[{value:"electronic",label:""},{value:"structural",label:""},{value:"optical",label:""},{value:"packaging",label:""},{value:"tooling",label:""},{value:"consumable",label:""}]}),i.jsx(Xe,{size:"small",mode:"multiple",style:{width:"100%"},placeholder:"//",value:be.bom_sub_categories||[],onChange:ze=>ut(et,{bom_sub_categories:ze}),options:[{value:"component",label:""},{value:"pcb",label:"PCB"},{value:"connector",label:""},{value:"cable",label:""},{value:"structural_part",label:""},{value:"fastener",label:""},{value:"light_engine",label:""},{value:"waveguide",label:""},{value:"lens",label:""},{value:"lightguide",label:""},{value:"box",label:""},{value:"document",label:"/"},{value:"cushion",label:"/"},{value:"mold",label:""},{value:"fixture",label:"/"},{value:"consumable",label:""}]})]}),i.jsx("div",{style:{marginTop:4,padding:"4px 8px",background:"#fff7e6",borderRadius:4},children:i.jsx(Gn,{type:"secondary",style:{fontSize:11},children:"SRMPR"})})]})]},et))}),i.jsx(J,{type:"dashed",block:!0,icon:i.jsx(Yt,{}),style:{marginTop:12},onClick:ye,children:""})]}),i.jsxs(Nt,{title:` - ${fe.name}${fe.version?` v${fe.version}`:""}`,open:V,onCancel:()=>{O(!1),B.resetFields(),F([])},onOk:Ke,okText:"",width:600,children:[i.jsxs(ee,{form:B,layout:"vertical",style:{marginTop:16},children:[i.jsx(ee.Item,{name:"codename_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",loading:A,onChange:ht,notFoundContent:A?i.jsx(tn,{size:"small"}):"",options:k.map(be=>({value:be.id,label:Ze(be)}))})}),i.jsx(ee.Item,{name:"project_code",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:or?"PLT-WG-2026":"PRD-Nova-2026",disabled:!0})}),i.jsx(ee.Item,{name:"project_name",label:"",children:i.jsx(Pe,{disabled:!0,placeholder:""})}),i.jsx(ee.Item,{name:"start_date",label:"",rules:[{required:!0,message:""}],children:i.jsx(qa,{style:{width:"100%"}})}),i.jsx(ee.Item,{name:"pm_user_id",label:"",rules:[{required:!0,message:""}],initialValue:n?.id,children:i.jsx(ko,{mode:"single",placeholder:"",style:{width:"100%"}})}),i.jsx(ee.Item,{name:"skip_weekends",label:"",initialValue:!0,children:i.jsx(Xe,{options:[{value:!0,label:" - "},{value:!1,label:" - "}]})})]}),i.jsx("div",{style:{background:"#f5f5f5",padding:12,borderRadius:4},children:i.jsxs(Gn,{type:"secondary",children:["",fe.name,fe.version?` v${fe.version}`:"",""," ",fe.estimated_days," "]})})]}),i.jsxs(Nt,{title:"",open:N,onCancel:()=>T(!1),onOk:qe,confirmLoading:R,okText:"",cancelText:"",width:400,children:[i.jsx("div",{style:{marginBottom:16},children:i.jsxs(Gn,{children:["",i.jsxs(_e,{color:"blue",children:["v",fe.version]})]})}),i.jsxs("div",{children:[i.jsx(Gn,{style:{display:"block",marginBottom:8},children:""}),i.jsx(Pe,{placeholder:` ${zz(String(fe.version))}`,value:j,onChange:be=>E(be.target.value),onPressEnter:qe})]})]})]})};function zz(t){const n=t.replace(/^[vV]/,"").split("."),s=parseInt(n[0],10)||1;let o=parseInt(n[1],10)||0;return o++,o>=10?`${s+1}.0`:`${s}.${o}`}const{Title:kz,Text:cu}=An,Fw={concept:"purple",evt:"blue",dvt:"cyan",pvt:"orange",mp:"green",CONCEPT:"purple",EVT:"blue",DVT:"cyan",PVT:"orange",MP:"green"},zw={planning:{color:"default",text:""},active:{color:"processing",text:""},on_hold:{color:"warning",text:""},completed:{color:"success",text:""},cancelled:{color:"error",text:""}},Bz=()=>{const t=Ni(),e=Ln(),{modal:n,message:s}=Ya.useApp(),o=Tn(),[l,d]=P.useState(""),{data:u,isLoading:h}=ct({queryKey:["projects"],queryFn:()=>Ci.list()}),p=P.useMemo(()=>{const g=u?.items||[];if(!l)return g;const v=l.toLowerCase();return g.filter(C=>C.name?.toLowerCase().includes(v)||C.code?.toLowerCase().includes(v))},[u,l]),m=(g,v)=>{g.stopPropagation(),n.confirm({title:"",icon:i.jsx(GR,{}),content:`${v.name}`,okText:"",okType:"danger",cancelText:"",onOk:async()=>{try{await Ci.delete(v.id),s.success(""),e.invalidateQueries({queryKey:["projects"]})}catch{s.error("")}}})};return i.jsxs("div",{style:{padding:o?0:24},children:[!o&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[i.jsx(kz,{level:3,style:{margin:0},children:""}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx(Pe,{placeholder:"",prefix:i.jsx(gi,{}),value:l,onChange:g=>d(g.target.value),style:{width:240},allowClear:!0}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>t("/templates"),children:""})]})]}),o&&i.jsx("div",{className:"ds-search-bar",children:i.jsx(Pe,{placeholder:"",prefix:i.jsx(gi,{}),value:l,onChange:g=>d(g.target.value),allowClear:!0,style:{borderRadius:20,height:40,background:"#f5f5f5",border:"none"}})}),h?i.jsx("div",{style:{textAlign:"center",padding:80},children:i.jsx(tn,{size:"large"})}):p.length===0?i.jsx("div",{style:{padding:o?16:0},children:i.jsx(ft,{description:l?"":""})}):o?i.jsx("div",{className:"ds-page-content",children:p.map(g=>{const v=zw[g.status]||{color:"default",text:g.status},C=v.color==="processing"?"ds-tag-processing":v.color==="success"?"ds-tag-success":v.color==="warning"?"ds-tag-warning":v.color==="error"?"ds-tag-danger":"ds-tag-default";return i.jsxs("div",{className:"ds-list-card",onClick:()=>t(`/projects/${g.id}`),children:[i.jsxs("div",{className:"ds-card-header",children:[i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsx("div",{className:"ds-card-title",children:g.name}),i.jsx("div",{className:"ds-card-subtitle",style:{fontFamily:"monospace"},children:g.code})]}),i.jsx("span",{className:`ds-tag ${C}`,children:v.text})]}),i.jsxs("div",{className:"ds-card-meta",children:[g.phase&&i.jsx(_e,{color:Fw[g.phase],style:{margin:0},children:g.phase?.toUpperCase()}),g.manager_name&&i.jsxs("span",{children:[i.jsx(wi,{})," ",g.manager_name]}),g.start_date&&i.jsxs("span",{children:[i.jsx(zp,{})," ",new Date(g.start_date).toLocaleDateString("zh-CN")]})]})]},g.id)})}):i.jsx("div",{children:i.jsx(kr,{gutter:[20,20],children:p.map(g=>{const v=zw[g.status]||{color:"default",text:g.status};return i.jsx(ni,{xs:24,sm:12,md:8,lg:6,children:i.jsxs(Mt,{hoverable:!0,onClick:()=>t(`/projects/${g.id}`),style:{height:"100%",borderRadius:8},bodyStyle:{padding:20},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsx(cu,{strong:!0,style:{fontSize:16,display:"block"},ellipsis:{tooltip:g.name},children:g.name}),i.jsx(cu,{type:"secondary",style:{fontSize:12,fontFamily:"monospace"},children:g.code})]}),i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{}),onClick:C=>m(C,g),style:{marginLeft:8,flexShrink:0}})]}),i.jsxs("div",{style:{display:"flex",gap:6,marginBottom:12,flexWrap:"wrap",alignItems:"center"},children:[i.jsx(Ii,{status:v.color,text:i.jsx(cu,{style:{fontSize:12},children:v.text})}),g.phase&&i.jsx(_e,{color:Fw[g.phase],style:{margin:0},children:g.phase?.toUpperCase()})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flexWrap:"wrap"},children:[g.manager_name&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx(wi,{style:{fontSize:12,color:"#999"}}),i.jsx(cu,{type:"secondary",style:{fontSize:12},children:g.manager_name})]}),g.start_date&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx(zp,{style:{fontSize:12,color:"#999"}}),i.jsx(cu,{type:"secondary",style:{fontSize:12},children:new Date(g.start_date).toLocaleDateString("zh-CN")})]})]})]})},g.id)})})}),o&&i.jsx("div",{className:"ds-fab",onClick:()=>t("/templates"),children:i.jsx(Yt,{})})]})},wu={assignTask:async(t,e,n)=>(await Z.post(`/projects/${t}/tasks/${e}/assign`,n)).data,startTask:async(t,e)=>(await Z.post(`/projects/${t}/tasks/${e}/start`)).data,completeTask:async(t,e)=>(await Z.post(`/projects/${t}/tasks/${e}/complete`)).data,submitReview:async(t,e,n)=>(await Z.post(`/projects/${t}/tasks/${e}/review`,n)).data,assignPhaseRoles:async(t,e,n)=>(await Z.post(`/projects/${t}/phases/${e}/assign-roles`,n)).data,getTaskHistory:async(t,e)=>(await Z.get(`/projects/${t}/tasks/${e}/history`)).data.data||[]},Rh={listSKUs:async t=>(await Z.get(`/projects/${t}/skus`)).data.data?.items||[],createSKU:async(t,e)=>(await Z.post(`/projects/${t}/skus`,e)).data.data,updateSKU:async(t,e,n)=>(await Z.put(`/projects/${t}/skus/${e}`,n)).data.data,deleteSKU:async(t,e)=>(await Z.delete(`/projects/${t}/skus/${e}`)).data,getBOMItems:async(t,e)=>(await Z.get(`/projects/${t}/skus/${e}/bom-items`)).data.data?.items||[],saveBOMItems:async(t,e,n)=>(await Z.put(`/projects/${t}/skus/${e}/bom-items`,n)).data.data?.items||[],getCMFConfigs:async(t,e)=>(await Z.get(`/projects/${t}/skus/${e}/cmf`)).data.data?.items||[],saveCMFConfigs:async(t,e,n)=>(await Z.put(`/projects/${t}/skus/${e}/cmf`,n)).data.data?.items||[],getFullBOM:async(t,e)=>(await Z.get(`/projects/${t}/skus/${e}/full-bom`)).data.data?.items||[]},Cu={getAppearanceParts:async t=>(await Z.get(`/projects/${t}/appearance-parts`)).data.data||[],listVariants:async(t,e)=>(await Z.get(`/projects/${t}/bom-items/${e}/cmf-variants`)).data.data||[],createVariant:async(t,e,n)=>(await Z.post(`/projects/${t}/bom-items/${e}/cmf-variants`,n)).data.data,updateVariant:async(t,e,n)=>(await Z.put(`/projects/${t}/cmf-variants/${e}`,n)).data.data,deleteVariant:async(t,e)=>{await Z.delete(`/projects/${t}/cmf-variants/${e}`)},getSRMItems:async t=>(await Z.get(`/projects/${t}/srm/items`)).data.data||[]},kw={list:async(t,e)=>(await Z.get(`/projects/${t}/bom-items/${e}/drawings`)).data.data,upload:async(t,e,n)=>(await Z.post(`/projects/${t}/bom-items/${e}/drawings`,n)).data.data,delete:async(t,e,n)=>{await Z.delete(`/projects/${t}/bom-items/${e}/drawings/${n}`)},listByBOM:async(t,e)=>(await Z.get(`/projects/${t}/boms/${e}/drawings`)).data.data},{Text:Gx}=An,cE=({columns:t,items:e,onChange:n,onCellSave:s,onDeleteRow:o,readonly:l=!1,rowKey:d="id",pageSize:u=10,showDelete:h,deleteConfirmText:p="",emptyText:m,style:g})=>{const[v,C]=P.useState(null),[b,_]=P.useState(1),y=E=>e.length>u?(b-1)*u+E:E,S=(E,R,M)=>{const I=y(E);if(e[I]&&e[I][R]===M){C(null);return}if(s)s(e[I],R,M,I);else if(n){const z=e.map((V,O)=>O===I?{...V,[R]:M}:V);n(z)}C(null)},D=E=>{const R=y(E);o?o(e[R],R):n&&n(e.filter((M,I)=>I!==R))},L=(E,R,M,I="text",z,V)=>{const O=y(R);if(I==="checkbox")return i.jsx(pa,{checked:!!E,disabled:l,onChange:A=>S(R,M,A.target.checked)});let k=E;return k!=null&&typeof k=="object"&&I!=="color"&&(k=null),V?k=V(E,e[O]):I==="select"&&z&&k&&(k=z.find(A=>A.value===k)?.label||k),l?I==="color"?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,minHeight:22,padding:"0 2px"},children:[E&&i.jsx("span",{style:{display:"inline-block",width:16,height:16,borderRadius:3,backgroundColor:E,border:"1px solid #d9d9d9",verticalAlign:"middle"}}),i.jsx("span",{children:E||i.jsx(Gx,{type:"secondary",style:{fontSize:11},children:"-"})})]}):i.jsx("div",{style:{minHeight:22,padding:"0 2px"},children:k??i.jsx(Gx,{type:"secondary",style:{fontSize:11},children:"-"})}):v?.rowIdx===O&&v?.field===M?I==="color"?i.jsx(RT,{showText:!0,format:"hex",size:"small",defaultValue:E||void 0,onChangeComplete:A=>S(R,M,A.toHexString()),onOpenChange:A=>{A||C(null)},open:!0}):I==="number"?i.jsx(en,{size:"small",autoFocus:!0,defaultValue:typeof E=="string"?parseFloat(E)||0:E,style:{width:"100%"},onBlur:A=>S(R,M,parseFloat(A.target.value)||0),onPressEnter:A=>S(R,M,parseFloat(A.target.value)||0)}):I==="select"&&z?i.jsx(Xe,{size:"small",autoFocus:!0,defaultValue:E||void 0,defaultOpen:!0,style:{width:"100%"},options:z,allowClear:!0,onChange:A=>S(R,M,A??""),onBlur:()=>C(null)}):i.jsx(Pe,{size:"small",autoFocus:!0,defaultValue:E,onBlur:A=>S(R,M,A.target.value),onPressEnter:A=>S(R,M,A.target.value)}):i.jsxs("div",{style:{cursor:"pointer",minHeight:22,padding:"0 2px",borderRadius:2,display:"flex",alignItems:"center",gap:4},className:"editable-cell",onClick:()=>C({rowIdx:O,field:M}),children:[I==="color"&&E&&i.jsx("span",{style:{display:"inline-block",width:16,height:16,borderRadius:3,backgroundColor:E,border:"1px solid #d9d9d9",verticalAlign:"middle"}}),k??i.jsx(Gx,{type:"secondary",style:{fontSize:11},children:"-"})]})},N=P.useMemo(()=>{const E=[];for(const M of t)M.render?E.push({title:M.title,dataIndex:M.key,width:M.width,align:M.align,ellipsis:M.ellipsis,fixed:M.fixed,render:M.render}):M.editable===!1?E.push({title:M.title,dataIndex:M.key,width:M.width,align:M.align,ellipsis:M.ellipsis,fixed:M.fixed,render:M.formatValue?(I,z)=>M.formatValue(I,z):void 0}):E.push({title:M.title,dataIndex:M.key,width:M.width,align:M.align,ellipsis:M.ellipsis,fixed:M.fixed,render:(I,z,V)=>L(I,V,M.key,M.type||"text",M.options,M.formatValue)});return(h!==void 0?h:!l)&&E.push({title:"",width:40,align:"center",fixed:"right",render:(M,I,z)=>i.jsx(Bn,{title:p,onConfirm:()=>D(z),children:i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{})})})}),E},[t,l,v,e,b,h]),T=N.reduce((E,R)=>E+(R.width||100),0),j=typeof d=="function"?d:(E,R)=>E[d]||String(R);return i.jsxs("div",{style:g,children:[i.jsx(sn,{columns:N,dataSource:e,rowKey:j,size:"small",pagination:e.length>u?{pageSize:u,size:"small",showTotal:E=>` ${E} `,current:b,onChange:E=>_(E)}:!1,scroll:{x:T},style:{fontSize:12},locale:{emptyText:m||i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE})}}),i.jsx("style",{children:".editable-cell:hover { background: #f0f5ff; }"})]})},{Text:Hr}=An,dE=["","","","",""],uE=["","","","PVD","IMD","UV","","",""],fE=["","","","","",""],hE=["UV","PU","","",""],Uz=["","","UV","","","","",""],Hz=dE.map(t=>({label:t,value:t})),Vz=uE.map(t=>({label:t,value:t})),qz=fE.map(t=>({label:t,value:t})),Gz=hE.map(t=>({label:t,value:t})),Bw=["color_hex","pantone_code","gloss_level","finish","texture","coating","reference_image_file_id","reference_image_url","process_drawing_type","process_drawings","notes"],pE=t=>{if(!t)return[];if(Array.isArray(t))return t;try{return JSON.parse(t)}catch{return[]}},$z=({bomItem:t,variants:e,onVariantsChange:n,onAddVariant:s,readonly:o})=>{const{message:l}=Ya.useApp(),d=P.useMemo(()=>[{key:"variant_index",title:"",width:50,editable:!1,render:u=>i.jsxs(_e,{color:"processing",style:{margin:0,fontSize:11},children:["V",u]})},{key:"color_hex",title:"",width:100,type:"color"},{key:"pantone_code",title:"(Pantone)",width:100},{key:"gloss_level",title:"",width:80,type:"select",options:Hz},{key:"finish",title:"",width:90,type:"select",options:Vz},{key:"texture",title:"",width:80,type:"select",options:qz},{key:"coating",title:"",width:90,type:"select",options:Gz},{key:"reference_image_file_id",title:"",width:60,render:(u,h)=>{const p=h.reference_image_file_id?h.reference_image_url||`/uploads/${h.reference_image_file_id}/image`:void 0;return p?i.jsx(DT,{src:p,width:40,height:30,style:{objectFit:"cover",borderRadius:3},fallback:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iMzAiPjxyZWN0IGZpbGw9IiNmNWY1ZjUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiLz48L3N2Zz4="}):o?i.jsx(Hr,{type:"secondary",style:{fontSize:11},children:"-"}):i.jsx(Zi,{showUploadList:!1,accept:"image/*",beforeUpload:m=>(Vn.uploadFile(m).then(g=>{n(e.map(v=>v.id===h.id?{...v,reference_image_file_id:g.id,reference_image_url:g.url}:v))}).catch(()=>l.error("")),!1),children:i.jsx(J,{size:"small",type:"text",icon:i.jsx(Li,{}),style:{fontSize:11,padding:"0 4px"}})})}},{key:"process_drawings",title:"",width:60,render:(u,h)=>{const p=pE(h.process_drawings);return p.length>0?i.jsxs(Be,{size:2,direction:"vertical",children:[h.process_drawing_type&&i.jsx(_e,{style:{fontSize:10,margin:0},children:h.process_drawing_type}),p.map(m=>i.jsx(rn,{title:m.file_name,children:i.jsx("a",{href:m.url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:11},children:i.jsx(Yu,{style:{color:"#1677ff"}})})},m.file_id))]}):o?i.jsx(Hr,{type:"secondary",style:{fontSize:11},children:"-"}):i.jsx(Zi,{showUploadList:!1,accept:".pdf,.dwg,.dxf,.ai,.cdr,image/*",beforeUpload:m=>(Vn.uploadFile(m).then(g=>{const v=[...p,{file_id:g.id,file_name:g.filename||m.name,url:g.url}];n(e.map(C=>C.id===h.id?{...C,process_drawings:JSON.stringify(v)}:C))}).catch(()=>l.error("")),!1),children:i.jsx(J,{size:"small",type:"text",icon:i.jsx(Li,{}),style:{fontSize:11,padding:"0 4px"}})})}},{key:"notes",title:"",width:120}],[o,e,n,l]);return i.jsxs("div",{style:{marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 12px",background:"#fff7e6",borderRadius:"4px 4px 0 0",borderBottom:"1px solid #f0f0f0"},children:[t.thumbnail_url&&i.jsx("img",{src:t.thumbnail_url,alt:"",width:24,height:18,style:{objectFit:"contain",borderRadius:3,background:"#f5f5f5"}}),i.jsxs(Hr,{style:{fontSize:13,fontWeight:500},children:["#",t.item_number," ",t.name]}),i.jsxs(_e,{style:{fontSize:11},children:[e.length," "]}),i.jsx("div",{style:{flex:1}}),!o&&i.jsx(J,{type:"dashed",size:"small",icon:i.jsx(Yt,{}),onClick:s,children:""})]}),e.length>0?i.jsx(cE,{columns:d,items:e,onChange:n,readonly:o,rowKey:"id",deleteConfirmText:"CMF"}):i.jsx("div",{style:{padding:"16px 0",textAlign:"center",color:"#999",fontSize:12,border:"1px solid #f0f0f0",borderTop:0,borderRadius:"0 0 4px 4px"},children:"CMF"})]})},Wz=({variant:t,readonly:e,onSave:n,onClose:s})=>{const{message:o}=Ya.useApp(),[l,d]=P.useState(!1),[u]=ee.useForm(),[h,p]=P.useState(!1),[m,g]=P.useState(!1),[v,C]=P.useState(t.reference_image_file_id||""),[b,_]=P.useState(t.reference_image_url||""),[y,S]=P.useState(t.process_drawing_type||""),[D,L]=P.useState(pE(t.process_drawings));P.useEffect(()=>{requestAnimationFrame(()=>d(!0))},[]);const N=()=>{d(!1),setTimeout(s,300)},T=()=>{u.validateFields().then(M=>{M.color_hex&&typeof M.color_hex=="object"&&M.color_hex.toHexString&&(M.color_hex=M.color_hex.toHexString()),M.reference_image_file_id=v,M.reference_image_url=b,M.process_drawing_type=y,M.process_drawings=JSON.stringify(D),n(t.id,M),N()})},j=async M=>{p(!0);try{const I=await Vn.uploadFile(M);C(I.id),_(I.url)}catch{o.error("")}finally{p(!1)}return!1},E=async M=>{g(!0);try{const I=await Vn.uploadFile(M);L(z=>[...z,{file_id:I.id,file_name:I.filename||M.name,url:I.url}])}catch{o.error("")}finally{g(!1)}return!1},R=v?b||`/uploads/${v}/image`:void 0;return i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1100,background:"#fff",transform:l?"translateX(0)":"translateX(100%)",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",borderBottom:"1px solid #f0f0f0",background:"#fff"},children:[i.jsx(Ls,{onClick:N,style:{fontSize:18,cursor:"pointer",padding:4}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontSize:16,fontWeight:600},children:e?"CMF":"CMF"}),i.jsxs("div",{style:{fontSize:12,color:"#999"},children:["V",t.variant_index," ",t.material_code||""]})]}),!e&&i.jsx(J,{type:"primary",onClick:T,style:{borderRadius:8,fontWeight:500},children:""})]}),i.jsx("div",{style:{flex:1,overflow:"auto",padding:16,WebkitOverflowScrolling:"touch"},children:i.jsxs(ee,{form:u,layout:"vertical",initialValues:{color_hex:t.color_hex||"",pantone_code:t.pantone_code||"",gloss_level:t.gloss_level||void 0,finish:t.finish||void 0,texture:t.texture||void 0,coating:t.coating||void 0,notes:t.notes||""},children:[i.jsxs("div",{style:Dh,children:[i.jsx("div",{style:$x,children:""}),i.jsx(ee.Item,{label:"",name:"color_hex",style:{marginBottom:14},children:i.jsx(RT,{showText:!0,format:"hex",disabled:e})}),i.jsx(ee.Item,{label:" (Pantone)",name:"pantone_code",style:{marginBottom:14},children:i.jsx(Pe,{placeholder:": Black 6C",size:"large",style:{borderRadius:10},disabled:e})})]}),i.jsxs("div",{style:Dh,children:[i.jsx("div",{style:$x,children:""}),i.jsx(ee.Item,{label:"",name:"gloss_level",style:{marginBottom:14},children:i.jsx(Xe,{placeholder:"",allowClear:!0,size:"large",disabled:e,options:dE.map(M=>({label:M,value:M}))})}),i.jsx(ee.Item,{label:"",name:"finish",style:{marginBottom:14},children:i.jsx(Xe,{placeholder:"",allowClear:!0,size:"large",disabled:e,options:uE.map(M=>({label:M,value:M}))})}),i.jsx(ee.Item,{label:"",name:"texture",style:{marginBottom:14},children:i.jsx(Xe,{placeholder:"",allowClear:!0,size:"large",disabled:e,options:fE.map(M=>({label:M,value:M}))})}),i.jsx(ee.Item,{label:"",name:"coating",style:{marginBottom:14},children:i.jsx(Xe,{placeholder:"",allowClear:!0,size:"large",disabled:e,options:hE.map(M=>({label:M,value:M}))})})]}),i.jsxs("div",{style:Dh,children:[i.jsx("div",{style:$x,children:""}),i.jsxs("div",{style:{marginBottom:14},children:[i.jsx(Hr,{style:{fontSize:13,color:"#666",display:"block",marginBottom:6},children:""}),R&&i.jsxs("div",{style:{position:"relative",display:"inline-block",marginBottom:8},children:[i.jsx(DT,{src:R,width:100,height:75,style:{objectFit:"cover",borderRadius:8},fallback:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNDUiPjxyZWN0IGZpbGw9IiNmNWY1ZjUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiLz48L3N2Zz4="}),!e&&i.jsx(Zn,{style:{position:"absolute",top:-6,right:-6,color:"#ff4d4f",cursor:"pointer",fontSize:14,background:"#fff",borderRadius:"50%",padding:3,boxShadow:"0 1px 4px rgba(0,0,0,0.15)"},onClick:()=>{C(""),_("")}})]}),!e&&i.jsx(Zi,{showUploadList:!1,accept:"image/*",beforeUpload:M=>(j(M),!1),children:i.jsx(J,{icon:i.jsx(Li,{}),loading:h,block:!0,style:{borderRadius:10},children:""})})]}),i.jsxs("div",{style:{marginBottom:14},children:[i.jsx(Hr,{style:{fontSize:13,color:"#666",display:"block",marginBottom:6},children:""}),!e&&i.jsxs(Be,{size:8,style:{marginBottom:8,width:"100%"},children:[i.jsx(Xe,{value:y||void 0,placeholder:"",allowClear:!0,style:{flex:1},onChange:M=>S(M||""),options:Uz.map(M=>({label:M,value:M}))}),i.jsx(Zi,{showUploadList:!1,accept:".pdf,.dwg,.dxf,.ai,.cdr,image/*",beforeUpload:M=>(E(M),!1),children:i.jsx(J,{icon:i.jsx(Li,{}),loading:m,children:""})})]}),t.process_drawing_type&&!y&&i.jsx(_e,{style:{marginBottom:4},children:t.process_drawing_type}),D.map(M=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,marginBottom:4,padding:"4px 0"},children:[i.jsx(Yu,{style:{color:"#1677ff"}}),i.jsx("a",{href:M.url,target:"_blank",rel:"noopener noreferrer",style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:M.file_name}),!e&&i.jsx(Zn,{style:{color:"#ff4d4f",cursor:"pointer"},onClick:()=>L(I=>I.filter(z=>z.file_id!==M.file_id))})]},M.file_id))]})]}),i.jsx("div",{style:Dh,children:i.jsx(ee.Item,{label:"",name:"notes",style:{marginBottom:0},children:i.jsx(Pe.TextArea,{rows:3,placeholder:"",style:{borderRadius:10},disabled:e})})}),i.jsx("div",{style:{height:40}})]})})]})},Dh={marginBottom:20,background:"#fafafa",borderRadius:12,padding:16},$x={fontSize:14,fontWeight:600,color:"#333",marginBottom:12},Yz=({variant:t,onClick:e})=>{const n=t.reference_image_file_id?t.reference_image_url||`/uploads/${t.reference_image_file_id}/image`:void 0;return i.jsxs("div",{onClick:e,style:{display:"flex",alignItems:"center",gap:12,padding:"12px 14px",background:"#fff",borderRadius:10,border:"1px solid #f0f0f0",marginBottom:8,cursor:"pointer",transition:"background 0.15s"},children:[n?i.jsx("img",{src:n,alt:"",width:44,height:44,style:{objectFit:"cover",borderRadius:8,background:"#f5f5f5",flexShrink:0}}):t.color_hex?i.jsx("div",{style:{width:44,height:44,borderRadius:8,flexShrink:0,backgroundColor:t.color_hex,border:"1px solid #e8e8e8",boxShadow:"0 1px 3px rgba(0,0,0,0.08)"}}):i.jsx("div",{style:{width:44,height:44,borderRadius:8,flexShrink:0,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(Hy,{style:{color:"#bfbfbf",fontSize:18}})}),i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:2},children:[i.jsxs(_e,{color:"processing",style:{margin:0,fontSize:10,lineHeight:"16px",padding:"0 4px"},children:["V",t.variant_index]}),t.material_code&&i.jsx(Hr,{style:{fontSize:11,color:"#8c8c8c"},children:t.material_code})]}),i.jsxs("div",{style:{fontSize:13,color:"#333",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t.color_hex||"",t.pantone_code?` / ${t.pantone_code}`:""]}),i.jsx("div",{style:{fontSize:11,color:"#999",marginTop:2},children:[t.gloss_level,t.finish,t.texture].filter(Boolean).join(" / ")||""})]}),i.jsx(Oi,{style:{color:"#bfbfbf",fontSize:12,flexShrink:0}})]})},Yv=({projectId:t,taskId:e,readonly:n=!1})=>{const{message:s}=Ya.useApp(),o=Ln(),l=Tn(),[d,u]=P.useState(null),[h,p]=P.useState([]),[m,g]=P.useState(!1),v=P.useRef([]),C=P.useRef(null),b=P.useRef(!1),{data:_=[],isLoading:y}=ct({queryKey:["appearance-parts",t],queryFn:()=>Cu.getAppearanceParts(t)});P.useEffect(()=>{if(b.current)return;if(!_.length){v.current=[],p([]),g(!0);return}const T=_.flatMap(j=>(j.cmf_variants||[]).map(E=>({...E,bom_item_id:j.bom_item.id})));v.current=T,p(T),g(!0)},[_]);const S=P.useCallback(T=>h.filter(j=>j.bom_item_id===T),[h]),D=P.useCallback((T,j)=>{p(E=>[...E.filter(R=>R.bom_item_id!==T),...j])},[]),L=P.useCallback(T=>{const E=h.filter(R=>R.bom_item_id===T).reduce((R,M)=>Math.max(R,M.variant_index||0),0);p(R=>[...R,{id:"new-"+Date.now(),bom_item_id:T,variant_index:E+1,color_hex:"",pantone_code:"",gloss_level:"",finish:"",texture:"",coating:"",reference_image_file_id:"",reference_image_url:"",process_drawing_type:"",process_drawings:"",notes:"",material_code:""}])},[h]),N=P.useCallback((T,j)=>{p(E=>E.map(R=>R.id===T?{...R,...j}:R))},[]);return P.useEffect(()=>{if(!n&&!b.current)return C.current&&clearTimeout(C.current),C.current=setTimeout(async()=>{if(!b.current){b.current=!0;try{const T=v.current,j=h,E=new Set(T.map(k=>k.id)),R=new Set(j.map(k=>k.id)),M=[...E].filter(k=>!R.has(k));for(const k of M)await Cu.deleteVariant(t,k);const I=j.filter(k=>typeof k.id=="string"&&k.id.startsWith("new-")),z={};for(const k of I){const F={};for(const q of Bw)k[q]&&(F[q]=k[q]);const A=await Cu.createVariant(t,k.bom_item_id,F);z[k.id]=A}const V=j.filter(k=>!(typeof k.id=="string"&&k.id.startsWith("new-"))&&E.has(k.id));for(const k of V){const F=T.find(B=>B.id===k.id);if(!F)continue;const A={};let q=!1;for(const B of Bw)String(k[B]??"")!==String(F[B]??"")&&(A[B]=k[B]??"",q=!0);q&&await Cu.updateVariant(t,k.id,A)}const O=j.map(k=>z[k.id]?{...z[k.id],bom_item_id:k.bom_item_id}:k);v.current=O,Object.keys(z).length>0&&p(O),await o.invalidateQueries({queryKey:["appearance-parts",t]})}catch{s.error(""),o.invalidateQueries({queryKey:["appearance-parts",t]})}finally{b.current=!1}}},1500),()=>{C.current&&clearTimeout(C.current)}},[h,t,n,o,s]),y||!m?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{tip:"CMF..."})}):_.length===0?i.jsx(ft,{description:"EBOM"}):l?i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:10,display:"flex",alignItems:"center",gap:6},children:[i.jsx(Hy,{style:{color:"#1677ff"}}),i.jsx(Hr,{type:"secondary",style:{fontSize:12},children:"CMF"})]}),_.map(T=>{const j=T.bom_item,E=S(j.id);return i.jsxs("div",{style:{marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 0",marginBottom:4},children:[j.thumbnail_url&&i.jsx("img",{src:j.thumbnail_url,alt:"",width:24,height:18,style:{objectFit:"contain",borderRadius:3,background:"#f5f5f5"}}),i.jsxs(Hr,{strong:!0,style:{fontSize:13,flex:1},children:["#",j.item_number," ",j.name]}),i.jsxs(_e,{color:"blue",style:{fontSize:10,margin:0},children:[E.length,""]})]}),E.map(R=>i.jsx(Yz,{variant:R,onClick:()=>u(R)},R.id)),!n&&i.jsx(J,{type:"dashed",icon:i.jsx(Yt,{}),onClick:()=>L(j.id),block:!0,style:{borderRadius:10,marginTop:4},children:""})]},j.id)}),d&&i.jsx(Wz,{variant:d,readonly:n,onSave:N,onClose:()=>u(null)})]}):i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[i.jsx(Hy,{style:{color:"#1677ff"}}),i.jsx(Hr,{strong:!0,style:{fontSize:14},children:"CMF"}),i.jsxs(_e,{style:{fontSize:11},children:[h.length," "]})]}),_.map(T=>i.jsx($z,{bomItem:T.bom_item,variants:S(T.bom_item.id),onVariantsChange:j=>D(T.bom_item.id,j),onAddVariant:()=>L(T.bom_item.id),readonly:n},T.bom_item.id))]})},{Text:Kz}=An,Uw=({value:t,displayName:e,onChange:n,category:s,categoryNe:o,readonly:l=!1,placeholder:d="",style:u})=>{const[h,p]=P.useState(""),{data:m=[],isFetching:g}=ct({queryKey:["supplier-search",h,s,o],queryFn:async()=>{const _={page:1,page_size:20};return h&&(_.search=h),s&&(_.category=s),o&&(_.category_ne=o),(await wt.listSuppliers(_)).items||[]},staleTime:3e4}),v=P.useMemo(()=>m.map(_=>({label:_.short_name||_.name,value:_.id,name:_.name,short_name:_.short_name})),[m]),C=P.useCallback(_=>{p(_)},[]),b=P.useCallback(_=>{if(!_){n(null,"");return}const y=m.find(S=>S.id===_);n(_,y?.short_name||y?.name||"")},[m,n]);return l?i.jsx(Kz,{style:{fontSize:12,...u||{}},children:e||"-"}):i.jsx(Xe,{showSearch:!0,allowClear:!0,value:t||void 0,placeholder:d,style:{width:"100%",minWidth:80,...u||{}},size:"small",filterOption:!1,onSearch:C,onChange:b,loading:g,options:v,notFoundContent:g?"...":"",popupMatchSelectWidth:200})},{Text:pc}=An,Xz=10,Ih=t=>t<1024?`${t}B`:t<1024*1024?`${(t/1024).toFixed(0)}KB`:`${(t/(1024*1024)).toFixed(1)}MB`,Qz={name:{title:"",width:120,type:"text"},quantity:{title:"",width:60,type:"number",align:"right"},unit:{title:"",width:55,type:"text"},supplier:{title:"",width:100,type:"text"},unit_price:{title:"",width:80,type:"number",align:"right"},extended_cost:{title:"",width:80,type:"number",align:"right"},notes:{title:"",width:120,type:"text"}},mE=({subCategory:t,items:e,onChange:n,fieldOrder:s,templates:o,readonly:l=!1,onItemSave:d,showMaterialCode:u=!1,onDeleteRow:h,bomType:p,category:m})=>{const g=Tn(),v=P.useMemo(()=>e.map(D=>({...D,...D.extended_attrs||{}})),[e]),C=P.useMemo(()=>{const D=o.filter(L=>L.show_in_table);if(s&&s.length>0){const L=[],N=[...D];for(const T of s){if(xl.includes(T))continue;const j=N.findIndex(E=>E.field_key===T);j>=0&&L.push(N.splice(j,1)[0])}return N.sort((T,j)=>T.sort_order-j.sort_order),[...L,...N]}return D.sort((L,N)=>L.sort_order-N.sort_order)},[o,s]),b=P.useMemo(()=>[...xl,"item_number","supplier_id","manufacturer_id","mpn","manufacturer_name"],[]),_=P.useCallback((D,L,N,T)=>{const j=!b.includes(L)&&o.some(E=>E.field_key===L);if(d&&D.id)d(D.id,L,N);else if(j){const E=e.map(R=>R.id!==D.id?R:{...R,extended_attrs:{...R.extended_attrs||{},[L]:N}});n(E)}else{const E=e.map(R=>{if(R.id!==D.id)return R;const M={...R,[L]:N};if(L==="quantity"||L==="unit_price"){const I=L==="quantity"?Number(N)||0:R.quantity||0,z=L==="unit_price"?Number(N)||0:R.unit_price||0;M.extended_cost=I*z}return M});n(E)}},[e,n,d,o,b]),y=P.useCallback((D,L)=>{h&&D.id?h(D.id):n(e.filter(N=>N.id!==D.id))},[e,n,h]),S=P.useMemo(()=>{const D=[];D.push({key:"item_number",title:"",width:55,align:"center",type:"number"}),u&&D.push({key:"material_code",title:"",width:150,render:L=>L?i.jsx("span",{style:{background:"#f5f5f5",border:"1px solid #d9d9d9",borderRadius:4,padding:"2px 8px",fontFamily:"monospace",fontSize:13,whiteSpace:"nowrap"},children:L}):i.jsx(pc,{type:"secondary",style:{fontSize:11},children:"-"})});for(const L of xl){const N=Qz[L];N&&(L==="extended_cost"?D.push({key:L,title:N.title,width:N.width,align:N.align,render:(T,j)=>{const E=T??(j.quantity||0)*(j.unit_price||0);return E>0?Number(E).toFixed(2):i.jsx(pc,{type:"secondary",style:{fontSize:11},children:"-"})}}):L==="supplier"?D.push({key:"supplier_id",title:N.title,width:130,editable:!1,render:(T,j)=>i.jsx(Uw,{value:j.supplier_id,displayName:j.supplier,categoryNe:"manufacturer",readonly:l,placeholder:"",onChange:(E,R)=>{const M=e.map(I=>I.id===j.id?{...I,supplier_id:E,supplier:R}:I);n(M)}})}):D.push({key:L,title:N.title,width:N.width,align:N.align,type:N.type,ellipsis:L==="notes",formatValue:L==="unit_price"?T=>T!=null&&T!==""?Number(T).toFixed(2):null:void 0}))}p==="EBOM"&&m==="electronic"&&(D.push({key:"manufacturer_id",title:"",width:130,editable:!1,render:(L,N)=>i.jsx(Uw,{value:N.manufacturer_id,displayName:N.manufacturer_name,category:"manufacturer",readonly:l,placeholder:"",onChange:(T,j)=>{const E=e.map(R=>R.id===N.id?{...R,manufacturer_id:T,manufacturer_name:j}:R);n(E)}})}),D.push({key:"mpn",title:"MPN",width:120,type:"text",ellipsis:!0}));for(const L of C){const N=L.unit?`${L.field_name}(${L.unit})`:L.field_name;if(L.field_type==="file"){const T=L.field_key;D.push({key:T,title:N,width:140,render:(j,E)=>{const R=E[T],M=R&&typeof R=="object"&&R.file_id;return l?M?i.jsxs(rn,{title:`${R.file_name}${R.file_size?" "+Ih(R.file_size):""}`,children:[i.jsx("a",{href:`/uploads/${R.file_id}/${R.file_name}`,target:"_blank",rel:"noreferrer",style:{fontSize:11,maxWidth:100,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R.file_name}),R.file_size>0&&i.jsx(pc,{type:"secondary",style:{fontSize:10,marginLeft:4},children:Ih(R.file_size)})]}):i.jsx(pc,{type:"secondary",style:{fontSize:11},children:"-"}):i.jsxs(Be,{size:4,style:{width:"100%"},children:[M?i.jsxs(rn,{title:`${R.file_name}${R.file_size?" "+Ih(R.file_size):""}`,children:[i.jsx("a",{href:`/uploads/${R.file_id}/${R.file_name}`,target:"_blank",rel:"noreferrer",style:{fontSize:11,maxWidth:70,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle"},children:R.file_name}),R.file_size>0&&i.jsx(pc,{type:"secondary",style:{fontSize:10},children:Ih(R.file_size)})]}):i.jsx(pc,{type:"secondary",style:{fontSize:11},children:"-"}),i.jsx(Zi,{showUploadList:!1,customRequest:()=>{},beforeUpload:I=>(Vn.uploadFile(I).then(z=>{const V={file_id:z.id,file_name:z.filename,file_size:I.size},O=e.map(k=>k.id!==E.id?k:{...k,extended_attrs:{...k.extended_attrs||{},[T]:V}});n(O),me.success("")}).catch(()=>{me.error("")}),Zi.LIST_IGNORE),children:i.jsx(Li,{style:{color:"#1677ff",cursor:"pointer",fontSize:12}})}),M&&i.jsx($r,{style:{color:"#ff4d4f",cursor:"pointer",fontSize:11},onClick:()=>{const I=e.map(z=>{if(z.id!==E.id)return z;const V={...z.extended_attrs||{}};return delete V[T],{...z,extended_attrs:V}});n(I)}})]})}})}else if(L.field_type==="thumbnail"){const T=L.field_key;D.push({key:T,title:N,width:80,align:"center",render:(j,E)=>{const R=E[T];return R&&typeof R=="string"?i.jsx("img",{src:R,width:64,height:64,style:{objectFit:"contain",background:"#fff",borderRadius:2}}):i.jsx("div",{style:{width:64,height:64,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4},children:i.jsx(rr,{style:{color:"#d9d9d9",fontSize:16}})})}})}else{const T=L.field_type==="number"?"number":L.field_type==="select"?"select":L.field_type==="boolean"?"checkbox":"text",j=L.field_type==="select"&&L.options?.values?L.options.values.map(E=>({label:E,value:E})):void 0;D.push({key:L.field_key,title:N,width:T==="checkbox"?60:T==="number"?80:100,align:T==="checkbox"?"center":T==="number"?"right":void 0,type:T,options:j,ellipsis:T==="text"})}}return D},[C,u,e,n,l,p,m]);return g?v.length===0?i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE,style:{padding:"16px 0"}}):i.jsx("div",{className:"bom-mobile-card-list",children:v.map((D,L)=>{const N=D.extended_cost??(D.quantity||0)*(D.unit_price||0);return i.jsxs("div",{className:"bom-item-card",children:[i.jsxs("div",{className:"bom-item-card-header",children:[i.jsx("span",{className:"bom-item-card-name",children:D.name||`#${D.item_number||L+1}`}),D.material_code&&i.jsx("span",{className:"bom-item-card-code",children:D.material_code})]}),i.jsxs("div",{className:"bom-item-card-meta",children:[i.jsxs("span",{className:"bom-item-card-meta-item",children:[i.jsx("span",{className:"bom-item-card-meta-label",children:""}),i.jsxs("span",{className:"bom-item-card-meta-value",children:[D.quantity||0," ",D.unit||""]})]}),D.unit_price>0&&i.jsxs("span",{className:"bom-item-card-meta-item",children:[i.jsx("span",{className:"bom-item-card-meta-label",children:""}),i.jsxs("span",{className:"bom-item-card-meta-value",children:["",Number(D.unit_price).toFixed(2)]})]}),N>0&&i.jsxs("span",{className:"bom-item-card-meta-item",children:[i.jsx("span",{className:"bom-item-card-meta-label",children:""}),i.jsxs("span",{className:"bom-item-card-cost",children:["",Number(N).toFixed(2)]})]}),D.supplier&&i.jsxs("span",{className:"bom-item-card-meta-item",children:[i.jsx("span",{className:"bom-item-card-meta-label",children:""}),i.jsx("span",{className:"bom-item-card-meta-value",children:D.supplier})]})]})]},D.id||L)})}):i.jsx(cE,{columns:S,items:v,onCellSave:_,onDeleteRow:y,readonly:l,rowKey:(D,L)=>D.id||String(L),pageSize:Xz,emptyText:i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE})})},Zz=t=>t==null||isNaN(t)?"-":`${t.toFixed(2)}`,Kv=({bomType:t,items:e,categories:n,getEnabledSubCategories:s,readonly:o,totalCost:l,onAddRow:d,onItemClick:u})=>{const h=P.useMemo(()=>{const L={};for(const T of e){const j=T.sub_category||"unknown";L[j]||(L[j]=[]),L[j].push(T)}const N=[];for(const T of n){const j=s(T),E=(Kc[T]||[]).filter(M=>j.includes(M)),R=e.filter(M=>M.category===T);if(!(o&&R.length===0))if(E.length===1){const M=E[0],I=L[M]||[];if(o&&I.length===0)continue;N.push({key:`${T}-${M}`,label:Yr[M]||M,isParent:!1,category:T,subCategory:M,count:I.length})}else{N.push({key:T,label:tr[T]||T,isParent:!0,count:R.length});for(const M of E){const I=L[M]||[];o&&I.length===0||N.push({key:`${T}-${M}`,label:Yr[M]||M,isParent:!1,parentKey:T,category:T,subCategory:M,count:I.length})}}}return{tree:N,itemsBySub:L}},[e,n,s,o]),p=h.tree.filter(L=>!L.isParent),[m,g]=P.useState(p[0]?.key||""),[v,C]=P.useState(()=>{const L=p[0];return L?.parentKey?{[L.parentKey]:!0}:{}}),b=P.useRef(null),_=P.useRef({}),y=P.useRef(!1),S=P.useCallback(L=>{C(N=>{const T={...N,[L]:!N[L]};if(T[L]){const j=h.tree.find(E=>!E.isParent&&E.parentKey===L);j&&(g(j.key),setTimeout(()=>{const E=_.current[j.key];E&&b.current&&(y.current=!0,E.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{y.current=!1},600))},50))}return T})},[h.tree]),D=P.useCallback(L=>{g(L);const N=_.current[L];N&&b.current&&(y.current=!0,N.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{y.current=!1},600))},[]);return P.useEffect(()=>{const L=b.current;if(!L)return;const N=new IntersectionObserver(T=>{if(!y.current){for(const j of T)if(j.isIntersecting){const E=j.target.getAttribute("data-section-key");if(E){g(E);const R=h.tree.find(M=>M.key===E);R?.parentKey&&C(M=>({...M,[R.parentKey]:!0}))}break}}},{root:L,rootMargin:"-10% 0px -80% 0px",threshold:0});for(const T of Object.keys(_.current)){const j=_.current[T];j&&N.observe(j)}return()=>N.disconnect()},[h.tree]),e.length===0&&o?i.jsx("div",{style:{padding:16},children:i.jsx(ft,{description:`${t}`})}):i.jsxs("div",{className:"bom-catview",children:[i.jsxs("div",{className:"bom-catview-summary",children:[i.jsx("span",{className:"bom-catview-summary-type",children:t}),i.jsxs("span",{className:"bom-catview-summary-count",children:[e.length,""]}),i.jsx("span",{className:"bom-catview-summary-cost",children:Zz(l)})]}),i.jsxs("div",{className:"bom-catview-body",children:[i.jsx("div",{className:"bom-catview-nav",children:h.tree.map(L=>{if(L.isParent){const N=h.tree.some(T=>!T.isParent&&T.parentKey===L.key&&T.key===m);return i.jsxs("div",{className:`bom-catview-nav-item is-parent ${N?"has-active":""}`,onClick:()=>S(L.key),children:[L.label,i.jsx("span",{className:"bom-catview-nav-count",children:L.count})]},L.key)}return L.parentKey&&!v[L.parentKey]?null:i.jsxs("div",{className:`bom-catview-nav-item ${L.parentKey?"is-child":""} ${m===L.key?"active":""}`,onClick:()=>D(L.key),children:[L.label,L.count>0&&i.jsx("span",{className:"bom-catview-nav-badge",children:L.count})]},L.key)})}),i.jsx("div",{className:"bom-catview-content",ref:b,children:p.map(L=>{const N=h.itemsBySub[L.subCategory]||[];return i.jsxs("div",{ref:T=>{_.current[L.key]=T},"data-section-key":L.key,className:"bom-catview-section",children:[i.jsxs("div",{className:"bom-catview-section-header",children:[i.jsx("span",{className:"bom-catview-section-title",children:L.label}),i.jsxs("span",{className:"bom-catview-section-count",children:[N.length,""]}),!o&&d&&L.category&&L.subCategory&&i.jsx(J,{type:"link",size:"small",icon:i.jsx(Yt,{}),className:"bom-catview-add-btn",onClick:()=>d(L.category,L.subCategory),children:""})]}),N.length===0?i.jsx("div",{className:"bom-catview-empty",children:""}):N.map((T,j)=>{const E=T.extended_cost??(T.quantity||0)*(T.unit_price||0);return i.jsxs("div",{className:"bom-catview-card",onClick:()=>u?.(T),children:[i.jsxs("div",{className:"bom-catview-card-top",children:[T.material_code&&i.jsx("span",{className:"bom-catview-card-code",children:T.material_code}),T._source&&i.jsx(_e,{color:T._source==="EBOM"?"blue":"orange",style:{margin:0,fontSize:10,lineHeight:"16px",padding:"0 4px"},children:T._source})]}),i.jsx("div",{className:"bom-catview-card-name",children:T.name||`#${T.item_number||j+1}`}),i.jsxs("div",{className:"bom-catview-card-bottom",children:[i.jsxs("span",{className:"bom-catview-card-qty",children:[T.quantity||0,T.unit||"pcs"]}),T.unit_price>0&&i.jsxs("span",{className:"bom-catview-card-price",children:["",Number(T.unit_price).toFixed(2)]}),E>0&&i.jsxs("span",{className:"bom-catview-card-cost",children:["",Number(E).toFixed(2)]})]})]},T.id||j)})]},L.key)})})]})]})},{Text:du}=An,gE=({open:t,onClose:e,onSelect:n,onCreate:s,onSkip:o,category:l,subCategory:d})=>{const[u,h]=P.useState(""),[p,m]=P.useState(!1),[g]=ee.useForm(),{data:v=[],isFetching:C}=ct({queryKey:["bom-item-search",u,l],queryFn:()=>Zt.searchItems({q:u,category:l,limit:20}),enabled:t&&u.length>0,staleTime:15e3}),b=P.useCallback(T=>{h(T),m(!1)},[]),_=P.useCallback(T=>{n({...T,id:"new-"+Date.now(),bom_id:void 0}),h(""),m(!1)},[n]),y=P.useCallback(()=>{g.validateFields().then(T=>{s({id:"new-"+Date.now(),category:l,sub_category:d,quantity:1,unit:"pcs",extended_attrs:{},...T}),g.resetFields(),h(""),m(!1)})},[g,s,l,d]),S=P.useCallback(()=>{o(),h(""),m(!1)},[o]),D=P.useCallback(()=>{h(""),m(!1),e()},[e]),L=tr[l]||l,N=Yr[d]||d;return i.jsxs(Nt,{title:` - ${L} / ${N}`,open:t,onCancel:D,footer:null,width:600,destroyOnClose:!0,children:[i.jsx(Pe,{prefix:i.jsx(gi,{}),placeholder:"MPN...",value:u,onChange:T=>b(T.target.value),allowClear:!0,size:"large",style:{marginBottom:16},autoFocus:!0}),u.length>0&&!p&&i.jsxs("div",{style:{marginBottom:16},children:[C?i.jsx("div",{style:{textAlign:"center",padding:24},children:i.jsx(tn,{})}):v.length>0?i.jsx(wa,{dataSource:v,size:"small",style:{maxHeight:300,overflow:"auto"},renderItem:T=>i.jsx(wa.Item,{style:{cursor:"pointer",padding:"8px 12px"},onClick:()=>_(T),actions:[i.jsx(J,{type:"link",size:"small",children:""},"add")],children:i.jsx(wa.Item.Meta,{title:i.jsxs(Be,{size:4,children:[i.jsx(du,{strong:!0,style:{fontSize:13},children:T.name}),T.mpn&&i.jsx(_e,{color:"blue",style:{fontSize:11},children:T.mpn})]}),description:i.jsxs(Be,{size:8,style:{fontSize:11},children:[T.category&&i.jsx(_e,{style:{fontSize:10},children:tr[T.category]||T.category}),T.supplier&&i.jsxs(du,{type:"secondary",children:[": ",T.supplier]}),T.extended_attrs?.specification&&i.jsx(du,{type:"secondary",ellipsis:!0,style:{maxWidth:200},children:T.extended_attrs.specification})]})})})}):i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE,style:{padding:"16px 0"}}),i.jsx(J,{type:"dashed",icon:i.jsx(Yt,{}),onClick:()=>m(!0),block:!0,style:{marginTop:8},children:""})]}),p&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(du,{strong:!0,style:{display:"block",marginBottom:8},children:""}),i.jsxs(ee,{form:g,layout:"vertical",size:"small",children:[i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsxs(Be,{style:{width:"100%"},size:8,children:[i.jsx(ee.Item,{name:"quantity",label:"",initialValue:1,style:{flex:1},children:i.jsx(en,{min:0,style:{width:"100%"}})}),i.jsx(ee.Item,{name:"unit",label:"",initialValue:"pcs",style:{flex:1},children:i.jsx(Xe,{options:[{label:"pcs",value:"pcs"},{label:"set",value:"set"},{label:"kg",value:"kg"},{label:"m",value:"m"}]})})]}),l==="electronic"&&i.jsx(ee.Item,{name:"mpn",label:"MPN ()",children:i.jsx(Pe,{placeholder:" GRM155R71C104KA88D"})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2})}),i.jsxs(Be,{children:[i.jsx(J,{type:"primary",onClick:y,children:""}),i.jsx(J,{onClick:()=>m(!1),children:""})]})]})]}),!p&&u.length===0&&i.jsxs("div",{style:{textAlign:"center",padding:"24px 0"},children:[i.jsx(du,{type:"secondary",style:{display:"block",marginBottom:12},children:""}),i.jsx(J,{type:"dashed",icon:i.jsx(Yt,{}),onClick:()=>m(!0),children:""})]}),i.jsx("div",{style:{textAlign:"center",marginTop:12,borderTop:"1px solid #f0f0f0",paddingTop:12},children:i.jsx(J,{type:"link",size:"small",onClick:S,children:""})})]})},{Text:jr}=An,Jz={electronic:i.jsx(Ps,{style:{color:"#595959"}}),structural:i.jsx(IT,{style:{color:"#595959"}}),optical:i.jsx(rr,{style:{color:"#595959"}})},ek={electronic:"#f0f5ff",structural:"#f6ffed",optical:"#fff7e6"},Hw=t=>t==null||isNaN(t)?"-":`${t.toFixed(2)}`,sf=({config:t,value:e,onChange:n,readonly:s=!1,onItemSave:o,onImportExcel:l,showMaterialCode:d=!1,editableCategories:u,onItemClick:h,onMobileAddRow:p})=>{const m=Array.isArray(e)?e:[],g=Tn(),{data:v=[],isLoading:C}=ct({queryKey:["bom-attr-templates"],queryFn:()=>Zt.listTemplates(),staleTime:300*1e3}),b=P.useCallback(A=>s?!1:u?u.includes(A):!0,[s,u]),_=P.useMemo(()=>t?.visible_categories?.length>0?t.visible_categories.filter(A=>ku.includes(A)):ku,[t]),y=P.useCallback(A=>t?.category_config?.[A]?.enabled_sub_categories?.length>0?t.category_config[A].enabled_sub_categories:Kc[A]||[],[t]),S=P.useCallback(A=>t?.category_config?.[A]?.sub_category_order?.length>0?t.category_config[A].sub_category_order:y(A),[t,y]),D=P.useCallback((A,q)=>t?.category_config?.[A]?.field_order?.[q],[t]),L=P.useMemo(()=>{const A={};for(const q of m){const B=q.sub_category||"unknown";A[B]||(A[B]=[]),A[B].push(q)}return A},[m]),N=P.useCallback(A=>v.filter(q=>q.sub_category===A&&q.bom_type==="EBOM"),[v]),T=P.useCallback((A,q)=>{const B=m.filter(W=>W.sub_category!==A);n([...B,...q])},[m,n]),[j,E]=P.useState(!1),[R,M]=P.useState({category:"",subCategory:""}),I=P.useCallback((A,q)=>{M({category:A,subCategory:q}),E(!0)},[]),z=P.useCallback(A=>{const q=m.reduce((W,Q)=>Math.max(W,Q.item_number||0),0),B={id:"new-"+Date.now(),item_number:q+1,category:R.category,sub_category:R.subCategory,quantity:1,unit:"pcs",extended_attrs:{},...A};n([...m,B]),E(!1)},[m,n,R]),V=P.useCallback((A,q)=>{const B=m.reduce((Q,ne)=>Math.max(Q,ne.item_number||0),0),W={id:"new-"+Date.now(),item_number:B+1,category:A,sub_category:q,name:"",quantity:1,unit:"pcs",extended_attrs:{}};n([...m,W])},[m,n]),O=P.useMemo(()=>m.reduce((A,q)=>{const B=q.extended_cost??(q.quantity||0)*(q.unit_price||0);return A+(B||0)},0),[m]),k=(A,q)=>{const B=L[q]||[],W=N(q),Q=D(A,q),ne=Yr[q]||q,de=b(A);return s&&B.length===0?null:i.jsxs("div",{style:{marginBottom:12,opacity:!de&&!s?.6:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 12px",background:"#fafafa",borderRadius:"4px 4px 0 0",borderBottom:"1px solid #f0f0f0"},children:[i.jsx(jr,{style:{fontSize:13,fontWeight:500},children:ne}),i.jsxs(_e,{style:{fontSize:11},children:[B.length," "]}),i.jsx("div",{style:{flex:1}}),de&&i.jsx(J,{type:"dashed",size:"small",icon:i.jsx(Yt,{}),onClick:()=>I(A,q),children:""})]}),i.jsx(mE,{subCategory:q,items:B,onChange:$=>T(q,$),fieldOrder:Q,templates:W,readonly:s||!de,onItemSave:o,showMaterialCode:d,bomType:"EBOM",category:A})]},`${A}-${q}`)},F=A=>{const q=S(A),B=y(A),W=Jz[A]||i.jsx(Ps,{style:{color:"#595959"}}),Q=ek[A]||"#fafafa",ne=tr[A]||A,de=m.filter(X=>X.category===A),$=q.filter(X=>B.includes(X)).map(X=>k(A,X)).filter(Boolean);return s&&$.length===0?null:i.jsxs("div",{style:{marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 12px",background:Q,borderRadius:6,borderBottom:"1px solid #e8e8e8"},children:[W,i.jsx(jr,{strong:!0,style:{fontSize:14},children:ne}),i.jsxs(_e,{style:{fontSize:11},children:[de.length," "]}),i.jsx("div",{style:{flex:1}}),b(A)&&i.jsxs(Be,{size:8,children:[i.jsx(J,{size:"small",icon:i.jsx(Fc,{}),children:""}),i.jsx(J,{size:"small",icon:i.jsx(Li,{}),children:""})]})]}),i.jsx("div",{style:{paddingLeft:16,paddingTop:8},children:q.filter(X=>B.includes(X)).map(X=>k(A,X))})]},A)};return C?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):g?i.jsx(Kv,{bomType:"EBOM",items:m,categories:_,getEnabledSubCategories:y,readonly:s,totalCost:O,onAddRow:s?void 0:p||V,onItemClick:h}):i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 0",marginBottom:8,borderBottom:"2px solid #1677ff"},children:[i.jsx(jr,{strong:!0,style:{fontSize:16},children:"EBOM"}),i.jsxs(_e,{color:"blue",children:[m.length," "]}),!s&&l&&i.jsx(J,{size:"small",onClick:l,style:{marginLeft:"auto"},children:"Excel"})]}),m.length===0&&s&&i.jsx(ft,{description:"EBOM"}),_.map(A=>F(A)),m.length>0&&i.jsxs("div",{style:{display:"flex",gap:24,padding:"10px 16px",background:"#fafafa",borderRadius:6,border:"1px solid #f0f0f0",flexWrap:"wrap",marginTop:8},children:[_.map(A=>{const B=m.filter(W=>W.category===A).reduce((W,Q)=>{const ne=Q.extended_cost??(Q.quantity||0)*(Q.unit_price||0);return W+(ne||0)},0);return i.jsxs(jr,{style:{fontSize:12},children:[tr[A]||A,": ",i.jsx(jr,{strong:!0,children:Hw(B)})]},A)}),i.jsxs(jr,{style:{fontSize:13},children:["EBOM: ",i.jsx(jr,{strong:!0,style:{color:"#1677ff"},children:Hw(O)})]}),i.jsxs(jr,{type:"secondary",style:{fontSize:12},children:[" ",m.length," "]}),m.filter(A=>A.unit_price==null||A.unit_price===0).length>0&&i.jsxs(jr,{type:"warning",style:{fontSize:12},children:[m.filter(A=>A.unit_price==null||A.unit_price===0).length,""]})]}),i.jsx(gE,{open:j,onClose:()=>E(!1),onSelect:z,onCreate:z,onSkip:()=>{V(R.category,R.subCategory),E(!1)},category:R.category,subCategory:R.subCategory})]})},{Text:So}=An,tk={packaging:i.jsx(OT,{style:{color:"#595959"}}),tooling:i.jsx(Np,{style:{color:"#595959"}}),consumable:i.jsx(Ps,{style:{color:"#595959"}})},nk={packaging:"#fff7e6",tooling:"#f9f0ff",consumable:"#f0f5ff"},Vw=t=>t==null||isNaN(t)?"-":`${t.toFixed(2)}`,rf=({config:t,value:e,onChange:n,readonly:s=!1,onItemSave:o,onImportExcel:l,showMaterialCode:d=!1,editableCategories:u,onItemClick:h,onMobileAddRow:p})=>{const m=Array.isArray(e)?e:[],g=Tn(),{data:v=[],isLoading:C}=ct({queryKey:["bom-attr-templates"],queryFn:()=>Zt.listTemplates(),staleTime:300*1e3}),b=P.useCallback(F=>s?!1:u?u.includes(F):!0,[s,u]),_=P.useMemo(()=>t?.visible_categories?.length>0?t.visible_categories.filter(F=>Bu.includes(F)):Bu,[t]),y=P.useCallback(F=>t?.category_config?.[F]?.enabled_sub_categories?.length>0?t.category_config[F].enabled_sub_categories:Kc[F]||[],[t]),S=P.useCallback(F=>t?.category_config?.[F]?.sub_category_order?.length>0?t.category_config[F].sub_category_order:y(F),[t,y]),D=P.useCallback((F,A)=>t?.category_config?.[F]?.field_order?.[A],[t]),L=P.useMemo(()=>{const F={};for(const A of m){const q=A.sub_category||"unknown";F[q]||(F[q]=[]),F[q].push(A)}return F},[m]),N=P.useCallback(F=>v.filter(A=>A.sub_category===F&&A.bom_type==="PBOM"),[v]),T=P.useCallback((F,A)=>{const q=m.filter(B=>B.sub_category!==F);n([...q,...A])},[m,n]),[j,E]=P.useState(!1),[R,M]=P.useState({category:"",subCategory:""}),I=P.useCallback((F,A)=>{M({category:F,subCategory:A}),E(!0)},[]),z=P.useCallback(F=>{const A=m.reduce((B,W)=>Math.max(B,W.item_number||0),0),q={id:"new-"+Date.now(),item_number:A+1,category:R.category,sub_category:R.subCategory,quantity:1,unit:"pcs",extended_attrs:{},...F};n([...m,q]),E(!1)},[m,n,R]),V=P.useCallback((F,A)=>{const q=m.reduce((W,Q)=>Math.max(W,Q.item_number||0),0),B={id:"new-"+Date.now(),item_number:q+1,category:F,sub_category:A,name:"",quantity:1,unit:"pcs",extended_attrs:{}};n([...m,B])},[m,n]),O=P.useMemo(()=>m.reduce((F,A)=>{const q=A.extended_cost??(A.quantity||0)*(A.unit_price||0);return F+(q||0)},0),[m]),k=(F,A)=>{const q=L[A]||[],B=N(A),W=D(F,A),Q=Yr[A]||A,ne=tk[F]||i.jsx(Ps,{style:{color:"#595959"}}),de=nk[F]||"#fafafa",$=b(F);return s&&q.length===0?null:i.jsxs("div",{style:{marginBottom:16,opacity:!$&&!s?.6:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 12px",background:de,borderRadius:"6px 6px 0 0",borderBottom:"1px solid #f0f0f0"},children:[ne,i.jsx(So,{strong:!0,style:{fontSize:13},children:Q}),i.jsxs(_e,{style:{fontSize:11},children:[q.length," "]})]}),i.jsx(mE,{subCategory:A,items:q,onChange:X=>T(A,X),fieldOrder:W,templates:B,readonly:s||!$,onItemSave:o,showMaterialCode:d,bomType:"PBOM",category:F}),$&&i.jsx("div",{style:{padding:"4px 12px"},children:i.jsx(J,{type:"dashed",size:"small",icon:i.jsx(Yt,{}),onClick:()=>I(F,A),children:""})})]},`${F}-${A}`)};return C?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):g?i.jsx(Kv,{bomType:"PBOM",items:m,categories:_,getEnabledSubCategories:y,readonly:s,totalCost:O,onAddRow:s?void 0:p||V,onItemClick:h}):i.jsxs("div",{children:[!s&&l&&i.jsx("div",{style:{marginBottom:12},children:i.jsx(J,{size:"small",onClick:l,children:"Excel"})}),m.length===0&&s&&i.jsx(ft,{description:"PBOM"}),_.map(F=>{const A=S(F),q=y(F);return i.jsx("div",{children:A.filter(B=>q.includes(B)).map(B=>k(F,B))},F)}),t?.show_route_editor&&i.jsx("div",{style:{marginTop:16,padding:"16px",background:"#fafafa",borderRadius:6,border:"1px dashed #d9d9d9",textAlign:"center"},children:i.jsx(So,{type:"secondary",children:""})}),m.length>0&&i.jsxs("div",{style:{display:"flex",gap:24,padding:"10px 16px",background:"#fafafa",borderRadius:6,border:"1px solid #f0f0f0",flexWrap:"wrap",marginTop:8},children:[_.map(F=>{const q=m.filter(B=>B.category===F).reduce((B,W)=>{const Q=W.extended_cost??(W.quantity||0)*(W.unit_price||0);return B+(Q||0)},0);return i.jsxs(So,{style:{fontSize:12},children:[tr[F]||F,": ",i.jsx(So,{strong:!0,children:Vw(q)})]},F)}),i.jsxs(So,{style:{fontSize:13},children:["PBOM: ",i.jsx(So,{strong:!0,style:{color:"#1677ff"},children:Vw(O)})]}),i.jsxs(So,{type:"secondary",style:{fontSize:12},children:[" ",m.length," "]}),m.filter(F=>F.unit_price==null||F.unit_price===0).length>0&&i.jsxs(So,{type:"warning",style:{fontSize:12},children:[m.filter(F=>F.unit_price==null||F.unit_price===0).length,""]})]}),i.jsx(gE,{open:j,onClose:()=>E(!1),onSelect:z,onCreate:z,onSkip:()=>{V(R.category,R.subCategory),E(!1)},category:R.category,subCategory:R.subCategory})]})},{Text:bs}=An,ik={electronic:i.jsx(Ps,{style:{color:"#595959"}}),structural:i.jsx(IT,{style:{color:"#595959"}}),optical:i.jsx(rr,{style:{color:"#595959"}}),packaging:i.jsx(OT,{style:{color:"#595959"}}),tooling:i.jsx(Np,{style:{color:"#595959"}}),consumable:i.jsx(Ps,{style:{color:"#595959"}})},ak={electronic:"#f0f5ff",structural:"#f6ffed",optical:"#fff7e6",packaging:"#fff7e6",tooling:"#f9f0ff",consumable:"#f0f5ff"},Wx=t=>t==null||isNaN(t)?"-":`${t.toFixed(2)}`,of=({config:t,value:e,onChange:n,readonly:s=!1,onItemSave:o,ebomData:l,pbomData:d,showMaterialCode:u=!1,editableCategories:h,onItemClick:p})=>{const m=Array.isArray(e)?e:[],g=Tn(),v=P.useMemo(()=>{const N=(l||[]).map(j=>({...j,_source:"EBOM"})),T=(d||[]).map(j=>({...j,_source:"PBOM"}));return[...N,...T]},[l,d]),C=P.useMemo(()=>{const N={};for(const T of m){const j=T.sub_category||"unknown";N[j]||(N[j]=[]),N[j].push(T)}return N},[m]),b=P.useMemo(()=>t?.visible_categories?.length>0?t.visible_categories:oE,[t]),_=P.useCallback(N=>t?.category_config?.[N]?.enabled_sub_categories?.length>0?t.category_config[N].enabled_sub_categories:Kc[N]||[],[t]),y=P.useCallback((N,T)=>{if(o)o(N,"scrap_rate",T);else{const j=m.map(E=>E.id===N?{...E,scrap_rate:T}:E);n(j)}},[m,n,o]),S=P.useCallback(N=>{const T=[{title:"",dataIndex:"item_number",width:55,align:"center"}];return u&&T.push({title:"",dataIndex:"material_code",width:150,render:j=>j?i.jsx("span",{style:{background:"#f5f5f5",border:"1px solid #d9d9d9",borderRadius:4,padding:"2px 8px",fontFamily:"monospace",fontSize:13,whiteSpace:"nowrap"},children:j}):i.jsx(bs,{type:"secondary",style:{fontSize:11},children:"-"})}),T.push({title:"",dataIndex:"name",width:120},{title:"",dataIndex:"quantity",width:60,align:"right"},{title:"",dataIndex:"unit",width:55},{title:"",dataIndex:"supplier",width:100,ellipsis:!0},{title:"",dataIndex:"unit_price",width:80,align:"right",render:j=>j!=null?Number(j).toFixed(2):"-"},{title:"",width:80,align:"right",render:(j,E)=>{const R=E.extended_cost??(E.quantity||0)*(E.unit_price||0);return R>0?Number(R).toFixed(2):"-"}}),t?.editable_scrap_rate&&T.push({title:"(%)",dataIndex:"scrap_rate",width:90,align:"right",render:(j,E)=>s?j!=null?`${j}%`:"-":i.jsx(en,{size:"small",value:j,min:0,max:100,step:.1,style:{width:"100%"},onChange:R=>y(E.id,R??0)})}),T.push({title:"",dataIndex:"_source",width:70,align:"center",render:j=>j?i.jsx(_e,{color:j==="EBOM"?"blue":"orange",children:j}):"-"}),T.push({title:"",dataIndex:"notes",width:120,ellipsis:!0}),T},[t,s,y,u]),D=P.useMemo(()=>m.reduce((N,T)=>{const j=T.extended_cost??(T.quantity||0)*(T.unit_price||0);return N+(j||0)},0),[m]),L=(N,T)=>{const j=C[T]||[],E=Yr[T]||T,R=ik[N]||i.jsx(Ps,{style:{color:"#595959"}}),M=ak[N]||"#fafafa",I=S(T);if(j.length===0)return null;const z=j.map(V=>({...V,...V.extended_attrs||{}}));return i.jsxs("div",{style:{marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 12px",background:M,borderRadius:"6px 6px 0 0",borderBottom:"1px solid #f0f0f0"},children:[R,i.jsx(bs,{strong:!0,style:{fontSize:13},children:E}),i.jsxs(_e,{style:{fontSize:11},children:[j.length," "]})]}),i.jsx(sn,{columns:I,dataSource:z,rowKey:V=>V.id||String(Math.random()),size:"small",pagination:j.length>10?{pageSize:10,size:"small"}:!1,scroll:{x:800},style:{fontSize:12}})]},`${N}-${T}`)};return g?i.jsx(Kv,{bomType:"MBOM",items:m,categories:b,getEnabledSubCategories:_,readonly:!0,totalCost:D,onItemClick:p}):i.jsxs("div",{children:[m.length===0&&v.length===0&&i.jsx(ft,{description:"MBOMEBOM/PBOM"}),v.length>0&&m.length===0&&i.jsx("div",{style:{padding:"12px 16px",background:"#fffbe6",borderRadius:6,border:"1px solid #ffe58f",marginBottom:16},children:i.jsxs(bs,{type:"secondary",style:{fontSize:12},children:[" ",(l||[]).length," EBOM ",(d||[]).length," PBOM MBOM"]})}),b.map(N=>{const T=_(N);return i.jsx("div",{children:T.map(j=>L(N,j))},N)}),m.length>0&&i.jsxs("div",{style:{display:"flex",gap:24,padding:"10px 16px",background:"#fafafa",borderRadius:6,border:"1px solid #f0f0f0",flexWrap:"wrap",marginTop:8},children:[i.jsxs(bs,{style:{fontSize:12},children:["EBOM: ",i.jsx(bs,{strong:!0,children:Wx(m.filter(N=>ku.includes(N.category)).reduce((N,T)=>N+((T.extended_cost??(T.quantity||0)*(T.unit_price||0))||0),0))})]}),i.jsxs(bs,{style:{fontSize:12},children:["PBOM: ",i.jsx(bs,{strong:!0,children:Wx(m.filter(N=>Bu.includes(N.category)).reduce((N,T)=>N+((T.extended_cost??(T.quantity||0)*(T.unit_price||0))||0),0))})]}),i.jsxs(bs,{style:{fontSize:13},children:["MBOM: ",i.jsx(bs,{strong:!0,style:{color:"#1677ff"},children:Wx(D)})]}),i.jsxs(bs,{type:"secondary",style:{fontSize:12},children:[" ",m.length," "]}),m.filter(N=>N.unit_price==null||N.unit_price===0).length>0&&i.jsxs(bs,{type:"warning",style:{fontSize:12},children:[m.filter(N=>N.unit_price==null||N.unit_price===0).length,""]})]})]})},{Text:uu}=An,sk={created:{color:"blue",text:""},sourcing:{color:"processing",text:""},completed:{color:"success",text:""},cancelled:{color:"default",text:""},pending:{color:"orange",text:""}},Xv=({value:t})=>{if(!t)return i.jsx(uu,{type:"secondary",children:""});const{sources:e,pr_code:n,pr_status:s,error:o}=t,l=sk[s||""]||{color:"default",text:s||""};return i.jsxs("div",{children:[o&&i.jsx("div",{style:{color:"#ff4d4f",marginBottom:8},children:i.jsxs(uu,{type:"danger",children:[": ",o]})}),n&&i.jsx("div",{style:{marginBottom:8},children:i.jsxs(Be,{children:[i.jsx(zo,{}),i.jsx(uu,{strong:!0,children:":"}),i.jsx(_e,{icon:i.jsx($R,{}),color:l.color,children:n}),i.jsx(uu,{type:"secondary",children:l.text})]})}),e&&e.length>0&&i.jsx(sn,{size:"small",dataSource:e,rowKey:d=>`${d.task_code}-${d.field_key}`,pagination:!1,columns:[{title:"",dataIndex:"task_code",width:120},{title:"",dataIndex:"field_label",width:150},{title:"",dataIndex:"item_count",width:80,align:"right"}]}),!n&&!o&&!e?.length&&i.jsx(uu,{type:"secondary",children:""})]})},{Title:rk,Text:At,Paragraph:ok}=An,_0=["concept","evt","dvt","pvt","mp"],Gp={concept:"purple",evt:"blue",dvt:"cyan",pvt:"orange",mp:"green",CONCEPT:"purple",EVT:"blue",DVT:"cyan",PVT:"orange",MP:"green"},lk={concept:"",evt:"EVT ",dvt:"DVT ",pvt:"PVT ",mp:"MP "},xE={planning:"default",active:"processing",on_hold:"warning",completed:"success",cancelled:"error"},Lr={unassigned:{color:"default",text:"",icon:i.jsx(WR,{}),barColor:"#d9d9d9"},pending:{color:"default",text:"",icon:i.jsx(er,{}),barColor:"#bfbfbf"},in_progress:{color:"processing",text:"",icon:i.jsx(er,{}),barColor:"#1677ff"},submitted:{color:"warning",text:"",icon:i.jsx(ra,{}),barColor:"#faad14"},reviewing:{color:"warning",text:"",icon:i.jsx(Cl,{}),barColor:"#faad14"},completed:{color:"success",text:"",icon:i.jsx(ra,{}),barColor:"#52c41a"},rejected:{color:"error",text:"",icon:i.jsx($r,{}),barColor:"#ff4d4f"}},il=36,Yx=50,Ss=28,ck=650,dk=({currentPhase:t})=>{const e=_0.indexOf(t?.toLowerCase());return i.jsx("div",{style:{display:"flex",alignItems:"center",gap:4},children:_0.map((n,s)=>{let o="",l=400;return s<e?o="":s===e&&(o="",l=600),i.jsxs(Pn.Fragment,{children:[s>0&&i.jsx("span",{style:{color:s<=e?"#1890ff":"#d9d9d9",fontSize:12},children:""}),i.jsxs("span",{style:{fontWeight:l,fontSize:13,color:s<=e?"#333":"#999"},children:[o," ",n.toUpperCase()]})]},n)})})},uk=({tasks:t,projectId:e,onCompleteTask:n,completingTask:s,onRefresh:o})=>{const l=Tn(),[d,u]=P.useState(new Set),[h,p]=P.useState(new Set),[m,g]=P.useState("phase"),v=P.useRef(null),C=P.useRef(null),b=O=>{C.current&&(C.current.scrollTop=O.currentTarget.scrollTop)},_=O=>{v.current&&(v.current.scrollTop=O.currentTarget.scrollTop)},y=O=>{const k=new Map,F=[];return O.forEach(A=>k.set(A.id,{...A,children:[],depth:0})),k.forEach(A=>{if(A.parent_task_id&&k.has(A.parent_task_id)){const q=k.get(A.parent_task_id);A.depth=q.depth+1,q.children.push(A)}else F.push(A)}),F},S=O=>{const k=[],F=(A,q)=>{A.forEach(B=>{B.depth=q,k.push(B),B.children.length>0&&!h.has(B.id)&&F(B.children,q+1)})};return F(O,0),k},D=P.useMemo(()=>{if(m==="none"){const F=y(t);return[{phase:"",label:"",tasks:S(F)}]}const O=["concept","evt","dvt","pvt","mp",""],k=new Map;return t.forEach(F=>{const A=(typeof F.phase=="object"&&F.phase!==null?F.phase.phase:F.phase||"").toLowerCase();k.has(A)||k.set(A,[]),k.get(A).push(F)}),O.filter(F=>k.has(F)).map(F=>{const A=y(k.get(F));return{phase:F,label:lk[F]||(F?F.toUpperCase():""),tasks:S(A)}})},[t,m,h]),{startDate:L,endDate:N,totalDays:T}=P.useMemo(()=>{let O=lt().subtract(7,"day"),k=lt().add(30,"day");return t.forEach(F=>{if(F.start_date){const A=lt(F.start_date);A.isBefore(O)&&(O=A)}if(F.due_date){const A=lt(F.due_date);A.isAfter(k)&&(k=A)}}),O=O.subtract(7,"day").startOf("week"),k=k.add(14,"day").endOf("week"),{startDate:O,endDate:k,totalDays:k.diff(O,"day")+1}},[t]),j=P.useMemo(()=>{const O=[];let k=L;for(;k.isBefore(N);){const F=k.endOf("month"),q=(F.isAfter(N)?N:F).diff(k,"day")+1;O.push({label:k.format("YYYYM"),days:q,offset:k.diff(L,"day")}),k=F.add(1,"day")}return O},[L,N]),E=P.useMemo(()=>{const O=[];for(let k=0;k<T;k++){const F=L.add(k,"day");O.push({label:F.format("D"),date:F,isWeekend:F.day()===0||F.day()===6,isToday:F.isSame(lt(),"day")})}return O},[L,T]);P.useEffect(()=>{if(v.current){const O=lt().diff(L,"day"),k=Math.max(0,O*Ss-200);v.current.scrollLeft=k}},[L]);const R=O=>{const k=O.start_date?lt(O.start_date):null,F=O.due_date?lt(O.due_date):null;if(!k&&!F)return null;const A=k||F,q=F||k,B=A.diff(L,"day")*Ss,W=Math.max((q.diff(A,"day")+1)*Ss,Ss);return{left:B,width:W}},M=O=>{u(k=>{const F=new Set(k);return F.has(O)?F.delete(O):F.add(O),F})},I=O=>{p(k=>{const F=new Set(k);return F.has(O)?F.delete(O):F.add(O),F})},z=[];D.forEach(O=>{m==="phase"&&z.push({type:"group",phase:O.phase,label:O.label,count:O.tasks.length}),(!d.has(O.phase)||m==="none")&&O.tasks.forEach(k=>z.push({type:"task",task:k}))});const V=z.length*il;if(l){const O={completed:"",in_progress:"",submitted:"",reviewing:"",pending:"",unassigned:"",rejected:""},k=D.filter(F=>F.tasks.length>0);return i.jsxs("div",{className:"gantt-mobile-list",children:[i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 4px",marginBottom:4},children:i.jsxs(At,{type:"secondary",style:{fontSize:13},children:[t.length," "]})}),k.map(F=>{const A=d.has(F.phase);return i.jsxs("div",{className:"gantt-mobile-phase",children:[i.jsxs("div",{className:"gantt-mobile-phase-header",onClick:()=>M(F.phase),children:[i.jsx(Oi,{className:`gantt-mobile-phase-chevron ${A?"":"expanded"}`}),i.jsx(_e,{color:Gp[F.phase]||"default",style:{margin:0},children:F.label}),i.jsxs(At,{type:"secondary",style:{fontSize:12,marginLeft:"auto"},children:["(",F.tasks.length,")"]})]}),!A&&i.jsx("div",{className:"gantt-mobile-phase-body",children:F.tasks.map(q=>{const B=Lr[q.status]||Lr.pending,W=O[q.status]||"",Q=q.start_date?lt(q.start_date).format("M/D"):"",ne=q.due_date?lt(q.due_date).format("M/D"):"",de=Q&&ne?`${Q}-${ne}`:Q||ne||"",$=q.children.length>0,X=h.has(q.id);return i.jsxs("div",{className:"gantt-mobile-task",style:{paddingLeft:12+q.depth*16},children:[i.jsxs("div",{className:"gantt-mobile-task-row",children:[$?i.jsx("span",{style:{cursor:"pointer",width:18,flexShrink:0,textAlign:"center"},onClick:()=>I(q.id),children:X?i.jsx(Oi,{style:{fontSize:10}}):i.jsx(No,{style:{fontSize:10}})}):i.jsx("span",{style:{width:18,flexShrink:0}}),i.jsx("span",{style:{fontSize:14,flexShrink:0},children:W}),i.jsx("span",{className:"gantt-mobile-task-name",style:{color:q.is_critical?"#cf1322":void 0},children:q.title}),i.jsx("span",{className:"gantt-mobile-task-date",children:de})]}),i.jsx("div",{className:"gantt-mobile-task-progress-track",style:{marginLeft:18+($?18:0)},children:i.jsx("div",{className:"gantt-mobile-task-progress-fill",style:{width:`${q.progress||0}%`,background:B.barColor}})})]},q.id)})})]},F.phase)})]})}return i.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid #f0f0f0"},children:[i.jsxs(Be,{children:[i.jsx(At,{strong:!0,children:""}),i.jsxs(_e,{children:[t.length," "]})]}),i.jsxs(Be,{children:[i.jsx(At,{type:"secondary",children:":"}),i.jsx(Xe,{size:"small",value:m,onChange:g,style:{width:120},options:[{label:"",value:"phase"},{label:"",value:"none"}]})]})]}),i.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden",border:"1px solid #e8e8e8",borderRadius:4},children:[i.jsxs("div",{style:{width:ck,flexShrink:0,borderRight:"2px solid #d9d9d9",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{height:Yx,borderBottom:"1px solid #e8e8e8",display:"flex",alignItems:"center",padding:"0 12px",background:"#fafafa",fontWeight:600,fontSize:13,flexShrink:0},children:[i.jsx("span",{style:{flex:1},children:""}),i.jsx("span",{style:{width:100,textAlign:"center"},children:""}),i.jsx("span",{style:{width:50,textAlign:"center"},children:""}),i.jsx("span",{style:{width:45,textAlign:"center"},children:""}),i.jsx("span",{style:{width:130,textAlign:"center"},children:""})]}),i.jsx("div",{ref:C,onScroll:_,style:{flex:1,overflowY:"auto",overflowX:"hidden"},children:i.jsx("div",{style:{minHeight:V},children:z.map((O,k)=>{if(O.type==="group"){const Q=d.has(O.phase);return i.jsxs("div",{style:{height:il,display:"flex",alignItems:"center",padding:"0 12px",background:"#f5f5f5",cursor:"pointer",borderBottom:"1px solid #f0f0f0",fontWeight:600,fontSize:13},onClick:()=>M(O.phase),children:[Q?i.jsx(Oi,{style:{fontSize:10,marginRight:8}}):i.jsx(No,{style:{fontSize:10,marginRight:8}}),i.jsx(_e,{color:Gp[O.phase]||"default",style:{marginRight:8},children:O.label}),i.jsxs(At,{type:"secondary",style:{fontSize:12},children:["(",O.count,")"]})]},`group-${O.phase}`)}const F=O.task,A=Lr[F.status]||Lr.pending,q=F.children.length>0,B=h.has(F.id),W=F.task_type==="MILESTONE";return i.jsxs("div",{style:{height:il,display:"flex",alignItems:"center",padding:"0 12px",borderBottom:"1px solid #f7f7f7",fontSize:12,background:k%2===0?"#fff":"#fafcff"},children:[i.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",minWidth:0,paddingLeft:F.depth*20},children:[q?i.jsx("span",{style:{cursor:"pointer",marginRight:4,width:16,textAlign:"center",flexShrink:0},onClick:()=>I(F.id),children:B?i.jsx(Oi,{style:{fontSize:9}}):i.jsx(No,{style:{fontSize:9}})}):i.jsx("span",{style:{width:16,marginRight:4,flexShrink:0}}),W&&i.jsx("span",{style:{display:"inline-block",width:10,height:10,background:A.barColor,transform:"rotate(45deg)",marginRight:6,flexShrink:0}}),i.jsx(rn,{title:F.title,children:i.jsxs("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:W?600:F.task_type==="SUBTASK"?400:500,color:F.is_critical?"#cf1322":void 0},children:[F.code||F.task_code?i.jsx(At,{code:!0,style:{fontSize:11,marginRight:4},children:F.code||F.task_code}):null,F.title]})})]}),i.jsx("span",{style:{width:100,flexShrink:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"#666"},children:F.assignee?.name||F.assignee_name?i.jsx(rn,{title:F.assignee?.name||F.assignee_name,children:i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[i.jsx(Pi,{size:18,src:F.assignee?.avatar_url,icon:i.jsx(wi,{}),style:{fontSize:10,flexShrink:0},children:(F.assignee?.name||F.assignee_name)?.[0]}),i.jsx("span",{style:{fontSize:11,overflow:"hidden",textOverflow:"ellipsis"},children:F.assignee?.name||F.assignee_name})]})}):"-"}),i.jsx("span",{style:{width:50,textAlign:"center",flexShrink:0},children:i.jsx(_e,{color:A.color,style:{fontSize:10,padding:"0 4px",margin:0,lineHeight:"18px"},children:A.text})}),i.jsxs("span",{style:{width:45,textAlign:"center",flexShrink:0,fontSize:11,color:"#666"},children:[F.progress,"%"]}),i.jsx("span",{style:{width:130,textAlign:"center",flexShrink:0},onClick:Q=>Q.stopPropagation(),children:i.jsx(_k,{task:F,projectId:e,onRefresh:o})})]},F.id)})})})]}),i.jsx("div",{ref:v,onScroll:b,style:{flex:1,overflow:"auto"},children:i.jsxs("div",{style:{minWidth:T*Ss,position:"relative"},children:[i.jsxs("div",{style:{position:"sticky",top:0,zIndex:10,background:"#fafafa"},children:[i.jsx("div",{style:{display:"flex",height:24,borderBottom:"1px solid #e8e8e8"},children:j.map((O,k)=>i.jsx("div",{style:{width:O.days*Ss,textAlign:"center",fontSize:11,fontWeight:600,lineHeight:"24px",borderRight:"1px solid #e8e8e8",color:"#333"},children:O.label},k))}),i.jsx("div",{style:{display:"flex",height:Yx-24,borderBottom:"1px solid #e8e8e8"},children:E.map((O,k)=>i.jsx("div",{style:{width:Ss,textAlign:"center",fontSize:10,lineHeight:`${Yx-24}px`,color:O.isToday?"#fff":O.isWeekend?"#bbb":"#666",background:O.isToday?"#1677ff":O.isWeekend?"#f9f9f9":"transparent",borderRight:"1px solid #f0f0f0",fontWeight:O.isToday?700:400},children:O.label},k))})]}),i.jsxs("div",{style:{position:"relative"},children:[E.map((O,k)=>O.isWeekend&&i.jsx("div",{style:{position:"absolute",left:k*Ss,top:0,width:Ss,height:V,background:"rgba(0,0,0,0.02)",zIndex:0}},`bg-${k}`)),(()=>{const O=lt().diff(L,"day");return O>=0&&O<=T?i.jsx("div",{style:{position:"absolute",left:O*Ss+Ss/2,top:0,width:2,height:V,background:"#ff4d4f",zIndex:5,opacity:.6}}):null})(),z.map((O,k)=>{if(O.type==="group")return i.jsx("div",{style:{height:il,background:"#f5f5f5",borderBottom:"1px solid #f0f0f0"}},`gbar-${O.phase}`);const F=O.task,A=R(F),q=Lr[F.status]||Lr.pending,B=F.task_type==="MILESTONE";return i.jsxs("div",{style:{height:il,position:"relative",borderBottom:"1px solid #f7f7f7",background:k%2===0?"#fff":"#fafcff"},children:[A&&!B&&i.jsx(rn,{title:i.jsxs("div",{children:[i.jsx("div",{children:i.jsx("strong",{children:F.title})}),i.jsxs("div",{children:[F.start_date||"?","  ",F.due_date||"?"]}),i.jsxs("div",{children:[": ",F.progress,"%"]}),(F.assignee?.name||F.assignee_name)&&i.jsxs("div",{children:[": ",F.assignee?.name||F.assignee_name]})]}),children:i.jsxs("div",{style:{position:"absolute",left:A.left,top:(il-18)/2,width:A.width,height:18,borderRadius:3,background:q.barColor,opacity:.85,zIndex:2,cursor:"pointer",overflow:"hidden",transition:"opacity 0.2s"},onMouseEnter:W=>W.currentTarget.style.opacity="1",onMouseLeave:W=>W.currentTarget.style.opacity="0.85",children:[F.progress>0&&F.progress<100&&i.jsx("div",{style:{position:"absolute",left:0,top:0,width:`${F.progress}%`,height:"100%",background:"rgba(255,255,255,0.3)",borderRadius:"3px 0 0 3px"}}),A.width>80&&i.jsx("span",{style:{position:"absolute",left:6,top:0,lineHeight:"18px",fontSize:10,color:"#fff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:A.width-12},children:F.title})]})}),A&&B&&i.jsx(rn,{title:i.jsxs("div",{children:[i.jsx("div",{children:i.jsxs("strong",{children:[" : ",F.title]})}),i.jsx("div",{children:F.due_date||F.start_date||"-"}),(F.assignee?.name||F.assignee_name)&&i.jsxs("div",{children:[": ",F.assignee?.name||F.assignee_name]})]}),children:i.jsx("div",{style:{position:"absolute",left:A.left+A.width/2-8,top:(il-16)/2,width:16,height:16,background:q.barColor,transform:"rotate(45deg)",zIndex:2,cursor:"pointer",border:"2px solid rgba(255,255,255,0.8)",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"}})})]},F.id)})]})]})})]}),i.jsxs("div",{style:{display:"flex",gap:16,padding:"8px 0",flexWrap:"wrap",alignItems:"center",borderTop:"1px solid #f0f0f0"},children:[i.jsx(At,{type:"secondary",style:{fontSize:12},children:":"}),Object.entries(Lr).map(([O,k])=>i.jsxs(Be,{size:4,children:[i.jsx("span",{style:{display:"inline-block",width:14,height:10,background:k.barColor,borderRadius:2}}),i.jsx(At,{style:{fontSize:11},children:k.text})]},O)),i.jsxs(Be,{size:4,children:[i.jsx("span",{style:{display:"inline-block",width:10,height:10,background:"#1677ff",transform:"rotate(45deg)"}}),i.jsx(At,{style:{fontSize:11},children:""})]}),i.jsxs(Be,{size:4,children:[i.jsx("span",{style:{display:"inline-block",width:2,height:12,background:"#ff4d4f"}}),i.jsx(At,{style:{fontSize:11},children:""})]})]})]})},fk=({project:t})=>{const e=Tn(),n=t.status==="planning"?"":t.status==="active"?"":t.status==="completed"?"":t.status==="on_hold"?"":t.status;if(e){const s=t.status==="active"?"ds-tag-processing":t.status==="completed"?"ds-tag-success":t.status==="on_hold"?"ds-tag-warning":t.status==="cancelled"?"ds-tag-danger":"ds-tag-default";return i.jsxs("div",{className:"ds-detail-page",style:{padding:0},children:[i.jsxs("div",{className:"ds-detail-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[i.jsx("div",{className:"ds-card-title",style:{flex:1},children:t.name}),i.jsx("span",{className:`ds-tag ${s}`,children:n})]}),i.jsx("div",{className:"ds-card-subtitle",style:{fontFamily:"monospace"},children:t.code})]}),i.jsxs("div",{className:"ds-detail-section",children:[i.jsx("div",{className:"ds-section-title",children:""}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:i.jsx(_e,{color:Gp[t.phase],style:{margin:0},children:t.phase?.toUpperCase()})})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:i.jsx(Mi,{percent:t.progress,size:"small",style:{width:120}})})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:t.manager_name||"-"})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:t.start_date?lt(t.start_date).format("YYYY-MM-DD"):"-"})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:t.planned_end?lt(t.planned_end).format("YYYY-MM-DD"):"-"})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:t.product_name||"-"})]})]}),t.description&&i.jsxs("div",{className:"ds-detail-section",children:[i.jsx("div",{className:"ds-section-title",children:""}),i.jsx("div",{style:{fontSize:14,color:"var(--ds-text-primary)",lineHeight:1.6},children:t.description})]})]})}return i.jsx("div",{children:i.jsxs(pe,{column:2,bordered:!0,size:"small",children:[i.jsx(pe.Item,{label:"",children:i.jsx(At,{code:!0,children:t.code})}),i.jsx(pe.Item,{label:"",children:i.jsx(At,{strong:!0,children:t.name})}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:Gp[t.phase],children:t.phase?.toUpperCase()})}),i.jsx(pe.Item,{label:"",children:i.jsx(Ii,{status:xE[t.status],text:n})}),i.jsx(pe.Item,{label:"",children:i.jsx(Mi,{percent:t.progress,size:"small",style:{width:200}})}),i.jsx(pe.Item,{label:"",children:t.manager_name||"-"}),i.jsx(pe.Item,{label:"",children:t.start_date?lt(t.start_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",children:t.planned_end?lt(t.planned_end).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",span:2,children:t.product_name||"-"}),i.jsx(pe.Item,{label:"",span:2,children:i.jsx(ok,{style:{margin:0},children:t.description||""})})]})})},Oh={draft:{color:"default",text:""},released:{color:"success",text:""},obsolete:{color:"default",text:""},pending_review:{color:"processing",text:""},published:{color:"success",text:""},rejected:{color:"error",text:""},frozen:{color:"purple",text:""}},hk=({open:t,onClose:e,onSelect:n})=>{const[s,o]=P.useState(""),{data:l,isLoading:d}=ct({queryKey:["materials-search",s],queryFn:()=>Mu.list({search:s||void 0}),enabled:t}),u=l?.materials||[],h=[{title:"",dataIndex:"code",width:120,render:p=>i.jsx(At,{code:!0,children:p})},{title:"",dataIndex:"name",width:160},{title:"",dataIndex:"description",width:200,ellipsis:!0},{title:"",dataIndex:"unit",width:60},{title:"",dataIndex:"standard_cost",width:100,render:p=>p!=null?`${p.toFixed(2)}`:"-"},{title:"",width:80,render:(p,m)=>i.jsx(J,{size:"small",type:"link",onClick:()=>{n(m),e()},children:""})}];return i.jsxs(Nt,{title:"",open:t,onCancel:e,width:800,footer:null,children:[i.jsx(Pe.Search,{placeholder:"//",allowClear:!0,onSearch:o,onChange:p=>{p.target.value||o("")},style:{marginBottom:12}}),i.jsx(sn,{columns:h,dataSource:u,rowKey:"id",size:"small",loading:d,pagination:{pageSize:8,showTotal:p=>` ${p} `},scroll:{y:350},locale:{emptyText:""}})]})},pk=({projectId:t})=>{const e=Ln(),n=Tn(),[s,o]=P.useState("EBOM"),[l,d]=P.useState(null),[u,h]=P.useState(!1),[p,m]=P.useState(!1),[g,v]=P.useState(""),[C,b]=P.useState(!1),[_,y]=P.useState(null),[S,D]=P.useState(!1),[L,N]=P.useState(void 0),[T,j]=P.useState(void 0),[E,R]=P.useState(null),[M,I]=P.useState(!1),[z,V]=P.useState(!1),[O,k]=P.useState(!1),[F,A]=P.useState(!1),[q,B]=P.useState(""),[W,Q]=P.useState("2D"),[ne,de]=P.useState(!1),[$,X]=P.useState(""),[le,oe]=P.useState("2D"),[ue,Ye]=P.useState(""),[ae,fe]=P.useState(!1),[pt,_t]=P.useState(""),[Se]=ee.useForm(),{data:$e=[],isLoading:jt}=ct({queryKey:["project-boms",t],queryFn:()=>Zt.list(t),retry:!1}),{data:Fe,isLoading:Dt}=ct({queryKey:["project-bom-detail",t,l],queryFn:()=>Zt.get(t,l),enabled:!!l,retry:!1}),{data:te={}}=ct({queryKey:["bom-drawings",t,l],queryFn:()=>kw.listByBOM(t,l),enabled:!!l,retry:!1}),bt=P.useMemo(()=>$e.filter(ye=>ye.bom_type===s),[$e,s]);P.useEffect(()=>{bt.length>0?d(bt[0].id):d(null)},[bt]);const It=Rt({mutationFn:ye=>Zt.create(t,ye),onSuccess:ye=>{me.success("BOM"),h(!1),Se.resetFields(),d(ye.id),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),tt=Rt({mutationFn:()=>Zt.submit(t,l),onSuccess:()=>{me.success(""),e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),nt=Rt({mutationFn:()=>Zt.approve(t,l),onSuccess:()=>{me.success(""),e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),G=Rt({mutationFn:ye=>Zt.reject(t,l,ye),onSuccess:()=>{me.success(""),m(!1),v(""),e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),H=Rt({mutationFn:()=>Zt.freeze(t,l),onSuccess:()=>{me.success(""),e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),ie=Rt({mutationFn:ye=>Zt.addItem(t,l,ye),onSuccess:()=>{e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),we=Rt({mutationFn:({itemId:ye,data:ut})=>Zt.updateItem(t,l,ye,ut),onSuccess:()=>{e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),Ce=Rt({mutationFn:()=>Zt.convertToMBOM(t,l),onSuccess:()=>{me.success("MBOM"),e.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),ge=Rt({mutationFn:ye=>Zt.release(t,l,ye),onSuccess:ye=>{me.success(` ${ye.version}`),fe(!1),_t(""),e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})},onError:ye=>me.error(ye?.response?.data?.message||"")}),je=Rt({mutationFn:({sourceBomId:ye,targetType:ut})=>Zt.createFrom(t,ye,ut),onSuccess:ye=>{me.success(`${ye.bom_type}`),o(ye.bom_type),e.invalidateQueries({queryKey:["project-boms",t]})},onError:ye=>me.error(ye?.response?.data?.message||"")}),He=Rt({mutationFn:()=>wt.createPRFromBOM({project_id:t,bom_id:l}),onSuccess:ye=>{me.success(` ${ye.pr_code}`)},onError:()=>me.error("SRM")}),dt=async()=>{if(l){V(!0);try{await Zt.exportExcel(t,l),me.success("")}catch{me.error("")}finally{V(!1)}}},gt=async ye=>{if(l){k(!0);try{const ut=await Zt.importExcel(t,l,ye);me.success(`${ut?.created??0}${ut?.matched??0}${ut?.auto_created??0}${ut?.errors??0}`),e.invalidateQueries({queryKey:["project-bom-detail",t,l]}),e.invalidateQueries({queryKey:["project-boms",t]})}catch{me.error("")}finally{k(!1)}}},We=async()=>{try{await Zt.downloadTemplate(Fe?.bom_type)}catch{me.error("")}},qe=async()=>{if(!L||!T){me.warning("BOM");return}I(!0);try{const ye=await Zt.compareBOMs(L,T);R(ye)}catch{me.error("")}finally{I(!1)}},at=ye=>{_?we.mutate({itemId:_,data:{material_id:ye.id,name:ye.name,specification:ye.description,unit:ye.unit||"pcs",unit_price:ye.standard_cost||void 0,quantity:1}}):ie.mutate({material_id:ye.id,name:ye.name,specification:ye.description,unit:ye.unit||"pcs",unit_price:ye.standard_cost||void 0,quantity:1,item_number:(Fe?.items?.length||0)+1}),y(null)},ot=async ye=>{try{const ut=await Vn.uploadFile(ye);await kw.upload(t,$,{drawing_type:le,file_id:ut.id,file_name:ut.filename,file_size:ye.size,change_description:ue}),me.success(""),de(!1),Ye(""),e.invalidateQueries({queryKey:["bom-drawings",t,l]})}catch{me.error("")}return!1},st=Fe?.bom_type||"EBOM",it=(Fe?.items||[]).map(({material:ye,children:ut,...Et})=>({...Et,...Et.extended_attrs||{},material_code:ye?.code||""})),re=it.length,rt=it.reduce((ye,ut)=>{const Et=ut.extended_cost??(ut.quantity&&ut.unit_price?ut.quantity*ut.unit_price:0);return ye+(Et||0)},0),Ze=st==="PBOM",ht=it.reduce((ye,ut)=>{const Et=Number(ut.extended_attrs?.target_price)||0;return ye+Et*(ut.quantity||1)},0),Ke=it.reduce((ye,ut)=>ye+(Number(ut.extended_attrs?.tooling_estimate)||0),0),Ue=()=>{if(!Fe)return null;const ye=Fe.status;return i.jsxs(Be,{split:i.jsx(vp,{type:"vertical"}),children:[i.jsxs(Be,{children:[(ye==="draft"||ye==="rejected")&&i.jsx(Bn,{title:"",onConfirm:()=>tt.mutate(),children:i.jsx(J,{type:"primary",icon:i.jsx(Tl,{}),loading:tt.isPending,children:""})}),ye==="pending_review"&&i.jsxs(i.Fragment,{children:[i.jsx(Bn,{title:"",onConfirm:()=>nt.mutate(),children:i.jsx(J,{type:"primary",style:{background:"#52c41a",borderColor:"#52c41a"},icon:i.jsx(ra,{}),loading:nt.isPending,children:""})}),i.jsx(J,{danger:!0,icon:i.jsx($r,{}),onClick:()=>m(!0),children:""})]}),ye==="published"&&i.jsx(Bn,{title:"BOM",onConfirm:()=>H.mutate(),children:i.jsx(J,{icon:i.jsx(Uy,{}),loading:H.isPending,children:""})}),ye==="frozen"&&i.jsx(_e,{color:"purple",icon:i.jsx(Uy,{}),children:" - "})]}),i.jsxs(Be,{children:[i.jsx(rn,{title:"Excel",children:i.jsx(J,{icon:i.jsx(Fc,{}),loading:z,onClick:dt,children:"Excel"})}),i.jsx(Zi,{accept:".xlsx,.xls,.rep",showUploadList:!1,beforeUpload:ut=>(gt(ut),!1),disabled:!(ye==="draft"||ye==="rejected"),children:i.jsx(rn,{title:ye==="draft"||ye==="rejected"?"Excel(.xlsx)PADS(.rep)":"/",children:i.jsx(J,{icon:i.jsx(Li,{}),loading:O,disabled:!(ye==="draft"||ye==="rejected"),children:"BOM"})})}),i.jsx(rn,{title:"",children:i.jsx(J,{icon:i.jsx(nd,{}),onClick:We,children:""})}),Fe.bom_type==="EBOM"&&(ye==="published"||ye==="frozen")&&i.jsx(Bn,{title:"EBOMMBOM",onConfirm:()=>Ce.mutate(),children:i.jsx(J,{icon:i.jsx(Gr,{}),loading:Ce.isPending,children:"MBOM"})}),i.jsx(rn,{title:"",children:i.jsx(J,{icon:i.jsx(Gr,{}),onClick:()=>{D(!0),R(null),N(void 0),j(void 0)},children:""})}),it.length>0&&i.jsx(Bn,{title:"BOMSRM",onConfirm:()=>He.mutate(),children:i.jsx(J,{type:"primary",icon:i.jsx(zo,{}),loading:He.isPending,style:{background:"#722ed1",borderColor:"#722ed1"},children:"SRM"})})]})]})},Je=P.useMemo(()=>({bom_type:s,visible_categories:[],category_config:{}}),[s]);return i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[i.jsx(At,{strong:!0,style:{fontSize:n?14:15},children:"BOM"}),i.jsx(J,{type:"primary",size:n?"small":void 0,icon:i.jsx(Yt,{}),onClick:()=>h(!0),children:"BOM"})]}),i.jsx(Ol,{activeKey:s,onChange:ye=>o(ye),size:n?"small":void 0,items:n?[{key:"EBOM",label:"EBOM"},{key:"PBOM",label:"PBOM"},{key:"MBOM",label:"MBOM"}]:[{key:"EBOM",label:"EBOM BOM"},{key:"PBOM",label:"PBOM BOM"},{key:"MBOM",label:"MBOM BOM"}],style:{marginBottom:8}}),bt.length>1&&i.jsx("div",{style:{marginBottom:12},children:i.jsx(Xe,{value:l||void 0,onChange:d,style:{width:n?"100%":300},placeholder:"BOM",loading:jt,options:bt.map(ye=>({label:`${ye.bom_type} ${ye.version||""}${ye.status==="obsolete"?" ()":ye.status==="released"?" ()":""}`,value:ye.id}))})}),!jt&&bt.length===0&&s==="PBOM"&&(()=>{const ye=$e.find(ut=>ut.bom_type==="EBOM"&&ut.status==="released");return ye?i.jsxs("div",{style:{textAlign:"center",padding:40},children:[i.jsx(ft,{description:"PBOM"}),i.jsxs(J,{type:"primary",style:{marginTop:16},loading:je.isPending,onClick:()=>je.mutate({sourceBomId:ye.id,targetType:"PBOM"}),children:[" EBOM ",ye.version,"  PBOM"]})]}):null})(),!jt&&bt.length===0&&s==="MBOM"&&(()=>{const ye=$e.find(ut=>ut.bom_type==="PBOM"&&ut.status==="released");return ye?i.jsxs("div",{style:{textAlign:"center",padding:40},children:[i.jsx(ft,{description:"MBOM"}),i.jsxs(J,{type:"primary",style:{marginTop:16},loading:je.isPending,onClick:()=>je.mutate({sourceBomId:ye.id,targetType:"MBOM"}),children:[" PBOM ",ye.version,"  MBOM"]})]}):null})(),Fe&&!n&&i.jsx(Mt,{size:"small",style:{marginBottom:12},styles:{body:{padding:"10px 16px"}},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:8},children:[i.jsxs(Be,{size:16,children:[i.jsxs("div",{children:[i.jsxs(Be,{size:8,children:[i.jsx(_e,{color:Oh[Fe.status]?.color,style:{fontSize:13},children:Oh[Fe.status]?.text||Fe.status}),i.jsxs(At,{strong:!0,style:{fontSize:15},children:[Fe.bom_type," ",Fe.version||"-"]})]}),Fe.status==="released"&&Fe.released_at&&i.jsx("div",{style:{marginTop:2},children:i.jsxs(At,{type:"secondary",style:{fontSize:12},children:[Fe.creator?.name||"","  ",lt(Fe.released_at).format("YYYY-MM-DD HH:mm")]})}),Fe.source_version&&i.jsx("div",{style:{marginTop:2},children:i.jsxs(At,{type:"secondary",style:{fontSize:11},children:[": ",Fe.source_version]})})]}),i.jsxs("div",{style:{borderLeft:"1px solid #f0f0f0",paddingLeft:16},children:[i.jsx(At,{type:"secondary",style:{fontSize:12},children:Ze?"":""}),i.jsx("div",{children:i.jsx(At,{strong:!0,children:re})})]}),Ze?i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx(At,{type:"secondary",style:{fontSize:12},children:""}),i.jsx("div",{children:i.jsxs(At,{strong:!0,style:{color:"#cf1322",fontSize:16},children:["",ht.toFixed(2)]})})]}),i.jsxs("div",{children:[i.jsx(At,{type:"secondary",style:{fontSize:12},children:""}),i.jsx("div",{children:i.jsxs(At,{strong:!0,style:{color:"#cf1322"},children:["",Ke.toFixed(2)]})})]})]}):i.jsxs("div",{children:[i.jsx(At,{type:"secondary",style:{fontSize:12},children:""}),i.jsx("div",{children:i.jsxs(At,{strong:!0,style:{color:"#cf1322",fontSize:16},children:["",rt.toFixed(2)]})})]})]}),i.jsxs(Be,{children:[Fe.status==="draft"&&re>0&&i.jsxs(J,{type:"primary",onClick:()=>fe(!0),children:[" ",Fe.bom_type]}),Ue()]})]})}),Fe&&n&&i.jsxs("div",{className:"bom-mobile-summary",children:[i.jsx(_e,{color:Oh[Fe.status]?.color,style:{margin:0},children:Oh[Fe.status]?.text||Fe.status}),i.jsx("span",{className:"bom-mobile-summary-stat",children:i.jsx("span",{className:"value",children:Fe.version||""})}),i.jsxs("span",{className:"bom-mobile-summary-stat",children:[i.jsx("span",{className:"label",children:Ze?"":""}),i.jsx("span",{className:"value",children:re})]}),i.jsxs("span",{className:"bom-mobile-summary-stat",children:[i.jsx("span",{className:"label",children:""}),i.jsxs("span",{className:"cost",children:["",(Ze?ht:rt).toFixed(0)]})]})]}),(jt||Dt)&&!Fe&&i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(tn,{})}),!jt&&bt.length===0&&i.jsx(ft,{description:`${s}`,style:{padding:60}}),Fe&&i.jsxs(i.Fragment,{children:[s==="EBOM"&&i.jsx(sf,{config:Je,value:it,onChange:()=>{},readonly:!0,showMaterialCode:!0}),s==="PBOM"&&i.jsx(rf,{config:Je,value:it,onChange:()=>{},readonly:!0,showMaterialCode:!0}),s==="MBOM"&&i.jsx(of,{config:Je,value:it,onChange:()=>{},readonly:!0,showMaterialCode:!0})]}),n&&Fe&&i.jsxs("div",{className:"bom-mobile-action-bar",children:[(Fe.status==="draft"||Fe.status==="rejected")&&i.jsx(J,{type:"primary",size:"small",icon:i.jsx(Tl,{}),loading:tt.isPending,onClick:()=>tt.mutate(),children:""}),Fe.status==="pending_review"&&i.jsxs(i.Fragment,{children:[i.jsx(J,{type:"primary",size:"small",style:{background:"#52c41a",borderColor:"#52c41a"},icon:i.jsx(ra,{}),loading:nt.isPending,onClick:()=>nt.mutate(),children:""}),i.jsx(J,{danger:!0,size:"small",icon:i.jsx($r,{}),onClick:()=>m(!0),children:""})]}),Fe.status==="draft"&&re>0&&i.jsx(J,{type:"primary",size:"small",onClick:()=>fe(!0),children:""}),i.jsx(J,{size:"small",icon:i.jsx(Fc,{}),loading:z,onClick:dt,children:""})]}),i.jsx(Nt,{title:"BOM",open:u,onCancel:()=>{h(!1),Se.resetFields()},onOk:()=>Se.submit(),confirmLoading:It.isPending,children:i.jsxs(ee,{form:Se,layout:"vertical",onFinish:ye=>It.mutate({...ye,name:ye.bom_type}),children:[i.jsx(ee.Item,{name:"bom_type",label:"BOM",initialValue:s,rules:[{required:!0,message:"BOM"}],children:i.jsx(Xe,{options:[{label:"EBOM - BOM",value:"EBOM"},{label:"PBOM - BOM",value:"PBOM"},{label:"MBOM - BOM",value:"MBOM"}]})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(Pe.TextArea,{rows:3,placeholder:"BOM"})})]})}),i.jsxs(Nt,{title:` ${Fe?.bom_type||""}`,open:ae,onCancel:()=>{fe(!1),_t("")},onOk:()=>ge.mutate(pt),confirmLoading:ge.isPending,okText:"",children:[i.jsx("div",{style:{marginBottom:12},children:i.jsx(At,{type:"secondary",children:"BOM"})}),i.jsx(Pe.TextArea,{rows:3,placeholder:"...",value:pt,onChange:ye=>_t(ye.target.value)})]}),i.jsx(Nt,{title:"BOM",open:p,onCancel:()=>{m(!1),v("")},onOk:()=>G.mutate(g),confirmLoading:G.isPending,okText:"",okButtonProps:{danger:!0},children:i.jsx(Pe.TextArea,{rows:4,placeholder:"...",value:g,onChange:ye=>v(ye.target.value)})}),i.jsx(hk,{open:C,onClose:()=>{b(!1),y(null)},onSelect:at}),i.jsxs(Nt,{title:"BOM",open:S,onCancel:()=>D(!1),width:800,footer:E?[i.jsx(J,{onClick:()=>D(!1),children:""},"close")]:void 0,onOk:qe,confirmLoading:M,okText:"",children:[i.jsxs(Be,{style:{marginBottom:16,width:"100%"},direction:"vertical",children:[i.jsxs(Be,{children:[i.jsx(At,{children:"BOM A"}),i.jsx(Xe,{style:{width:280},placeholder:"BOM",value:L,onChange:N,options:$e.map(ye=>({label:`${ye.bom_type} ${ye.version||""}`,value:ye.id}))})]}),i.jsxs(Be,{children:[i.jsx(At,{children:"BOM B"}),i.jsx(Xe,{style:{width:280},placeholder:"BOM",value:T,onChange:j,options:$e.map(ye=>({label:`${ye.bom_type} ${ye.version||""}`,value:ye.id}))})]})]}),E&&i.jsx(sn,{dataSource:E,rowKey:(ye,ut)=>String(ut),size:"small",pagination:!1,scroll:{y:400},rowClassName:ye=>ye.change_type==="added"?"compare-row-added":ye.change_type==="removed"?"compare-row-removed":ye.change_type==="changed"?"compare-row-changed":"",columns:[{title:"",width:60,render:(ye,ut,Et)=>Et+1},{title:"",dataIndex:"name",width:140},{title:"",dataIndex:"specification",width:160,ellipsis:!0},{title:"",dataIndex:"change_type",width:100,render:ye=>{const Et={added:{color:"success",text:""},removed:{color:"error",text:""},changed:{color:"warning",text:""},unchanged:{color:"default",text:""}}[ye]||{color:"default",text:ye};return i.jsx(_e,{color:Et.color,children:Et.text})}},{title:"",dataIndex:"details",ellipsis:!0}]}),i.jsx("style",{children:`
          .compare-row-added { background: #f6ffed !important; }
          .compare-row-added:hover > td { background: #d9f7be !important; }
          .compare-row-removed { background: #fff1f0 !important; }
          .compare-row-removed:hover > td { background: #ffccc7 !important; }
          .compare-row-changed { background: #fffbe6 !important; }
          .compare-row-changed:hover > td { background: #fff1b8 !important; }
        `})]}),i.jsxs(Nt,{title:`${le}`,open:ne,onCancel:()=>{de(!1),Ye("")},footer:null,width:400,children:[i.jsxs("div",{style:{marginBottom:12},children:[i.jsx(At,{type:"secondary",children:""}),i.jsx(Pe.TextArea,{rows:2,value:ue,onChange:ye=>Ye(ye.target.value),placeholder:"...",style:{marginTop:4}})]}),i.jsx(Zi,{showUploadList:!1,beforeUpload:ot,children:i.jsx(J,{icon:i.jsx(Li,{}),type:"primary",children:""})})]}),i.jsx(ci,{title:`${W}`,open:F,onClose:()=>A(!1),width:480,children:(()=>{const ut=te[q]?.[W]||[];return ut.length===0?i.jsx(ft,{description:""}):i.jsx(Il,{items:ut.map(Et=>({key:Et.id,color:Et===ut[0]?"blue":"gray",children:i.jsxs("div",{children:[i.jsxs(Be,{children:[i.jsx(_e,{color:Et===ut[0]?"blue":"default",children:Et.version}),i.jsx("a",{href:Et.file_url,target:"_blank",rel:"noreferrer",children:Et.file_name}),i.jsx(At,{type:"secondary",style:{fontSize:11},children:Et.file_size?`${(Et.file_size/1024).toFixed(0)}KB`:""})]}),Et.change_description&&i.jsx("div",{style:{marginTop:4},children:i.jsx(At,{type:"secondary",style:{fontSize:12},children:Et.change_description})}),i.jsx("div",{style:{marginTop:2},children:i.jsxs(At,{type:"secondary",style:{fontSize:11},children:[Et.uploader?.name||""," ",lt(Et.created_at).format("MM-DD HH:mm")]})})]})}))})})()})]})},mk=({projectId:t})=>{const{data:e,isLoading:n,isError:s}=ct({queryKey:["project-documents",t],queryFn:()=>ls.list({related_type:"project",related_id:t}),retry:!1}),o=[{title:"",dataIndex:"code",key:"code",width:140,render:l=>i.jsx(At,{code:!0,children:l})},{title:"",dataIndex:"title",key:"title",width:200},{title:"",dataIndex:"category",key:"category",width:100,render:(l,d)=>d.category?.name||(typeof d.category=="string"?d.category:"-")},{title:"",dataIndex:"version",key:"version",width:80},{title:"",dataIndex:"status",key:"status",width:100,render:l=>i.jsx(_e,{color:l==="released"?"success":l==="draft"?"default":"warning",children:l==="released"?"":l==="draft"?"":l})},{title:"",dataIndex:"created_by_name",key:"created_by_name",width:100,render:(l,d)=>l||d.uploader?.name||"-"},{title:"",dataIndex:"updated_at",key:"updated_at",width:160,render:l=>l?lt(l).format("YYYY-MM-DD HH:mm"):"-"}];return s?i.jsx(ft,{description:"API",image:ft.PRESENTED_IMAGE_SIMPLE}):i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx(At,{strong:!0,children:""}),i.jsx(J,{icon:i.jsx(Li,{}),children:""})]}),i.jsx(sn,{columns:o,dataSource:e?.items||[],rowKey:"id",loading:n,size:"small",pagination:{pageSize:10,showTotal:l=>` ${l} `},locale:{emptyText:""}})]})},gk=({projectId:t,currentPhase:e})=>{const[n,s]=P.useState(e?.toLowerCase()||"evt"),{data:o,isLoading:l,isError:d}=ct({queryKey:["project-deliverables",t,n],queryFn:()=>XI.list(t,n),retry:!1}),u=o?.items||[],h=u.filter(b=>b.status==="approved"||b.status==="submitted").length,p=u.length,m=p>0?Math.round(h/p*100):0,g=p>0&&h===p,v=p-h,C={not_started:{icon:"",color:"#999",text:""},in_progress:{icon:"",color:"#faad14",text:""},submitted:{icon:"",color:"#52c41a",text:""},approved:{icon:"",color:"#52c41a",text:""},rejected:{icon:"",color:"#ff4d4f",text:""}};return d?i.jsx(ft,{description:"API",image:ft.PRESENTED_IMAGE_SIMPLE}):i.jsxs("div",{children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:i.jsxs(Be,{children:[i.jsx(At,{strong:!0,children:""}),i.jsx(Xe,{value:n,onChange:s,style:{width:120},options:_0.map(b=>({label:`${b.toUpperCase()} `,value:b}))})]})}),l?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):u.length===0?i.jsx(ft,{description:""}):i.jsxs(i.Fragment,{children:[i.jsx(Mt,{size:"small",style:{marginBottom:16,background:"#fafafa"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[i.jsxs(At,{children:[": ",h,"/",p," (",m,"%)"]}),i.jsx(Mi,{percent:m,style:{flex:1,maxWidth:300},size:"small",status:g?"success":"active"})]})}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:u.map(b=>{const _=C[b.status]||C.not_started;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px 16px",border:"1px solid #f0f0f0",borderRadius:6,background:"#fff"},children:[i.jsx("span",{style:{fontSize:16,marginRight:12},children:_.icon}),i.jsxs("div",{style:{flex:1},children:[i.jsx(At,{strong:!0,children:b.name}),b.description&&i.jsx(At,{type:"secondary",style:{marginLeft:8,fontSize:12},children:b.description})]}),i.jsx(At,{type:"secondary",style:{marginRight:16},children:b.assignee_role||b.assignee_name||"-"}),i.jsx(_e,{color:_.color==="#52c41a"?"success":_.color==="#ff4d4f"?"error":_.color==="#faad14"?"warning":"default",children:_.text})]},b.id)})}),i.jsxs("div",{style:{marginTop:16,textAlign:"right"},children:[!g&&i.jsx(Ur,{type:"warning",showIcon:!0,icon:i.jsx(PT,{}),message:` ${v} `,style:{marginBottom:12}}),i.jsx(J,{type:"primary",disabled:!g,children:""})]})]})]})},xk=({productId:t})=>{const{data:e,isLoading:n,isError:s}=ct({queryKey:["project-ecns",t],queryFn:()=>ia.list({product_id:t}),enabled:!!t,retry:!1}),o={draft:{color:"default",text:""},pending:{color:"processing",text:""},approved:{color:"success",text:""},rejected:{color:"error",text:""},implemented:{color:"purple",text:""}},l={low:"default",medium:"blue",high:"orange",urgent:"red"},d=[{title:"ECN",dataIndex:"code",key:"code",width:140,render:u=>i.jsx(At,{code:!0,children:u})},{title:"",dataIndex:"title",key:"title",width:200},{title:"",dataIndex:"change_type",key:"change_type",width:100},{title:"",dataIndex:"urgency",key:"urgency",width:80,render:u=>i.jsx(_e,{color:l[u]||"default",children:u==="high"?"":u==="medium"?"":u==="urgent"?"":""})},{title:"",dataIndex:"status",key:"status",width:100,render:u=>{const h=o[u]||{color:"default",text:u};return i.jsx(_e,{color:h.color,children:h.text})}},{title:"",key:"requester",width:100,render:(u,h)=>h.requester?.name||"-"},{title:"",dataIndex:"created_at",key:"created_at",width:160,render:u=>u?lt(u).format("YYYY-MM-DD HH:mm"):"-"}];return s?i.jsx(ft,{description:"ECN",image:ft.PRESENTED_IMAGE_SIMPLE}):t?i.jsxs("div",{children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx(At,{strong:!0,children:""})}),i.jsx(sn,{columns:d,dataSource:e?.items||[],rowKey:"id",loading:n,size:"small",pagination:{pageSize:10,showTotal:u=>` ${u} `},locale:{emptyText:"ECN"}})]}):i.jsx(ft,{description:"ECN",image:ft.PRESENTED_IMAGE_SIMPLE})},yk=({data:t})=>{const[e,n]=Pn.useState(!1),s=Pn.useMemo(()=>{if(!t?.items?.length)return[];const l={};for(const d of t.items){const u=d.category||"";l[u]=(l[u]||0)+1}return Object.entries(l).sort((d,u)=>u[1]-d[1])},[t?.items]),o=[{title:"",dataIndex:"item_number",key:"item_number",width:50,align:"center"},{title:"",dataIndex:"reference",key:"reference",width:80,ellipsis:!0},{title:"",dataIndex:"name",key:"name",width:100,ellipsis:!0},{title:"",dataIndex:"specification",key:"specification",width:120,ellipsis:!0},{title:"",dataIndex:"quantity",key:"quantity",width:50,align:"center"},{title:"",dataIndex:"unit",key:"unit",width:45,align:"center"},{title:"",dataIndex:"category",key:"category",width:70,ellipsis:!0},{title:"",dataIndex:"manufacturer",key:"manufacturer",width:90,ellipsis:!0}];return i.jsxs("div",{children:[i.jsxs(Be,{size:8,style:{marginBottom:4},children:[i.jsx(nd,{style:{color:"#52c41a"}}),i.jsx("span",{style:{fontSize:13},children:t.filename}),i.jsxs(_e,{color:"blue",children:[t.item_count," "]}),i.jsx(J,{type:"link",size:"small",onClick:()=>n(!e),style:{padding:0},children:e?"":""})]}),e&&i.jsxs("div",{style:{marginTop:8},children:[s.length>0&&i.jsx("div",{style:{marginBottom:6,display:"flex",flexWrap:"wrap",gap:4},children:s.map(([l,d])=>i.jsxs(_e,{style:{fontSize:11},children:[l,": ",d]},l))}),i.jsx(sn,{columns:o,dataSource:t.items,rowKey:"item_number",size:"small",pagination:t.items.length>10?{pageSize:10,size:"small"}:!1,scroll:{x:600}})]})]})},vk=({projectId:t,taskId:e})=>{const[n,s]=P.useState(null),[o,l]=P.useState(null),[d,u]=P.useState(!0),[h,p]=P.useState({}),m=Tn();if(Pn.useEffect(()=>{Promise.all([Vn.getForm(t,e),Vn.getSubmission(t,e)]).then(([_,y])=>{s(_),l(y),_?.fields?.some(S=>S.type==="user"||S.type==="role_assignment")&&ef.list().then(S=>{const D={};S.forEach(L=>{D[L.id]=L.name}),p(D)})}).finally(()=>u(!1))},[t,e]),d)return i.jsx("div",{style:{color:"#999",fontSize:12},children:"..."});if(!n||!o)return null;const g=n.fields||[],v=o.data||{},C=_=>{let y=v[_.key];if(_.type==="bom_upload"&&y&&typeof y=="object"&&y.items)return{key:_.key,label:_.label,complex:!0,node:i.jsx(yk,{data:y})};if(["ebom_control","pbom_control","mbom_control"].includes(_.type)&&Array.isArray(y)){const S=_.type==="ebom_control"?sf:_.type==="pbom_control"?rf:of;return{key:_.key,label:_.label,complex:!0,node:i.jsx(S,{config:_.config||{},value:y,onChange:()=>{},readonly:!0})}}if((_.type==="tooling_list"||_.type==="consumable_list")&&y&&typeof y=="object"&&y.items){const S=_.type==="tooling_list"?"":"",D=y.items||[];return{key:_.key,label:_.label,complex:!0,node:i.jsxs("div",{children:[i.jsxs(_e,{color:"blue",children:[y.item_count||D.length," "]}),i.jsx(At,{type:"secondary",style:{fontSize:12},children:S}),D.length>0&&i.jsx(sn,{size:"small",dataSource:D,rowKey:(L,N)=>String(N),pagination:!1,style:{marginTop:8},columns:[{title:"",width:55,align:"center",render:(L,N,T)=>T+1},{title:"",dataIndex:"name",width:200},{title:"",dataIndex:"unit",width:80},{title:"",dataIndex:"quantity",width:100,align:"right"},{title:"",dataIndex:"unit_price",width:100,align:"right"}]})]})}}return _.type==="procurement_control"&&y&&typeof y=="object"?{key:_.key,label:_.label,complex:!0,node:i.jsx(Xv,{value:y})}:(y==null?y="-":_.type==="role_assignment"&&typeof y=="object"&&!Array.isArray(y)?y=Object.entries(y).map(([S,D])=>`${S}: ${h[D]||D}`).join("; ")||"-":_.type==="user"?y=h[y]||y:typeof y=="boolean"?y=y?"":"":Array.isArray(y)&&(y=y.length>0&&typeof y[0]=="object"&&y[0].filename?y.map(S=>S.filename).join(", "):y.join(", ")),{key:_.key,label:_.label,complex:!1,text:String(y)})},b=g.map(C);return m?i.jsxs("div",{className:"ds-detail-section",style:{marginTop:8},children:[i.jsx("div",{className:"ds-section-title",children:""}),b.map(_=>_.complex?i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("div",{style:{fontSize:12,color:"var(--ds-text-secondary)",marginBottom:4},children:_.label}),_.node]},_.key):i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:_.label}),i.jsx("span",{className:"ds-info-value",children:_.text})]},_.key)),i.jsxs("div",{style:{fontSize:11,color:"var(--ds-text-secondary)",marginTop:8},children:[": ",o.submitted_at?lt(o.submitted_at).format("YYYY-MM-DD HH:mm"):"-"]})]}):i.jsxs("div",{style:{background:"#fafafa",padding:12,borderRadius:6,marginTop:8},children:[i.jsx(At,{strong:!0,style:{fontSize:13,marginBottom:8,display:"block"},children:""}),i.jsx(pe,{size:"small",column:2,bordered:!0,children:b.map(_=>_.complex?i.jsx(pe.Item,{label:_.label,span:2,children:_.node},_.key):i.jsx(pe.Item,{label:_.label,children:_.text},_.key))}),i.jsxs(At,{type:"secondary",style:{fontSize:11,marginTop:4,display:"block"},children:[": ",o.submitted_at?lt(o.submitted_at).format("YYYY-MM-DD HH:mm"):"-"]})]})},_k=({task:t,projectId:e,onRefresh:n})=>{const[s,o]=P.useState(!1),[l,d]=P.useState(!1),[u,h]=P.useState(!1),[p,m]=P.useState(!1),[g,v]=P.useState(!1),[C,b]=P.useState([]),[_,y]=P.useState(!1),[S,D]=P.useState(!1),[L,N]=P.useState(""),[T,j]=P.useState(""),[E,R]=P.useState(""),[M,I]=P.useState([]),z=$=>{const X=$,le=X?.response?.status,oe=X?.response?.data?.error||X?.response?.data?.message||"";le===400?me.error(`${oe}`):me.error(oe)},V=async()=>{if(!L.trim()){me.warning("ID");return}D(!0);try{await wu.assignTask(e,t.id,{assignee_id:L.trim(),feishu_user_id:T.trim()||void 0}),me.success(""),o(!1),N(""),j(""),n()}catch($){z($)}finally{D(!1)}},O=async()=>{D(!0);try{await wu.startTask(e,t.id),me.success(""),n()}catch($){z($)}finally{D(!1)}},k=async()=>{if(M.length===0){me.warning("");return}D(!0);try{await QI.create({project_id:e,task_id:t.id,title:`: ${t.title}`,reviewer_ids:M}),me.success(""),h(!1),I([]),n()}catch($){z($)}finally{D(!1)}},F=async()=>{D(!0);try{await wu.submitReview(e,t.id,{outcome_code:"fail_rollback",comment:E}),me.success(""),d(!1),R(""),n()}catch($){console.error("Review reject failed:",$),z($)}finally{D(!1)}},A=async()=>{y(!0);try{const $=await wu.getTaskHistory(e,t.id);b($)}catch($){z($)}finally{y(!1)}},q=()=>{v(!0),A()},B={assign:"",start:"",complete:"",review_pass:"",review_reject:"",review:"",rollback:""},W=async()=>{D(!0);try{await Vn.confirmTask(e,t.id),me.success(""),n()}catch($){z($)}finally{D(!1)}},Q=async()=>{D(!0);try{await Vn.rejectTask(e,t.id),me.success(""),n()}catch($){z($)}finally{D(!1)}},ne=()=>{switch(t.status){case"unassigned":return i.jsx(J,{size:"small",type:"primary",onClick:()=>o(!0),loading:S,children:""});case"pending":return t.dependencies?.some(X=>X.depends_on_status!=="completed")?i.jsx(_e,{color:"default",icon:i.jsx(er,{}),children:""}):i.jsx(J,{size:"small",type:"primary",style:{background:"#52c41a",borderColor:"#52c41a"},onClick:O,loading:S,children:""});case"in_progress":return i.jsx(_e,{color:"processing",icon:i.jsx(er,{}),children:""});case"submitted":return t.requires_approval?i.jsx(_e,{color:"orange",icon:i.jsx(ra,{}),children:""}):i.jsxs(Be,{size:4,children:[i.jsx(Bn,{title:"",onConfirm:W,okText:"",cancelText:"",children:i.jsx(rn,{title:"",children:i.jsx(J,{size:"small",type:"text",icon:i.jsx(ra,{}),style:{color:"#52c41a"},loading:S})})}),i.jsx(Bn,{title:"",onConfirm:Q,okText:"",cancelText:"",okButtonProps:{danger:!0},children:i.jsx(rn,{title:"",children:i.jsx(J,{size:"small",type:"text",icon:i.jsx($r,{}),style:{color:"#ff4d4f"},loading:S})})})]});case"reviewing":return i.jsx(_e,{color:"warning",icon:i.jsx(Cl,{}),children:""});case"completed":return i.jsx(_e,{color:"green",icon:i.jsx(ra,{}),children:""});case"rejected":return i.jsx(J,{size:"small",style:{color:"#fa8c16",borderColor:"#fa8c16"},onClick:O,loading:S,children:""});default:return null}},de=t.status==="submitted"||t.status==="completed"||t.status==="reviewing";return i.jsxs(i.Fragment,{children:[i.jsxs(Be,{size:4,children:[ne(),de&&i.jsx(rn,{title:"",children:i.jsx(J,{size:"small",type:"text",icon:i.jsx(rr,{}),onClick:()=>m(!0),style:{color:"#1677ff"}})}),i.jsx(rn,{title:"",children:i.jsx(J,{size:"small",type:"text",icon:i.jsx(Fp,{}),onClick:q,style:{color:"#999"}})})]}),i.jsxs(Nt,{title:`: ${t.title}`,open:s,onCancel:()=>{o(!1),N(""),j("")},onOk:V,confirmLoading:S,okText:"",cancelText:"",children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(At,{type:"secondary",style:{display:"block",marginBottom:4},children:" *"}),i.jsx(ko,{value:L||void 0,onChange:$=>N($),mode:"single",placeholder:"",style:{width:"100%"}})]}),i.jsxs("div",{children:[i.jsx(At,{type:"secondary",style:{display:"block",marginBottom:4},children:" ID"}),i.jsx(Pe,{placeholder:" User ID",value:T,onChange:$=>j($.target.value)})]})]}),i.jsxs(Nt,{title:"",open:l,onCancel:()=>{d(!1),R("")},onOk:F,confirmLoading:S,okText:"",okButtonProps:{danger:!0},cancelText:"",children:[i.jsx(At,{type:"secondary",style:{display:"block",marginBottom:4},children:""}),i.jsx(Pe.TextArea,{rows:4,placeholder:"...",value:E,onChange:$=>R($.target.value)})]}),i.jsxs(Nt,{title:"",open:u,onCancel:()=>{h(!1),I([])},onOk:k,confirmLoading:S,okText:"",cancelText:"",children:[i.jsx("div",{style:{marginBottom:8},children:i.jsxs(At,{type:"secondary",children:[": ",t.title]})}),i.jsxs("div",{children:[i.jsx(At,{type:"secondary",style:{display:"block",marginBottom:4},children:" *"}),i.jsx(ko,{value:M,onChange:$=>I($),mode:"multiple",placeholder:"",style:{width:"100%"}})]})]}),i.jsx(ci,{title:`: ${t.title}`,open:p,onClose:()=>m(!1),width:520,children:i.jsx(vk,{projectId:e,taskId:t.id})}),i.jsx(ci,{title:`: ${t.title}`,open:g,onClose:()=>v(!1),width:480,children:_?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):C.length===0?i.jsx(ft,{description:""}):i.jsx(Il,{items:C.map($=>({color:$.action.includes("reject")||$.action.includes("fail")?"red":$.action.includes("pass")||$.action==="complete"?"green":$.action==="start"?"blue":"gray",children:i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:500},children:B[$.action]||$.action}),i.jsx("div",{style:{fontSize:12,color:"#666"},children:$.from_status&&$.to_status&&i.jsxs(_e,{style:{fontSize:11},children:[Lr[$.from_status]?.text||$.from_status,"  ",Lr[$.to_status]?.text||$.to_status]})}),i.jsxs("div",{style:{fontSize:12,color:"#999",marginTop:4},children:[i.jsxs("span",{children:[": ",$.operator_id]}),i.jsx("span",{style:{marginLeft:12},children:lt($.created_at).format("YYYY-MM-DD HH:mm:ss")})]}),$.comment&&i.jsxs("div",{style:{fontSize:12,color:"#fa8c16",marginTop:4},children:[": ",$.comment]})]})}))})})]})},bk=({projectId:t})=>{const e=Ln(),[n,s]=P.useState({}),[o,l]=P.useState(!1),{data:d=[]}=ct({queryKey:["project-tasks",t],queryFn:()=>Ci.listTasks(t),enabled:!!t}),{data:u=[]}=ct({queryKey:["task-roles"],queryFn:()=>Wv.list()}),h=P.useMemo(()=>{const v={};for(const C of u)v[C.code]=C.name;for(const C of lE)v[C.code]||(v[C.code]=C.label);return v},[u]),p=P.useMemo(()=>{const v=new Set;for(const C of d){const b=C.default_assignee_role;b&&v.add(b)}return Array.from(v).sort()},[d]),m=(v,C)=>{s(b=>({...b,[v]:C}))},g=async()=>{const v=Object.entries(n).filter(([,C])=>C&&C.trim()).map(([C,b])=>({role:C,user_id:b.trim()}));if(v.length===0){me.warning("");return}l(!0);try{await Ci.assignRoles(t,v),me.success(""),e.invalidateQueries({queryKey:["project-tasks",t]}),e.invalidateQueries({queryKey:["project",t]}),e.invalidateQueries({queryKey:["my-tasks"]})}catch(C){const _=C?.response?.data?.message||"";me.error(_)}finally{l(!1)}};return i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx(At,{strong:!0,children:""}),i.jsx(J,{type:"primary",onClick:g,loading:o,children:""})]}),i.jsx(Ur,{type:"info",showIcon:!0,message:"",style:{marginBottom:16}}),p.length===0?i.jsx(ft,{description:""}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:p.map(v=>i.jsx(Mt,{size:"small",styles:{body:{padding:"12px 16px"}},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[i.jsx("div",{style:{width:140,fontWeight:500},children:h[v]||v}),i.jsx(_e,{color:"blue",children:v}),i.jsx(ko,{value:n[v]||void 0,onChange:C=>m(v,C),mode:"single",placeholder:"",style:{flex:1}})]})},v))})]})},qw=({hex:t,size:e=14})=>t?i.jsx("span",{style:{display:"inline-block",width:e,height:e,borderRadius:3,backgroundColor:t,border:"1px solid #d9d9d9",verticalAlign:"middle"}}):null,Sk=({projectId:t})=>{const e=Ln(),[n,s]=P.useState(!1),[o,l]=P.useState(null),[d]=ee.useForm(),[u,h]=P.useState(new Set),[p,m]=P.useState({}),{data:g=[],isLoading:v}=ct({queryKey:["project-skus",t],queryFn:()=>Rh.listSKUs(t)}),{data:C=[]}=ct({queryKey:["project-pbom-items",t],queryFn:async()=>{const T=await Zt.list(t,{bom_type:"PBOM"});return T.length===0?[]:(await Zt.get(t,T[0].id)).items||[]},enabled:n}),{data:b=[]}=ct({queryKey:["appearance-parts",t],queryFn:()=>Cu.getAppearanceParts(t),enabled:n}),{data:_=[],isLoading:y}=ct({queryKey:["sku-full-bom",t,o?.id],queryFn:()=>Rh.getFullBOM(t,o.id),enabled:!!o}),S=P.useMemo(()=>C.filter(T=>!T.extended_attrs?.is_appearance_part&&!T.extended_attrs?.is_variant),[C]);P.useEffect(()=>{n&&S.length>0&&(h(new Set(S.map(T=>T.id))),m({}))},[n,S]);const D=Rt({mutationFn:T=>Rh.createSKU(t,T),onSuccess:()=>{e.invalidateQueries({queryKey:["project-skus",t]}),s(!1),d.resetFields(),me.success("SKU")},onError:()=>me.error("")}),L=Rt({mutationFn:T=>Rh.deleteSKU(t,T),onSuccess:()=>{e.invalidateQueries({queryKey:["project-skus",t]}),o&&l(null),me.success("")}}),N=T=>{const j=[];for(const E of u)j.push({bom_item_id:E});for(const[E,R]of Object.entries(p))R&&j.push({bom_item_id:E,cmf_variant_id:R});D.mutate({name:T.name,bom_items:j})};if(o){const T=[{title:"",dataIndex:"item_number",width:60,align:"center"},{title:"",dataIndex:"name",width:160},{title:"",dataIndex:"material_type",width:100},{title:"",dataIndex:"quantity",width:70,align:"right"},{title:"",dataIndex:"unit",width:60},{title:"CMF",width:280,render:(j,E)=>{if(!E.is_appearance_part||!E.cmf_variant)return"-";const R=E.cmf_variant;return i.jsxs(Be,{size:6,children:[i.jsx(qw,{hex:R.color_hex}),R.material_code&&i.jsx(_e,{style:{fontSize:11},children:R.material_code}),R.finish&&i.jsx(At,{style:{fontSize:12},children:R.finish}),R.texture&&i.jsx(At,{style:{fontSize:12},children:R.texture})]})}}];return i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:16},children:[i.jsx(J,{size:"small",onClick:()=>l(null),children:"< "}),i.jsx(At,{strong:!0,style:{fontSize:15},children:o.name}),o.code&&i.jsx(_e,{children:o.code})]}),y?i.jsx(tn,{}):_.length===0?i.jsx(ft,{description:"SKUBOM"}):i.jsx(sn,{columns:T,dataSource:_,rowKey:"id",size:"small",pagination:!1,scroll:{x:700}})]})}return i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[i.jsx(At,{strong:!0,style:{fontSize:15},children:" / SKU"}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>s(!0),children:"SKU"})]}),v?i.jsx(tn,{}):g.length===0?i.jsx(ft,{description:'SKU"SKU"'}):i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:12},children:g.map(T=>i.jsxs(Mt,{size:"small",hoverable:!0,onClick:()=>l(T),styles:{body:{padding:"12px 16px"}},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx(At,{strong:!0,children:T.name}),T.code&&i.jsx(_e,{style:{marginLeft:8},children:T.code})]}),i.jsx(_e,{color:T.status==="active"?"green":"default",children:T.status==="active"?"":""})]}),T.description&&i.jsx(At,{type:"secondary",style:{fontSize:12,marginTop:4,display:"block"},children:T.description}),i.jsx("div",{style:{marginTop:8,display:"flex",justifyContent:"flex-end"},children:i.jsx(Bn,{title:"SKU",onConfirm:j=>{j?.stopPropagation(),L.mutate(T.id)},children:i.jsx(J,{size:"small",type:"text",danger:!0,icon:i.jsx(Zn,{}),onClick:j=>j.stopPropagation()})})})]},T.id))}),i.jsxs(Nt,{title:"SKU",open:n,onCancel:()=>{s(!1),d.resetFields()},onOk:()=>d.submit(),confirmLoading:D.isPending,width:700,children:[i.jsx(ee,{form:d,layout:"vertical",onFinish:N,children:i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:"SKU"}],children:i.jsx(Pe,{placeholder:""})})}),S.length>0&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(At,{strong:!0,style:{fontSize:13,marginBottom:8,display:"block"},children:""}),i.jsx("div",{style:{maxHeight:200,overflow:"auto",border:"1px solid #f0f0f0",borderRadius:6,padding:8},children:S.map(T=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 0"},children:[i.jsx(pa,{checked:u.has(T.id),onChange:j=>{const E=new Set(u);j.target.checked?E.add(T.id):E.delete(T.id),h(E)}}),i.jsxs(At,{style:{fontSize:13},children:["#",T.item_number," ",T.name]}),T.extended_attrs?.material_type&&i.jsx(_e,{style:{fontSize:11},children:T.extended_attrs.material_type})]},T.id))})]}),b.length>0&&i.jsxs("div",{children:[i.jsx(At,{strong:!0,style:{fontSize:13,marginBottom:8,display:"block"},children:"CMF"}),i.jsx("div",{style:{border:"1px solid #f0f0f0",borderRadius:6,padding:8},children:b.map(T=>{const j=T.bom_item,E=T.cmf_variants||[];return i.jsxs("div",{style:{marginBottom:12},children:[i.jsxs(At,{strong:!0,style:{fontSize:13},children:["#",j.item_number," ",j.name]}),j.extended_attrs?.material_type&&i.jsx(_e,{style:{fontSize:11,marginLeft:6},children:j.extended_attrs.material_type}),E.length===0?i.jsx("div",{style:{padding:"4px 0",color:"#999",fontSize:12},children:"CMF"}):i.jsx(Ws.Group,{value:p[j.id]||"",onChange:R=>m(M=>({...M,[j.id]:R.target.value})),style:{display:"flex",flexDirection:"column",gap:4,marginTop:4},children:E.map(R=>i.jsx(Ws,{value:R.id,style:{fontSize:12},children:i.jsxs(Be,{size:6,children:[i.jsxs(_e,{color:"processing",style:{margin:0,fontSize:11},children:["V",R.variant_index]}),R.material_code&&i.jsx(At,{style:{fontSize:11,color:"#8c8c8c"},children:R.material_code}),i.jsx(qw,{hex:R.color_hex}),R.finish&&i.jsx(At,{style:{fontSize:11},children:R.finish}),R.texture&&i.jsx(At,{style:{fontSize:11},children:R.texture})]})},R.id))})]},j.id)})})]})]})]})},Mk=()=>{const{id:t}=td(),e=Ni(),n=Ln(),s=Tn(),{data:o,isLoading:l}=ct({queryKey:["project",t],queryFn:()=>Ci.get(t),enabled:!!t}),{data:d,isLoading:u}=ct({queryKey:["project-tasks",t],queryFn:()=>Ci.listTasks(t),enabled:!!t}),h=Rt({mutationFn:({projectId:m,taskId:g})=>Ci.completeTask(m,g),onSuccess:()=>{me.success(""),n.invalidateQueries({queryKey:["project-tasks",t]})},onError:()=>me.error("")}),p=()=>{n.invalidateQueries({queryKey:["project-tasks",t]}),n.invalidateQueries({queryKey:["project",t]})};return $v({onTaskUpdate:P.useCallback(m=>{m.project_id===t&&(n.invalidateQueries({queryKey:["project-tasks",t]}),n.invalidateQueries({queryKey:["project",t]}))},[t,n]),onProjectUpdate:P.useCallback(m=>{m.project_id===t&&(n.invalidateQueries({queryKey:["project-tasks",t]}),n.invalidateQueries({queryKey:["project",t]}))},[t,n]),enabled:!!t}),l?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:i.jsx(tn,{size:"large",tip:"..."})}):o?i.jsxs("div",{style:{padding:s?12:24},children:[!s&&i.jsxs("div",{style:{marginBottom:24},children:[i.jsx(J,{type:"link",icon:i.jsx(Ls,{}),onClick:()=>e("/projects"),style:{padding:0,marginBottom:8},children:""}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[i.jsxs("div",{style:{minWidth:0,flex:1},children:[i.jsxs(rk,{level:3,style:{margin:0},children:[o.name,o.code&&i.jsx(At,{code:!0,style:{marginLeft:8,fontSize:14},children:o.code})]}),i.jsx("div",{style:{marginTop:8},children:i.jsx(dk,{currentPhase:o.phase})})]}),i.jsxs(Be,{children:[i.jsx(Ii,{status:xE[o.status],text:o.status==="planning"?"":o.status==="active"?"":o.status==="completed"?"":o.status==="on_hold"?"":o.status}),i.jsx(Mi,{type:"circle",percent:o.progress,size:48})]})]})]}),i.jsx(Mt,{bodyStyle:{padding:s?8:void 0},children:i.jsx(Ol,{defaultActiveKey:"overview",tabBarGutter:s?8:void 0,size:s?"small":void 0,items:[{key:"overview",label:"",children:i.jsx(fk,{project:o})},{key:"gantt",label:` (${d?.length||0})`,children:u?i.jsx("div",{style:{textAlign:"center",padding:40},children:"..."}):d&&d.length>0?i.jsx("div",{style:{height:560},children:i.jsx(uk,{tasks:d,projectId:o.id,onCompleteTask:m=>h.mutate({projectId:o.id,taskId:m}),completingTask:h.isPending,onRefresh:p})}):i.jsx(ft,{description:""})},{key:"bom",label:"BOM",children:i.jsx(pk,{projectId:o.id})},{key:"sku",label:"SKU",children:i.jsx(Sk,{projectId:o.id})},{key:"cmf",label:"CMF",children:i.jsx(Yv,{projectId:o.id,readonly:!0})},{key:"documents",label:"",children:i.jsx(mk,{projectId:o.id})},{key:"deliverables",label:"",children:i.jsx(gk,{projectId:o.id,currentPhase:o.phase})},{key:"ecn",label:"ECN",children:i.jsx(xk,{projectId:o.id,productId:o.product_id})},{key:"roles",label:"",children:i.jsx(bk,{projectId:o.id})}]})})]}):i.jsxs("div",{style:{padding:24},children:[i.jsx(ft,{description:""}),i.jsx("div",{style:{textAlign:"center",marginTop:16},children:i.jsx(J,{onClick:()=>e("/projects"),children:""})})]})},{Search:wk}=Pe,Ck=()=>{const t=Tn(),[e,n]=P.useState([]),[s,o]=P.useState([]),[l,d]=P.useState(!1),[u,h]=P.useState(""),[p,m]=P.useState(""),[g,v]=P.useState(!1),[C,b]=P.useState(!1),[_,y]=P.useState(null),[S]=ee.useForm(),D=async()=>{d(!0);try{const O=await Mu.list({category:p||void 0,search:u||void 0});n(O.materials||[])}catch(O){console.error(":",O)}finally{d(!1)}},L=async()=>{try{const O=await Mu.listCategories();o(O.categories||[])}catch(O){console.error(":",O)}};P.useEffect(()=>{D(),L()},[p]);const N=()=>{D()},T=()=>{S.resetFields(),y(null),v(!0)},j=O=>{y(O),S.setFieldsValue(O),v(!0)},E=O=>{y(O),b(!0)},R=async()=>{try{const O=await S.validateFields();_?(await Mu.update(_.id,O),me.success("")):(await Mu.create(O),me.success("")),v(!1),D()}catch(O){console.error(":",O),me.error("")}},M=s.map(O=>({title:O.name,value:O.id,key:O.id,children:O.children?.map(k=>({title:k.name,value:k.id,key:k.id}))})),I=O=>({active:"green",inactive:"default",deprecated:"red"})[O]||"default",z=O=>O==="active"?"":O==="inactive"?"":"",V=[{title:"",dataIndex:"code",key:"code",width:150,render:O=>i.jsx("span",{style:{fontFamily:"monospace"},children:O})},{title:"",dataIndex:"name",key:"name",width:200},{title:"",dataIndex:"category",key:"category",width:150,render:O=>O?O.code?`${O.name} (${O.code})`:O.name:"-"},{title:"",dataIndex:"description",key:"description",ellipsis:!0},{title:"",dataIndex:"unit",key:"unit",width:80},{title:"",dataIndex:"standard_cost",key:"standard_cost",width:100,render:O=>`${O?.toFixed(2)||"0.00"}`},{title:"",dataIndex:"status",key:"status",width:80,render:O=>i.jsx(_e,{color:I(O),children:z(O)})},{title:"",key:"action",width:120,render:(O,k)=>i.jsxs(Be,{children:[i.jsx(J,{type:"link",size:"small",icon:i.jsx(rr,{}),onClick:()=>E(k),children:""}),i.jsx(J,{type:"link",size:"small",icon:i.jsx($u,{}),onClick:()=>j(k),children:""})]})}];return t?i.jsxs("div",{style:{background:"#f5f5f5",minHeight:"100vh"},children:[i.jsx("div",{style:{padding:"12px 16px",background:"#fff",position:"sticky",top:0,zIndex:10},children:i.jsx(Pe,{placeholder:"/",prefix:i.jsx(gi,{style:{color:"#bbb"}}),value:u,onChange:O=>h(O.target.value),onPressEnter:N,allowClear:!0,style:{borderRadius:20}})}),s.length>0&&i.jsxs("div",{style:{display:"flex",gap:8,padding:"8px 16px",overflowX:"auto",WebkitOverflowScrolling:"touch"},className:"mobile-filter-pills",children:[i.jsx("div",{className:`mobile-filter-pill ${p?"":"active"}`,onClick:()=>m(""),children:""}),s.map(O=>i.jsx("div",{className:`mobile-filter-pill ${p===O.id?"active":""}`,onClick:()=>m(O.id),children:O.name},O.id))]}),i.jsxs("div",{style:{padding:"4px 16px 8px",fontSize:12,color:"#999"},children:[" ",e.length," "]}),l?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):i.jsxs("div",{style:{padding:"0 12px"},children:[e.map(O=>i.jsxs("div",{onClick:()=>E(O),style:{background:"#fff",borderRadius:10,padding:"12px 14px",marginBottom:8,boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[i.jsx("span",{style:{fontWeight:600,fontSize:15,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.name}),i.jsx(_e,{color:I(O.status),style:{marginLeft:8,flexShrink:0},children:z(O.status)})]}),i.jsx("div",{style:{fontSize:12,fontFamily:"monospace",color:"#1677ff",marginBottom:6},children:O.code}),i.jsxs("div",{style:{display:"flex",gap:16,fontSize:13,color:"#666"},children:[O.category&&i.jsx("span",{children:O.category.name}),i.jsx("span",{children:O.unit}),i.jsxs("span",{style:{marginLeft:"auto",color:"#333",fontWeight:500},children:["",O.standard_cost?.toFixed(2)||"0.00"]})]}),O.description&&i.jsx("div",{style:{fontSize:12,color:"#999",marginTop:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.description})]},O.id)),e.length===0&&i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:""})]}),i.jsx("div",{onClick:T,style:{position:"fixed",bottom:80,right:20,width:52,height:52,borderRadius:26,background:"#1677ff",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(22,119,255,0.4)",zIndex:100,fontSize:22,cursor:"pointer"},children:i.jsx(Yt,{})}),i.jsx(Nt,{title:_?"":"",open:g,onOk:R,onCancel:()=>v(!1),width:600,children:i.jsxs(ee,{form:S,layout:"vertical",children:[i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"category_id",label:"",children:i.jsx(hx,{placeholder:"",allowClear:!0,treeDefaultExpandAll:!0,treeData:M})}),i.jsx(ee.Item,{name:"unit",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:": pcs, kg, m"})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})}),i.jsx(ee.Item,{name:"standard_cost",label:"",children:i.jsx(en,{style:{width:"100%"},min:0,precision:2,placeholder:"0.00"})}),i.jsx(ee.Item,{name:"lead_time_days",label:"()",children:i.jsx(en,{style:{width:"100%"},min:0,placeholder:"0"})}),i.jsx(ee.Item,{name:"safety_stock",label:"",children:i.jsx(en,{style:{width:"100%"},min:0,placeholder:"0"})})]})}),i.jsx(ci,{title:"",open:C,onClose:()=>b(!1),width:"100%",children:_&&i.jsxs(pe,{column:1,bordered:!0,size:"small",children:[i.jsx(pe.Item,{label:"",children:_.code}),i.jsx(pe.Item,{label:"",children:_.name}),i.jsx(pe.Item,{label:"",children:_.category?.name||"-"}),i.jsx(pe.Item,{label:"",children:_.unit}),i.jsx(pe.Item,{label:"",children:_.description||"-"}),i.jsxs(pe.Item,{label:"",children:["",_.standard_cost?.toFixed(2)||"0.00"]}),i.jsxs(pe.Item,{label:"",children:["",_.last_cost?.toFixed(2)||"0.00"]}),i.jsxs(pe.Item,{label:"",children:[_.lead_time_days||0," "]}),i.jsx(pe.Item,{label:"",children:_.min_order_qty||0}),i.jsx(pe.Item,{label:"",children:_.safety_stock||0}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:I(_.status),children:_.status==="active"?"":""})}),i.jsx(pe.Item,{label:"",children:i.jsx("pre",{style:{margin:0,fontSize:12},children:JSON.stringify(_.specs,null,2)})}),i.jsx(pe.Item,{label:"",children:new Date(_.created_at).toLocaleString()})]})})]}):i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{children:[i.jsx(hx,{placeholder:"",allowClear:!0,treeDefaultExpandAll:!0,style:{width:180},value:p||void 0,onChange:O=>m(O||""),treeData:M}),i.jsx(wk,{placeholder:"",value:u,onChange:O=>h(O.target.value),onSearch:N,style:{width:200}}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:D,children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:T,children:""})]}),children:i.jsx(sn,{columns:V,dataSource:e,rowKey:"id",loading:l,pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:O=>` ${O} `}})}),i.jsx(Nt,{title:_?"":"",open:g,onOk:R,onCancel:()=>v(!1),width:600,children:i.jsxs(ee,{form:S,layout:"vertical",children:[i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"category_id",label:"",children:i.jsx(hx,{placeholder:"",allowClear:!0,treeDefaultExpandAll:!0,treeData:M})}),i.jsx(ee.Item,{name:"unit",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:": pcs, kg, m"})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})}),i.jsx(ee.Item,{name:"standard_cost",label:"",children:i.jsx(en,{style:{width:"100%"},min:0,precision:2,placeholder:"0.00"})}),i.jsx(ee.Item,{name:"lead_time_days",label:"()",children:i.jsx(en,{style:{width:"100%"},min:0,placeholder:"0"})}),i.jsx(ee.Item,{name:"safety_stock",label:"",children:i.jsx(en,{style:{width:"100%"},min:0,placeholder:"0"})})]})}),i.jsx(ci,{title:"",open:C,onClose:()=>b(!1),width:500,children:_&&i.jsxs(pe,{column:1,bordered:!0,size:"small",children:[i.jsx(pe.Item,{label:"",children:_.code}),i.jsx(pe.Item,{label:"",children:_.name}),i.jsx(pe.Item,{label:"",children:_.category?.name||"-"}),i.jsx(pe.Item,{label:"",children:_.unit}),i.jsx(pe.Item,{label:"",children:_.description||"-"}),i.jsxs(pe.Item,{label:"",children:["",_.standard_cost?.toFixed(2)||"0.00"]}),i.jsxs(pe.Item,{label:"",children:["",_.last_cost?.toFixed(2)||"0.00"]}),i.jsxs(pe.Item,{label:"",children:[_.lead_time_days||0," "]}),i.jsx(pe.Item,{label:"",children:_.min_order_qty||0}),i.jsx(pe.Item,{label:"",children:_.safety_stock||0}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:I(_.status),children:_.status==="active"?"":""})}),i.jsx(pe.Item,{label:"",children:i.jsx("pre",{style:{margin:0,fontSize:12},children:JSON.stringify(_.specs,null,2)})}),i.jsx(pe.Item,{label:"",children:new Date(_.created_at).toLocaleString()})]})})]})},{Option:CV}=Xe,Kx={draft:{color:"default",label:""},pending:{color:"processing",label:""},approved:{color:"success",label:""},rejected:{color:"error",label:""},executing:{color:"warning",label:""},closed:{color:"default",label:""},implemented:{color:"success",label:""},cancelled:{color:"default",label:""}},Xx={low:{color:"blue",label:""},medium:{color:"blue",label:""},high:{color:"orange",label:""},critical:{color:"red",label:""}},Ph={design:"",material:"",process:"",spec:"",document:""},Tk=()=>{const t=Ni(),{message:e}=Ya.useApp(),n=Tn(),[s,o]=P.useState(!1),[l,d]=P.useState([]),[u,h]=P.useState(0),[p,m]=P.useState(1),[g,v]=P.useState({pending_approval:0,executing:0,month_created:0,month_closed:0}),[C,b]=P.useState([]),[_,y]=P.useState({}),[S,D]=P.useState("table"),L=async()=>{o(!0);try{const R=await ia.list({..._,page:p,page_size:20});d(R.items||[]),h(R.total)}catch{e.error("ECN")}finally{o(!1)}},N=async()=>{try{const R=await ia.getStats();v(R)}catch{}},T=async()=>{try{const M=(await Ci.list())?.items||[];b(M.map(I=>({id:I.product_id||I.id,name:I.name})))}catch{}};P.useEffect(()=>{T()},[]),P.useEffect(()=>{L(),N()},[p,_]);const j=[{title:"",dataIndex:"code",width:150,render:(R,M)=>i.jsx("a",{onClick:()=>t(`/ecn/${M.id}`),children:R})},{title:"",dataIndex:"title",ellipsis:!0},{title:"",dataIndex:["product","name"],width:120},{title:"",dataIndex:"change_type",width:100,render:R=>Ph[R]||R},{title:"",dataIndex:"urgency",width:80,render:R=>{const M=Xx[R]||{color:"default",label:R};return i.jsx(_e,{color:M.color,children:M.label})}},{title:"",dataIndex:"status",width:100,render:R=>{const M=Kx[R]||{color:"default",label:R};return i.jsx(_e,{color:M.color,children:M.label})}},{title:"",width:80,render:(R,M)=>M.affected_items?.length||0},{title:"",dataIndex:"completion_rate",width:80,render:(R,M)=>["executing","closed"].includes(M.status)?`${R||0}%`:"-"},{title:"",dataIndex:["requester","name"],width:80},{title:"",dataIndex:"created_at",width:110,render:R=>R?lt(R).format("MM-DD HH:mm"):"-"},{title:"",width:80,render:(R,M)=>i.jsx(J,{type:"link",size:"small",onClick:()=>t(`/ecn/${M.id}`),children:""})}],E=[{label:"",value:""},{label:"",value:"draft"},{label:"",value:"pending"},{label:"",value:"executing"},{label:"",value:"closed"}];return n?i.jsxs("div",{style:{background:"#f5f5f5",minHeight:"100vh"},children:[i.jsx("div",{style:{display:"flex",gap:8,padding:"12px 12px 4px",overflowX:"auto"},children:[{label:"",value:g.pending_approval,color:g.pending_approval>0?"#ff4d4f":void 0},{label:"",value:g.executing,color:"#fa8c16"},{label:"",value:g.month_created,color:"#1890ff"},{label:"",value:g.month_closed,color:"#52c41a"}].map(R=>i.jsxs("div",{style:{flex:1,minWidth:72,background:"#fff",borderRadius:10,padding:"10px 8px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[i.jsx("div",{style:{fontSize:20,fontWeight:700,color:R.color||"#333"},children:R.value}),i.jsx("div",{style:{fontSize:11,color:"#999"},children:R.label})]},R.label))}),i.jsx("div",{style:{padding:"8px 12px"},children:i.jsx(Pe,{placeholder:"/",prefix:i.jsx(gi,{style:{color:"#bbb"}}),allowClear:!0,style:{borderRadius:20},onPressEnter:R=>{y(M=>({...M,keyword:R.target.value})),m(1)},onChange:R=>{R.target.value||(y(M=>({...M,keyword:""})),m(1))}})}),i.jsx("div",{className:"mobile-filter-pills",style:{padding:"4px 12px 8px"},children:E.map(R=>i.jsx("div",{className:`mobile-filter-pill ${(_.status||"")===R.value?"active":""}`,onClick:()=>{y(M=>({...M,status:R.value})),m(1)},children:R.label},R.value))}),s?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):i.jsxs("div",{style:{padding:"0 12px"},children:[l.map(R=>{const M=Kx[R.status]||{color:"default",label:R.status},I=Xx[R.urgency]||{color:"default",label:R.urgency};return i.jsxs("div",{onClick:()=>t(`/ecn/${R.id}`),style:{background:"#fff",borderRadius:10,padding:"12px 14px",marginBottom:8,boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[i.jsx("span",{style:{fontSize:12,fontFamily:"monospace",color:"#1677ff"},children:R.code}),i.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:4},children:[(R.urgency==="high"||R.urgency==="critical")&&i.jsx(_e,{color:I.color,style:{margin:0,fontSize:11},children:I.label}),i.jsx(_e,{color:M.color,style:{margin:0,fontSize:11},children:M.label})]})]}),i.jsx("div",{style:{fontSize:15,fontWeight:500,marginBottom:6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R.title}),i.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:12,color:"#999",gap:12},children:[i.jsx("span",{children:Ph[R.change_type]||R.change_type}),i.jsx("span",{children:R.product?.name||"-"}),i.jsxs("span",{children:[R.affected_items?.length||0,""]}),i.jsx("span",{style:{marginLeft:"auto"},children:R.created_at?lt(R.created_at).format("M/D"):""}),i.jsx(Oi,{style:{fontSize:10,color:"#ccc"}})]})]},R.id)}),l.length===0&&!s&&i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:"ECN"}),u>20&&l.length>=20&&i.jsx("div",{style:{textAlign:"center",padding:12},children:i.jsx(J,{size:"small",onClick:()=>m(R=>R+1),children:""})})]}),i.jsx("div",{onClick:()=>t("/ecn/new"),style:{position:"fixed",bottom:80,right:20,width:52,height:52,borderRadius:26,background:"#1677ff",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(22,119,255,0.4)",zIndex:100,fontSize:22,cursor:"pointer"},children:i.jsx(Yt,{})})]}):i.jsxs("div",{style:{padding:0},children:[i.jsxs(kr,{gutter:16,style:{marginBottom:16},children:[i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{size:"small",style:{textAlign:"center"},children:i.jsx(na,{title:"",value:g.pending_approval,prefix:i.jsx(YR,{style:{color:"#ff4d4f"}}),valueStyle:g.pending_approval>0?{color:"#ff4d4f"}:void 0})})}),i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{size:"small",style:{textAlign:"center"},children:i.jsx(na,{title:"",value:g.executing,prefix:i.jsx(er,{style:{color:"#fa8c16"}})})})}),i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{size:"small",style:{textAlign:"center"},children:i.jsx(na,{title:"",value:g.month_created,prefix:i.jsx(Gu,{style:{color:"#1890ff"}})})})}),i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{size:"small",style:{textAlign:"center"},children:i.jsx(na,{title:"",value:g.month_closed,prefix:i.jsx(ra,{style:{color:"#52c41a"}})})})})]}),i.jsxs(Mt,{title:"ECN",extra:i.jsxs(Be,{children:[i.jsx(Y1,{options:[{value:"table",icon:i.jsx(KR,{})},{value:"card",icon:i.jsx(Qp,{})}],value:S,onChange:R=>D(R)}),i.jsx(rn,{title:"",children:i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>{L(),N()}})}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>t("/ecn/new"),children:""})]}),children:[i.jsxs(Be,{wrap:!0,style:{marginBottom:16,width:"100%"},children:[i.jsx(Y1,{options:E,value:_.status||"",onChange:R=>{y(M=>({...M,status:R})),m(1)}}),i.jsx(Pe,{placeholder:"/",prefix:i.jsx(gi,{}),allowClear:!0,style:{width:200},onPressEnter:R=>{y(M=>({...M,keyword:R.target.value})),m(1)},onChange:R=>{R.target.value||(y(M=>({...M,keyword:""})),m(1))}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:120},options:Object.entries(Ph).map(([R,M])=>({label:M,value:R})),onChange:R=>{y(M=>({...M,change_type:R})),m(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:110},options:[{label:"",value:"medium"},{label:"",value:"high"},{label:"",value:"critical"}],onChange:R=>{y(M=>({...M,urgency:R})),m(1)}})]}),S==="table"?i.jsx(sn,{dataSource:l,columns:j,rowKey:"id",loading:s,size:"small",pagination:{current:p,total:u,pageSize:20,showTotal:R=>` ${R} `,onChange:R=>m(R)}}):i.jsxs(i.Fragment,{children:[i.jsx(kr,{gutter:[16,16],children:l.map(R=>{const M=Kx[R.status]||{color:"default",label:R.status},I=Xx[R.urgency]||{color:"default",label:R.urgency};return i.jsx(ni,{xs:24,sm:24,md:12,lg:8,children:i.jsxs(Mt,{hoverable:!0,size:"small",onClick:()=>t(`/ecn/${R.id}`),style:{cursor:"pointer"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[i.jsx("span",{style:{fontWeight:500,color:"#1890ff"},children:R.code}),i.jsxs(Be,{size:4,children:[(R.urgency==="high"||R.urgency==="critical")&&i.jsx(_e,{color:I.color,children:I.label}),i.jsx(_e,{color:M.color,children:M.label})]})]}),i.jsx("div",{style:{fontSize:14,fontWeight:500,marginBottom:8,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R.title}),i.jsx("div",{style:{color:"#999",fontSize:12},children:i.jsxs(Be,{split:"",children:[i.jsxs("span",{children:["",R.product?.name||"-"]}),i.jsx("span",{children:Ph[R.change_type]||R.change_type})]})}),i.jsx("div",{style:{color:"#999",fontSize:12,marginTop:4},children:i.jsxs(Be,{split:"",children:[i.jsxs("span",{children:["",R.affected_items?.length||0,""]}),i.jsx("span",{children:R.requester?.name||"-"}),i.jsx("span",{children:R.created_at?lt(R.created_at).format("MD"):"-"})]})})]})},R.id)})}),u>20&&i.jsx("div",{style:{textAlign:"center",marginTop:16},children:i.jsx(J,{onClick:()=>m(R=>R+1),children:""})})]})]})]})},{Search:jk}=Pe,{Option:Gw}=Xe,Ek=()=>{const[t,e]=P.useState([]),[n,s]=P.useState([]),[o,l]=P.useState(!1),[d,u]=P.useState(""),[h,p]=P.useState(""),[m,g]=P.useState(!1),[v,C]=P.useState(!1),[b,_]=P.useState(!1),[y,S]=P.useState(!1),[D,L]=P.useState(null),[N,T]=P.useState([]),[j,E]=P.useState(null),[R,M]=P.useState(null),[I,z]=P.useState(!1),[V]=ee.useForm(),[O]=ee.useForm(),[k,F]=P.useState({current:1,pageSize:20,total:0}),A=async(Se=1)=>{l(!0);try{const $e=await ls.list({category:h||void 0,search:d||void 0,page:Se,page_size:k.pageSize});e($e.items||[]),F({...k,current:Se,total:$e.total})}catch($e){console.error(":",$e)}finally{l(!1)}},q=async()=>{try{const Se=await ls.listCategories();s(Se.categories||[])}catch(Se){console.error(":",Se)}};P.useEffect(()=>{A(),q()},[h]);const B=()=>{A(1)},W=()=>{V.resetFields(),E(null),L(null),g(!0)},Q=Se=>{L(Se),C(!0)},ne=async Se=>{try{const $e=await ls.listVersions(Se.id);T($e||[]),L(Se),_(!0)}catch{me.error("")}},de=async(Se,$e)=>{try{const jt=await ls.download(Se),Fe=window.URL.createObjectURL(jt),Dt=document.createElement("a");Dt.href=Fe,Dt.download=$e,document.body.appendChild(Dt),Dt.click(),window.URL.revokeObjectURL(Fe),document.body.removeChild(Dt)}catch{me.error("")}},$=async Se=>{try{await ls.delete(Se),me.success(""),A()}catch{me.error("")}},X=async Se=>{try{await ls.release(Se),me.success(""),A()}catch{me.error("")}},le=async()=>{try{const Se=await V.validateFields();if(!j){me.warning("");return}await ls.upload(j,{title:Se.title,category_id:Se.category_id,description:Se.description}),me.success(""),g(!1),A()}catch(Se){console.error(":",Se),me.error("")}},oe=()=>{O.resetFields(),M(null),S(!0)},ue=async()=>{if(D){if(!R){me.warning("");return}z(!0);try{const Se=await O.validateFields();await ls.uploadNewVersion(D.id,R,Se.change_summary),me.success(""),S(!1);const $e=await ls.listVersions(D.id);T($e||[]),A(k.current);const jt=await ls.get(D.id);L(jt)}catch(Se){console.error(":",Se),me.error("")}finally{z(!1)}}},Ye=async Se=>{if(D)try{const $e=await ls.downloadVersion(D.id,Se.id),jt=window.URL.createObjectURL($e),Fe=document.createElement("a");Fe.href=jt,Fe.download=Se.file_name,document.body.appendChild(Fe),Fe.click(),window.URL.revokeObjectURL(jt),document.body.removeChild(Fe)}catch{me.error("")}},ae=Se=>Se?.includes("pdf")?i.jsx(XR,{style:{color:"#ff4d4f",fontSize:20}}):Se?.includes("word")||Se?.includes("doc")?i.jsx(QR,{style:{color:"#1890ff",fontSize:20}}):Se?.includes("excel")||Se?.includes("sheet")?i.jsx(nd,{style:{color:"#52c41a",fontSize:20}}):Se?.includes("image")?i.jsx(ZR,{style:{color:"#faad14",fontSize:20}}):Se?.includes("zip")||Se?.includes("rar")?i.jsx(JR,{style:{color:"#722ed1",fontSize:20}}):i.jsx(e3,{style:{color:"#666",fontSize:20}}),fe=Se=>{if(!Se)return"0 B";const $e=1024,jt=["B","KB","MB","GB"],Fe=Math.floor(Math.log(Se)/Math.log($e));return parseFloat((Se/Math.pow($e,Fe)).toFixed(2))+" "+jt[Fe]},pt=Se=>{const $e={draft:{color:"default",text:""},released:{color:"green",text:""},obsolete:{color:"red",text:""}},{color:jt,text:Fe}=$e[Se]||{color:"default",text:Se};return i.jsx(_e,{color:jt,children:Fe})},_t=[{title:"",key:"file",width:50,render:(Se,$e)=>ae($e.file_type)},{title:"",dataIndex:"code",key:"code",width:130,render:Se=>i.jsx("span",{style:{fontFamily:"monospace"},children:Se})},{title:"",dataIndex:"title",key:"title",ellipsis:!0},{title:"",dataIndex:"category",key:"category",width:100,render:Se=>Se?.name||"-"},{title:"",dataIndex:"version",key:"version",width:70,render:Se=>i.jsxs(_e,{color:"blue",children:["V",Se]})},{title:"",dataIndex:"file_size",key:"file_size",width:90,render:Se=>fe(Se)},{title:"",dataIndex:"status",key:"status",width:80,render:Se=>pt(Se)},{title:"",dataIndex:"uploader",key:"uploader",width:100,render:Se=>Se?.name||"-"},{title:"",dataIndex:"created_at",key:"created_at",width:160,render:Se=>new Date(Se).toLocaleString()},{title:"",key:"action",width:200,render:(Se,$e)=>i.jsxs(Be,{children:[i.jsx(rn,{title:"",children:i.jsx(J,{type:"link",size:"small",icon:i.jsx(rr,{}),onClick:()=>Q($e)})}),i.jsx(rn,{title:"",children:i.jsx(J,{type:"link",size:"small",icon:i.jsx(Fc,{}),onClick:()=>de($e.id,$e.file_name)})}),i.jsx(rn,{title:"",children:i.jsx(J,{type:"link",size:"small",icon:i.jsx(Fp,{}),onClick:()=>ne($e)})}),$e.status==="draft"&&i.jsx(rn,{title:"",children:i.jsx(Bn,{title:"",onConfirm:()=>X($e.id),children:i.jsx(J,{type:"link",size:"small",style:{color:"green"},children:""})})}),i.jsx(rn,{title:"",children:i.jsx(Bn,{title:"",onConfirm:()=>$($e.id),children:i.jsx(J,{type:"link",size:"small",danger:!0,icon:i.jsx(Zn,{})})})})]})}];return i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{children:[i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:150},value:h||void 0,onChange:Se=>p(Se||""),children:n.map(Se=>i.jsx(Gw,{value:Se.id,children:Se.name},Se.id))}),i.jsx(jk,{placeholder:"",value:d,onChange:Se=>u(Se.target.value),onSearch:B,style:{width:200}}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>A(),children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Li,{}),onClick:W,children:""})]}),children:i.jsx(sn,{columns:_t,dataSource:t,rowKey:"id",loading:o,pagination:{...k,showSizeChanger:!0,showQuickJumper:!0,showTotal:Se=>` ${Se} `,onChange:(Se,$e)=>{F({...k,current:Se,pageSize:$e}),A(Se)}}})}),i.jsx(Nt,{title:"",open:m,onOk:le,onCancel:()=>g(!1),width:500,children:i.jsxs(ee,{form:V,layout:"vertical",children:[i.jsxs(ee.Item,{label:"",required:!0,children:[i.jsx(Zi,{beforeUpload:Se=>(E(Se),!1),maxCount:1,onRemove:()=>E(null),children:i.jsx(J,{icon:i.jsx(Li,{}),children:""})}),j&&i.jsx("div",{style:{marginTop:8},children:j.name})]}),i.jsx(ee.Item,{name:"title",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"category_id",label:"",children:i.jsx(Xe,{placeholder:"",allowClear:!0,children:n.map(Se=>i.jsx(Gw,{value:Se.id,children:Se.name},Se.id))})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(Pe.TextArea,{rows:3,placeholder:""})})]})}),i.jsx(ci,{title:"",open:v,onClose:()=>C(!1),width:500,extra:i.jsxs(Be,{children:[i.jsx(J,{icon:i.jsx(Fp,{}),onClick:()=>{D&&(C(!1),ne(D))},children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Fc,{}),onClick:()=>D&&de(D.id,D.file_name),children:""})]}),children:D&&i.jsxs(pe,{column:1,bordered:!0,size:"small",children:[i.jsx(pe.Item,{label:"",children:D.code}),i.jsx(pe.Item,{label:"",children:D.title}),i.jsx(pe.Item,{label:"",children:D.category?.name||"-"}),i.jsx(pe.Item,{label:"",children:D.file_name}),i.jsx(pe.Item,{label:"",children:fe(D.file_size)}),i.jsx(pe.Item,{label:"",children:i.jsxs(_e,{color:"blue",children:["V",D.version]})}),i.jsx(pe.Item,{label:"",children:pt(D.status)}),i.jsx(pe.Item,{label:"",children:D.description||"-"}),i.jsx(pe.Item,{label:"",children:D.uploader?.name||"-"}),i.jsx(pe.Item,{label:"",children:new Date(D.created_at).toLocaleString()}),D.released_at&&i.jsxs(i.Fragment,{children:[i.jsx(pe.Item,{label:"",children:D.releaser?.name||"-"}),i.jsx(pe.Item,{label:"",children:new Date(D.released_at).toLocaleString()})]})]})}),i.jsx(ci,{title:` - ${D?.title||""}`,open:b,onClose:()=>_(!1),width:600,extra:i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:oe,children:""}),children:i.jsx(wa,{dataSource:N,renderItem:Se=>{const $e=Se.version===D?.version;return i.jsx(wa.Item,{style:$e?{backgroundColor:"#e6f7ff",borderRadius:6,padding:"12px 16px"}:{padding:"12px 16px"},actions:[i.jsx(J,{type:"link",icon:i.jsx(Fc,{}),onClick:()=>Ye(Se),children:""},"download")],children:i.jsx(wa.Item.Meta,{avatar:ae(Se.file_name),title:i.jsxs(Be,{children:[i.jsxs("span",{children:["V",Se.version]}),$e&&i.jsx(_e,{color:"blue",children:""})]}),description:i.jsxs("div",{children:[i.jsxs("div",{children:[Se.file_name," (",fe(Se.file_size),")"]}),i.jsxs("div",{style:{color:"#999"},children:[Se.creator?.name||"","  ",new Date(Se.created_at).toLocaleString()]}),Se.change_summary&&i.jsxs("div",{style:{marginTop:4,color:"#666"},children:[": ",Se.change_summary]})]})})})}})}),i.jsx(Nt,{title:"",open:y,onOk:ue,onCancel:()=>S(!1),confirmLoading:I,width:500,children:i.jsxs(ee,{form:O,layout:"vertical",children:[i.jsxs(ee.Item,{label:"",required:!0,children:[i.jsx(Zi,{beforeUpload:Se=>(M(Se),!1),maxCount:1,onRemove:()=>M(null),children:i.jsx(J,{icon:i.jsx(Li,{}),children:""})}),R&&i.jsx("div",{style:{marginTop:8},children:R.name})]}),i.jsx(ee.Item,{name:"change_summary",label:"",children:i.jsx(Pe.TextArea,{rows:3,placeholder:""})})]})})]})},{Title:Ak,Text:Di}=An,yl={pending:{color:"processing",text:"",icon:i.jsx(er,{})},approved:{color:"success",text:"",icon:i.jsx(ra,{})},rejected:{color:"error",text:"",icon:i.jsx($r,{})},cancelled:{color:"default",text:"",icon:i.jsx($r,{})}},Rk=()=>{const[t,e]=P.useState("center"),n=Ni(),s=Tn();return i.jsxs("div",{style:{padding:s?0:24},children:[!s&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[i.jsx(Ak,{level:3,style:{margin:0},children:""}),i.jsx(J,{icon:i.jsx(t3,{}),onClick:()=>n("/approval-admin"),children:""})]}),i.jsx(Ol,{activeKey:t,onChange:e,size:s?"middle":"large",style:{padding:s?"0 12px":0},items:[{key:"center",label:""},{key:"submit",label:""}]}),t==="submit"?i.jsx(Dk,{}):i.jsx(Pk,{})]})},Dk=()=>{const[t,e]=P.useState(""),[n,s]=P.useState(!1),[o,l]=P.useState(null),d=Tn(),{data:u,isLoading:h}=ct({queryKey:["approval-definitions"],queryFn:Rs.list}),p=P.useMemo(()=>{const C=u?.groups||[],b=[];return C.forEach(_=>{_.definitions.forEach(y=>{y.status==="published"&&b.push(y)})}),b},[u]),m=P.useMemo(()=>t?p.filter(C=>C.name.toLowerCase().includes(t.toLowerCase())):p,[p,t]),g=P.useMemo(()=>{const C={};return m.forEach(b=>{const _=b.group_name||"";C[_]||(C[_]=[]),C[_].push(b)}),C},[m]),v=C=>{l(C),s(!0)};return i.jsxs("div",{style:{padding:d?"0 12px":0},children:[i.jsx(Pe,{placeholder:"",prefix:i.jsx(gi,{}),value:t,onChange:C=>e(C.target.value),style:{width:d?"100%":300,marginBottom:24},allowClear:!0}),h?i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(tn,{})}):p.length===0?i.jsx(ft,{description:""}):Object.entries(g).map(([C,b])=>i.jsxs("div",{style:{marginBottom:24},children:[i.jsx(Di,{strong:!0,style:{fontSize:16,marginBottom:12,display:"block"},children:C}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12},children:b.map(_=>i.jsxs(Mt,{hoverable:!0,style:{width:160,textAlign:"center"},bodyStyle:{padding:16},onClick:()=>v(_),children:[i.jsx("div",{style:{width:48,height:48,borderRadius:12,background:"#1890ff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:24,color:"#fff",margin:"0 auto 8px"},children:_.icon||i.jsx(Gu,{})}),i.jsx(Di,{strong:!0,children:_.name})]},_.id))})]},C)),o&&i.jsx(Ik,{open:n,definition:o,onClose:()=>{s(!1),l(null)}})]})},Ik=({open:t,definition:e,onClose:n})=>{const[s]=ee.useForm(),o=Ln(),[l,d]=P.useState([]),u=e.flow_schema?.nodes?.some(m=>m.type==="approve"&&m.config.approver_type==="self_select"),h=Rt({mutationFn:m=>Rs.submit(e.id,{form_data:m,approver_ids:u?l:void 0}),onSuccess:()=>{me.success(""),o.invalidateQueries({queryKey:["approvals"]}),s.resetFields(),d([]),n()},onError:m=>{me.error(m?.response?.data?.error||"")}}),p=async()=>{try{const m=await s.validateFields(),g={};(e.form_schema||[]).forEach(v=>{let C=m[v.key];v.type==="date"&&C?C=C.format("YYYY-MM-DD"):v.type==="daterange"&&C&&(C=[C[0]?.format("YYYY-MM-DD"),C[1]?.format("YYYY-MM-DD")]),g[v.key]=C}),h.mutate(g)}catch{}};return i.jsx(Nt,{title:` - ${e.name}`,open:t,onCancel:n,onOk:p,confirmLoading:h.isPending,okText:"",cancelText:"",width:600,destroyOnClose:!0,children:i.jsxs(ee,{form:s,layout:"vertical",children:[(e.form_schema||[]).map(m=>i.jsx(Ok,{field:m},m.key)),u&&i.jsx(ee.Item,{label:"",required:!0,children:i.jsx(ko,{mode:"multiple",value:l,onChange:m=>d(m),placeholder:"",style:{width:"100%"}})})]})})},Ok=({field:t})=>{if(t.type==="description")return i.jsx("div",{style:{marginBottom:16},children:i.jsx(Di,{type:"secondary",children:t.label})});const e=t.required?[{required:!0,message:`${t.label}`}]:[];switch(t.type){case"text":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(Pe,{placeholder:t.placeholder||`${t.label}`})});case"textarea":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(Pe.TextArea,{placeholder:t.placeholder||`${t.label}`,rows:3})});case"number":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(en,{placeholder:t.placeholder||`${t.label}`,style:{width:"100%"}})});case"money":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(en,{prefix:t.prefix||"",placeholder:t.placeholder||"0.00",style:{width:"100%"},precision:2})});case"select":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(Xe,{placeholder:t.placeholder||`${t.label}`,options:(t.options||[]).map(n=>({label:n,value:n}))})});case"multiselect":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(Xe,{mode:"multiple",placeholder:t.placeholder||`${t.label}`,options:(t.options||[]).map(n=>({label:n,value:n}))})});case"date":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(qa,{placeholder:t.placeholder||"",style:{width:"100%"}})});case"daterange":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(qa.RangePicker,{style:{width:"100%"}})});case"user":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(ko,{mode:t.multiple?"multiple":"single",placeholder:t.placeholder||"",style:{width:"100%"}})});case"attachment":return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsxs(Zi.Dragger,{children:[i.jsx("p",{className:"ant-upload-drag-icon",children:i.jsx(yv,{})}),i.jsx("p",{className:"ant-upload-text",children:""})]})});case"table":return i.jsx(ee.Item,{name:t.key,label:t.label,children:i.jsx(Di,{type:"secondary",children:""})});default:return i.jsx(ee.Item,{name:t.key,label:t.label,rules:e,children:i.jsx(Pe,{placeholder:t.placeholder})})}},Pk=()=>{const t=Ln(),e=Tn(),[n,s]=P.useState("my_pending"),[o,l]=P.useState(null),[d,u]=P.useState(!1),[h,p]=P.useState(""),{data:m=[],isLoading:g}=ct({queryKey:["approvals",n],queryFn:()=>Mh.list({type:n}),refetchInterval:1e4}),{data:v,isLoading:C}=ct({queryKey:["approval-detail",o],queryFn:()=>Mh.get(o),enabled:!!o}),b=Rt({mutationFn:({id:D,comment:L})=>Mh.approve(D,L),onSuccess:()=>{me.success(""),t.invalidateQueries({queryKey:["approvals"]}),t.invalidateQueries({queryKey:["approval-detail"]}),t.invalidateQueries({queryKey:["project-tasks"]}),t.invalidateQueries({queryKey:["project"]}),t.invalidateQueries({queryKey:["my-tasks"]})},onError:D=>{me.error(D?.response?.data?.error||"")}}),_=Rt({mutationFn:({id:D,comment:L})=>Mh.reject(D,L),onSuccess:()=>{me.success(""),u(!1),p(""),t.invalidateQueries({queryKey:["approvals"]}),t.invalidateQueries({queryKey:["approval-detail"]}),t.invalidateQueries({queryKey:["project-tasks"]}),t.invalidateQueries({queryKey:["project"]}),t.invalidateQueries({queryKey:["my-tasks"]})},onError:D=>{me.error(D?.response?.data?.error||"")}}),y=D=>{b.mutate({id:D})},S=Array.isArray(m)?m:[];return e&&o?i.jsxs("div",{className:"ds-detail-page",children:[i.jsx(J,{type:"link",icon:i.jsx(er,{}),onClick:()=>l(null),style:{padding:0,marginBottom:8},children:""}),C?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):v?i.jsxs(i.Fragment,{children:[i.jsx($w,{approval:v,onApprove:y,onReject:D=>{l(D),u(!0)},approvePending:b.isPending}),v.status==="pending"&&i.jsxs("div",{className:"mobile-approval-actions",children:[i.jsx(J,{danger:!0,size:"large",onClick:()=>{u(!0)},children:""}),i.jsx(J,{type:"primary",size:"large",style:{background:"#52c41a",borderColor:"#52c41a"},onClick:()=>y(v.id),loading:b.isPending,children:""})]})]}):i.jsx(ft,{description:""}),i.jsx(Nt,{title:"",open:d,onCancel:()=>{u(!1),p("")},onOk:()=>{if(!h.trim()){me.warning("");return}o&&_.mutate({id:o,comment:h.trim()})},confirmLoading:_.isPending,okText:"",okButtonProps:{danger:!0},cancelText:"",children:i.jsx(Pe.TextArea,{rows:4,placeholder:"...",value:h,onChange:D=>p(D.target.value)})})]}):e?i.jsxs("div",{children:[i.jsx("div",{className:"mobile-filter-pills",children:[{key:"my_pending",label:""},{key:"my_approved",label:""},{key:"my_submitted",label:""}].map(D=>i.jsx("div",{className:`mobile-filter-pill ${n===D.key?"active":""}`,onClick:()=>{s(D.key),l(null)},children:D.label},D.key))}),i.jsx("div",{className:"ds-page-content",children:g?i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(tn,{})}):S.length===0?i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE})}):S.map(D=>{const L=yl[D.status],N=L?.color==="processing"?"ds-tag-processing":L?.color==="success"?"ds-tag-success":L?.color==="error"?"ds-tag-danger":"ds-tag-default";return i.jsxs("div",{className:"ds-list-card",onClick:()=>l(D.id),children:[i.jsxs("div",{className:"ds-card-header",children:[i.jsx("div",{style:{flex:1,minWidth:0},children:i.jsx("div",{className:"ds-card-title",children:D.definition_name||""})}),i.jsx("span",{className:`ds-tag ${N}`,children:L?.text||D.status})]}),i.jsxs("div",{className:"ds-card-meta",children:[i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[i.jsx(Pi,{size:18,icon:i.jsx(wi,{}),src:D.requester?.avatar_url,style:{flexShrink:0},children:D.requester?.name?.[0]}),D.requester?.name||""]}),i.jsx("span",{style:{color:"var(--ds-text-tertiary)"},children:D.created_at?lt(D.created_at).format("MM-DD HH:mm"):""})]})]},D.id)})})]}):i.jsxs("div",{style:{display:"flex",gap:16,minHeight:500},children:[i.jsx("div",{style:{width:160,flexShrink:0},children:i.jsx(gv,{mode:"inline",selectedKeys:[n],onClick:D=>{s(D.key),l(null)},items:[{key:"my_pending",label:"",icon:i.jsx(er,{})},{key:"my_approved",label:"",icon:i.jsx(ra,{})},{key:"my_submitted",label:"",icon:i.jsx(wi,{})}],style:{border:"none"}})}),i.jsx("div",{style:{width:320,flexShrink:0,overflowY:"auto",borderRight:"1px solid #f0f0f0",paddingRight:16},children:g?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):S.length===0?i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE}):S.map(D=>i.jsx(Mt,{size:"small",hoverable:!0,style:{marginBottom:8,border:o===D.id?"2px solid #1890ff":"1px solid #f0f0f0"},bodyStyle:{padding:12},onClick:()=>l(D.id),children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[i.jsxs("div",{children:[i.jsx(Di,{strong:!0,style:{fontSize:14},children:D.definition_name||""}),i.jsx("br",{}),i.jsxs(Be,{size:4,style:{marginTop:4},children:[i.jsx(Pi,{size:"small",icon:i.jsx(wi,{}),src:D.requester?.avatar_url,children:D.requester?.name?.[0]}),i.jsx(Di,{type:"secondary",style:{fontSize:12},children:D.requester?.name||""})]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx(_e,{color:yl[D.status]?.color||"default",children:yl[D.status]?.text||D.status}),i.jsx("br",{}),i.jsx(Di,{type:"secondary",style:{fontSize:11},children:D.created_at?lt(D.created_at).format("MM-DD HH:mm"):""})]})]})},D.id))}),i.jsx("div",{style:{flex:1,minWidth:0},children:o?C?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):v?i.jsx($w,{approval:v,onApprove:y,onReject:D=>{l(D),u(!0)},approvePending:b.isPending}):i.jsx(ft,{description:""}):i.jsx("div",{style:{textAlign:"center",padding:80},children:i.jsx(ft,{description:""})})}),i.jsx(Nt,{title:"",open:d,onCancel:()=>{u(!1),p("")},onOk:()=>{if(!h.trim()){me.warning("");return}o&&_.mutate({id:o,comment:h.trim()})},confirmLoading:_.isPending,okText:"",okButtonProps:{danger:!0},cancelText:"",children:i.jsx(Pe.TextArea,{rows:4,placeholder:"...",value:h,onChange:D=>p(D.target.value)})})]})},Lk=({projectId:t,taskId:e})=>{const[n,s]=P.useState(null),[o,l]=P.useState(null),[d,u]=P.useState(!0),[h,p]=P.useState({}),m=Tn();if(P.useEffect(()=>{Promise.all([Vn.getForm(t,e),Vn.getSubmission(t,e)]).then(([b,_])=>{s(b),l(_),b?.fields?.some(y=>y.type==="user"||y.type==="role_assignment")&&ef.list().then(y=>{const S={};y.forEach(D=>{S[D.id]=D.name}),p(S)})}).finally(()=>u(!1))},[t,e]),d)return i.jsx("div",{style:{color:"#999",fontSize:12,padding:"8px 0"},children:"..."});if(!n||!o)return null;const g=n.fields||[],v=o.data||{},C=b=>{let _=v[b.key];if(_==null)return"-";if(b.type==="role_assignment"&&typeof _=="object"&&!Array.isArray(_)){const y=Object.fromEntries(lE.map(S=>[S.code,S.label]));return Object.entries(_).map(([S,D])=>`${y[S]||S}: ${h[D]||D}`).join("; ")||"-"}return b.type==="user"?h[_]||_:typeof _=="boolean"?_?"":"":Array.isArray(_)?_.length>0&&typeof _[0]=="object"&&_[0].filename?_.map(y=>y.filename).join(", "):_.join(", "):String(_)};return m?i.jsxs("div",{className:"ds-detail-section",style:{marginTop:12,background:"#f6ffed",border:"1px solid #b7eb8f"},children:[i.jsx("div",{className:"ds-section-title",children:""}),g.map(b=>i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:b.label}),i.jsx("span",{className:"ds-info-value",children:C(b)})]},b.key)),i.jsxs("div",{style:{fontSize:11,color:"var(--ds-text-secondary)",marginTop:8},children:[": ",o.submitted_at?lt(o.submitted_at).format("YYYY-MM-DD HH:mm"):"-"]})]}):i.jsxs("div",{style:{marginTop:16,padding:12,background:"#f6ffed",borderRadius:6,border:"1px solid #b7eb8f"},children:[i.jsx(Di,{strong:!0,style:{fontSize:13,marginBottom:8,display:"block"},children:""}),i.jsx(pe,{size:"small",column:2,bordered:!0,children:g.map(b=>i.jsx(pe.Item,{label:b.label,children:C(b)},b.key))}),i.jsxs(Di,{type:"secondary",style:{fontSize:11,marginTop:4,display:"block"},children:[": ",o.submitted_at?lt(o.submitted_at).format("YYYY-MM-DD HH:mm"):"-"]})]})},$w=({approval:t,onApprove:e,onReject:n,approvePending:s})=>{const[o,l]=P.useState("detail");return i.jsxs(Mt,{title:i.jsxs(Be,{children:[i.jsx(Di,{strong:!0,style:{fontSize:16},children:t.definition_name||""}),i.jsx(_e,{color:yl[t.status]?.color||"default",children:yl[t.status]?.text||t.status})]}),extra:i.jsx(Di,{type:"secondary",style:{fontSize:12},children:t.created_at?lt(t.created_at).format("YYYY-MM-DD HH:mm"):""}),children:[i.jsx(Ol,{activeKey:o,onChange:l,items:[{key:"detail",label:""},{key:"timeline",label:""}]}),o==="detail"?i.jsxs("div",{children:[i.jsx("div",{style:{marginBottom:16,padding:12,background:"#fafafa",borderRadius:6},children:i.jsxs(Be,{children:[i.jsx(Pi,{icon:i.jsx(wi,{}),src:t.requester?.avatar_url,children:t.requester?.name?.[0]}),i.jsxs("div",{children:[i.jsx(Di,{strong:!0,children:t.requester?.name||""}),i.jsx("br",{}),i.jsx(Di,{type:"secondary",style:{fontSize:12},children:""})]})]})}),t.form_data&&Object.keys(t.form_data).length>0?i.jsx("div",{children:Object.entries(t.form_data).map(([d,u])=>{const p=t.definition?.form_schema?.find(m=>m.key===d)?.label||d;return i.jsxs("div",{style:{marginBottom:12,padding:"8px 0",borderBottom:"1px solid #f5f5f5"},children:[i.jsx(Di,{type:"secondary",style:{fontSize:12},children:p}),i.jsx("div",{style:{marginTop:2},children:i.jsx(Di,{children:Nk(u)})})]},d)})}):i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE}),t.project_id&&t.task_id&&i.jsx(Lk,{projectId:t.project_id,taskId:t.task_id})]}):i.jsx("div",{children:i.jsx(Il,{items:[{color:"green",children:i.jsxs("div",{children:[i.jsx(Di,{strong:!0,children:t.requester?.name||""}),i.jsx(Di,{type:"secondary",children:" "}),i.jsx("div",{style:{fontSize:12,color:"#999",marginTop:2},children:t.created_at?lt(t.created_at).format("YYYY-MM-DD HH:mm:ss"):""})]})},...(t.steps||[]).flatMap(d=>(d.approvers||[]).map(u=>({color:u.status==="approved"?"green":u.status==="rejected"?"red":"gray",children:i.jsxs("div",{children:[i.jsxs(Be,{children:[i.jsx(Pi,{size:"small",icon:i.jsx(wi,{}),src:u.user?.avatar_url,children:u.user?.name?.[0]}),i.jsx(Di,{strong:!0,children:u.user?.name||u.user_id}),i.jsx(_e,{color:yl[u.status]?.color||"default",children:yl[u.status]?.text||u.status})]}),u.comment&&i.jsx("div",{style:{marginTop:4,color:"#666",fontSize:12},children:u.comment}),u.decided_at&&i.jsx("div",{style:{fontSize:12,color:"#999",marginTop:2},children:lt(u.decided_at).format("YYYY-MM-DD HH:mm:ss")})]})})))]})}),t.status==="pending"&&i.jsx("div",{style:{marginTop:24,padding:"16px 0",borderTop:"1px solid #f0f0f0",textAlign:"right"},children:i.jsxs(Be,{children:[i.jsx(J,{type:"primary",style:{background:"#52c41a",borderColor:"#52c41a"},onClick:()=>e(t.id),loading:s,children:""}),i.jsx(J,{danger:!0,onClick:()=>n(t.id),children:""})]})})]})};function Nk(t){return t==null?"-":Array.isArray(t)?t.join(", "):typeof t=="object"?JSON.stringify(t):String(t)}const{Title:Fk,Text:Lh}=An,zk=()=>{const t=Ni(),e=Ln(),[n,s]=P.useState(""),[o,l]=P.useState(!1),[d,u]=P.useState(""),{data:h,isLoading:p}=ct({queryKey:["approval-definitions"],queryFn:Rs.list}),m=Rt({mutationFn:S=>t0.create(S),onSuccess:()=>{me.success(""),l(!1),u(""),e.invalidateQueries({queryKey:["approval-definitions"]}),e.invalidateQueries({queryKey:["approval-groups"]})},onError:S=>{me.error(S?.response?.data?.error||"")}}),g=Rt({mutationFn:S=>t0.delete(S),onSuccess:()=>{me.success(""),e.invalidateQueries({queryKey:["approval-definitions"]}),e.invalidateQueries({queryKey:["approval-groups"]})},onError:S=>{me.error(S?.response?.data?.error||"")}}),v=Rt({mutationFn:S=>Rs.delete(S),onSuccess:()=>{me.success(""),e.invalidateQueries({queryKey:["approval-definitions"]})},onError:S=>{me.error(S?.response?.data?.error||"")}}),C=Rt({mutationFn:S=>Rs.publish(S),onSuccess:()=>{me.success(""),e.invalidateQueries({queryKey:["approval-definitions"]})},onError:S=>{me.error(S?.response?.data?.error||"")}}),b=Rt({mutationFn:S=>Rs.unpublish(S),onSuccess:()=>{me.success(""),e.invalidateQueries({queryKey:["approval-definitions"]})},onError:S=>{me.error(S?.response?.data?.error||"")}}),y=(h?.groups||[]).map(S=>({...S,definitions:S.definitions.filter(D=>D.name.toLowerCase().includes(n.toLowerCase()))})).filter(S=>n?S.definitions.length>0:!0);return i.jsxs("div",{style:{padding:24},children:[i.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(Fk,{level:3,style:{margin:0},children:""}),i.jsxs(Be,{children:[i.jsx(Pe,{placeholder:"",prefix:i.jsx(gi,{}),value:n,onChange:S=>s(S.target.value),style:{width:200},allowClear:!0}),i.jsx(J,{icon:i.jsx(n3,{}),onClick:()=>l(!0),children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>t("/approval-editor/new"),children:""})]})]}),p?i.jsx("div",{style:{textAlign:"center",padding:80},children:i.jsx(tn,{size:"large"})}):y.length===0?i.jsx(Mt,{children:i.jsx(ft,{description:"",children:i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>t("/approval-editor/new"),children:""})})}):y.map(S=>i.jsx(Mt,{title:i.jsxs(Be,{children:[i.jsx(Lh,{strong:!0,style:{fontSize:16},children:S.name||""}),i.jsx(_e,{children:S.definitions.length})]}),extra:S.name&&S.id?i.jsx(Bn,{title:"",description:"",onConfirm:()=>g.mutate(S.id),children:i.jsx(J,{type:"text",danger:!0,size:"small",icon:i.jsx(Zn,{}),children:""})}):null,style:{marginBottom:16},children:i.jsx(wa,{dataSource:S.definitions,locale:{emptyText:i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE})},renderItem:D=>i.jsx(wa.Item,{actions:[i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",icon:i.jsx($u,{}),onClick:()=>t(`/approval-editor/${D.id}`)})},"edit"),D.status==="published"?i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",icon:i.jsx(i3,{}),onClick:()=>b.mutate(D.id)})},"unpublish"):i.jsx(rn,{title:"",children:i.jsx(J,{type:"text",style:{color:"#52c41a"},icon:i.jsx(Tl,{}),onClick:()=>C.mutate(D.id)})},"publish"),i.jsx(Bn,{title:"",onConfirm:()=>v.mutate(D.id),children:i.jsx(J,{type:"text",danger:!0,icon:i.jsx(Zn,{})})},"delete")],children:i.jsx(wa.Item.Meta,{avatar:i.jsx("div",{style:{width:40,height:40,borderRadius:8,background:"#1890ff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,color:"#fff"},children:D.icon||i.jsx(Gu,{})}),title:i.jsxs(Be,{children:[i.jsx(Lh,{strong:!0,children:D.name}),i.jsx(_e,{color:D.status==="published"?"green":"default",children:D.status==="published"?"":""})]}),description:i.jsxs(Be,{children:[D.description&&i.jsx(Lh,{type:"secondary",children:D.description}),i.jsxs(Lh,{type:"secondary",children:[": ",D.visibility==="all"?"":""]})]})})})})},S.name)),i.jsx(Nt,{title:"",open:o,onCancel:()=>{l(!1),u("")},onOk:()=>{if(!d.trim()){me.warning("");return}m.mutate(d.trim())},confirmLoading:m.isPending,okText:"",cancelText:"",children:i.jsx(Pe,{placeholder:"",value:d,onChange:S=>u(S.target.value),onPressEnter:()=>{d.trim()&&m.mutate(d.trim())}})})]})},{Title:kk,Text:li}=An,yE=[{category:"",items:[{type:"text",label:"",icon:i.jsx(a3,{})},{type:"textarea",label:"",icon:i.jsx(s3,{})},{type:"description",label:"",icon:i.jsx(r3,{})}]},{category:"",items:[{type:"number",label:"",icon:i.jsx(o3,{})},{type:"money",label:"",icon:i.jsx(l3,{})}]},{category:"",items:[{type:"select",label:"",icon:i.jsx(Lp,{})},{type:"multiselect",label:"",icon:i.jsx(Qp,{})}]},{category:"",items:[{type:"date",label:"",icon:i.jsx(zp,{})},{type:"daterange",label:"",icon:i.jsx(Gr,{})}]},{category:"",items:[{type:"user",label:"",icon:i.jsx(wi,{})},{type:"attachment",label:"",icon:i.jsx(Yu,{})},{type:"table",label:"",icon:i.jsx(c3,{})}]}],Qv={},vE={};yE.forEach(t=>t.items.forEach(e=>{Qv[e.type]=e.label,vE[e.type]=e.icon}));const Ww=[{type:"submit",name:"",config:{submitter:"all"}},{type:"approve",name:"",config:{approver_type:"designated",multi_approve:"all"}},{type:"end",name:"",config:{}}],Bk=()=>{const{id:t}=td(),e=Ni(),n=Ln(),s=t==="new",[o,l]=P.useState(0),[d]=ee.useForm(),[u,h]=P.useState([]),[p,m]=P.useState(null),[g,v]=P.useState(Ww),[C,b]=P.useState(null),[_,y]=P.useState(!0),[S,D]=P.useState(!1),[L,N]=P.useState(s?null:t||null),{data:T,isLoading:j}=ct({queryKey:["approval-definition",t],queryFn:()=>Rs.get(t),enabled:!s&&!!t}),{data:E=[]}=ct({queryKey:["approval-groups"],queryFn:t0.list});P.useEffect(()=>{T&&(d.setFieldsValue({name:T.name,description:T.description,group_name:T.group_name,visibility:T.visibility||"all"}),h(T.form_schema||[]),v(T.flow_schema?.nodes?.length>0?T.flow_schema.nodes:Ww),N(T.id))},[T,d]);const R=Rt({mutationFn:$=>Rs.create($),onSuccess:$=>{me.success(""),N($.id),n.invalidateQueries({queryKey:["approval-definitions"]}),window.history.replaceState(null,"",`/approval-editor/${$.id}`)},onError:$=>{me.error($?.response?.data?.error||"")}}),M=Rt({mutationFn:({defId:$,data:X})=>Rs.update($,X),onSuccess:()=>{me.success(""),n.invalidateQueries({queryKey:["approval-definitions"]}),n.invalidateQueries({queryKey:["approval-definition",L]})},onError:$=>{me.error($?.response?.data?.error||"")}}),I=Rt({mutationFn:$=>Rs.publish($),onSuccess:()=>{me.success(""),n.invalidateQueries({queryKey:["approval-definitions"]}),e("/approval-admin")},onError:$=>{me.error($?.response?.data?.error||"")}}),z=P.useCallback(()=>{const $=d.getFieldsValue();return{name:$.name,description:$.description,group_name:$.group_name,icon:"",visibility:$.visibility||"all",form_schema:u,flow_schema:{nodes:g}}},[d,u,g]),V=P.useCallback(async()=>{const $=z();if(!$.name){me.warning(""),l(0);return}L?M.mutate({defId:L,data:$}):R.mutate($)},[z,L,M,R]),O=P.useCallback(async()=>{const $=z();if(!$.name){me.warning(""),l(0);return}if(L)await M.mutateAsync({defId:L,data:$}),I.mutate(L);else{const X=await R.mutateAsync($);I.mutate(X.id)}},[z,L,M,R,I]),k=$=>{const X=Date.now().toString(36)+Math.random().toString(36).substr(2,4),le=Qv[$]||$,oe={key:X,type:$,label:le,required:!1};($==="select"||$==="multiselect")&&(oe.options=["1","2","3"]),$==="table"&&(oe.columns=[{key:"col1",label:"1",type:"text"},{key:"col2",label:"2",type:"text"}]),$==="money"&&(oe.prefix=""),h([...u,oe]),m(u.length)},F=($,X)=>{const le=[...u];le[$]={...le[$],...X},h(le)},A=$=>{const X=u.filter((le,oe)=>oe!==$);h(X),p===$?m(null):p!==null&&p>$&&m(p-1)},q=($,X)=>{const le=X==="up"?$-1:$+1;if(le<0||le>=u.length)return;const oe=[...u];[oe[$],oe[le]]=[oe[le],oe[$]],h(oe),m(le)},B=$=>{const X={type:"approve",name:"",config:{approver_type:"designated",multi_approve:"all"}},le=[...g];le.splice($+1,0,X),v(le)},W=($,X)=>{const le=[...g];le[$]={...le[$],...X},v(le)},Q=($,X)=>{const le=[...g];le[$]={...le[$],config:{...le[$].config,...X}},v(le)},ne=$=>{if(g.filter(oe=>oe.type==="approve").length<=1){me.warning("");return}const le=g.filter((oe,ue)=>ue!==$);v(le),C===$&&b(null)};if(!s&&j)return i.jsx("div",{style:{textAlign:"center",padding:80},children:i.jsx(tn,{size:"large"})});const de=R.isPending||M.isPending;return i.jsxs("div",{style:{padding:24},children:[i.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs(Be,{children:[i.jsx(J,{icon:i.jsx(Ls,{}),onClick:()=>e("/approval-admin")}),i.jsx(kk,{level:3,style:{margin:0},children:s?"":` - ${T?.name||""}`}),T?.status&&i.jsx(_e,{color:T.status==="published"?"green":"default",children:T.status==="published"?"":""})]}),i.jsxs(Be,{children:[i.jsx(J,{icon:i.jsx(AT,{}),onClick:V,loading:de,children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Tl,{}),onClick:O,loading:I.isPending,children:""})]})]}),i.jsx(Mt,{style:{marginBottom:24},children:i.jsx(vv,{current:o,onChange:l,items:[{title:""},{title:""},{title:""},{title:""}]})}),o===0&&i.jsx(Mt,{title:"",children:i.jsxs(ee,{form:d,layout:"vertical",style:{maxWidth:600},initialValues:{visibility:"all"},children:[i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(Pe.TextArea,{placeholder:"",rows:3})}),i.jsx(ee.Item,{name:"group_name",label:"",children:i.jsx(Xe,{placeholder:"",allowClear:!0,children:E.map($=>i.jsx(Xe.Option,{value:$.name,children:$.name},$.id||$.name))})}),i.jsx(ee.Item,{name:"visibility",label:"",children:i.jsxs(Ws.Group,{children:[i.jsx(Ws,{value:"all",children:""}),i.jsx(Ws,{value:"specified",children:""})]})})]})}),o===1&&i.jsx(Uk,{fields:u,selectedIndex:p,onAdd:k,onSelect:m,onUpdate:F,onRemove:A,onMove:q}),o===2&&i.jsx(qk,{nodes:g,selectedIndex:C,onSelect:b,onAddAfter:B,onUpdateNode:W,onUpdateConfig:Q,onRemoveNode:ne}),o===3&&i.jsx(Mt,{title:"",children:i.jsxs("div",{style:{maxWidth:500},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid #f0f0f0"},children:[i.jsxs("div",{children:[i.jsx(li,{strong:!0,children:""}),i.jsx("br",{}),i.jsx(li,{type:"secondary",style:{fontSize:12},children:""})]}),i.jsx(Br,{checked:_,onChange:y})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"},children:[i.jsxs("div",{children:[i.jsx(li,{strong:!0,children:""}),i.jsx("br",{}),i.jsx(li,{type:"secondary",style:{fontSize:12},children:""})]}),i.jsx(Br,{checked:S,onChange:D})]})]})}),i.jsx("div",{style:{marginTop:24,textAlign:"center"},children:i.jsxs(Be,{children:[o>0&&i.jsx(J,{onClick:()=>l(o-1),children:""}),o<3&&i.jsx(J,{type:"primary",onClick:()=>l(o+1),children:""})]})})]})},Uk=({fields:t,selectedIndex:e,onAdd:n,onSelect:s,onUpdate:o,onRemove:l,onMove:d})=>{const u=e!==null?t[e]:null;return i.jsxs("div",{style:{display:"flex",gap:16,minHeight:500},children:[i.jsx(Mt,{title:"",size:"small",style:{width:200,flexShrink:0},bodyStyle:{padding:"8px 12px"},children:yE.map(h=>i.jsxs("div",{style:{marginBottom:12},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:h.category}),i.jsx("div",{style:{marginTop:4},children:h.items.map(p=>i.jsx(J,{block:!0,size:"small",style:{textAlign:"left",marginBottom:4},icon:p.icon,onClick:()=>n(p.type),children:p.label},p.type))})]},h.category))}),i.jsx(Mt,{title:` (${t.length})`,size:"small",style:{flex:1,minWidth:300},children:t.length===0?i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE}):i.jsx("div",{children:t.map((h,p)=>i.jsxs("div",{onClick:()=>s(p),style:{padding:"10px 12px",marginBottom:8,border:`2px solid ${e===p?"#1890ff":"#f0f0f0"}`,borderRadius:6,cursor:"pointer",background:e===p?"#e6f7ff":"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s"},children:[i.jsxs(Be,{children:[i.jsx("span",{style:{color:"#999"},children:vE[h.type]}),i.jsx(li,{strong:!0,children:h.label}),i.jsx(_e,{children:Qv[h.type]}),h.required&&i.jsx(_e,{color:"red",children:""})]}),i.jsxs(Be,{size:2,children:[i.jsx(J,{type:"text",size:"small",icon:i.jsx(LT,{}),disabled:p===0,onClick:m=>{m.stopPropagation(),d(p,"up")}}),i.jsx(J,{type:"text",size:"small",icon:i.jsx(Vy,{}),disabled:p===t.length-1,onClick:m=>{m.stopPropagation(),d(p,"down")}}),i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{}),onClick:m=>{m.stopPropagation(),l(p)}})]})]},h.key))})}),i.jsx(Mt,{title:"",size:"small",style:{width:300,flexShrink:0},extra:u&&i.jsx(J,{type:"text",size:"small",icon:i.jsx(Wu,{}),onClick:()=>s(null)}),children:u&&e!==null?i.jsx(Hk,{field:u,onChange:h=>o(e,h)}):i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE})})]})},Hk=({field:t,onChange:e})=>i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Pe,{value:t.label,onChange:n=>e({label:n.target.value}),style:{marginTop:4}})]}),i.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Br,{checked:t.required,onChange:n=>e({required:n}),size:"small"})]}),t.type!=="description"&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Pe,{value:t.placeholder,onChange:n=>e({placeholder:n.target.value}),placeholder:"",style:{marginTop:4}})]}),t.type==="money"&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Pe,{value:t.prefix||"",onChange:n=>e({prefix:n.target.value}),style:{marginTop:4,width:80}})]}),(t.type==="select"||t.type==="multiselect")&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsxs("div",{style:{marginTop:4},children:[(t.options||[]).map((n,s)=>i.jsxs("div",{style:{display:"flex",gap:4,marginBottom:4},children:[i.jsx(Pe,{size:"small",value:n,onChange:o=>{const l=[...t.options||[]];l[s]=o.target.value,e({options:l})}}),i.jsx(J,{size:"small",danger:!0,icon:i.jsx(Zn,{}),onClick:()=>{const o=(t.options||[]).filter((l,d)=>d!==s);e({options:o})}})]},s)),i.jsx(J,{size:"small",type:"dashed",block:!0,icon:i.jsx(Yt,{}),onClick:()=>{const n=[...t.options||[],`${(t.options?.length||0)+1}`];e({options:n})},children:""})]})]}),t.type==="table"&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsxs("div",{style:{marginTop:4},children:[(t.columns||[]).map((n,s)=>i.jsxs("div",{style:{display:"flex",gap:4,marginBottom:4},children:[i.jsx(Pe,{size:"small",placeholder:"",value:n.label,onChange:o=>{const l=[...t.columns||[]];l[s]={...l[s],label:o.target.value},e({columns:l})},style:{flex:1}}),i.jsx(Xe,{size:"small",value:n.type,onChange:o=>{const l=[...t.columns||[]];l[s]={...l[s],type:o},e({columns:l})},style:{width:80},options:[{label:"",value:"text"},{label:"",value:"number"},{label:"",value:"date"}]}),i.jsx(J,{size:"small",danger:!0,icon:i.jsx(Zn,{}),onClick:()=>{const o=(t.columns||[]).filter((l,d)=>d!==s);e({columns:o})}})]},s)),i.jsx(J,{size:"small",type:"dashed",block:!0,icon:i.jsx(Yt,{}),onClick:()=>{const n="col"+Date.now().toString(36),s=[...t.columns||[],{key:n,label:"",type:"text"}];e({columns:s})},children:""})]})]}),t.type==="description"&&i.jsx("div",{style:{marginBottom:16},children:i.jsx(li,{type:"secondary",style:{fontSize:12},children:""})})]}),_E={designated:"",self_select:"",supervisor:"",dept_leader:"",submitter:"",role:""},Vk={all:"",any:"",sequential:""},qk=({nodes:t,selectedIndex:e,onSelect:n,onAddAfter:s,onUpdateNode:o,onUpdateConfig:l,onRemoveNode:d})=>{const u=e!==null?t[e]:null,h=p=>p.type==="submit"?"":p.type==="end"?"":_E[p.config.approver_type||""]||"";return i.jsxs("div",{style:{display:"flex",gap:16,minHeight:500},children:[i.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center"},children:i.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:t.map((p,m)=>i.jsxs(Pn.Fragment,{children:[i.jsx("div",{onClick:()=>n(m),style:{width:300,padding:"12px 16px",border:`2px solid ${e===m?"#1890ff":p.type==="approve"?"#fa8c16":"#d9d9d9"}`,borderRadius:8,background:e===m?"#e6f7ff":p.type==="approve"?"#fff7e6":"#fafafa",cursor:"pointer",transition:"all 0.2s"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs(Be,{children:[i.jsx(_e,{color:p.type==="approve"?"orange":"default",children:p.name}),i.jsx(li,{type:"secondary",style:{fontSize:12},children:h(p)})]}),p.type==="approve"&&i.jsx(Bn,{title:"",onConfirm:g=>{g?.stopPropagation(),d(m)},onCancel:g=>g?.stopPropagation(),children:i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{}),onClick:g=>g.stopPropagation()})})]})}),m<t.length-1&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"4px 0"},children:[i.jsx("div",{style:{width:2,height:16,background:"#d9d9d9"}}),i.jsx(J,{icon:i.jsx(Yt,{}),shape:"circle",size:"small",onClick:()=>s(m)}),i.jsx("div",{style:{width:2,height:16,background:"#d9d9d9"}})]})]},m))})}),i.jsx(Mt,{title:"",size:"small",style:{width:320,flexShrink:0},extra:u&&i.jsx(J,{type:"text",size:"small",icon:i.jsx(Wu,{}),onClick:()=>n(null)}),children:u&&e!==null?i.jsx(Gk,{node:u,index:e,onUpdateNode:o,onUpdateConfig:l}):i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE})})]})},Gk=({node:t,index:e,onUpdateNode:n,onUpdateConfig:s})=>t.type==="submit"?i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Pe,{value:t.name,onChange:o=>n(e,{name:o.target.value}),style:{marginTop:4}})]}),i.jsx(li,{type:"secondary",style:{fontSize:12},children:""})]}):t.type==="end"?i.jsx("div",{children:i.jsx(li,{type:"secondary",children:""})}):i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Pe,{value:t.name,onChange:o=>n(e,{name:o.target.value}),style:{marginTop:4}})]}),i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Xe,{value:t.config.approver_type||"designated",onChange:o=>s(e,{approver_type:o}),style:{width:"100%",marginTop:4},options:Object.entries(_E).map(([o,l])=>({value:o,label:l}))})]}),t.config.approver_type==="designated"&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx("div",{style:{marginTop:4},children:i.jsx(ko,{mode:"multiple",value:t.config.approver_ids||[],onChange:o=>s(e,{approver_ids:o}),placeholder:"",style:{width:"100%"}})})]}),i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(li,{type:"secondary",style:{fontSize:12},children:""}),i.jsx(Xe,{value:t.config.multi_approve||"all",onChange:o=>s(e,{multi_approve:o}),style:{width:"100%",marginTop:4},options:Object.entries(Vk).map(([o,l])=>({value:o,label:l}))})]})]});const Zv="182",Bc={ROTATE:0,DOLLY:1,PAN:2},Pc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},$k=0,Yw=1,Wk=2,Tp=1,Yk=2,Tu=3,Bo=0,ja=1,Ys=2,Vr=0,Uc=1,Kw=2,Xw=3,Qw=4,Kk=5,fl=100,Xk=101,Qk=102,Zk=103,Jk=104,eB=200,tB=201,nB=202,iB=203,b0=204,S0=205,aB=206,sB=207,rB=208,oB=209,lB=210,cB=211,dB=212,uB=213,fB=214,M0=0,w0=1,C0=2,Xc=3,T0=4,j0=5,E0=6,A0=7,Jv=0,hB=1,pB=2,Zs=0,bE=1,SE=2,ME=3,wE=4,CE=5,TE=6,jE=7,EE=300,Rl=301,Qc=302,R0=303,D0=304,sm=306,I0=1e3,zr=1001,O0=1002,Ki=1003,mB=1004,Nh=1005,sa=1006,Qx=1007,vl=1008,Va=1009,AE=1010,RE=1011,Uu=1012,e_=1013,nr=1014,Ks=1015,Kr=1016,t_=1017,n_=1018,Hu=1020,DE=35902,IE=35899,OE=1021,PE=1022,Ds=1023,Xr=1026,_l=1027,LE=1028,i_=1029,Zc=1030,a_=1031,s_=1033,jp=33776,Ep=33777,Ap=33778,Rp=33779,P0=35840,L0=35841,N0=35842,F0=35843,z0=36196,k0=37492,B0=37496,U0=37488,H0=37489,V0=37490,q0=37491,G0=37808,$0=37809,W0=37810,Y0=37811,K0=37812,X0=37813,Q0=37814,Z0=37815,J0=37816,ev=37817,tv=37818,nv=37819,iv=37820,av=37821,sv=36492,rv=36494,ov=36495,lv=36283,cv=36284,dv=36285,uv=36286,gB=3200,NE=0,xB=1,Io="",Ha="srgb",Jc="srgb-linear",$p="linear",On="srgb",mc=7680,Zw=519,yB=512,vB=513,_B=514,r_=515,bB=516,SB=517,o_=518,MB=519,Jw=35044,eC="300 es",Xs=2e3,Wp=2001;function FE(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Yp(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function wB(){const t=Yp("canvas");return t.style.display="block",t}const tC={};function nC(...t){const e="THREE."+t.shift();console.log(e,...t)}function $t(...t){const e="THREE."+t.shift();console.warn(e,...t)}function Sn(...t){const e="THREE."+t.shift();console.error(e,...t)}function Vu(...t){const e=t.join(" ");e in tC||(tC[e]=!0,$t(...t))}function CB(t,e,n){return new Promise(function(s,o){function l(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:o();break;case t.TIMEOUT_EXPIRED:setTimeout(l,n);break;default:s()}}setTimeout(l,n)})}class Pl{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const s=this._listeners;s[e]===void 0&&(s[e]=[]),s[e].indexOf(n)===-1&&s[e].push(n)}hasEventListener(e,n){const s=this._listeners;return s===void 0?!1:s[e]!==void 0&&s[e].indexOf(n)!==-1}removeEventListener(e,n){const s=this._listeners;if(s===void 0)return;const o=s[e];if(o!==void 0){const l=o.indexOf(n);l!==-1&&o.splice(l,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const s=n[e.type];if(s!==void 0){e.target=this;const o=s.slice(0);for(let l=0,d=o.length;l<d;l++)o[l].call(this,e);e.target=null}}}const Ji=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Dp=Math.PI/180,fv=180/Math.PI;function lf(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return(Ji[t&255]+Ji[t>>8&255]+Ji[t>>16&255]+Ji[t>>24&255]+"-"+Ji[e&255]+Ji[e>>8&255]+"-"+Ji[e>>16&15|64]+Ji[e>>24&255]+"-"+Ji[n&63|128]+Ji[n>>8&255]+"-"+Ji[n>>16&255]+Ji[n>>24&255]+Ji[s&255]+Ji[s>>8&255]+Ji[s>>16&255]+Ji[s>>24&255]).toLowerCase()}function cn(t,e,n){return Math.max(e,Math.min(n,t))}function TB(t,e){return(t%e+e)%e}function Zx(t,e,n){return(1-n)*t+n*e}function fu(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Sa(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const jB={DEG2RAD:Dp};class Xt{constructor(e=0,n=0){Xt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,s=this.y,o=e.elements;return this.x=o[0]*n+o[3]*s+o[6],this.y=o[1]*n+o[4]*s+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=cn(this.x,e.x,n.x),this.y=cn(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=cn(this.x,e,n),this.y=cn(this.y,e,n),this}clampLength(e,n){const s=this.length();return this.divideScalar(s||1).multiplyScalar(cn(s,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const s=this.dot(e)/n;return Math.acos(cn(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,s=this.y-e.y;return n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,s){return this.x=e.x+(n.x-e.x)*s,this.y=e.y+(n.y-e.y)*s,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const s=Math.cos(n),o=Math.sin(n),l=this.x-e.x,d=this.y-e.y;return this.x=l*s-d*o+e.x,this.y=l*o+d*s+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Dl{constructor(e=0,n=0,s=0,o=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=s,this._w=o}static slerpFlat(e,n,s,o,l,d,u){let h=s[o+0],p=s[o+1],m=s[o+2],g=s[o+3],v=l[d+0],C=l[d+1],b=l[d+2],_=l[d+3];if(u<=0){e[n+0]=h,e[n+1]=p,e[n+2]=m,e[n+3]=g;return}if(u>=1){e[n+0]=v,e[n+1]=C,e[n+2]=b,e[n+3]=_;return}if(g!==_||h!==v||p!==C||m!==b){let y=h*v+p*C+m*b+g*_;y<0&&(v=-v,C=-C,b=-b,_=-_,y=-y);let S=1-u;if(y<.9995){const D=Math.acos(y),L=Math.sin(D);S=Math.sin(S*D)/L,u=Math.sin(u*D)/L,h=h*S+v*u,p=p*S+C*u,m=m*S+b*u,g=g*S+_*u}else{h=h*S+v*u,p=p*S+C*u,m=m*S+b*u,g=g*S+_*u;const D=1/Math.sqrt(h*h+p*p+m*m+g*g);h*=D,p*=D,m*=D,g*=D}}e[n]=h,e[n+1]=p,e[n+2]=m,e[n+3]=g}static multiplyQuaternionsFlat(e,n,s,o,l,d){const u=s[o],h=s[o+1],p=s[o+2],m=s[o+3],g=l[d],v=l[d+1],C=l[d+2],b=l[d+3];return e[n]=u*b+m*g+h*C-p*v,e[n+1]=h*b+m*v+p*g-u*C,e[n+2]=p*b+m*C+u*v-h*g,e[n+3]=m*b-u*g-h*v-p*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,s,o){return this._x=e,this._y=n,this._z=s,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const s=e._x,o=e._y,l=e._z,d=e._order,u=Math.cos,h=Math.sin,p=u(s/2),m=u(o/2),g=u(l/2),v=h(s/2),C=h(o/2),b=h(l/2);switch(d){case"XYZ":this._x=v*m*g+p*C*b,this._y=p*C*g-v*m*b,this._z=p*m*b+v*C*g,this._w=p*m*g-v*C*b;break;case"YXZ":this._x=v*m*g+p*C*b,this._y=p*C*g-v*m*b,this._z=p*m*b-v*C*g,this._w=p*m*g+v*C*b;break;case"ZXY":this._x=v*m*g-p*C*b,this._y=p*C*g+v*m*b,this._z=p*m*b+v*C*g,this._w=p*m*g-v*C*b;break;case"ZYX":this._x=v*m*g-p*C*b,this._y=p*C*g+v*m*b,this._z=p*m*b-v*C*g,this._w=p*m*g+v*C*b;break;case"YZX":this._x=v*m*g+p*C*b,this._y=p*C*g+v*m*b,this._z=p*m*b-v*C*g,this._w=p*m*g-v*C*b;break;case"XZY":this._x=v*m*g-p*C*b,this._y=p*C*g-v*m*b,this._z=p*m*b+v*C*g,this._w=p*m*g+v*C*b;break;default:$t("Quaternion: .setFromEuler() encountered an unknown order: "+d)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const s=n/2,o=Math.sin(s);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,s=n[0],o=n[4],l=n[8],d=n[1],u=n[5],h=n[9],p=n[2],m=n[6],g=n[10],v=s+u+g;if(v>0){const C=.5/Math.sqrt(v+1);this._w=.25/C,this._x=(m-h)*C,this._y=(l-p)*C,this._z=(d-o)*C}else if(s>u&&s>g){const C=2*Math.sqrt(1+s-u-g);this._w=(m-h)/C,this._x=.25*C,this._y=(o+d)/C,this._z=(l+p)/C}else if(u>g){const C=2*Math.sqrt(1+u-s-g);this._w=(l-p)/C,this._x=(o+d)/C,this._y=.25*C,this._z=(h+m)/C}else{const C=2*Math.sqrt(1+g-s-u);this._w=(d-o)/C,this._x=(l+p)/C,this._y=(h+m)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let s=e.dot(n)+1;return s<1e-8?(s=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=s):(this._x=0,this._y=-e.z,this._z=e.y,this._w=s)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=s),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(cn(this.dot(e),-1,1)))}rotateTowards(e,n){const s=this.angleTo(e);if(s===0)return this;const o=Math.min(1,n/s);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const s=e._x,o=e._y,l=e._z,d=e._w,u=n._x,h=n._y,p=n._z,m=n._w;return this._x=s*m+d*u+o*p-l*h,this._y=o*m+d*h+l*u-s*p,this._z=l*m+d*p+s*h-o*u,this._w=d*m-s*u-o*h-l*p,this._onChangeCallback(),this}slerp(e,n){if(n<=0)return this;if(n>=1)return this.copy(e);let s=e._x,o=e._y,l=e._z,d=e._w,u=this.dot(e);u<0&&(s=-s,o=-o,l=-l,d=-d,u=-u);let h=1-n;if(u<.9995){const p=Math.acos(u),m=Math.sin(p);h=Math.sin(h*p)/m,n=Math.sin(n*p)/m,this._x=this._x*h+s*n,this._y=this._y*h+o*n,this._z=this._z*h+l*n,this._w=this._w*h+d*n,this._onChangeCallback()}else this._x=this._x*h+s*n,this._y=this._y*h+o*n,this._z=this._z*h+l*n,this._w=this._w*h+d*n,this.normalize();return this}slerpQuaternions(e,n,s){return this.copy(e).slerp(n,s)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),s=Math.random(),o=Math.sqrt(1-s),l=Math.sqrt(s);return this.set(o*Math.sin(e),o*Math.cos(e),l*Math.sin(n),l*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Re{constructor(e=0,n=0,s=0){Re.prototype.isVector3=!0,this.x=e,this.y=n,this.z=s}set(e,n,s){return s===void 0&&(s=this.z),this.x=e,this.y=n,this.z=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(iC.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(iC.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,s=this.y,o=this.z,l=e.elements;return this.x=l[0]*n+l[3]*s+l[6]*o,this.y=l[1]*n+l[4]*s+l[7]*o,this.z=l[2]*n+l[5]*s+l[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,s=this.y,o=this.z,l=e.elements,d=1/(l[3]*n+l[7]*s+l[11]*o+l[15]);return this.x=(l[0]*n+l[4]*s+l[8]*o+l[12])*d,this.y=(l[1]*n+l[5]*s+l[9]*o+l[13])*d,this.z=(l[2]*n+l[6]*s+l[10]*o+l[14])*d,this}applyQuaternion(e){const n=this.x,s=this.y,o=this.z,l=e.x,d=e.y,u=e.z,h=e.w,p=2*(d*o-u*s),m=2*(u*n-l*o),g=2*(l*s-d*n);return this.x=n+h*p+d*g-u*m,this.y=s+h*m+u*p-l*g,this.z=o+h*g+l*m-d*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,s=this.y,o=this.z,l=e.elements;return this.x=l[0]*n+l[4]*s+l[8]*o,this.y=l[1]*n+l[5]*s+l[9]*o,this.z=l[2]*n+l[6]*s+l[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=cn(this.x,e.x,n.x),this.y=cn(this.y,e.y,n.y),this.z=cn(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=cn(this.x,e,n),this.y=cn(this.y,e,n),this.z=cn(this.z,e,n),this}clampLength(e,n){const s=this.length();return this.divideScalar(s||1).multiplyScalar(cn(s,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,s){return this.x=e.x+(n.x-e.x)*s,this.y=e.y+(n.y-e.y)*s,this.z=e.z+(n.z-e.z)*s,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const s=e.x,o=e.y,l=e.z,d=n.x,u=n.y,h=n.z;return this.x=o*h-l*u,this.y=l*d-s*h,this.z=s*u-o*d,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const s=e.dot(this)/n;return this.copy(e).multiplyScalar(s)}projectOnPlane(e){return Jx.copy(this).projectOnVector(e),this.sub(Jx)}reflect(e){return this.sub(Jx.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const s=this.dot(e)/n;return Math.acos(cn(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,s=this.y-e.y,o=this.z-e.z;return n*n+s*s+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,s){const o=Math.sin(n)*e;return this.x=o*Math.sin(s),this.y=Math.cos(n)*e,this.z=o*Math.cos(s),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,s){return this.x=e*Math.sin(n),this.y=s,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),s=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=s,this.z=o,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,s=Math.sqrt(1-n*n);return this.x=s*Math.cos(e),this.y=n,this.z=s*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Jx=new Re,iC=new Dl;class Jt{constructor(e,n,s,o,l,d,u,h,p){Jt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,s,o,l,d,u,h,p)}set(e,n,s,o,l,d,u,h,p){const m=this.elements;return m[0]=e,m[1]=o,m[2]=u,m[3]=n,m[4]=l,m[5]=h,m[6]=s,m[7]=d,m[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,s=e.elements;return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],this}extractBasis(e,n,s){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const s=e.elements,o=n.elements,l=this.elements,d=s[0],u=s[3],h=s[6],p=s[1],m=s[4],g=s[7],v=s[2],C=s[5],b=s[8],_=o[0],y=o[3],S=o[6],D=o[1],L=o[4],N=o[7],T=o[2],j=o[5],E=o[8];return l[0]=d*_+u*D+h*T,l[3]=d*y+u*L+h*j,l[6]=d*S+u*N+h*E,l[1]=p*_+m*D+g*T,l[4]=p*y+m*L+g*j,l[7]=p*S+m*N+g*E,l[2]=v*_+C*D+b*T,l[5]=v*y+C*L+b*j,l[8]=v*S+C*N+b*E,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],s=e[1],o=e[2],l=e[3],d=e[4],u=e[5],h=e[6],p=e[7],m=e[8];return n*d*m-n*u*p-s*l*m+s*u*h+o*l*p-o*d*h}invert(){const e=this.elements,n=e[0],s=e[1],o=e[2],l=e[3],d=e[4],u=e[5],h=e[6],p=e[7],m=e[8],g=m*d-u*p,v=u*h-m*l,C=p*l-d*h,b=n*g+s*v+o*C;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/b;return e[0]=g*_,e[1]=(o*p-m*s)*_,e[2]=(u*s-o*d)*_,e[3]=v*_,e[4]=(m*n-o*h)*_,e[5]=(o*l-u*n)*_,e[6]=C*_,e[7]=(s*h-p*n)*_,e[8]=(d*n-s*l)*_,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,s,o,l,d,u){const h=Math.cos(l),p=Math.sin(l);return this.set(s*h,s*p,-s*(h*d+p*u)+d+e,-o*p,o*h,-o*(-p*d+h*u)+u+n,0,0,1),this}scale(e,n){return this.premultiply(ey.makeScale(e,n)),this}rotate(e){return this.premultiply(ey.makeRotation(-e)),this}translate(e,n){return this.premultiply(ey.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),s=Math.sin(e);return this.set(n,-s,0,s,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,s=e.elements;for(let o=0;o<9;o++)if(n[o]!==s[o])return!1;return!0}fromArray(e,n=0){for(let s=0;s<9;s++)this.elements[s]=e[s+n];return this}toArray(e=[],n=0){const s=this.elements;return e[n]=s[0],e[n+1]=s[1],e[n+2]=s[2],e[n+3]=s[3],e[n+4]=s[4],e[n+5]=s[5],e[n+6]=s[6],e[n+7]=s[7],e[n+8]=s[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const ey=new Jt,aC=new Jt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),sC=new Jt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function EB(){const t={enabled:!0,workingColorSpace:Jc,spaces:{},convert:function(o,l,d){return this.enabled===!1||l===d||!l||!d||(this.spaces[l].transfer===On&&(o.r=qr(o.r),o.g=qr(o.g),o.b=qr(o.b)),this.spaces[l].primaries!==this.spaces[d].primaries&&(o.applyMatrix3(this.spaces[l].toXYZ),o.applyMatrix3(this.spaces[d].fromXYZ)),this.spaces[d].transfer===On&&(o.r=Hc(o.r),o.g=Hc(o.g),o.b=Hc(o.b))),o},workingToColorSpace:function(o,l){return this.convert(o,this.workingColorSpace,l)},colorSpaceToWorking:function(o,l){return this.convert(o,l,this.workingColorSpace)},getPrimaries:function(o){return this.spaces[o].primaries},getTransfer:function(o){return o===Io?$p:this.spaces[o].transfer},getToneMappingMode:function(o){return this.spaces[o].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(o,l=this.workingColorSpace){return o.fromArray(this.spaces[l].luminanceCoefficients)},define:function(o){Object.assign(this.spaces,o)},_getMatrix:function(o,l,d){return o.copy(this.spaces[l].toXYZ).multiply(this.spaces[d].fromXYZ)},_getDrawingBufferColorSpace:function(o){return this.spaces[o].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(o=this.workingColorSpace){return this.spaces[o].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(o,l){return Vu("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),t.workingToColorSpace(o,l)},toWorkingColorSpace:function(o,l){return Vu("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),t.colorSpaceToWorking(o,l)}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],s=[.3127,.329];return t.define({[Jc]:{primaries:e,whitePoint:s,transfer:$p,toXYZ:aC,fromXYZ:sC,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Ha},outputColorSpaceConfig:{drawingBufferColorSpace:Ha}},[Ha]:{primaries:e,whitePoint:s,transfer:On,toXYZ:aC,fromXYZ:sC,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Ha}}}),t}const yn=EB();function qr(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Hc(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let gc;class AB{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let s;if(e instanceof HTMLCanvasElement)s=e;else{gc===void 0&&(gc=Yp("canvas")),gc.width=e.width,gc.height=e.height;const o=gc.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),s=gc}return s.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Yp("canvas");n.width=e.width,n.height=e.height;const s=n.getContext("2d");s.drawImage(e,0,0,e.width,e.height);const o=s.getImageData(0,0,e.width,e.height),l=o.data;for(let d=0;d<l.length;d++)l[d]=qr(l[d]/255)*255;return s.putImageData(o,0,0),n}else if(e.data){const n=e.data.slice(0);for(let s=0;s<n.length;s++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[s]=Math.floor(qr(n[s]/255)*255):n[s]=qr(n[s]);return{data:n,width:e.width,height:e.height}}else return $t("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let RB=0;class l_{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:RB++}),this.uuid=lf(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const n=this.data;return typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?e.set(n.videoWidth,n.videoHeight,0):typeof VideoFrame<"u"&&n instanceof VideoFrame?e.set(n.displayHeight,n.displayWidth,0):n!==null?e.set(n.width,n.height,n.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const s={uuid:this.uuid,url:""},o=this.data;if(o!==null){let l;if(Array.isArray(o)){l=[];for(let d=0,u=o.length;d<u;d++)o[d].isDataTexture?l.push(ty(o[d].image)):l.push(ty(o[d]))}else l=ty(o);s.url=l}return n||(e.images[this.uuid]=s),s}}function ty(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?AB.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:($t("Texture: Unable to serialize Texture."),{})}let DB=0;const ny=new Re;class ma extends Pl{constructor(e=ma.DEFAULT_IMAGE,n=ma.DEFAULT_MAPPING,s=zr,o=zr,l=sa,d=vl,u=Ds,h=Va,p=ma.DEFAULT_ANISOTROPY,m=Io){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:DB++}),this.uuid=lf(),this.name="",this.source=new l_(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=s,this.wrapT=o,this.magFilter=l,this.minFilter=d,this.anisotropy=p,this.format=u,this.internalFormat=null,this.type=h,this.offset=new Xt(0,0),this.repeat=new Xt(1,1),this.center=new Xt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(ny).x}get height(){return this.source.getSize(ny).y}get depth(){return this.source.getSize(ny).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const n in e){const s=e[n];if(s===void 0){$t(`Texture.setValues(): parameter '${n}' has value of undefined.`);continue}const o=this[n];if(o===void 0){$t(`Texture.setValues(): property '${n}' does not exist.`);continue}o&&s&&o.isVector2&&s.isVector2||o&&s&&o.isVector3&&s.isVector3||o&&s&&o.isMatrix3&&s.isMatrix3?o.copy(s):this[n]=s}}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const s={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),n||(e.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==EE)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case I0:e.x=e.x-Math.floor(e.x);break;case zr:e.x=e.x<0?0:1;break;case O0:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case I0:e.y=e.y-Math.floor(e.y);break;case zr:e.y=e.y<0?0:1;break;case O0:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ma.DEFAULT_IMAGE=null;ma.DEFAULT_MAPPING=EE;ma.DEFAULT_ANISOTROPY=1;class ii{constructor(e=0,n=0,s=0,o=1){ii.prototype.isVector4=!0,this.x=e,this.y=n,this.z=s,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,s,o){return this.x=e,this.y=n,this.z=s,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,s=this.y,o=this.z,l=this.w,d=e.elements;return this.x=d[0]*n+d[4]*s+d[8]*o+d[12]*l,this.y=d[1]*n+d[5]*s+d[9]*o+d[13]*l,this.z=d[2]*n+d[6]*s+d[10]*o+d[14]*l,this.w=d[3]*n+d[7]*s+d[11]*o+d[15]*l,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,s,o,l;const h=e.elements,p=h[0],m=h[4],g=h[8],v=h[1],C=h[5],b=h[9],_=h[2],y=h[6],S=h[10];if(Math.abs(m-v)<.01&&Math.abs(g-_)<.01&&Math.abs(b-y)<.01){if(Math.abs(m+v)<.1&&Math.abs(g+_)<.1&&Math.abs(b+y)<.1&&Math.abs(p+C+S-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const L=(p+1)/2,N=(C+1)/2,T=(S+1)/2,j=(m+v)/4,E=(g+_)/4,R=(b+y)/4;return L>N&&L>T?L<.01?(s=0,o=.707106781,l=.707106781):(s=Math.sqrt(L),o=j/s,l=E/s):N>T?N<.01?(s=.707106781,o=0,l=.707106781):(o=Math.sqrt(N),s=j/o,l=R/o):T<.01?(s=.707106781,o=.707106781,l=0):(l=Math.sqrt(T),s=E/l,o=R/l),this.set(s,o,l,n),this}let D=Math.sqrt((y-b)*(y-b)+(g-_)*(g-_)+(v-m)*(v-m));return Math.abs(D)<.001&&(D=1),this.x=(y-b)/D,this.y=(g-_)/D,this.z=(v-m)/D,this.w=Math.acos((p+C+S-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=cn(this.x,e.x,n.x),this.y=cn(this.y,e.y,n.y),this.z=cn(this.z,e.z,n.z),this.w=cn(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=cn(this.x,e,n),this.y=cn(this.y,e,n),this.z=cn(this.z,e,n),this.w=cn(this.w,e,n),this}clampLength(e,n){const s=this.length();return this.divideScalar(s||1).multiplyScalar(cn(s,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,s){return this.x=e.x+(n.x-e.x)*s,this.y=e.y+(n.y-e.y)*s,this.z=e.z+(n.z-e.z)*s,this.w=e.w+(n.w-e.w)*s,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class IB extends Pl{constructor(e=1,n=1,s={}){super(),s=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:sa,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},s),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=s.depth,this.scissor=new ii(0,0,e,n),this.scissorTest=!1,this.viewport=new ii(0,0,e,n);const o={width:e,height:n,depth:s.depth},l=new ma(o);this.textures=[];const d=s.count;for(let u=0;u<d;u++)this.textures[u]=l.clone(),this.textures[u].isRenderTargetTexture=!0,this.textures[u].renderTarget=this;this._setTextureOptions(s),this.depthBuffer=s.depthBuffer,this.stencilBuffer=s.stencilBuffer,this.resolveDepthBuffer=s.resolveDepthBuffer,this.resolveStencilBuffer=s.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=s.depthTexture,this.samples=s.samples,this.multiview=s.multiview}_setTextureOptions(e={}){const n={minFilter:sa,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(n.mapping=e.mapping),e.wrapS!==void 0&&(n.wrapS=e.wrapS),e.wrapT!==void 0&&(n.wrapT=e.wrapT),e.wrapR!==void 0&&(n.wrapR=e.wrapR),e.magFilter!==void 0&&(n.magFilter=e.magFilter),e.minFilter!==void 0&&(n.minFilter=e.minFilter),e.format!==void 0&&(n.format=e.format),e.type!==void 0&&(n.type=e.type),e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(n.colorSpace=e.colorSpace),e.flipY!==void 0&&(n.flipY=e.flipY),e.generateMipmaps!==void 0&&(n.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(n.internalFormat=e.internalFormat);for(let s=0;s<this.textures.length;s++)this.textures[s].setValues(n)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,s=1){if(this.width!==e||this.height!==n||this.depth!==s){this.width=e,this.height=n,this.depth=s;for(let o=0,l=this.textures.length;o<l;o++)this.textures[o].image.width=e,this.textures[o].image.height=n,this.textures[o].image.depth=s,this.textures[o].isData3DTexture!==!0&&(this.textures[o].isArrayTexture=this.textures[o].image.depth>1);this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,s=e.textures.length;n<s;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const o=Object.assign({},e.textures[n].image);this.textures[n].source=new l_(o)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Js extends IB{constructor(e=1,n=1,s={}){super(e,n,s),this.isWebGLRenderTarget=!0}}class zE extends ma{constructor(e=null,n=1,s=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:s,depth:o},this.magFilter=Ki,this.minFilter=Ki,this.wrapR=zr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class OB extends ma{constructor(e=null,n=1,s=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:s,depth:o},this.magFilter=Ki,this.minFilter=Ki,this.wrapR=zr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class cf{constructor(e=new Re(1/0,1/0,1/0),n=new Re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,s=e.length;n<s;n+=3)this.expandByPoint(Ms.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,s=e.count;n<s;n++)this.expandByPoint(Ms.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,s=e.length;n<s;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const s=Ms.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const s=e.geometry;if(s!==void 0){const l=s.getAttribute("position");if(n===!0&&l!==void 0&&e.isInstancedMesh!==!0)for(let d=0,u=l.count;d<u;d++)e.isMesh===!0?e.getVertexPosition(d,Ms):Ms.fromBufferAttribute(l,d),Ms.applyMatrix4(e.matrixWorld),this.expandByPoint(Ms);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Fh.copy(e.boundingBox)):(s.boundingBox===null&&s.computeBoundingBox(),Fh.copy(s.boundingBox)),Fh.applyMatrix4(e.matrixWorld),this.union(Fh)}const o=e.children;for(let l=0,d=o.length;l<d;l++)this.expandByObject(o[l],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ms),Ms.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,s;return e.normal.x>0?(n=e.normal.x*this.min.x,s=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,s=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,s+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,s+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,s+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,s+=e.normal.z*this.min.z),n<=-e.constant&&s>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(hu),zh.subVectors(this.max,hu),xc.subVectors(e.a,hu),yc.subVectors(e.b,hu),vc.subVectors(e.c,hu),Mo.subVectors(yc,xc),wo.subVectors(vc,yc),al.subVectors(xc,vc);let n=[0,-Mo.z,Mo.y,0,-wo.z,wo.y,0,-al.z,al.y,Mo.z,0,-Mo.x,wo.z,0,-wo.x,al.z,0,-al.x,-Mo.y,Mo.x,0,-wo.y,wo.x,0,-al.y,al.x,0];return!iy(n,xc,yc,vc,zh)||(n=[1,0,0,0,1,0,0,0,1],!iy(n,xc,yc,vc,zh))?!1:(kh.crossVectors(Mo,wo),n=[kh.x,kh.y,kh.z],iy(n,xc,yc,vc,zh))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ms).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ms).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Er[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Er[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Er[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Er[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Er[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Er[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Er[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Er[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Er),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Er=[new Re,new Re,new Re,new Re,new Re,new Re,new Re,new Re],Ms=new Re,Fh=new cf,xc=new Re,yc=new Re,vc=new Re,Mo=new Re,wo=new Re,al=new Re,hu=new Re,zh=new Re,kh=new Re,sl=new Re;function iy(t,e,n,s,o){for(let l=0,d=t.length-3;l<=d;l+=3){sl.fromArray(t,l);const u=o.x*Math.abs(sl.x)+o.y*Math.abs(sl.y)+o.z*Math.abs(sl.z),h=e.dot(sl),p=n.dot(sl),m=s.dot(sl);if(Math.max(-Math.max(h,p,m),Math.min(h,p,m))>u)return!1}return!0}const PB=new cf,pu=new Re,ay=new Re;class c_{constructor(e=new Re,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const s=this.center;n!==void 0?s.copy(n):PB.setFromPoints(e).getCenter(s);let o=0;for(let l=0,d=e.length;l<d;l++)o=Math.max(o,s.distanceToSquared(e[l]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const s=this.center.distanceToSquared(e);return n.copy(e),s>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;pu.subVectors(e,this.center);const n=pu.lengthSq();if(n>this.radius*this.radius){const s=Math.sqrt(n),o=(s-this.radius)*.5;this.center.addScaledVector(pu,o/s),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ay.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(pu.copy(e.center).add(ay)),this.expandByPoint(pu.copy(e.center).sub(ay))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Ar=new Re,sy=new Re,Bh=new Re,Co=new Re,ry=new Re,Uh=new Re,oy=new Re;class kE{constructor(e=new Re,n=new Re(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ar)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const s=n.dot(this.direction);return s<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Ar.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Ar.copy(this.origin).addScaledVector(this.direction,n),Ar.distanceToSquared(e))}distanceSqToSegment(e,n,s,o){sy.copy(e).add(n).multiplyScalar(.5),Bh.copy(n).sub(e).normalize(),Co.copy(this.origin).sub(sy);const l=e.distanceTo(n)*.5,d=-this.direction.dot(Bh),u=Co.dot(this.direction),h=-Co.dot(Bh),p=Co.lengthSq(),m=Math.abs(1-d*d);let g,v,C,b;if(m>0)if(g=d*h-u,v=d*u-h,b=l*m,g>=0)if(v>=-b)if(v<=b){const _=1/m;g*=_,v*=_,C=g*(g+d*v+2*u)+v*(d*g+v+2*h)+p}else v=l,g=Math.max(0,-(d*v+u)),C=-g*g+v*(v+2*h)+p;else v=-l,g=Math.max(0,-(d*v+u)),C=-g*g+v*(v+2*h)+p;else v<=-b?(g=Math.max(0,-(-d*l+u)),v=g>0?-l:Math.min(Math.max(-l,-h),l),C=-g*g+v*(v+2*h)+p):v<=b?(g=0,v=Math.min(Math.max(-l,-h),l),C=v*(v+2*h)+p):(g=Math.max(0,-(d*l+u)),v=g>0?l:Math.min(Math.max(-l,-h),l),C=-g*g+v*(v+2*h)+p);else v=d>0?-l:l,g=Math.max(0,-(d*v+u)),C=-g*g+v*(v+2*h)+p;return s&&s.copy(this.origin).addScaledVector(this.direction,g),o&&o.copy(sy).addScaledVector(Bh,v),C}intersectSphere(e,n){Ar.subVectors(e.center,this.origin);const s=Ar.dot(this.direction),o=Ar.dot(Ar)-s*s,l=e.radius*e.radius;if(o>l)return null;const d=Math.sqrt(l-o),u=s-d,h=s+d;return h<0?null:u<0?this.at(h,n):this.at(u,n)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const s=-(this.origin.dot(e.normal)+e.constant)/n;return s>=0?s:null}intersectPlane(e,n){const s=this.distanceToPlane(e);return s===null?null:this.at(s,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let s,o,l,d,u,h;const p=1/this.direction.x,m=1/this.direction.y,g=1/this.direction.z,v=this.origin;return p>=0?(s=(e.min.x-v.x)*p,o=(e.max.x-v.x)*p):(s=(e.max.x-v.x)*p,o=(e.min.x-v.x)*p),m>=0?(l=(e.min.y-v.y)*m,d=(e.max.y-v.y)*m):(l=(e.max.y-v.y)*m,d=(e.min.y-v.y)*m),s>d||l>o||((l>s||isNaN(s))&&(s=l),(d<o||isNaN(o))&&(o=d),g>=0?(u=(e.min.z-v.z)*g,h=(e.max.z-v.z)*g):(u=(e.max.z-v.z)*g,h=(e.min.z-v.z)*g),s>h||u>o)||((u>s||s!==s)&&(s=u),(h<o||o!==o)&&(o=h),o<0)?null:this.at(s>=0?s:o,n)}intersectsBox(e){return this.intersectBox(e,Ar)!==null}intersectTriangle(e,n,s,o,l){ry.subVectors(n,e),Uh.subVectors(s,e),oy.crossVectors(ry,Uh);let d=this.direction.dot(oy),u;if(d>0){if(o)return null;u=1}else if(d<0)u=-1,d=-d;else return null;Co.subVectors(this.origin,e);const h=u*this.direction.dot(Uh.crossVectors(Co,Uh));if(h<0)return null;const p=u*this.direction.dot(ry.cross(Co));if(p<0||h+p>d)return null;const m=-u*Co.dot(oy);return m<0?null:this.at(m/d,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ai{constructor(e,n,s,o,l,d,u,h,p,m,g,v,C,b,_,y){ai.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,s,o,l,d,u,h,p,m,g,v,C,b,_,y)}set(e,n,s,o,l,d,u,h,p,m,g,v,C,b,_,y){const S=this.elements;return S[0]=e,S[4]=n,S[8]=s,S[12]=o,S[1]=l,S[5]=d,S[9]=u,S[13]=h,S[2]=p,S[6]=m,S[10]=g,S[14]=v,S[3]=C,S[7]=b,S[11]=_,S[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ai().fromArray(this.elements)}copy(e){const n=this.elements,s=e.elements;return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],this}copyPosition(e){const n=this.elements,s=e.elements;return n[12]=s[12],n[13]=s[13],n[14]=s[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,s){return this.determinant()===0?(e.set(1,0,0),n.set(0,1,0),s.set(0,0,1),this):(e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this)}makeBasis(e,n,s){return this.set(e.x,n.x,s.x,0,e.y,n.y,s.y,0,e.z,n.z,s.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const n=this.elements,s=e.elements,o=1/_c.setFromMatrixColumn(e,0).length(),l=1/_c.setFromMatrixColumn(e,1).length(),d=1/_c.setFromMatrixColumn(e,2).length();return n[0]=s[0]*o,n[1]=s[1]*o,n[2]=s[2]*o,n[3]=0,n[4]=s[4]*l,n[5]=s[5]*l,n[6]=s[6]*l,n[7]=0,n[8]=s[8]*d,n[9]=s[9]*d,n[10]=s[10]*d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,s=e.x,o=e.y,l=e.z,d=Math.cos(s),u=Math.sin(s),h=Math.cos(o),p=Math.sin(o),m=Math.cos(l),g=Math.sin(l);if(e.order==="XYZ"){const v=d*m,C=d*g,b=u*m,_=u*g;n[0]=h*m,n[4]=-h*g,n[8]=p,n[1]=C+b*p,n[5]=v-_*p,n[9]=-u*h,n[2]=_-v*p,n[6]=b+C*p,n[10]=d*h}else if(e.order==="YXZ"){const v=h*m,C=h*g,b=p*m,_=p*g;n[0]=v+_*u,n[4]=b*u-C,n[8]=d*p,n[1]=d*g,n[5]=d*m,n[9]=-u,n[2]=C*u-b,n[6]=_+v*u,n[10]=d*h}else if(e.order==="ZXY"){const v=h*m,C=h*g,b=p*m,_=p*g;n[0]=v-_*u,n[4]=-d*g,n[8]=b+C*u,n[1]=C+b*u,n[5]=d*m,n[9]=_-v*u,n[2]=-d*p,n[6]=u,n[10]=d*h}else if(e.order==="ZYX"){const v=d*m,C=d*g,b=u*m,_=u*g;n[0]=h*m,n[4]=b*p-C,n[8]=v*p+_,n[1]=h*g,n[5]=_*p+v,n[9]=C*p-b,n[2]=-p,n[6]=u*h,n[10]=d*h}else if(e.order==="YZX"){const v=d*h,C=d*p,b=u*h,_=u*p;n[0]=h*m,n[4]=_-v*g,n[8]=b*g+C,n[1]=g,n[5]=d*m,n[9]=-u*m,n[2]=-p*m,n[6]=C*g+b,n[10]=v-_*g}else if(e.order==="XZY"){const v=d*h,C=d*p,b=u*h,_=u*p;n[0]=h*m,n[4]=-g,n[8]=p*m,n[1]=v*g+_,n[5]=d*m,n[9]=C*g-b,n[2]=b*g-C,n[6]=u*m,n[10]=_*g+v}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(LB,e,NB)}lookAt(e,n,s){const o=this.elements;return za.subVectors(e,n),za.lengthSq()===0&&(za.z=1),za.normalize(),To.crossVectors(s,za),To.lengthSq()===0&&(Math.abs(s.z)===1?za.x+=1e-4:za.z+=1e-4,za.normalize(),To.crossVectors(s,za)),To.normalize(),Hh.crossVectors(za,To),o[0]=To.x,o[4]=Hh.x,o[8]=za.x,o[1]=To.y,o[5]=Hh.y,o[9]=za.y,o[2]=To.z,o[6]=Hh.z,o[10]=za.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const s=e.elements,o=n.elements,l=this.elements,d=s[0],u=s[4],h=s[8],p=s[12],m=s[1],g=s[5],v=s[9],C=s[13],b=s[2],_=s[6],y=s[10],S=s[14],D=s[3],L=s[7],N=s[11],T=s[15],j=o[0],E=o[4],R=o[8],M=o[12],I=o[1],z=o[5],V=o[9],O=o[13],k=o[2],F=o[6],A=o[10],q=o[14],B=o[3],W=o[7],Q=o[11],ne=o[15];return l[0]=d*j+u*I+h*k+p*B,l[4]=d*E+u*z+h*F+p*W,l[8]=d*R+u*V+h*A+p*Q,l[12]=d*M+u*O+h*q+p*ne,l[1]=m*j+g*I+v*k+C*B,l[5]=m*E+g*z+v*F+C*W,l[9]=m*R+g*V+v*A+C*Q,l[13]=m*M+g*O+v*q+C*ne,l[2]=b*j+_*I+y*k+S*B,l[6]=b*E+_*z+y*F+S*W,l[10]=b*R+_*V+y*A+S*Q,l[14]=b*M+_*O+y*q+S*ne,l[3]=D*j+L*I+N*k+T*B,l[7]=D*E+L*z+N*F+T*W,l[11]=D*R+L*V+N*A+T*Q,l[15]=D*M+L*O+N*q+T*ne,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],s=e[4],o=e[8],l=e[12],d=e[1],u=e[5],h=e[9],p=e[13],m=e[2],g=e[6],v=e[10],C=e[14],b=e[3],_=e[7],y=e[11],S=e[15],D=h*C-p*v,L=u*C-p*g,N=u*v-h*g,T=d*C-p*m,j=d*v-h*m,E=d*g-u*m;return n*(_*D-y*L+S*N)-s*(b*D-y*T+S*j)+o*(b*L-_*T+S*E)-l*(b*N-_*j+y*E)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,s){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=n,o[14]=s),this}invert(){const e=this.elements,n=e[0],s=e[1],o=e[2],l=e[3],d=e[4],u=e[5],h=e[6],p=e[7],m=e[8],g=e[9],v=e[10],C=e[11],b=e[12],_=e[13],y=e[14],S=e[15],D=g*y*p-_*v*p+_*h*C-u*y*C-g*h*S+u*v*S,L=b*v*p-m*y*p-b*h*C+d*y*C+m*h*S-d*v*S,N=m*_*p-b*g*p+b*u*C-d*_*C-m*u*S+d*g*S,T=b*g*h-m*_*h-b*u*v+d*_*v+m*u*y-d*g*y,j=n*D+s*L+o*N+l*T;if(j===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/j;return e[0]=D*E,e[1]=(_*v*l-g*y*l-_*o*C+s*y*C+g*o*S-s*v*S)*E,e[2]=(u*y*l-_*h*l+_*o*p-s*y*p-u*o*S+s*h*S)*E,e[3]=(g*h*l-u*v*l-g*o*p+s*v*p+u*o*C-s*h*C)*E,e[4]=L*E,e[5]=(m*y*l-b*v*l+b*o*C-n*y*C-m*o*S+n*v*S)*E,e[6]=(b*h*l-d*y*l-b*o*p+n*y*p+d*o*S-n*h*S)*E,e[7]=(d*v*l-m*h*l+m*o*p-n*v*p-d*o*C+n*h*C)*E,e[8]=N*E,e[9]=(b*g*l-m*_*l-b*s*C+n*_*C+m*s*S-n*g*S)*E,e[10]=(d*_*l-b*u*l+b*s*p-n*_*p-d*s*S+n*u*S)*E,e[11]=(m*u*l-d*g*l-m*s*p+n*g*p+d*s*C-n*u*C)*E,e[12]=T*E,e[13]=(m*_*o-b*g*o+b*s*v-n*_*v-m*s*y+n*g*y)*E,e[14]=(b*u*o-d*_*o-b*s*h+n*_*h+d*s*y-n*u*y)*E,e[15]=(d*g*o-m*u*o+m*s*h-n*g*h-d*s*v+n*u*v)*E,this}scale(e){const n=this.elements,s=e.x,o=e.y,l=e.z;return n[0]*=s,n[4]*=o,n[8]*=l,n[1]*=s,n[5]*=o,n[9]*=l,n[2]*=s,n[6]*=o,n[10]*=l,n[3]*=s,n[7]*=o,n[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],s=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,s,o))}makeTranslation(e,n,s){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,s,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,n,-s,0,0,s,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),s=Math.sin(e);return this.set(n,0,s,0,0,1,0,0,-s,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),s=Math.sin(e);return this.set(n,-s,0,0,s,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const s=Math.cos(n),o=Math.sin(n),l=1-s,d=e.x,u=e.y,h=e.z,p=l*d,m=l*u;return this.set(p*d+s,p*u-o*h,p*h+o*u,0,p*u+o*h,m*u+s,m*h-o*d,0,p*h-o*u,m*h+o*d,l*h*h+s,0,0,0,0,1),this}makeScale(e,n,s){return this.set(e,0,0,0,0,n,0,0,0,0,s,0,0,0,0,1),this}makeShear(e,n,s,o,l,d){return this.set(1,s,l,0,e,1,d,0,n,o,1,0,0,0,0,1),this}compose(e,n,s){const o=this.elements,l=n._x,d=n._y,u=n._z,h=n._w,p=l+l,m=d+d,g=u+u,v=l*p,C=l*m,b=l*g,_=d*m,y=d*g,S=u*g,D=h*p,L=h*m,N=h*g,T=s.x,j=s.y,E=s.z;return o[0]=(1-(_+S))*T,o[1]=(C+N)*T,o[2]=(b-L)*T,o[3]=0,o[4]=(C-N)*j,o[5]=(1-(v+S))*j,o[6]=(y+D)*j,o[7]=0,o[8]=(b+L)*E,o[9]=(y-D)*E,o[10]=(1-(v+_))*E,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,n,s){const o=this.elements;if(e.x=o[12],e.y=o[13],e.z=o[14],this.determinant()===0)return s.set(1,1,1),n.identity(),this;let l=_c.set(o[0],o[1],o[2]).length();const d=_c.set(o[4],o[5],o[6]).length(),u=_c.set(o[8],o[9],o[10]).length();this.determinant()<0&&(l=-l),ws.copy(this);const p=1/l,m=1/d,g=1/u;return ws.elements[0]*=p,ws.elements[1]*=p,ws.elements[2]*=p,ws.elements[4]*=m,ws.elements[5]*=m,ws.elements[6]*=m,ws.elements[8]*=g,ws.elements[9]*=g,ws.elements[10]*=g,n.setFromRotationMatrix(ws),s.x=l,s.y=d,s.z=u,this}makePerspective(e,n,s,o,l,d,u=Xs,h=!1){const p=this.elements,m=2*l/(n-e),g=2*l/(s-o),v=(n+e)/(n-e),C=(s+o)/(s-o);let b,_;if(h)b=l/(d-l),_=d*l/(d-l);else if(u===Xs)b=-(d+l)/(d-l),_=-2*d*l/(d-l);else if(u===Wp)b=-d/(d-l),_=-d*l/(d-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return p[0]=m,p[4]=0,p[8]=v,p[12]=0,p[1]=0,p[5]=g,p[9]=C,p[13]=0,p[2]=0,p[6]=0,p[10]=b,p[14]=_,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,n,s,o,l,d,u=Xs,h=!1){const p=this.elements,m=2/(n-e),g=2/(s-o),v=-(n+e)/(n-e),C=-(s+o)/(s-o);let b,_;if(h)b=1/(d-l),_=d/(d-l);else if(u===Xs)b=-2/(d-l),_=-(d+l)/(d-l);else if(u===Wp)b=-1/(d-l),_=-l/(d-l);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return p[0]=m,p[4]=0,p[8]=0,p[12]=v,p[1]=0,p[5]=g,p[9]=0,p[13]=C,p[2]=0,p[6]=0,p[10]=b,p[14]=_,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const n=this.elements,s=e.elements;for(let o=0;o<16;o++)if(n[o]!==s[o])return!1;return!0}fromArray(e,n=0){for(let s=0;s<16;s++)this.elements[s]=e[s+n];return this}toArray(e=[],n=0){const s=this.elements;return e[n]=s[0],e[n+1]=s[1],e[n+2]=s[2],e[n+3]=s[3],e[n+4]=s[4],e[n+5]=s[5],e[n+6]=s[6],e[n+7]=s[7],e[n+8]=s[8],e[n+9]=s[9],e[n+10]=s[10],e[n+11]=s[11],e[n+12]=s[12],e[n+13]=s[13],e[n+14]=s[14],e[n+15]=s[15],e}}const _c=new Re,ws=new ai,LB=new Re(0,0,0),NB=new Re(1,1,1),To=new Re,Hh=new Re,za=new Re,rC=new ai,oC=new Dl;class ir{constructor(e=0,n=0,s=0,o=ir.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=s,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,s,o=this._order){return this._x=e,this._y=n,this._z=s,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,s=!0){const o=e.elements,l=o[0],d=o[4],u=o[8],h=o[1],p=o[5],m=o[9],g=o[2],v=o[6],C=o[10];switch(n){case"XYZ":this._y=Math.asin(cn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-m,C),this._z=Math.atan2(-d,l)):(this._x=Math.atan2(v,p),this._z=0);break;case"YXZ":this._x=Math.asin(-cn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(u,C),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-g,l),this._z=0);break;case"ZXY":this._x=Math.asin(cn(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-g,C),this._z=Math.atan2(-d,p)):(this._y=0,this._z=Math.atan2(h,l));break;case"ZYX":this._y=Math.asin(-cn(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(v,C),this._z=Math.atan2(h,l)):(this._x=0,this._z=Math.atan2(-d,p));break;case"YZX":this._z=Math.asin(cn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-m,p),this._y=Math.atan2(-g,l)):(this._x=0,this._y=Math.atan2(u,C));break;case"XZY":this._z=Math.asin(-cn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(v,p),this._y=Math.atan2(u,l)):(this._x=Math.atan2(-m,C),this._y=0);break;default:$t("Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,s===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,s){return rC.makeRotationFromQuaternion(e),this.setFromRotationMatrix(rC,n,s)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return oC.setFromEuler(this),this.setFromQuaternion(oC,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ir.DEFAULT_ORDER="XYZ";class BE{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let FB=0;const lC=new Re,bc=new Dl,Rr=new ai,Vh=new Re,mu=new Re,zB=new Re,kB=new Dl,cC=new Re(1,0,0),dC=new Re(0,1,0),uC=new Re(0,0,1),fC={type:"added"},BB={type:"removed"},Sc={type:"childadded",child:null},ly={type:"childremoved",child:null};class oa extends Pl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:FB++}),this.uuid=lf(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=oa.DEFAULT_UP.clone();const e=new Re,n=new ir,s=new Dl,o=new Re(1,1,1);function l(){s.setFromEuler(n,!1)}function d(){n.setFromQuaternion(s,void 0,!1)}n._onChange(l),s._onChange(d),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new ai},normalMatrix:{value:new Jt}}),this.matrix=new ai,this.matrixWorld=new ai,this.matrixAutoUpdate=oa.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=oa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new BE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return bc.setFromAxisAngle(e,n),this.quaternion.multiply(bc),this}rotateOnWorldAxis(e,n){return bc.setFromAxisAngle(e,n),this.quaternion.premultiply(bc),this}rotateX(e){return this.rotateOnAxis(cC,e)}rotateY(e){return this.rotateOnAxis(dC,e)}rotateZ(e){return this.rotateOnAxis(uC,e)}translateOnAxis(e,n){return lC.copy(e).applyQuaternion(this.quaternion),this.position.add(lC.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(cC,e)}translateY(e){return this.translateOnAxis(dC,e)}translateZ(e){return this.translateOnAxis(uC,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Rr.copy(this.matrixWorld).invert())}lookAt(e,n,s){e.isVector3?Vh.copy(e):Vh.set(e,n,s);const o=this.parent;this.updateWorldMatrix(!0,!1),mu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Rr.lookAt(mu,Vh,this.up):Rr.lookAt(Vh,mu,this.up),this.quaternion.setFromRotationMatrix(Rr),o&&(Rr.extractRotation(o.matrixWorld),bc.setFromRotationMatrix(Rr),this.quaternion.premultiply(bc.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(Sn("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(fC),Sc.child=e,this.dispatchEvent(Sc),Sc.child=null):Sn("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(BB),ly.child=e,this.dispatchEvent(ly),ly.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Rr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Rr.multiply(e.parent.matrixWorld)),e.applyMatrix4(Rr),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(fC),Sc.child=e,this.dispatchEvent(Sc),Sc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let s=0,o=this.children.length;s<o;s++){const d=this.children[s].getObjectByProperty(e,n);if(d!==void 0)return d}}getObjectsByProperty(e,n,s=[]){this[e]===n&&s.push(this);const o=this.children;for(let l=0,d=o.length;l<d;l++)o[l].getObjectsByProperty(e,n,s);return s}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mu,e,zB),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mu,kB,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let s=0,o=n.length;s<o;s++)n[s].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let s=0,o=n.length;s<o;s++)n[s].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let s=0,o=n.length;s<o;s++)n[s].updateMatrixWorld(e)}updateWorldMatrix(e,n){const s=this.parent;if(e===!0&&s!==null&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const o=this.children;for(let l=0,d=o.length;l<d;l++)o[l].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",s={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.geometryInfo=this._geometryInfo.map(u=>({...u,boundingBox:u.boundingBox?u.boundingBox.toJSON():void 0,boundingSphere:u.boundingSphere?u.boundingSphere.toJSON():void 0})),o.instanceInfo=this._instanceInfo.map(u=>({...u})),o.availableInstanceIds=this._availableInstanceIds.slice(),o.availableGeometryIds=this._availableGeometryIds.slice(),o.nextIndexStart=this._nextIndexStart,o.nextVertexStart=this._nextVertexStart,o.geometryCount=this._geometryCount,o.maxInstanceCount=this._maxInstanceCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.matricesTexture=this._matricesTexture.toJSON(e),o.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(o.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(o.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(o.boundingBox=this.boundingBox.toJSON()));function l(u,h){return u[h.uuid]===void 0&&(u[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=l(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const h=u.shapes;if(Array.isArray(h))for(let p=0,m=h.length;p<m;p++){const g=h[p];l(e.shapes,g)}else l(e.shapes,h)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let h=0,p=this.material.length;h<p;h++)u.push(l(e.materials,this.material[h]));o.material=u}else o.material=l(e.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++){const h=this.animations[u];o.animations.push(l(e.animations,h))}}if(n){const u=d(e.geometries),h=d(e.materials),p=d(e.textures),m=d(e.images),g=d(e.shapes),v=d(e.skeletons),C=d(e.animations),b=d(e.nodes);u.length>0&&(s.geometries=u),h.length>0&&(s.materials=h),p.length>0&&(s.textures=p),m.length>0&&(s.images=m),g.length>0&&(s.shapes=g),v.length>0&&(s.skeletons=v),C.length>0&&(s.animations=C),b.length>0&&(s.nodes=b)}return s.object=o,s;function d(u){const h=[];for(const p in u){const m=u[p];delete m.metadata,h.push(m)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let s=0;s<e.children.length;s++){const o=e.children[s];this.add(o.clone())}return this}}oa.DEFAULT_UP=new Re(0,1,0);oa.DEFAULT_MATRIX_AUTO_UPDATE=!0;oa.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Cs=new Re,Dr=new Re,cy=new Re,Ir=new Re,Mc=new Re,wc=new Re,hC=new Re,dy=new Re,uy=new Re,fy=new Re,hy=new ii,py=new ii,my=new ii;class As{constructor(e=new Re,n=new Re,s=new Re){this.a=e,this.b=n,this.c=s}static getNormal(e,n,s,o){o.subVectors(s,n),Cs.subVectors(e,n),o.cross(Cs);const l=o.lengthSq();return l>0?o.multiplyScalar(1/Math.sqrt(l)):o.set(0,0,0)}static getBarycoord(e,n,s,o,l){Cs.subVectors(o,n),Dr.subVectors(s,n),cy.subVectors(e,n);const d=Cs.dot(Cs),u=Cs.dot(Dr),h=Cs.dot(cy),p=Dr.dot(Dr),m=Dr.dot(cy),g=d*p-u*u;if(g===0)return l.set(0,0,0),null;const v=1/g,C=(p*h-u*m)*v,b=(d*m-u*h)*v;return l.set(1-C-b,b,C)}static containsPoint(e,n,s,o){return this.getBarycoord(e,n,s,o,Ir)===null?!1:Ir.x>=0&&Ir.y>=0&&Ir.x+Ir.y<=1}static getInterpolation(e,n,s,o,l,d,u,h){return this.getBarycoord(e,n,s,o,Ir)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(l,Ir.x),h.addScaledVector(d,Ir.y),h.addScaledVector(u,Ir.z),h)}static getInterpolatedAttribute(e,n,s,o,l,d){return hy.setScalar(0),py.setScalar(0),my.setScalar(0),hy.fromBufferAttribute(e,n),py.fromBufferAttribute(e,s),my.fromBufferAttribute(e,o),d.setScalar(0),d.addScaledVector(hy,l.x),d.addScaledVector(py,l.y),d.addScaledVector(my,l.z),d}static isFrontFacing(e,n,s,o){return Cs.subVectors(s,n),Dr.subVectors(e,n),Cs.cross(Dr).dot(o)<0}set(e,n,s){return this.a.copy(e),this.b.copy(n),this.c.copy(s),this}setFromPointsAndIndices(e,n,s,o){return this.a.copy(e[n]),this.b.copy(e[s]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,n,s,o){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,s),this.c.fromBufferAttribute(e,o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Cs.subVectors(this.c,this.b),Dr.subVectors(this.a,this.b),Cs.cross(Dr).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return As.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return As.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,s,o,l){return As.getInterpolation(e,this.a,this.b,this.c,n,s,o,l)}containsPoint(e){return As.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return As.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const s=this.a,o=this.b,l=this.c;let d,u;Mc.subVectors(o,s),wc.subVectors(l,s),dy.subVectors(e,s);const h=Mc.dot(dy),p=wc.dot(dy);if(h<=0&&p<=0)return n.copy(s);uy.subVectors(e,o);const m=Mc.dot(uy),g=wc.dot(uy);if(m>=0&&g<=m)return n.copy(o);const v=h*g-m*p;if(v<=0&&h>=0&&m<=0)return d=h/(h-m),n.copy(s).addScaledVector(Mc,d);fy.subVectors(e,l);const C=Mc.dot(fy),b=wc.dot(fy);if(b>=0&&C<=b)return n.copy(l);const _=C*p-h*b;if(_<=0&&p>=0&&b<=0)return u=p/(p-b),n.copy(s).addScaledVector(wc,u);const y=m*b-C*g;if(y<=0&&g-m>=0&&C-b>=0)return hC.subVectors(l,o),u=(g-m)/(g-m+(C-b)),n.copy(o).addScaledVector(hC,u);const S=1/(y+_+v);return d=_*S,u=v*S,n.copy(s).addScaledVector(Mc,d).addScaledVector(wc,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const UE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},jo={h:0,s:0,l:0},qh={h:0,s:0,l:0};function gy(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class xn{constructor(e,n,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,s)}set(e,n,s){if(n===void 0&&s===void 0){const o=e;o&&o.isColor?this.copy(o):typeof o=="number"?this.setHex(o):typeof o=="string"&&this.setStyle(o)}else this.setRGB(e,n,s);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Ha){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,yn.colorSpaceToWorking(this,n),this}setRGB(e,n,s,o=yn.workingColorSpace){return this.r=e,this.g=n,this.b=s,yn.colorSpaceToWorking(this,o),this}setHSL(e,n,s,o=yn.workingColorSpace){if(e=TB(e,1),n=cn(n,0,1),s=cn(s,0,1),n===0)this.r=this.g=this.b=s;else{const l=s<=.5?s*(1+n):s+n-s*n,d=2*s-l;this.r=gy(d,l,e+1/3),this.g=gy(d,l,e),this.b=gy(d,l,e-1/3)}return yn.colorSpaceToWorking(this,o),this}setStyle(e,n=Ha){function s(l){l!==void 0&&parseFloat(l)<1&&$t("Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const d=o[1],u=o[2];switch(d){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,n);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,n);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,n);break;default:$t("Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=o[1],d=l.length;if(d===3)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,n);if(d===6)return this.setHex(parseInt(l,16),n);$t("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Ha){const s=UE[e.toLowerCase()];return s!==void 0?this.setHex(s,n):$t("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=qr(e.r),this.g=qr(e.g),this.b=qr(e.b),this}copyLinearToSRGB(e){return this.r=Hc(e.r),this.g=Hc(e.g),this.b=Hc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ha){return yn.workingToColorSpace(ea.copy(this),e),Math.round(cn(ea.r*255,0,255))*65536+Math.round(cn(ea.g*255,0,255))*256+Math.round(cn(ea.b*255,0,255))}getHexString(e=Ha){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=yn.workingColorSpace){yn.workingToColorSpace(ea.copy(this),n);const s=ea.r,o=ea.g,l=ea.b,d=Math.max(s,o,l),u=Math.min(s,o,l);let h,p;const m=(u+d)/2;if(u===d)h=0,p=0;else{const g=d-u;switch(p=m<=.5?g/(d+u):g/(2-d-u),d){case s:h=(o-l)/g+(o<l?6:0);break;case o:h=(l-s)/g+2;break;case l:h=(s-o)/g+4;break}h/=6}return e.h=h,e.s=p,e.l=m,e}getRGB(e,n=yn.workingColorSpace){return yn.workingToColorSpace(ea.copy(this),n),e.r=ea.r,e.g=ea.g,e.b=ea.b,e}getStyle(e=Ha){yn.workingToColorSpace(ea.copy(this),e);const n=ea.r,s=ea.g,o=ea.b;return e!==Ha?`color(${e} ${n.toFixed(3)} ${s.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(s*255)},${Math.round(o*255)})`}offsetHSL(e,n,s){return this.getHSL(jo),this.setHSL(jo.h+e,jo.s+n,jo.l+s)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,s){return this.r=e.r+(n.r-e.r)*s,this.g=e.g+(n.g-e.g)*s,this.b=e.b+(n.b-e.b)*s,this}lerpHSL(e,n){this.getHSL(jo),e.getHSL(qh);const s=Zx(jo.h,qh.h,n),o=Zx(jo.s,qh.s,n),l=Zx(jo.l,qh.l,n);return this.setHSL(s,o,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,s=this.g,o=this.b,l=e.elements;return this.r=l[0]*n+l[3]*s+l[6]*o,this.g=l[1]*n+l[4]*s+l[7]*o,this.b=l[2]*n+l[5]*s+l[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ea=new xn;xn.NAMES=UE;let UB=0;class df extends Pl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:UB++}),this.uuid=lf(),this.name="",this.type="Material",this.blending=Uc,this.side=Bo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=b0,this.blendDst=S0,this.blendEquation=fl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xn(0,0,0),this.blendAlpha=0,this.depthFunc=Xc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Zw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=mc,this.stencilZFail=mc,this.stencilZPass=mc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const s=e[n];if(s===void 0){$t(`Material: parameter '${n}' has value of undefined.`);continue}const o=this[n];if(o===void 0){$t(`Material: '${n}' is not a property of THREE.${this.type}.`);continue}o&&o.isColor?o.set(s):o&&o.isVector3&&s&&s.isVector3?o.copy(s):this[n]=s}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const s={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen!==void 0&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(s.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(s.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(s.dispersion=this.dispersion),this.iridescence!==void 0&&(s.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(s.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(s.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(s.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(s.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(e).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(e).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(e).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(e).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(e).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(s.combine=this.combine)),this.envMapRotation!==void 0&&(s.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(s.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(s.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(s.size=this.size),this.shadowSide!==null&&(s.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==Uc&&(s.blending=this.blending),this.side!==Bo&&(s.side=this.side),this.vertexColors===!0&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=!0),this.blendSrc!==b0&&(s.blendSrc=this.blendSrc),this.blendDst!==S0&&(s.blendDst=this.blendDst),this.blendEquation!==fl&&(s.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(s.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(s.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(s.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(s.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(s.blendAlpha=this.blendAlpha),this.depthFunc!==Xc&&(s.depthFunc=this.depthFunc),this.depthTest===!1&&(s.depthTest=this.depthTest),this.depthWrite===!1&&(s.depthWrite=this.depthWrite),this.colorWrite===!1&&(s.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(s.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Zw&&(s.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(s.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(s.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==mc&&(s.stencilFail=this.stencilFail),this.stencilZFail!==mc&&(s.stencilZFail=this.stencilZFail),this.stencilZPass!==mc&&(s.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(s.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),this.alphaHash===!0&&(s.alphaHash=!0),this.alphaToCoverage===!0&&(s.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=!0),this.forceSinglePass===!0&&(s.forceSinglePass=!0),this.allowOverride===!1&&(s.allowOverride=!1),this.wireframe===!0&&(s.wireframe=!0),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(s.flatShading=!0),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),this.fog===!1&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData);function o(l){const d=[];for(const u in l){const h=l[u];delete h.metadata,d.push(h)}return d}if(n){const l=o(e.textures),d=o(e.images);l.length>0&&(s.textures=l),d.length>0&&(s.images=d)}return s}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let s=null;if(n!==null){const o=n.length;s=new Array(o);for(let l=0;l!==o;++l)s[l]=n[l].clone()}return this.clippingPlanes=s,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class HE extends df{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ir,this.combine=Jv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const pi=new Re,Gh=new Xt;let HB=0;class $a{constructor(e,n,s=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:HB++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=s,this.usage=Jw,this.updateRanges=[],this.gpuType=Ks,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,s){e*=this.itemSize,s*=n.itemSize;for(let o=0,l=this.itemSize;o<l;o++)this.array[e+o]=n.array[s+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,s=this.count;n<s;n++)Gh.fromBufferAttribute(this,n),Gh.applyMatrix3(e),this.setXY(n,Gh.x,Gh.y);else if(this.itemSize===3)for(let n=0,s=this.count;n<s;n++)pi.fromBufferAttribute(this,n),pi.applyMatrix3(e),this.setXYZ(n,pi.x,pi.y,pi.z);return this}applyMatrix4(e){for(let n=0,s=this.count;n<s;n++)pi.fromBufferAttribute(this,n),pi.applyMatrix4(e),this.setXYZ(n,pi.x,pi.y,pi.z);return this}applyNormalMatrix(e){for(let n=0,s=this.count;n<s;n++)pi.fromBufferAttribute(this,n),pi.applyNormalMatrix(e),this.setXYZ(n,pi.x,pi.y,pi.z);return this}transformDirection(e){for(let n=0,s=this.count;n<s;n++)pi.fromBufferAttribute(this,n),pi.transformDirection(e),this.setXYZ(n,pi.x,pi.y,pi.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let s=this.array[e*this.itemSize+n];return this.normalized&&(s=fu(s,this.array)),s}setComponent(e,n,s){return this.normalized&&(s=Sa(s,this.array)),this.array[e*this.itemSize+n]=s,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=fu(n,this.array)),n}setX(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=fu(n,this.array)),n}setY(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=fu(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=fu(n,this.array)),n}setW(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,s){return e*=this.itemSize,this.normalized&&(n=Sa(n,this.array),s=Sa(s,this.array)),this.array[e+0]=n,this.array[e+1]=s,this}setXYZ(e,n,s,o){return e*=this.itemSize,this.normalized&&(n=Sa(n,this.array),s=Sa(s,this.array),o=Sa(o,this.array)),this.array[e+0]=n,this.array[e+1]=s,this.array[e+2]=o,this}setXYZW(e,n,s,o,l){return e*=this.itemSize,this.normalized&&(n=Sa(n,this.array),s=Sa(s,this.array),o=Sa(o,this.array),l=Sa(l,this.array)),this.array[e+0]=n,this.array[e+1]=s,this.array[e+2]=o,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Jw&&(e.usage=this.usage),e}}class VE extends $a{constructor(e,n,s){super(new Uint16Array(e),n,s)}}class qE extends $a{constructor(e,n,s){super(new Uint32Array(e),n,s)}}class Os extends $a{constructor(e,n,s){super(new Float32Array(e),n,s)}}let VB=0;const rs=new ai,xy=new oa,Cc=new Re,ka=new cf,gu=new cf,Ri=new Re;class Ns extends Pl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:VB++}),this.uuid=lf(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(FE(e)?qE:VE)(e,1):this.index=e,this}setIndirect(e,n=0){return this.indirect=e,this.indirectOffset=n,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,s=0){this.groups.push({start:e,count:n,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const s=this.attributes.normal;if(s!==void 0){const l=new Jt().getNormalMatrix(e);s.applyNormalMatrix(l),s.needsUpdate=!0}const o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return rs.makeRotationFromQuaternion(e),this.applyMatrix4(rs),this}rotateX(e){return rs.makeRotationX(e),this.applyMatrix4(rs),this}rotateY(e){return rs.makeRotationY(e),this.applyMatrix4(rs),this}rotateZ(e){return rs.makeRotationZ(e),this.applyMatrix4(rs),this}translate(e,n,s){return rs.makeTranslation(e,n,s),this.applyMatrix4(rs),this}scale(e,n,s){return rs.makeScale(e,n,s),this.applyMatrix4(rs),this}lookAt(e){return xy.lookAt(e),xy.updateMatrix(),this.applyMatrix4(xy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cc).negate(),this.translate(Cc.x,Cc.y,Cc.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const s=[];for(let o=0,l=e.length;o<l;o++){const d=e[o];s.push(d.x,d.y,d.z||0)}this.setAttribute("position",new Os(s,3))}else{const s=Math.min(e.length,n.count);for(let o=0;o<s;o++){const l=e[o];n.setXYZ(o,l.x,l.y,l.z||0)}e.length>n.count&&$t("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new cf);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Sn("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Re(-1/0,-1/0,-1/0),new Re(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const l=n[s];ka.setFromBufferAttribute(l),this.morphTargetsRelative?(Ri.addVectors(this.boundingBox.min,ka.min),this.boundingBox.expandByPoint(Ri),Ri.addVectors(this.boundingBox.max,ka.max),this.boundingBox.expandByPoint(Ri)):(this.boundingBox.expandByPoint(ka.min),this.boundingBox.expandByPoint(ka.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Sn('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new c_);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Sn("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Re,1/0);return}if(e){const s=this.boundingSphere.center;if(ka.setFromBufferAttribute(e),n)for(let l=0,d=n.length;l<d;l++){const u=n[l];gu.setFromBufferAttribute(u),this.morphTargetsRelative?(Ri.addVectors(ka.min,gu.min),ka.expandByPoint(Ri),Ri.addVectors(ka.max,gu.max),ka.expandByPoint(Ri)):(ka.expandByPoint(gu.min),ka.expandByPoint(gu.max))}ka.getCenter(s);let o=0;for(let l=0,d=e.count;l<d;l++)Ri.fromBufferAttribute(e,l),o=Math.max(o,s.distanceToSquared(Ri));if(n)for(let l=0,d=n.length;l<d;l++){const u=n[l],h=this.morphTargetsRelative;for(let p=0,m=u.count;p<m;p++)Ri.fromBufferAttribute(u,p),h&&(Cc.fromBufferAttribute(e,p),Ri.add(Cc)),o=Math.max(o,s.distanceToSquared(Ri))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&Sn('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){Sn("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const s=n.position,o=n.normal,l=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new $a(new Float32Array(4*s.count),4));const d=this.getAttribute("tangent"),u=[],h=[];for(let R=0;R<s.count;R++)u[R]=new Re,h[R]=new Re;const p=new Re,m=new Re,g=new Re,v=new Xt,C=new Xt,b=new Xt,_=new Re,y=new Re;function S(R,M,I){p.fromBufferAttribute(s,R),m.fromBufferAttribute(s,M),g.fromBufferAttribute(s,I),v.fromBufferAttribute(l,R),C.fromBufferAttribute(l,M),b.fromBufferAttribute(l,I),m.sub(p),g.sub(p),C.sub(v),b.sub(v);const z=1/(C.x*b.y-b.x*C.y);isFinite(z)&&(_.copy(m).multiplyScalar(b.y).addScaledVector(g,-C.y).multiplyScalar(z),y.copy(g).multiplyScalar(C.x).addScaledVector(m,-b.x).multiplyScalar(z),u[R].add(_),u[M].add(_),u[I].add(_),h[R].add(y),h[M].add(y),h[I].add(y))}let D=this.groups;D.length===0&&(D=[{start:0,count:e.count}]);for(let R=0,M=D.length;R<M;++R){const I=D[R],z=I.start,V=I.count;for(let O=z,k=z+V;O<k;O+=3)S(e.getX(O+0),e.getX(O+1),e.getX(O+2))}const L=new Re,N=new Re,T=new Re,j=new Re;function E(R){T.fromBufferAttribute(o,R),j.copy(T);const M=u[R];L.copy(M),L.sub(T.multiplyScalar(T.dot(M))).normalize(),N.crossVectors(j,M);const z=N.dot(h[R])<0?-1:1;d.setXYZW(R,L.x,L.y,L.z,z)}for(let R=0,M=D.length;R<M;++R){const I=D[R],z=I.start,V=I.count;for(let O=z,k=z+V;O<k;O+=3)E(e.getX(O+0)),E(e.getX(O+1)),E(e.getX(O+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let s=this.getAttribute("normal");if(s===void 0)s=new $a(new Float32Array(n.count*3),3),this.setAttribute("normal",s);else for(let v=0,C=s.count;v<C;v++)s.setXYZ(v,0,0,0);const o=new Re,l=new Re,d=new Re,u=new Re,h=new Re,p=new Re,m=new Re,g=new Re;if(e)for(let v=0,C=e.count;v<C;v+=3){const b=e.getX(v+0),_=e.getX(v+1),y=e.getX(v+2);o.fromBufferAttribute(n,b),l.fromBufferAttribute(n,_),d.fromBufferAttribute(n,y),m.subVectors(d,l),g.subVectors(o,l),m.cross(g),u.fromBufferAttribute(s,b),h.fromBufferAttribute(s,_),p.fromBufferAttribute(s,y),u.add(m),h.add(m),p.add(m),s.setXYZ(b,u.x,u.y,u.z),s.setXYZ(_,h.x,h.y,h.z),s.setXYZ(y,p.x,p.y,p.z)}else for(let v=0,C=n.count;v<C;v+=3)o.fromBufferAttribute(n,v+0),l.fromBufferAttribute(n,v+1),d.fromBufferAttribute(n,v+2),m.subVectors(d,l),g.subVectors(o,l),m.cross(g),s.setXYZ(v+0,m.x,m.y,m.z),s.setXYZ(v+1,m.x,m.y,m.z),s.setXYZ(v+2,m.x,m.y,m.z);this.normalizeNormals(),s.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,s=e.count;n<s;n++)Ri.fromBufferAttribute(e,n),Ri.normalize(),e.setXYZ(n,Ri.x,Ri.y,Ri.z)}toNonIndexed(){function e(u,h){const p=u.array,m=u.itemSize,g=u.normalized,v=new p.constructor(h.length*m);let C=0,b=0;for(let _=0,y=h.length;_<y;_++){u.isInterleavedBufferAttribute?C=h[_]*u.data.stride+u.offset:C=h[_]*m;for(let S=0;S<m;S++)v[b++]=p[C++]}return new $a(v,m,g)}if(this.index===null)return $t("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Ns,s=this.index.array,o=this.attributes;for(const u in o){const h=o[u],p=e(h,s);n.setAttribute(u,p)}const l=this.morphAttributes;for(const u in l){const h=[],p=l[u];for(let m=0,g=p.length;m<g;m++){const v=p[m],C=e(v,s);h.push(C)}n.morphAttributes[u]=h}n.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let u=0,h=d.length;u<h;u++){const p=d[u];n.addGroup(p.start,p.count,p.materialIndex)}return n}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const p in h)h[p]!==void 0&&(e[p]=h[p]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const s=this.attributes;for(const h in s){const p=s[h];e.data.attributes[h]=p.toJSON(e.data)}const o={};let l=!1;for(const h in this.morphAttributes){const p=this.morphAttributes[h],m=[];for(let g=0,v=p.length;g<v;g++){const C=p[g];m.push(C.toJSON(e.data))}m.length>0&&(o[h]=m,l=!0)}l&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere=u.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const s=e.index;s!==null&&this.setIndex(s.clone());const o=e.attributes;for(const p in o){const m=o[p];this.setAttribute(p,m.clone(n))}const l=e.morphAttributes;for(const p in l){const m=[],g=l[p];for(let v=0,C=g.length;v<C;v++)m.push(g[v].clone(n));this.morphAttributes[p]=m}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let p=0,m=d.length;p<m;p++){const g=d[p];this.addGroup(g.start,g.count,g.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const pC=new ai,rl=new kE,$h=new c_,mC=new Re,Wh=new Re,Yh=new Re,Kh=new Re,yy=new Re,Xh=new Re,gC=new Re,Qh=new Re;class ar extends oa{constructor(e=new Ns,n=new HE){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,s=Object.keys(n);if(s.length>0){const o=n[s[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=o.length;l<d;l++){const u=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=l}}}}getVertexPosition(e,n){const s=this.geometry,o=s.attributes.position,l=s.morphAttributes.position,d=s.morphTargetsRelative;n.fromBufferAttribute(o,e);const u=this.morphTargetInfluences;if(l&&u){Xh.set(0,0,0);for(let h=0,p=l.length;h<p;h++){const m=u[h],g=l[h];m!==0&&(yy.fromBufferAttribute(g,e),d?Xh.addScaledVector(yy,m):Xh.addScaledVector(yy.sub(n),m))}n.add(Xh)}return n}raycast(e,n){const s=this.geometry,o=this.material,l=this.matrixWorld;o!==void 0&&(s.boundingSphere===null&&s.computeBoundingSphere(),$h.copy(s.boundingSphere),$h.applyMatrix4(l),rl.copy(e.ray).recast(e.near),!($h.containsPoint(rl.origin)===!1&&(rl.intersectSphere($h,mC)===null||rl.origin.distanceToSquared(mC)>(e.far-e.near)**2))&&(pC.copy(l).invert(),rl.copy(e.ray).applyMatrix4(pC),!(s.boundingBox!==null&&rl.intersectsBox(s.boundingBox)===!1)&&this._computeIntersections(e,n,rl)))}_computeIntersections(e,n,s){let o;const l=this.geometry,d=this.material,u=l.index,h=l.attributes.position,p=l.attributes.uv,m=l.attributes.uv1,g=l.attributes.normal,v=l.groups,C=l.drawRange;if(u!==null)if(Array.isArray(d))for(let b=0,_=v.length;b<_;b++){const y=v[b],S=d[y.materialIndex],D=Math.max(y.start,C.start),L=Math.min(u.count,Math.min(y.start+y.count,C.start+C.count));for(let N=D,T=L;N<T;N+=3){const j=u.getX(N),E=u.getX(N+1),R=u.getX(N+2);o=Zh(this,S,e,s,p,m,g,j,E,R),o&&(o.faceIndex=Math.floor(N/3),o.face.materialIndex=y.materialIndex,n.push(o))}}else{const b=Math.max(0,C.start),_=Math.min(u.count,C.start+C.count);for(let y=b,S=_;y<S;y+=3){const D=u.getX(y),L=u.getX(y+1),N=u.getX(y+2);o=Zh(this,d,e,s,p,m,g,D,L,N),o&&(o.faceIndex=Math.floor(y/3),n.push(o))}}else if(h!==void 0)if(Array.isArray(d))for(let b=0,_=v.length;b<_;b++){const y=v[b],S=d[y.materialIndex],D=Math.max(y.start,C.start),L=Math.min(h.count,Math.min(y.start+y.count,C.start+C.count));for(let N=D,T=L;N<T;N+=3){const j=N,E=N+1,R=N+2;o=Zh(this,S,e,s,p,m,g,j,E,R),o&&(o.faceIndex=Math.floor(N/3),o.face.materialIndex=y.materialIndex,n.push(o))}}else{const b=Math.max(0,C.start),_=Math.min(h.count,C.start+C.count);for(let y=b,S=_;y<S;y+=3){const D=y,L=y+1,N=y+2;o=Zh(this,d,e,s,p,m,g,D,L,N),o&&(o.faceIndex=Math.floor(y/3),n.push(o))}}}}function qB(t,e,n,s,o,l,d,u){let h;if(e.side===ja?h=s.intersectTriangle(d,l,o,!0,u):h=s.intersectTriangle(o,l,d,e.side===Bo,u),h===null)return null;Qh.copy(u),Qh.applyMatrix4(t.matrixWorld);const p=n.ray.origin.distanceTo(Qh);return p<n.near||p>n.far?null:{distance:p,point:Qh.clone(),object:t}}function Zh(t,e,n,s,o,l,d,u,h,p){t.getVertexPosition(u,Wh),t.getVertexPosition(h,Yh),t.getVertexPosition(p,Kh);const m=qB(t,e,n,s,Wh,Yh,Kh,gC);if(m){const g=new Re;As.getBarycoord(gC,Wh,Yh,Kh,g),o&&(m.uv=As.getInterpolatedAttribute(o,u,h,p,g,new Xt)),l&&(m.uv1=As.getInterpolatedAttribute(l,u,h,p,g,new Xt)),d&&(m.normal=As.getInterpolatedAttribute(d,u,h,p,g,new Re),m.normal.dot(s.direction)>0&&m.normal.multiplyScalar(-1));const v={a:u,b:h,c:p,normal:new Re,materialIndex:0};As.getNormal(Wh,Yh,Kh,v.normal),m.face=v,m.barycoord=g}return m}class uf extends Ns{constructor(e=1,n=1,s=1,o=1,l=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:s,widthSegments:o,heightSegments:l,depthSegments:d};const u=this;o=Math.floor(o),l=Math.floor(l),d=Math.floor(d);const h=[],p=[],m=[],g=[];let v=0,C=0;b("z","y","x",-1,-1,s,n,e,d,l,0),b("z","y","x",1,-1,s,n,-e,d,l,1),b("x","z","y",1,1,e,s,n,o,d,2),b("x","z","y",1,-1,e,s,-n,o,d,3),b("x","y","z",1,-1,e,n,s,o,l,4),b("x","y","z",-1,-1,e,n,-s,o,l,5),this.setIndex(h),this.setAttribute("position",new Os(p,3)),this.setAttribute("normal",new Os(m,3)),this.setAttribute("uv",new Os(g,2));function b(_,y,S,D,L,N,T,j,E,R,M){const I=N/E,z=T/R,V=N/2,O=T/2,k=j/2,F=E+1,A=R+1;let q=0,B=0;const W=new Re;for(let Q=0;Q<A;Q++){const ne=Q*z-O;for(let de=0;de<F;de++){const $=de*I-V;W[_]=$*D,W[y]=ne*L,W[S]=k,p.push(W.x,W.y,W.z),W[_]=0,W[y]=0,W[S]=j>0?1:-1,m.push(W.x,W.y,W.z),g.push(de/E),g.push(1-Q/R),q+=1}}for(let Q=0;Q<R;Q++)for(let ne=0;ne<E;ne++){const de=v+ne+F*Q,$=v+ne+F*(Q+1),X=v+(ne+1)+F*(Q+1),le=v+(ne+1)+F*Q;h.push(de,$,le),h.push($,X,le),B+=6}u.addGroup(C,B,M),C+=B,v+=q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ed(t){const e={};for(const n in t){e[n]={};for(const s in t[n]){const o=t[n][s];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.isRenderTargetTexture?($t("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][s]=null):e[n][s]=o.clone():Array.isArray(o)?e[n][s]=o.slice():e[n][s]=o}}return e}function fa(t){const e={};for(let n=0;n<t.length;n++){const s=ed(t[n]);for(const o in s)e[o]=s[o]}return e}function GB(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function GE(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:yn.workingColorSpace}const $B={clone:ed,merge:fa};var WB=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,YB=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class sr extends df{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=WB,this.fragmentShader=YB,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ed(e.uniforms),this.uniformsGroups=GB(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const o in this.uniforms){const d=this.uniforms[o].value;d&&d.isTexture?n.uniforms[o]={type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?n.uniforms[o]={type:"c",value:d.getHex()}:d&&d.isVector2?n.uniforms[o]={type:"v2",value:d.toArray()}:d&&d.isVector3?n.uniforms[o]={type:"v3",value:d.toArray()}:d&&d.isVector4?n.uniforms[o]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?n.uniforms[o]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?n.uniforms[o]={type:"m4",value:d.toArray()}:n.uniforms[o]={value:d}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const s={};for(const o in this.extensions)this.extensions[o]===!0&&(s[o]=!0);return Object.keys(s).length>0&&(n.extensions=s),n}}class $E extends oa{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ai,this.projectionMatrix=new ai,this.projectionMatrixInverse=new ai,this.coordinateSystem=Xs,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Eo=new Re,xC=new Xt,yC=new Xt;class ds extends $E{constructor(e=50,n=1,s=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=s,this.far=o,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=fv*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Dp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return fv*2*Math.atan(Math.tan(Dp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,s){Eo.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Eo.x,Eo.y).multiplyScalar(-e/Eo.z),Eo.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),s.set(Eo.x,Eo.y).multiplyScalar(-e/Eo.z)}getViewSize(e,n){return this.getViewBounds(e,xC,yC),n.subVectors(yC,xC)}setViewOffset(e,n,s,o,l,d){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=s,this.view.offsetY=o,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(Dp*.5*this.fov)/this.zoom,s=2*n,o=this.aspect*s,l=-.5*o;const d=this.view;if(this.view!==null&&this.view.enabled){const h=d.fullWidth,p=d.fullHeight;l+=d.offsetX*o/h,n-=d.offsetY*s/p,o*=d.width/h,s*=d.height/p}const u=this.filmOffset;u!==0&&(l+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+o,n,n-s,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Tc=-90,jc=1;class KB extends oa{constructor(e,n,s){super(),this.type="CubeCamera",this.renderTarget=s,this.coordinateSystem=null,this.activeMipmapLevel=0;const o=new ds(Tc,jc,e,n);o.layers=this.layers,this.add(o);const l=new ds(Tc,jc,e,n);l.layers=this.layers,this.add(l);const d=new ds(Tc,jc,e,n);d.layers=this.layers,this.add(d);const u=new ds(Tc,jc,e,n);u.layers=this.layers,this.add(u);const h=new ds(Tc,jc,e,n);h.layers=this.layers,this.add(h);const p=new ds(Tc,jc,e,n);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[s,o,l,d,u,h]=n;for(const p of n)this.remove(p);if(e===Xs)s.up.set(0,1,0),s.lookAt(1,0,0),o.up.set(0,1,0),o.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===Wp)s.up.set(0,-1,0),s.lookAt(-1,0,0),o.up.set(0,-1,0),o.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of n)this.add(p),p.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:s,activeMipmapLevel:o}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,d,u,h,p,m]=this.children,g=e.getRenderTarget(),v=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;const _=s.texture.generateMipmaps;s.texture.generateMipmaps=!1,e.setRenderTarget(s,0,o),e.render(n,l),e.setRenderTarget(s,1,o),e.render(n,d),e.setRenderTarget(s,2,o),e.render(n,u),e.setRenderTarget(s,3,o),e.render(n,h),e.setRenderTarget(s,4,o),e.render(n,p),s.texture.generateMipmaps=_,e.setRenderTarget(s,5,o),e.render(n,m),e.setRenderTarget(g,v,C),e.xr.enabled=b,s.texture.needsPMREMUpdate=!0}}class WE extends ma{constructor(e=[],n=Rl,s,o,l,d,u,h,p,m){super(e,n,s,o,l,d,u,h,p,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class YE extends Js{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const s={width:e,height:e,depth:1},o=[s,s,s,s,s,s];this.texture=new WE(o),this._setTextureOptions(n),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const s={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},o=new uf(5,5,5),l=new sr({name:"CubemapFromEquirect",uniforms:ed(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,side:ja,blending:Vr});l.uniforms.tEquirect.value=n;const d=new ar(o,l),u=n.minFilter;return n.minFilter===vl&&(n.minFilter=sa),new KB(1,10,this).update(e,d),n.minFilter=u,d.geometry.dispose(),d.material.dispose(),this}clear(e,n=!0,s=!0,o=!0){const l=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(n,s,o);e.setRenderTarget(l)}}class Jh extends oa{constructor(){super(),this.isGroup=!0,this.type="Group"}}const XB={type:"move"};class vy{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Jh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Jh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Re,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Re),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Jh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Re,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Re),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const s of e.hand.values())this._getHandJoint(n,s)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,s){let o=null,l=null,d=null;const u=this._targetRay,h=this._grip,p=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(p&&e.hand){d=!0;for(const _ of e.hand.values()){const y=n.getJointPose(_,s),S=this._getHandJoint(p,_);y!==null&&(S.matrix.fromArray(y.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=y.radius),S.visible=y!==null}const m=p.joints["index-finger-tip"],g=p.joints["thumb-tip"],v=m.position.distanceTo(g.position),C=.02,b=.005;p.inputState.pinching&&v>C+b?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&v<=C-b&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(l=n.getPose(e.gripSpace,s),l!==null&&(h.matrix.fromArray(l.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,l.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(l.linearVelocity)):h.hasLinearVelocity=!1,l.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(l.angularVelocity)):h.hasAngularVelocity=!1));u!==null&&(o=n.getPose(e.targetRaySpace,s),o===null&&l!==null&&(o=l),o!==null&&(u.matrix.fromArray(o.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,o.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(o.linearVelocity)):u.hasLinearVelocity=!1,o.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(o.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(XB)))}return u!==null&&(u.visible=o!==null),h!==null&&(h.visible=l!==null),p!==null&&(p.visible=d!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const s=new Jh;s.matrixAutoUpdate=!1,s.visible=!1,e.joints[n.jointName]=s,e.add(s)}return e.joints[n.jointName]}}class QB extends oa{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ir,this.environmentIntensity=1,this.environmentRotation=new ir,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class ZB extends ma{constructor(e=null,n=1,s=1,o,l,d,u,h,p=Ki,m=Ki,g,v){super(null,d,u,h,p,m,o,l,g,v),this.isDataTexture=!0,this.image={data:e,width:n,height:s},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _y=new Re,JB=new Re,e4=new Jt;class Do{constructor(e=new Re(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,s,o){return this.normal.set(e,n,s),this.constant=o,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,s){const o=_y.subVectors(s,n).cross(JB.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const s=e.delta(_y),o=this.normal.dot(s);if(o===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/o;return l<0||l>1?null:n.copy(e.start).addScaledVector(s,l)}intersectsLine(e){const n=this.distanceToPoint(e.start),s=this.distanceToPoint(e.end);return n<0&&s>0||s<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const s=n||e4.getNormalMatrix(e),o=this.coplanarPoint(_y).applyMatrix4(e),l=this.normal.applyMatrix3(s).normalize();return this.constant=-o.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const ol=new c_,t4=new Xt(.5,.5),ep=new Re;class d_{constructor(e=new Do,n=new Do,s=new Do,o=new Do,l=new Do,d=new Do){this.planes=[e,n,s,o,l,d]}set(e,n,s,o,l,d){const u=this.planes;return u[0].copy(e),u[1].copy(n),u[2].copy(s),u[3].copy(o),u[4].copy(l),u[5].copy(d),this}copy(e){const n=this.planes;for(let s=0;s<6;s++)n[s].copy(e.planes[s]);return this}setFromProjectionMatrix(e,n=Xs,s=!1){const o=this.planes,l=e.elements,d=l[0],u=l[1],h=l[2],p=l[3],m=l[4],g=l[5],v=l[6],C=l[7],b=l[8],_=l[9],y=l[10],S=l[11],D=l[12],L=l[13],N=l[14],T=l[15];if(o[0].setComponents(p-d,C-m,S-b,T-D).normalize(),o[1].setComponents(p+d,C+m,S+b,T+D).normalize(),o[2].setComponents(p+u,C+g,S+_,T+L).normalize(),o[3].setComponents(p-u,C-g,S-_,T-L).normalize(),s)o[4].setComponents(h,v,y,N).normalize(),o[5].setComponents(p-h,C-v,S-y,T-N).normalize();else if(o[4].setComponents(p-h,C-v,S-y,T-N).normalize(),n===Xs)o[5].setComponents(p+h,C+v,S+y,T+N).normalize();else if(n===Wp)o[5].setComponents(h,v,y,N).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),ol.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),ol.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ol)}intersectsSprite(e){ol.center.set(0,0,0);const n=t4.distanceTo(e.center);return ol.radius=.7071067811865476+n,ol.applyMatrix4(e.matrixWorld),this.intersectsSphere(ol)}intersectsSphere(e){const n=this.planes,s=e.center,o=-e.radius;for(let l=0;l<6;l++)if(n[l].distanceToPoint(s)<o)return!1;return!0}intersectsBox(e){const n=this.planes;for(let s=0;s<6;s++){const o=n[s];if(ep.x=o.normal.x>0?e.max.x:e.min.x,ep.y=o.normal.y>0?e.max.y:e.min.y,ep.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(ep)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let s=0;s<6;s++)if(n[s].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class qu extends ma{constructor(e,n,s=nr,o,l,d,u=Ki,h=Ki,p,m=Xr,g=1){if(m!==Xr&&m!==_l)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const v={width:e,height:n,depth:g};super(v,o,l,d,u,h,m,s,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new l_(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class n4 extends qu{constructor(e,n=nr,s=Rl,o,l,d=Ki,u=Ki,h,p=Xr){const m={width:e,height:e,depth:1},g=[m,m,m,m,m,m];super(e,e,n,s,o,l,d,u,h,p),this.image=g,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class KE extends ma{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class rm extends Ns{constructor(e=1,n=1,s=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:s,heightSegments:o};const l=e/2,d=n/2,u=Math.floor(s),h=Math.floor(o),p=u+1,m=h+1,g=e/u,v=n/h,C=[],b=[],_=[],y=[];for(let S=0;S<m;S++){const D=S*v-d;for(let L=0;L<p;L++){const N=L*g-l;b.push(N,-D,0),_.push(0,0,1),y.push(L/u),y.push(1-S/h)}}for(let S=0;S<h;S++)for(let D=0;D<u;D++){const L=D+p*S,N=D+p*(S+1),T=D+1+p*(S+1),j=D+1+p*S;C.push(L,N,j),C.push(N,T,j)}this.setIndex(C),this.setAttribute("position",new Os(b,3)),this.setAttribute("normal",new Os(_,3)),this.setAttribute("uv",new Os(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rm(e.width,e.height,e.widthSegments,e.heightSegments)}}class i4 extends sr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class a4 extends df{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new xn(16777215),this.specular=new xn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=NE,this.normalScale=new Xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ir,this.combine=Jv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class s4 extends df{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=gB,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class r4 extends df{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const vC={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class o4{constructor(e,n,s){const o=this;let l=!1,d=0,u=0,h;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=s,this._abortController=null,this.itemStart=function(m){u++,l===!1&&o.onStart!==void 0&&o.onStart(m,d,u),l=!0},this.itemEnd=function(m){d++,o.onProgress!==void 0&&o.onProgress(m,d,u),d===u&&(l=!1,o.onLoad!==void 0&&o.onLoad())},this.itemError=function(m){o.onError!==void 0&&o.onError(m)},this.resolveURL=function(m){return h?h(m):m},this.setURLModifier=function(m){return h=m,this},this.addHandler=function(m,g){return p.push(m,g),this},this.removeHandler=function(m){const g=p.indexOf(m);return g!==-1&&p.splice(g,2),this},this.getHandler=function(m){for(let g=0,v=p.length;g<v;g+=2){const C=p[g],b=p[g+1];if(C.global&&(C.lastIndex=0),C.test(m))return b}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const l4=new o4;class u_{constructor(e){this.manager=e!==void 0?e:l4,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const s=this;return new Promise(function(o,l){s.load(e,o,n,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}u_.DEFAULT_MATERIAL_NAME="__DEFAULT";const Or={};class c4 extends Error{constructor(e,n){super(e),this.response=n}}class d4 extends u_{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,n,s,o){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=vC.get(`file:${e}`);if(l!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(l),this.manager.itemEnd(e)},0),l;if(Or[e]!==void 0){Or[e].push({onLoad:n,onProgress:s,onError:o});return}Or[e]=[],Or[e].push({onLoad:n,onProgress:s,onError:o});const d=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),u=this.mimeType,h=this.responseType;fetch(d).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&$t("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const m=Or[e],g=p.body.getReader(),v=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),C=v?parseInt(v):0,b=C!==0;let _=0;const y=new ReadableStream({start(S){D();function D(){g.read().then(({done:L,value:N})=>{if(L)S.close();else{_+=N.byteLength;const T=new ProgressEvent("progress",{lengthComputable:b,loaded:_,total:C});for(let j=0,E=m.length;j<E;j++){const R=m[j];R.onProgress&&R.onProgress(T)}S.enqueue(N),D()}},L=>{S.error(L)})}}});return new Response(y)}else throw new c4(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(h){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(m=>new DOMParser().parseFromString(m,u));case"json":return p.json();default:if(u==="")return p.text();{const g=/charset="?([^;"\s]*)"?/i.exec(u),v=g&&g[1]?g[1].toLowerCase():void 0,C=new TextDecoder(v);return p.arrayBuffer().then(b=>C.decode(b))}}}).then(p=>{vC.add(`file:${e}`,p);const m=Or[e];delete Or[e];for(let g=0,v=m.length;g<v;g++){const C=m[g];C.onLoad&&C.onLoad(p)}}).catch(p=>{const m=Or[e];if(m===void 0)throw this.manager.itemError(e),p;delete Or[e];for(let g=0,v=m.length;g<v;g++){const C=m[g];C.onError&&C.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class XE extends oa{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new xn(e),this.intensity=n}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,n}}const by=new ai,_C=new Re,bC=new Re;class u4{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xt(512,512),this.mapType=Va,this.map=null,this.mapPass=null,this.matrix=new ai,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new d_,this._frameExtents=new Xt(1,1),this._viewportCount=1,this._viewports=[new ii(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,s=this.matrix;_C.setFromMatrixPosition(e.matrixWorld),n.position.copy(_C),bC.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(bC),n.updateMatrixWorld(),by.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(by,n.coordinateSystem,n.reversedDepth),n.reversedDepth?s.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),s.multiply(by)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class f_ extends $E{constructor(e=-1,n=1,s=1,o=-1,l=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=s,this.bottom=o,this.near=l,this.far=d,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,s,o,l,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=s,this.view.offsetY=o,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),s=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let l=s-e,d=s+e,u=o+n,h=o-n;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=p*this.view.offsetX,d=l+p*this.view.width,u-=m*this.view.offsetY,h=u-m*this.view.height}this.projectionMatrix.makeOrthographic(l,d,u,h,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class f4 extends u4{constructor(){super(new f_(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class SC extends XE{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(oa.DEFAULT_UP),this.updateMatrix(),this.target=new oa,this.shadow=new f4}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const n=super.toJSON(e);return n.object.shadow=this.shadow.toJSON(),n.object.target=this.target.uuid,n}}class h4 extends XE{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class p4 extends ds{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class MC{constructor(e=1,n=0,s=0){this.radius=e,this.phi=n,this.theta=s}set(e,n,s){return this.radius=e,this.phi=n,this.theta=s,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=cn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,s){return this.radius=Math.sqrt(e*e+n*n+s*s),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,s),this.phi=Math.acos(cn(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class m4 extends Pl{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){$t("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function wC(t,e,n,s){const o=g4(s);switch(n){case OE:return t*e;case LE:return t*e/o.components*o.byteLength;case i_:return t*e/o.components*o.byteLength;case Zc:return t*e*2/o.components*o.byteLength;case a_:return t*e*2/o.components*o.byteLength;case PE:return t*e*3/o.components*o.byteLength;case Ds:return t*e*4/o.components*o.byteLength;case s_:return t*e*4/o.components*o.byteLength;case jp:case Ep:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case Ap:case Rp:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case L0:case F0:return Math.max(t,16)*Math.max(e,8)/4;case P0:case N0:return Math.max(t,8)*Math.max(e,8)/2;case z0:case k0:case U0:case H0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case B0:case V0:case q0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case G0:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case $0:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case W0:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case Y0:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case K0:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case X0:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case Q0:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case Z0:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case J0:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case ev:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case tv:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case nv:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case iv:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case av:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case sv:case rv:case ov:return Math.ceil(t/4)*Math.ceil(e/4)*16;case lv:case cv:return Math.ceil(t/4)*Math.ceil(e/4)*8;case dv:case uv:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function g4(t){switch(t){case Va:case AE:return{byteLength:1,components:1};case Uu:case RE:case Kr:return{byteLength:2,components:1};case t_:case n_:return{byteLength:2,components:4};case nr:case e_:case Ks:return{byteLength:4,components:1};case DE:case IE:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Zv}}));typeof window<"u"&&(window.__THREE__?$t("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Zv);function QE(){let t=null,e=!1,n=null,s=null;function o(l,d){n(l,d),s=t.requestAnimationFrame(o)}return{start:function(){e!==!0&&n!==null&&(s=t.requestAnimationFrame(o),e=!0)},stop:function(){t.cancelAnimationFrame(s),e=!1},setAnimationLoop:function(l){n=l},setContext:function(l){t=l}}}function x4(t){const e=new WeakMap;function n(u,h){const p=u.array,m=u.usage,g=p.byteLength,v=t.createBuffer();t.bindBuffer(h,v),t.bufferData(h,p,m),u.onUploadCallback();let C;if(p instanceof Float32Array)C=t.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)C=t.HALF_FLOAT;else if(p instanceof Uint16Array)u.isFloat16BufferAttribute?C=t.HALF_FLOAT:C=t.UNSIGNED_SHORT;else if(p instanceof Int16Array)C=t.SHORT;else if(p instanceof Uint32Array)C=t.UNSIGNED_INT;else if(p instanceof Int32Array)C=t.INT;else if(p instanceof Int8Array)C=t.BYTE;else if(p instanceof Uint8Array)C=t.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)C=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:v,type:C,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version,size:g}}function s(u,h,p){const m=h.array,g=h.updateRanges;if(t.bindBuffer(p,u),g.length===0)t.bufferSubData(p,0,m);else{g.sort((C,b)=>C.start-b.start);let v=0;for(let C=1;C<g.length;C++){const b=g[v],_=g[C];_.start<=b.start+b.count+1?b.count=Math.max(b.count,_.start+_.count-b.start):(++v,g[v]=_)}g.length=v+1;for(let C=0,b=g.length;C<b;C++){const _=g[C];t.bufferSubData(p,_.start*m.BYTES_PER_ELEMENT,m,_.start,_.count)}h.clearUpdateRanges()}h.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),e.get(u)}function l(u){u.isInterleavedBufferAttribute&&(u=u.data);const h=e.get(u);h&&(t.deleteBuffer(h.buffer),e.delete(u))}function d(u,h){if(u.isInterleavedBufferAttribute&&(u=u.data),u.isGLBufferAttribute){const m=e.get(u);(!m||m.version<u.version)&&e.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}const p=e.get(u);if(p===void 0)e.set(u,n(u,h));else if(p.version<u.version){if(p.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(p.buffer,u,h),p.version=u.version}}return{get:o,remove:l,update:d}}var y4=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,v4=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,_4=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,b4=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,S4=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,M4=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,w4=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,C4=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,T4=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,j4=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,E4=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,A4=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,R4=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,D4=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,I4=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,O4=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,P4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,L4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,N4=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,F4=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,z4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,k4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,B4=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,U4=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,H4=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,V4=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,q4=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,G4=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,$4=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,W4=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Y4="gl_FragColor = linearToOutputTexel( gl_FragColor );",K4=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,X4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Q4=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,Z4=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,J4=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,eU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,tU=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,nU=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,iU=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,aU=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,sU=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,rU=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,oU=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lU=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,cU=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,dU=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,uU=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,fU=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,hU=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,pU=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,mU=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,gU=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,xU=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,yU=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,vU=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,_U=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,bU=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,SU=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,MU=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,wU=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,CU=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,TU=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,jU=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,EU=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,AU=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,RU=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,DU=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,IU=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,OU=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,PU=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,LU=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,NU=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,FU=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,zU=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,kU=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,BU=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,UU=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,HU=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,VU=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,qU=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,GU=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,$U=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,WU=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,YU=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,KU=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,XU=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,QU=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ZU=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,JU=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,e6=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,t6=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,n6=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,i6=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,a6=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,s6=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,r6=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,o6=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,l6=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,c6=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,d6=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,u6=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,f6=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,h6=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,p6=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,m6=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,g6=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const x6=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,y6=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,v6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_6=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,b6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,S6=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,M6=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,w6=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,C6=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,T6=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,j6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,E6=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,A6=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,R6=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,D6=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,I6=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,O6=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,P6=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,L6=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,N6=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,F6=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,z6=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,k6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,B6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,U6=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,H6=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,V6=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,q6=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,G6=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,$6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,W6=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Y6=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,K6=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,X6=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,nn={alphahash_fragment:y4,alphahash_pars_fragment:v4,alphamap_fragment:_4,alphamap_pars_fragment:b4,alphatest_fragment:S4,alphatest_pars_fragment:M4,aomap_fragment:w4,aomap_pars_fragment:C4,batching_pars_vertex:T4,batching_vertex:j4,begin_vertex:E4,beginnormal_vertex:A4,bsdfs:R4,iridescence_fragment:D4,bumpmap_pars_fragment:I4,clipping_planes_fragment:O4,clipping_planes_pars_fragment:P4,clipping_planes_pars_vertex:L4,clipping_planes_vertex:N4,color_fragment:F4,color_pars_fragment:z4,color_pars_vertex:k4,color_vertex:B4,common:U4,cube_uv_reflection_fragment:H4,defaultnormal_vertex:V4,displacementmap_pars_vertex:q4,displacementmap_vertex:G4,emissivemap_fragment:$4,emissivemap_pars_fragment:W4,colorspace_fragment:Y4,colorspace_pars_fragment:K4,envmap_fragment:X4,envmap_common_pars_fragment:Q4,envmap_pars_fragment:Z4,envmap_pars_vertex:J4,envmap_physical_pars_fragment:dU,envmap_vertex:eU,fog_vertex:tU,fog_pars_vertex:nU,fog_fragment:iU,fog_pars_fragment:aU,gradientmap_pars_fragment:sU,lightmap_pars_fragment:rU,lights_lambert_fragment:oU,lights_lambert_pars_fragment:lU,lights_pars_begin:cU,lights_toon_fragment:uU,lights_toon_pars_fragment:fU,lights_phong_fragment:hU,lights_phong_pars_fragment:pU,lights_physical_fragment:mU,lights_physical_pars_fragment:gU,lights_fragment_begin:xU,lights_fragment_maps:yU,lights_fragment_end:vU,logdepthbuf_fragment:_U,logdepthbuf_pars_fragment:bU,logdepthbuf_pars_vertex:SU,logdepthbuf_vertex:MU,map_fragment:wU,map_pars_fragment:CU,map_particle_fragment:TU,map_particle_pars_fragment:jU,metalnessmap_fragment:EU,metalnessmap_pars_fragment:AU,morphinstance_vertex:RU,morphcolor_vertex:DU,morphnormal_vertex:IU,morphtarget_pars_vertex:OU,morphtarget_vertex:PU,normal_fragment_begin:LU,normal_fragment_maps:NU,normal_pars_fragment:FU,normal_pars_vertex:zU,normal_vertex:kU,normalmap_pars_fragment:BU,clearcoat_normal_fragment_begin:UU,clearcoat_normal_fragment_maps:HU,clearcoat_pars_fragment:VU,iridescence_pars_fragment:qU,opaque_fragment:GU,packing:$U,premultiplied_alpha_fragment:WU,project_vertex:YU,dithering_fragment:KU,dithering_pars_fragment:XU,roughnessmap_fragment:QU,roughnessmap_pars_fragment:ZU,shadowmap_pars_fragment:JU,shadowmap_pars_vertex:e6,shadowmap_vertex:t6,shadowmask_pars_fragment:n6,skinbase_vertex:i6,skinning_pars_vertex:a6,skinning_vertex:s6,skinnormal_vertex:r6,specularmap_fragment:o6,specularmap_pars_fragment:l6,tonemapping_fragment:c6,tonemapping_pars_fragment:d6,transmission_fragment:u6,transmission_pars_fragment:f6,uv_pars_fragment:h6,uv_pars_vertex:p6,uv_vertex:m6,worldpos_vertex:g6,background_vert:x6,background_frag:y6,backgroundCube_vert:v6,backgroundCube_frag:_6,cube_vert:b6,cube_frag:S6,depth_vert:M6,depth_frag:w6,distance_vert:C6,distance_frag:T6,equirect_vert:j6,equirect_frag:E6,linedashed_vert:A6,linedashed_frag:R6,meshbasic_vert:D6,meshbasic_frag:I6,meshlambert_vert:O6,meshlambert_frag:P6,meshmatcap_vert:L6,meshmatcap_frag:N6,meshnormal_vert:F6,meshnormal_frag:z6,meshphong_vert:k6,meshphong_frag:B6,meshphysical_vert:U6,meshphysical_frag:H6,meshtoon_vert:V6,meshtoon_frag:q6,points_vert:G6,points_frag:$6,shadow_vert:W6,shadow_frag:Y6,sprite_vert:K6,sprite_frag:X6},vt={common:{diffuse:{value:new xn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Jt},alphaMap:{value:null},alphaMapTransform:{value:new Jt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Jt}},envmap:{envMap:{value:null},envMapRotation:{value:new Jt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Jt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Jt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Jt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Jt},normalScale:{value:new Xt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Jt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Jt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Jt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Jt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Jt},alphaTest:{value:0},uvTransform:{value:new Jt}},sprite:{diffuse:{value:new xn(16777215)},opacity:{value:1},center:{value:new Xt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Jt},alphaMap:{value:null},alphaMapTransform:{value:new Jt},alphaTest:{value:0}}},$s={basic:{uniforms:fa([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.fog]),vertexShader:nn.meshbasic_vert,fragmentShader:nn.meshbasic_frag},lambert:{uniforms:fa([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new xn(0)}}]),vertexShader:nn.meshlambert_vert,fragmentShader:nn.meshlambert_frag},phong:{uniforms:fa([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new xn(0)},specular:{value:new xn(1118481)},shininess:{value:30}}]),vertexShader:nn.meshphong_vert,fragmentShader:nn.meshphong_frag},standard:{uniforms:fa([vt.common,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.roughnessmap,vt.metalnessmap,vt.fog,vt.lights,{emissive:{value:new xn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:nn.meshphysical_vert,fragmentShader:nn.meshphysical_frag},toon:{uniforms:fa([vt.common,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.gradientmap,vt.fog,vt.lights,{emissive:{value:new xn(0)}}]),vertexShader:nn.meshtoon_vert,fragmentShader:nn.meshtoon_frag},matcap:{uniforms:fa([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,{matcap:{value:null}}]),vertexShader:nn.meshmatcap_vert,fragmentShader:nn.meshmatcap_frag},points:{uniforms:fa([vt.points,vt.fog]),vertexShader:nn.points_vert,fragmentShader:nn.points_frag},dashed:{uniforms:fa([vt.common,vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:nn.linedashed_vert,fragmentShader:nn.linedashed_frag},depth:{uniforms:fa([vt.common,vt.displacementmap]),vertexShader:nn.depth_vert,fragmentShader:nn.depth_frag},normal:{uniforms:fa([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,{opacity:{value:1}}]),vertexShader:nn.meshnormal_vert,fragmentShader:nn.meshnormal_frag},sprite:{uniforms:fa([vt.sprite,vt.fog]),vertexShader:nn.sprite_vert,fragmentShader:nn.sprite_frag},background:{uniforms:{uvTransform:{value:new Jt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:nn.background_vert,fragmentShader:nn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Jt}},vertexShader:nn.backgroundCube_vert,fragmentShader:nn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:nn.cube_vert,fragmentShader:nn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:nn.equirect_vert,fragmentShader:nn.equirect_frag},distance:{uniforms:fa([vt.common,vt.displacementmap,{referencePosition:{value:new Re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:nn.distance_vert,fragmentShader:nn.distance_frag},shadow:{uniforms:fa([vt.lights,vt.fog,{color:{value:new xn(0)},opacity:{value:1}}]),vertexShader:nn.shadow_vert,fragmentShader:nn.shadow_frag}};$s.physical={uniforms:fa([$s.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Jt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Jt},clearcoatNormalScale:{value:new Xt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Jt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Jt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Jt},sheen:{value:0},sheenColor:{value:new xn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Jt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Jt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Jt},transmissionSamplerSize:{value:new Xt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Jt},attenuationDistance:{value:0},attenuationColor:{value:new xn(0)},specularColor:{value:new xn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Jt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Jt},anisotropyVector:{value:new Xt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Jt}}]),vertexShader:nn.meshphysical_vert,fragmentShader:nn.meshphysical_frag};const tp={r:0,b:0,g:0},ll=new ir,Q6=new ai;function Z6(t,e,n,s,o,l,d){const u=new xn(0);let h=l===!0?0:1,p,m,g=null,v=0,C=null;function b(L){let N=L.isScene===!0?L.background:null;return N&&N.isTexture&&(N=(L.backgroundBlurriness>0?n:e).get(N)),N}function _(L){let N=!1;const T=b(L);T===null?S(u,h):T&&T.isColor&&(S(T,1),N=!0);const j=t.xr.getEnvironmentBlendMode();j==="additive"?s.buffers.color.setClear(0,0,0,1,d):j==="alpha-blend"&&s.buffers.color.setClear(0,0,0,0,d),(t.autoClear||N)&&(s.buffers.depth.setTest(!0),s.buffers.depth.setMask(!0),s.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function y(L,N){const T=b(N);T&&(T.isCubeTexture||T.mapping===sm)?(m===void 0&&(m=new ar(new uf(1,1,1),new sr({name:"BackgroundCubeMaterial",uniforms:ed($s.backgroundCube.uniforms),vertexShader:$s.backgroundCube.vertexShader,fragmentShader:$s.backgroundCube.fragmentShader,side:ja,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(j,E,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(m)),ll.copy(N.backgroundRotation),ll.x*=-1,ll.y*=-1,ll.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(ll.y*=-1,ll.z*=-1),m.material.uniforms.envMap.value=T,m.material.uniforms.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=N.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=N.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(Q6.makeRotationFromEuler(ll)),m.material.toneMapped=yn.getTransfer(T.colorSpace)!==On,(g!==T||v!==T.version||C!==t.toneMapping)&&(m.material.needsUpdate=!0,g=T,v=T.version,C=t.toneMapping),m.layers.enableAll(),L.unshift(m,m.geometry,m.material,0,0,null)):T&&T.isTexture&&(p===void 0&&(p=new ar(new rm(2,2),new sr({name:"BackgroundMaterial",uniforms:ed($s.background.uniforms),vertexShader:$s.background.vertexShader,fragmentShader:$s.background.fragmentShader,side:Bo,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(p)),p.material.uniforms.t2D.value=T,p.material.uniforms.backgroundIntensity.value=N.backgroundIntensity,p.material.toneMapped=yn.getTransfer(T.colorSpace)!==On,T.matrixAutoUpdate===!0&&T.updateMatrix(),p.material.uniforms.uvTransform.value.copy(T.matrix),(g!==T||v!==T.version||C!==t.toneMapping)&&(p.material.needsUpdate=!0,g=T,v=T.version,C=t.toneMapping),p.layers.enableAll(),L.unshift(p,p.geometry,p.material,0,0,null))}function S(L,N){L.getRGB(tp,GE(t)),s.buffers.color.setClear(tp.r,tp.g,tp.b,N,d)}function D(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return u},setClearColor:function(L,N=1){u.set(L),h=N,S(u,h)},getClearAlpha:function(){return h},setClearAlpha:function(L){h=L,S(u,h)},render:_,addToRenderList:y,dispose:D}}function J6(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),s={},o=v(null);let l=o,d=!1;function u(I,z,V,O,k){let F=!1;const A=g(O,V,z);l!==A&&(l=A,p(l.object)),F=C(I,O,V,k),F&&b(I,O,V,k),k!==null&&e.update(k,t.ELEMENT_ARRAY_BUFFER),(F||d)&&(d=!1,N(I,z,V,O),k!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(k).buffer))}function h(){return t.createVertexArray()}function p(I){return t.bindVertexArray(I)}function m(I){return t.deleteVertexArray(I)}function g(I,z,V){const O=V.wireframe===!0;let k=s[I.id];k===void 0&&(k={},s[I.id]=k);let F=k[z.id];F===void 0&&(F={},k[z.id]=F);let A=F[O];return A===void 0&&(A=v(h()),F[O]=A),A}function v(I){const z=[],V=[],O=[];for(let k=0;k<n;k++)z[k]=0,V[k]=0,O[k]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:V,attributeDivisors:O,object:I,attributes:{},index:null}}function C(I,z,V,O){const k=l.attributes,F=z.attributes;let A=0;const q=V.getAttributes();for(const B in q)if(q[B].location>=0){const Q=k[B];let ne=F[B];if(ne===void 0&&(B==="instanceMatrix"&&I.instanceMatrix&&(ne=I.instanceMatrix),B==="instanceColor"&&I.instanceColor&&(ne=I.instanceColor)),Q===void 0||Q.attribute!==ne||ne&&Q.data!==ne.data)return!0;A++}return l.attributesNum!==A||l.index!==O}function b(I,z,V,O){const k={},F=z.attributes;let A=0;const q=V.getAttributes();for(const B in q)if(q[B].location>=0){let Q=F[B];Q===void 0&&(B==="instanceMatrix"&&I.instanceMatrix&&(Q=I.instanceMatrix),B==="instanceColor"&&I.instanceColor&&(Q=I.instanceColor));const ne={};ne.attribute=Q,Q&&Q.data&&(ne.data=Q.data),k[B]=ne,A++}l.attributes=k,l.attributesNum=A,l.index=O}function _(){const I=l.newAttributes;for(let z=0,V=I.length;z<V;z++)I[z]=0}function y(I){S(I,0)}function S(I,z){const V=l.newAttributes,O=l.enabledAttributes,k=l.attributeDivisors;V[I]=1,O[I]===0&&(t.enableVertexAttribArray(I),O[I]=1),k[I]!==z&&(t.vertexAttribDivisor(I,z),k[I]=z)}function D(){const I=l.newAttributes,z=l.enabledAttributes;for(let V=0,O=z.length;V<O;V++)z[V]!==I[V]&&(t.disableVertexAttribArray(V),z[V]=0)}function L(I,z,V,O,k,F,A){A===!0?t.vertexAttribIPointer(I,z,V,k,F):t.vertexAttribPointer(I,z,V,O,k,F)}function N(I,z,V,O){_();const k=O.attributes,F=V.getAttributes(),A=z.defaultAttributeValues;for(const q in F){const B=F[q];if(B.location>=0){let W=k[q];if(W===void 0&&(q==="instanceMatrix"&&I.instanceMatrix&&(W=I.instanceMatrix),q==="instanceColor"&&I.instanceColor&&(W=I.instanceColor)),W!==void 0){const Q=W.normalized,ne=W.itemSize,de=e.get(W);if(de===void 0)continue;const $=de.buffer,X=de.type,le=de.bytesPerElement,oe=X===t.INT||X===t.UNSIGNED_INT||W.gpuType===e_;if(W.isInterleavedBufferAttribute){const ue=W.data,Ye=ue.stride,ae=W.offset;if(ue.isInstancedInterleavedBuffer){for(let fe=0;fe<B.locationSize;fe++)S(B.location+fe,ue.meshPerAttribute);I.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let fe=0;fe<B.locationSize;fe++)y(B.location+fe);t.bindBuffer(t.ARRAY_BUFFER,$);for(let fe=0;fe<B.locationSize;fe++)L(B.location+fe,ne/B.locationSize,X,Q,Ye*le,(ae+ne/B.locationSize*fe)*le,oe)}else{if(W.isInstancedBufferAttribute){for(let ue=0;ue<B.locationSize;ue++)S(B.location+ue,W.meshPerAttribute);I.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=W.meshPerAttribute*W.count)}else for(let ue=0;ue<B.locationSize;ue++)y(B.location+ue);t.bindBuffer(t.ARRAY_BUFFER,$);for(let ue=0;ue<B.locationSize;ue++)L(B.location+ue,ne/B.locationSize,X,Q,ne*le,ne/B.locationSize*ue*le,oe)}}else if(A!==void 0){const Q=A[q];if(Q!==void 0)switch(Q.length){case 2:t.vertexAttrib2fv(B.location,Q);break;case 3:t.vertexAttrib3fv(B.location,Q);break;case 4:t.vertexAttrib4fv(B.location,Q);break;default:t.vertexAttrib1fv(B.location,Q)}}}}D()}function T(){R();for(const I in s){const z=s[I];for(const V in z){const O=z[V];for(const k in O)m(O[k].object),delete O[k];delete z[V]}delete s[I]}}function j(I){if(s[I.id]===void 0)return;const z=s[I.id];for(const V in z){const O=z[V];for(const k in O)m(O[k].object),delete O[k];delete z[V]}delete s[I.id]}function E(I){for(const z in s){const V=s[z];if(V[I.id]===void 0)continue;const O=V[I.id];for(const k in O)m(O[k].object),delete O[k];delete V[I.id]}}function R(){M(),d=!0,l!==o&&(l=o,p(l.object))}function M(){o.geometry=null,o.program=null,o.wireframe=!1}return{setup:u,reset:R,resetDefaultState:M,dispose:T,releaseStatesOfGeometry:j,releaseStatesOfProgram:E,initAttributes:_,enableAttribute:y,disableUnusedAttributes:D}}function e5(t,e,n){let s;function o(p){s=p}function l(p,m){t.drawArrays(s,p,m),n.update(m,s,1)}function d(p,m,g){g!==0&&(t.drawArraysInstanced(s,p,m,g),n.update(m,s,g))}function u(p,m,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(s,p,0,m,0,g);let C=0;for(let b=0;b<g;b++)C+=m[b];n.update(C,s,1)}function h(p,m,g,v){if(g===0)return;const C=e.get("WEBGL_multi_draw");if(C===null)for(let b=0;b<p.length;b++)d(p[b],m[b],v[b]);else{C.multiDrawArraysInstancedWEBGL(s,p,0,m,0,v,0,g);let b=0;for(let _=0;_<g;_++)b+=m[_]*v[_];n.update(b,s,1)}}this.setMode=o,this.render=l,this.renderInstances=d,this.renderMultiDraw=u,this.renderMultiDrawInstances=h}function t5(t,e,n,s){let o;function l(){if(o!==void 0)return o;if(e.has("EXT_texture_filter_anisotropic")===!0){const E=e.get("EXT_texture_filter_anisotropic");o=t.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function d(E){return!(E!==Ds&&s.convert(E)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function u(E){const R=E===Kr&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(E!==Va&&s.convert(E)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&E!==Ks&&!R)}function h(E){if(E==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=n.precision!==void 0?n.precision:"highp";const m=h(p);m!==p&&($t("WebGLRenderer:",p,"not supported, using",m,"instead."),p=m);const g=n.logarithmicDepthBuffer===!0,v=n.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),C=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),b=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=t.getParameter(t.MAX_TEXTURE_SIZE),y=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),S=t.getParameter(t.MAX_VERTEX_ATTRIBS),D=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),L=t.getParameter(t.MAX_VARYING_VECTORS),N=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),T=t.getParameter(t.MAX_SAMPLES),j=t.getParameter(t.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:l,getMaxPrecision:h,textureFormatReadable:d,textureTypeReadable:u,precision:p,logarithmicDepthBuffer:g,reversedDepthBuffer:v,maxTextures:C,maxVertexTextures:b,maxTextureSize:_,maxCubemapSize:y,maxAttributes:S,maxVertexUniforms:D,maxVaryings:L,maxFragmentUniforms:N,maxSamples:T,samples:j}}function n5(t){const e=this;let n=null,s=0,o=!1,l=!1;const d=new Do,u=new Jt,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(g,v){const C=g.length!==0||v||s!==0||o;return o=v,s=g.length,C},this.beginShadows=function(){l=!0,m(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(g,v){n=m(g,v,0)},this.setState=function(g,v,C){const b=g.clippingPlanes,_=g.clipIntersection,y=g.clipShadows,S=t.get(g);if(!o||b===null||b.length===0||l&&!y)l?m(null):p();else{const D=l?0:s,L=D*4;let N=S.clippingState||null;h.value=N,N=m(b,v,L,C);for(let T=0;T!==L;++T)N[T]=n[T];S.clippingState=N,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=D}};function p(){h.value!==n&&(h.value=n,h.needsUpdate=s>0),e.numPlanes=s,e.numIntersection=0}function m(g,v,C,b){const _=g!==null?g.length:0;let y=null;if(_!==0){if(y=h.value,b!==!0||y===null){const S=C+_*4,D=v.matrixWorldInverse;u.getNormalMatrix(D),(y===null||y.length<S)&&(y=new Float32Array(S));for(let L=0,N=C;L!==_;++L,N+=4)d.copy(g[L]).applyMatrix4(D,u),d.normal.toArray(y,N),y[N+3]=d.constant}h.value=y,h.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,y}}function i5(t){let e=new WeakMap;function n(d,u){return u===R0?d.mapping=Rl:u===D0&&(d.mapping=Qc),d}function s(d){if(d&&d.isTexture){const u=d.mapping;if(u===R0||u===D0)if(e.has(d)){const h=e.get(d).texture;return n(h,d.mapping)}else{const h=d.image;if(h&&h.height>0){const p=new YE(h.height);return p.fromEquirectangularTexture(t,d),e.set(d,p),d.addEventListener("dispose",o),n(p.texture,d.mapping)}else return null}}return d}function o(d){const u=d.target;u.removeEventListener("dispose",o);const h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}function l(){e=new WeakMap}return{get:s,dispose:l}}const Lo=4,CC=[.125,.215,.35,.446,.526,.582],hl=20,a5=256,xu=new f_,TC=new xn;let Sy=null,My=0,wy=0,Cy=!1;const s5=new Re;class jC{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,n=0,s=.1,o=100,l={}){const{size:d=256,position:u=s5}=l;Sy=this._renderer.getRenderTarget(),My=this._renderer.getActiveCubeFace(),wy=this._renderer.getActiveMipmapLevel(),Cy=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(d);const h=this._allocateTargets();return h.depthBuffer=!0,this._sceneToCubeUV(e,s,o,h,u),n>0&&this._blur(h,0,0,n),this._applyPMREM(h),this._cleanup(h),h}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=RC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=AC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(Sy,My,wy),this._renderer.xr.enabled=Cy,e.scissorTest=!1,Ec(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Rl||e.mapping===Qc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Sy=this._renderer.getRenderTarget(),My=this._renderer.getActiveCubeFace(),wy=this._renderer.getActiveMipmapLevel(),Cy=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const s=n||this._allocateTargets();return this._textureToCubeUV(e,s),this._applyPMREM(s),this._cleanup(s),s}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,s={magFilter:sa,minFilter:sa,generateMipmaps:!1,type:Kr,format:Ds,colorSpace:Jc,depthBuffer:!1},o=EC(e,n,s);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=EC(e,n,s);const{_lodMax:l}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=r5(l)),this._blurMaterial=l5(l,e,n),this._ggxMaterial=o5(l,e,n)}return o}_compileMaterial(e){const n=new ar(new Ns,e);this._renderer.compile(n,xu)}_sceneToCubeUV(e,n,s,o,l){const h=new ds(90,1,n,s),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],g=this._renderer,v=g.autoClear,C=g.toneMapping;g.getClearColor(TC),g.toneMapping=Zs,g.autoClear=!1,g.state.buffers.depth.getReversed()&&(g.setRenderTarget(o),g.clearDepth(),g.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new ar(new uf,new HE({name:"PMREM.Background",side:ja,depthWrite:!1,depthTest:!1})));const _=this._backgroundBox,y=_.material;let S=!1;const D=e.background;D?D.isColor&&(y.color.copy(D),e.background=null,S=!0):(y.color.copy(TC),S=!0);for(let L=0;L<6;L++){const N=L%3;N===0?(h.up.set(0,p[L],0),h.position.set(l.x,l.y,l.z),h.lookAt(l.x+m[L],l.y,l.z)):N===1?(h.up.set(0,0,p[L]),h.position.set(l.x,l.y,l.z),h.lookAt(l.x,l.y+m[L],l.z)):(h.up.set(0,p[L],0),h.position.set(l.x,l.y,l.z),h.lookAt(l.x,l.y,l.z+m[L]));const T=this._cubeSize;Ec(o,N*T,L>2?T:0,T,T),g.setRenderTarget(o),S&&g.render(_,h),g.render(e,h)}g.toneMapping=C,g.autoClear=v,e.background=D}_textureToCubeUV(e,n){const s=this._renderer,o=e.mapping===Rl||e.mapping===Qc;o?(this._cubemapMaterial===null&&(this._cubemapMaterial=RC()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=AC());const l=o?this._cubemapMaterial:this._equirectMaterial,d=this._lodMeshes[0];d.material=l;const u=l.uniforms;u.envMap.value=e;const h=this._cubeSize;Ec(n,0,0,3*h,2*h),s.setRenderTarget(n),s.render(d,xu)}_applyPMREM(e){const n=this._renderer,s=n.autoClear;n.autoClear=!1;const o=this._lodMeshes.length;for(let l=1;l<o;l++)this._applyGGXFilter(e,l-1,l);n.autoClear=s}_applyGGXFilter(e,n,s){const o=this._renderer,l=this._pingPongRenderTarget,d=this._ggxMaterial,u=this._lodMeshes[s];u.material=d;const h=d.uniforms,p=s/(this._lodMeshes.length-1),m=n/(this._lodMeshes.length-1),g=Math.sqrt(p*p-m*m),v=0+p*1.25,C=g*v,{_lodMax:b}=this,_=this._sizeLods[s],y=3*_*(s>b-Lo?s-b+Lo:0),S=4*(this._cubeSize-_);h.envMap.value=e.texture,h.roughness.value=C,h.mipInt.value=b-n,Ec(l,y,S,3*_,2*_),o.setRenderTarget(l),o.render(u,xu),h.envMap.value=l.texture,h.roughness.value=0,h.mipInt.value=b-s,Ec(e,y,S,3*_,2*_),o.setRenderTarget(e),o.render(u,xu)}_blur(e,n,s,o,l){const d=this._pingPongRenderTarget;this._halfBlur(e,d,n,s,o,"latitudinal",l),this._halfBlur(d,e,s,s,o,"longitudinal",l)}_halfBlur(e,n,s,o,l,d,u){const h=this._renderer,p=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&Sn("blur direction must be either latitudinal or longitudinal!");const m=3,g=this._lodMeshes[o];g.material=p;const v=p.uniforms,C=this._sizeLods[s]-1,b=isFinite(l)?Math.PI/(2*C):2*Math.PI/(2*hl-1),_=l/b,y=isFinite(l)?1+Math.floor(m*_):hl;y>hl&&$t(`sigmaRadians, ${l}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${hl}`);const S=[];let D=0;for(let E=0;E<hl;++E){const R=E/_,M=Math.exp(-R*R/2);S.push(M),E===0?D+=M:E<y&&(D+=2*M)}for(let E=0;E<S.length;E++)S[E]=S[E]/D;v.envMap.value=e.texture,v.samples.value=y,v.weights.value=S,v.latitudinal.value=d==="latitudinal",u&&(v.poleAxis.value=u);const{_lodMax:L}=this;v.dTheta.value=b,v.mipInt.value=L-s;const N=this._sizeLods[o],T=3*N*(o>L-Lo?o-L+Lo:0),j=4*(this._cubeSize-N);Ec(n,T,j,3*N,2*N),h.setRenderTarget(n),h.render(g,xu)}}function r5(t){const e=[],n=[],s=[];let o=t;const l=t-Lo+1+CC.length;for(let d=0;d<l;d++){const u=Math.pow(2,o);e.push(u);let h=1/u;d>t-Lo?h=CC[d-t+Lo-1]:d===0&&(h=0),n.push(h);const p=1/(u-2),m=-p,g=1+p,v=[m,m,g,m,g,g,m,m,g,g,m,g],C=6,b=6,_=3,y=2,S=1,D=new Float32Array(_*b*C),L=new Float32Array(y*b*C),N=new Float32Array(S*b*C);for(let j=0;j<C;j++){const E=j%3*2/3-1,R=j>2?0:-1,M=[E,R,0,E+2/3,R,0,E+2/3,R+1,0,E,R,0,E+2/3,R+1,0,E,R+1,0];D.set(M,_*b*j),L.set(v,y*b*j);const I=[j,j,j,j,j,j];N.set(I,S*b*j)}const T=new Ns;T.setAttribute("position",new $a(D,_)),T.setAttribute("uv",new $a(L,y)),T.setAttribute("faceIndex",new $a(N,S)),s.push(new ar(T,null)),o>Lo&&o--}return{lodMeshes:s,sizeLods:e,sigmas:n}}function EC(t,e,n){const s=new Js(t,e,n);return s.texture.mapping=sm,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function Ec(t,e,n,s,o){t.viewport.set(e,n,s,o),t.scissor.set(e,n,s,o)}function o5(t,e,n){return new sr({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:a5,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:om(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Vr,depthTest:!1,depthWrite:!1})}function l5(t,e,n){const s=new Float32Array(hl),o=new Re(0,1,0);return new sr({name:"SphericalGaussianBlur",defines:{n:hl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:om(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Vr,depthTest:!1,depthWrite:!1})}function AC(){return new sr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:om(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Vr,depthTest:!1,depthWrite:!1})}function RC(){return new sr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:om(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Vr,depthTest:!1,depthWrite:!1})}function om(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function c5(t){let e=new WeakMap,n=null;function s(u){if(u&&u.isTexture){const h=u.mapping,p=h===R0||h===D0,m=h===Rl||h===Qc;if(p||m){let g=e.get(u);const v=g!==void 0?g.texture.pmremVersion:0;if(u.isRenderTargetTexture&&u.pmremVersion!==v)return n===null&&(n=new jC(t)),g=p?n.fromEquirectangular(u,g):n.fromCubemap(u,g),g.texture.pmremVersion=u.pmremVersion,e.set(u,g),g.texture;if(g!==void 0)return g.texture;{const C=u.image;return p&&C&&C.height>0||m&&C&&o(C)?(n===null&&(n=new jC(t)),g=p?n.fromEquirectangular(u):n.fromCubemap(u),g.texture.pmremVersion=u.pmremVersion,e.set(u,g),u.addEventListener("dispose",l),g.texture):null}}}return u}function o(u){let h=0;const p=6;for(let m=0;m<p;m++)u[m]!==void 0&&h++;return h===p}function l(u){const h=u.target;h.removeEventListener("dispose",l);const p=e.get(h);p!==void 0&&(e.delete(h),p.dispose())}function d(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:s,dispose:d}}function d5(t){const e={};function n(s){if(e[s]!==void 0)return e[s];const o=t.getExtension(s);return e[s]=o,o}return{has:function(s){return n(s)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(s){const o=n(s);return o===null&&Vu("WebGLRenderer: "+s+" extension not supported."),o}}}function u5(t,e,n,s){const o={},l=new WeakMap;function d(g){const v=g.target;v.index!==null&&e.remove(v.index);for(const b in v.attributes)e.remove(v.attributes[b]);v.removeEventListener("dispose",d),delete o[v.id];const C=l.get(v);C&&(e.remove(C),l.delete(v)),s.releaseStatesOfGeometry(v),v.isInstancedBufferGeometry===!0&&delete v._maxInstanceCount,n.memory.geometries--}function u(g,v){return o[v.id]===!0||(v.addEventListener("dispose",d),o[v.id]=!0,n.memory.geometries++),v}function h(g){const v=g.attributes;for(const C in v)e.update(v[C],t.ARRAY_BUFFER)}function p(g){const v=[],C=g.index,b=g.attributes.position;let _=0;if(C!==null){const D=C.array;_=C.version;for(let L=0,N=D.length;L<N;L+=3){const T=D[L+0],j=D[L+1],E=D[L+2];v.push(T,j,j,E,E,T)}}else if(b!==void 0){const D=b.array;_=b.version;for(let L=0,N=D.length/3-1;L<N;L+=3){const T=L+0,j=L+1,E=L+2;v.push(T,j,j,E,E,T)}}else return;const y=new(FE(v)?qE:VE)(v,1);y.version=_;const S=l.get(g);S&&e.remove(S),l.set(g,y)}function m(g){const v=l.get(g);if(v){const C=g.index;C!==null&&v.version<C.version&&p(g)}else p(g);return l.get(g)}return{get:u,update:h,getWireframeAttribute:m}}function f5(t,e,n){let s;function o(v){s=v}let l,d;function u(v){l=v.type,d=v.bytesPerElement}function h(v,C){t.drawElements(s,C,l,v*d),n.update(C,s,1)}function p(v,C,b){b!==0&&(t.drawElementsInstanced(s,C,l,v*d,b),n.update(C,s,b))}function m(v,C,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(s,C,0,l,v,0,b);let y=0;for(let S=0;S<b;S++)y+=C[S];n.update(y,s,1)}function g(v,C,b,_){if(b===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let S=0;S<v.length;S++)p(v[S]/d,C[S],_[S]);else{y.multiDrawElementsInstancedWEBGL(s,C,0,l,v,0,_,0,b);let S=0;for(let D=0;D<b;D++)S+=C[D]*_[D];n.update(S,s,1)}}this.setMode=o,this.setIndex=u,this.render=h,this.renderInstances=p,this.renderMultiDraw=m,this.renderMultiDrawInstances=g}function h5(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function s(l,d,u){switch(n.calls++,d){case t.TRIANGLES:n.triangles+=u*(l/3);break;case t.LINES:n.lines+=u*(l/2);break;case t.LINE_STRIP:n.lines+=u*(l-1);break;case t.LINE_LOOP:n.lines+=u*l;break;case t.POINTS:n.points+=u*l;break;default:Sn("WebGLInfo: Unknown draw mode:",d);break}}function o(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:o,update:s}}function p5(t,e,n){const s=new WeakMap,o=new ii;function l(d,u,h){const p=d.morphTargetInfluences,m=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,g=m!==void 0?m.length:0;let v=s.get(u);if(v===void 0||v.count!==g){let M=function(){E.dispose(),s.delete(u),u.removeEventListener("dispose",M)};v!==void 0&&v.texture.dispose();const C=u.morphAttributes.position!==void 0,b=u.morphAttributes.normal!==void 0,_=u.morphAttributes.color!==void 0,y=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],D=u.morphAttributes.color||[];let L=0;C===!0&&(L=1),b===!0&&(L=2),_===!0&&(L=3);let N=u.attributes.position.count*L,T=1;N>e.maxTextureSize&&(T=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const j=new Float32Array(N*T*4*g),E=new zE(j,N,T,g);E.type=Ks,E.needsUpdate=!0;const R=L*4;for(let I=0;I<g;I++){const z=y[I],V=S[I],O=D[I],k=N*T*4*I;for(let F=0;F<z.count;F++){const A=F*R;C===!0&&(o.fromBufferAttribute(z,F),j[k+A+0]=o.x,j[k+A+1]=o.y,j[k+A+2]=o.z,j[k+A+3]=0),b===!0&&(o.fromBufferAttribute(V,F),j[k+A+4]=o.x,j[k+A+5]=o.y,j[k+A+6]=o.z,j[k+A+7]=0),_===!0&&(o.fromBufferAttribute(O,F),j[k+A+8]=o.x,j[k+A+9]=o.y,j[k+A+10]=o.z,j[k+A+11]=O.itemSize===4?o.w:1)}}v={count:g,texture:E,size:new Xt(N,T)},s.set(u,v),u.addEventListener("dispose",M)}if(d.isInstancedMesh===!0&&d.morphTexture!==null)h.getUniforms().setValue(t,"morphTexture",d.morphTexture,n);else{let C=0;for(let _=0;_<p.length;_++)C+=p[_];const b=u.morphTargetsRelative?1:1-C;h.getUniforms().setValue(t,"morphTargetBaseInfluence",b),h.getUniforms().setValue(t,"morphTargetInfluences",p)}h.getUniforms().setValue(t,"morphTargetsTexture",v.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",v.size)}return{update:l}}function m5(t,e,n,s){let o=new WeakMap;function l(h){const p=s.render.frame,m=h.geometry,g=e.get(h,m);if(o.get(g)!==p&&(e.update(g),o.set(g,p)),h.isInstancedMesh&&(h.hasEventListener("dispose",u)===!1&&h.addEventListener("dispose",u),o.get(h)!==p&&(n.update(h.instanceMatrix,t.ARRAY_BUFFER),h.instanceColor!==null&&n.update(h.instanceColor,t.ARRAY_BUFFER),o.set(h,p))),h.isSkinnedMesh){const v=h.skeleton;o.get(v)!==p&&(v.update(),o.set(v,p))}return g}function d(){o=new WeakMap}function u(h){const p=h.target;p.removeEventListener("dispose",u),n.remove(p.instanceMatrix),p.instanceColor!==null&&n.remove(p.instanceColor)}return{update:l,dispose:d}}const g5={[bE]:"LINEAR_TONE_MAPPING",[SE]:"REINHARD_TONE_MAPPING",[ME]:"CINEON_TONE_MAPPING",[wE]:"ACES_FILMIC_TONE_MAPPING",[TE]:"AGX_TONE_MAPPING",[jE]:"NEUTRAL_TONE_MAPPING",[CE]:"CUSTOM_TONE_MAPPING"};function x5(t,e,n,s,o){const l=new Js(e,n,{type:t,depthBuffer:s,stencilBuffer:o}),d=new Js(e,n,{type:Kr,depthBuffer:!1,stencilBuffer:!1}),u=new Ns;u.setAttribute("position",new Os([-1,3,0,-1,-1,0,3,-1,0],3)),u.setAttribute("uv",new Os([0,2,0,0,2,0],2));const h=new i4({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),p=new ar(u,h),m=new f_(-1,1,1,-1,0,1);let g=null,v=null,C=!1,b,_=null,y=[],S=!1;this.setSize=function(D,L){l.setSize(D,L),d.setSize(D,L);for(let N=0;N<y.length;N++){const T=y[N];T.setSize&&T.setSize(D,L)}},this.setEffects=function(D){y=D,S=y.length>0&&y[0].isRenderPass===!0;const L=l.width,N=l.height;for(let T=0;T<y.length;T++){const j=y[T];j.setSize&&j.setSize(L,N)}},this.begin=function(D,L){if(C||D.toneMapping===Zs&&y.length===0)return!1;if(_=L,L!==null){const N=L.width,T=L.height;(l.width!==N||l.height!==T)&&this.setSize(N,T)}return S===!1&&D.setRenderTarget(l),b=D.toneMapping,D.toneMapping=Zs,!0},this.hasRenderPass=function(){return S},this.end=function(D,L){D.toneMapping=b,C=!0;let N=l,T=d;for(let j=0;j<y.length;j++){const E=y[j];if(E.enabled!==!1&&(E.render(D,T,N,L),E.needsSwap!==!1)){const R=N;N=T,T=R}}if(g!==D.outputColorSpace||v!==D.toneMapping){g=D.outputColorSpace,v=D.toneMapping,h.defines={},yn.getTransfer(g)===On&&(h.defines.SRGB_TRANSFER="");const j=g5[v];j&&(h.defines[j]=""),h.needsUpdate=!0}h.uniforms.tDiffuse.value=N.texture,D.setRenderTarget(_),D.render(p,m),_=null,C=!1},this.isCompositing=function(){return C},this.dispose=function(){l.dispose(),d.dispose(),u.dispose(),h.dispose()}}const ZE=new ma,hv=new qu(1,1),JE=new zE,e2=new OB,t2=new WE,DC=[],IC=[],OC=new Float32Array(16),PC=new Float32Array(9),LC=new Float32Array(4);function od(t,e,n){const s=t[0];if(s<=0||s>0)return t;const o=e*n;let l=DC[o];if(l===void 0&&(l=new Float32Array(o),DC[o]=l),e!==0){s.toArray(l,0);for(let d=1,u=0;d!==e;++d)u+=n,t[d].toArray(l,u)}return l}function Ti(t,e){if(t.length!==e.length)return!1;for(let n=0,s=t.length;n<s;n++)if(t[n]!==e[n])return!1;return!0}function ji(t,e){for(let n=0,s=e.length;n<s;n++)t[n]=e[n]}function lm(t,e){let n=IC[e];n===void 0&&(n=new Int32Array(e),IC[e]=n);for(let s=0;s!==e;++s)n[s]=t.allocateTextureUnit();return n}function y5(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function v5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ti(n,e))return;t.uniform2fv(this.addr,e),ji(n,e)}}function _5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Ti(n,e))return;t.uniform3fv(this.addr,e),ji(n,e)}}function b5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ti(n,e))return;t.uniform4fv(this.addr,e),ji(n,e)}}function S5(t,e){const n=this.cache,s=e.elements;if(s===void 0){if(Ti(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),ji(n,e)}else{if(Ti(n,s))return;LC.set(s),t.uniformMatrix2fv(this.addr,!1,LC),ji(n,s)}}function M5(t,e){const n=this.cache,s=e.elements;if(s===void 0){if(Ti(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),ji(n,e)}else{if(Ti(n,s))return;PC.set(s),t.uniformMatrix3fv(this.addr,!1,PC),ji(n,s)}}function w5(t,e){const n=this.cache,s=e.elements;if(s===void 0){if(Ti(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),ji(n,e)}else{if(Ti(n,s))return;OC.set(s),t.uniformMatrix4fv(this.addr,!1,OC),ji(n,s)}}function C5(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function T5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ti(n,e))return;t.uniform2iv(this.addr,e),ji(n,e)}}function j5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Ti(n,e))return;t.uniform3iv(this.addr,e),ji(n,e)}}function E5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ti(n,e))return;t.uniform4iv(this.addr,e),ji(n,e)}}function A5(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function R5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ti(n,e))return;t.uniform2uiv(this.addr,e),ji(n,e)}}function D5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Ti(n,e))return;t.uniform3uiv(this.addr,e),ji(n,e)}}function I5(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ti(n,e))return;t.uniform4uiv(this.addr,e),ji(n,e)}}function O5(t,e,n){const s=this.cache,o=n.allocateTextureUnit();s[0]!==o&&(t.uniform1i(this.addr,o),s[0]=o);let l;this.type===t.SAMPLER_2D_SHADOW?(hv.compareFunction=n.isReversedDepthBuffer()?o_:r_,l=hv):l=ZE,n.setTexture2D(e||l,o)}function P5(t,e,n){const s=this.cache,o=n.allocateTextureUnit();s[0]!==o&&(t.uniform1i(this.addr,o),s[0]=o),n.setTexture3D(e||e2,o)}function L5(t,e,n){const s=this.cache,o=n.allocateTextureUnit();s[0]!==o&&(t.uniform1i(this.addr,o),s[0]=o),n.setTextureCube(e||t2,o)}function N5(t,e,n){const s=this.cache,o=n.allocateTextureUnit();s[0]!==o&&(t.uniform1i(this.addr,o),s[0]=o),n.setTexture2DArray(e||JE,o)}function F5(t){switch(t){case 5126:return y5;case 35664:return v5;case 35665:return _5;case 35666:return b5;case 35674:return S5;case 35675:return M5;case 35676:return w5;case 5124:case 35670:return C5;case 35667:case 35671:return T5;case 35668:case 35672:return j5;case 35669:case 35673:return E5;case 5125:return A5;case 36294:return R5;case 36295:return D5;case 36296:return I5;case 35678:case 36198:case 36298:case 36306:case 35682:return O5;case 35679:case 36299:case 36307:return P5;case 35680:case 36300:case 36308:case 36293:return L5;case 36289:case 36303:case 36311:case 36292:return N5}}function z5(t,e){t.uniform1fv(this.addr,e)}function k5(t,e){const n=od(e,this.size,2);t.uniform2fv(this.addr,n)}function B5(t,e){const n=od(e,this.size,3);t.uniform3fv(this.addr,n)}function U5(t,e){const n=od(e,this.size,4);t.uniform4fv(this.addr,n)}function H5(t,e){const n=od(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function V5(t,e){const n=od(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function q5(t,e){const n=od(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function G5(t,e){t.uniform1iv(this.addr,e)}function $5(t,e){t.uniform2iv(this.addr,e)}function W5(t,e){t.uniform3iv(this.addr,e)}function Y5(t,e){t.uniform4iv(this.addr,e)}function K5(t,e){t.uniform1uiv(this.addr,e)}function X5(t,e){t.uniform2uiv(this.addr,e)}function Q5(t,e){t.uniform3uiv(this.addr,e)}function Z5(t,e){t.uniform4uiv(this.addr,e)}function J5(t,e,n){const s=this.cache,o=e.length,l=lm(n,o);Ti(s,l)||(t.uniform1iv(this.addr,l),ji(s,l));let d;this.type===t.SAMPLER_2D_SHADOW?d=hv:d=ZE;for(let u=0;u!==o;++u)n.setTexture2D(e[u]||d,l[u])}function e8(t,e,n){const s=this.cache,o=e.length,l=lm(n,o);Ti(s,l)||(t.uniform1iv(this.addr,l),ji(s,l));for(let d=0;d!==o;++d)n.setTexture3D(e[d]||e2,l[d])}function t8(t,e,n){const s=this.cache,o=e.length,l=lm(n,o);Ti(s,l)||(t.uniform1iv(this.addr,l),ji(s,l));for(let d=0;d!==o;++d)n.setTextureCube(e[d]||t2,l[d])}function n8(t,e,n){const s=this.cache,o=e.length,l=lm(n,o);Ti(s,l)||(t.uniform1iv(this.addr,l),ji(s,l));for(let d=0;d!==o;++d)n.setTexture2DArray(e[d]||JE,l[d])}function i8(t){switch(t){case 5126:return z5;case 35664:return k5;case 35665:return B5;case 35666:return U5;case 35674:return H5;case 35675:return V5;case 35676:return q5;case 5124:case 35670:return G5;case 35667:case 35671:return $5;case 35668:case 35672:return W5;case 35669:case 35673:return Y5;case 5125:return K5;case 36294:return X5;case 36295:return Q5;case 36296:return Z5;case 35678:case 36198:case 36298:case 36306:case 35682:return J5;case 35679:case 36299:case 36307:return e8;case 35680:case 36300:case 36308:case 36293:return t8;case 36289:case 36303:case 36311:case 36292:return n8}}class a8{constructor(e,n,s){this.id=e,this.addr=s,this.cache=[],this.type=n.type,this.setValue=F5(n.type)}}class s8{constructor(e,n,s){this.id=e,this.addr=s,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=i8(n.type)}}class r8{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,s){const o=this.seq;for(let l=0,d=o.length;l!==d;++l){const u=o[l];u.setValue(e,n[u.id],s)}}}const Ty=/(\w+)(\])?(\[|\.)?/g;function NC(t,e){t.seq.push(e),t.map[e.id]=e}function o8(t,e,n){const s=t.name,o=s.length;for(Ty.lastIndex=0;;){const l=Ty.exec(s),d=Ty.lastIndex;let u=l[1];const h=l[2]==="]",p=l[3];if(h&&(u=u|0),p===void 0||p==="["&&d+2===o){NC(n,p===void 0?new a8(u,t,e):new s8(u,t,e));break}else{let g=n.map[u];g===void 0&&(g=new r8(u),NC(n,g)),n=g}}}class Ip{constructor(e,n){this.seq=[],this.map={};const s=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let d=0;d<s;++d){const u=e.getActiveUniform(n,d),h=e.getUniformLocation(n,u.name);o8(u,h,this)}const o=[],l=[];for(const d of this.seq)d.type===e.SAMPLER_2D_SHADOW||d.type===e.SAMPLER_CUBE_SHADOW||d.type===e.SAMPLER_2D_ARRAY_SHADOW?o.push(d):l.push(d);o.length>0&&(this.seq=o.concat(l))}setValue(e,n,s,o){const l=this.map[n];l!==void 0&&l.setValue(e,s,o)}setOptional(e,n,s){const o=n[s];o!==void 0&&this.setValue(e,s,o)}static upload(e,n,s,o){for(let l=0,d=n.length;l!==d;++l){const u=n[l],h=s[u.id];h.needsUpdate!==!1&&u.setValue(e,h.value,o)}}static seqWithValue(e,n){const s=[];for(let o=0,l=e.length;o!==l;++o){const d=e[o];d.id in n&&s.push(d)}return s}}function FC(t,e,n){const s=t.createShader(e);return t.shaderSource(s,n),t.compileShader(s),s}const l8=37297;let c8=0;function d8(t,e){const n=t.split(`
`),s=[],o=Math.max(e-6,0),l=Math.min(e+6,n.length);for(let d=o;d<l;d++){const u=d+1;s.push(`${u===e?">":" "} ${u}: ${n[d]}`)}return s.join(`
`)}const zC=new Jt;function u8(t){yn._getMatrix(zC,yn.workingColorSpace,t);const e=`mat3( ${zC.elements.map(n=>n.toFixed(4))} )`;switch(yn.getTransfer(t)){case $p:return[e,"LinearTransferOETF"];case On:return[e,"sRGBTransferOETF"];default:return $t("WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function kC(t,e,n){const s=t.getShaderParameter(e,t.COMPILE_STATUS),l=(t.getShaderInfoLog(e)||"").trim();if(s&&l==="")return"";const d=/ERROR: 0:(\d+)/.exec(l);if(d){const u=parseInt(d[1]);return n.toUpperCase()+`

`+l+`

`+d8(t.getShaderSource(e),u)}else return l}function f8(t,e){const n=u8(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}const h8={[bE]:"Linear",[SE]:"Reinhard",[ME]:"Cineon",[wE]:"ACESFilmic",[TE]:"AgX",[jE]:"Neutral",[CE]:"Custom"};function p8(t,e){const n=h8[e];return n===void 0?($t("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+t+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const np=new Re;function m8(){yn.getLuminanceCoefficients(np);const t=np.x.toFixed(4),e=np.y.toFixed(4),n=np.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function g8(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(ju).join(`
`)}function x8(t){const e=[];for(const n in t){const s=t[n];s!==!1&&e.push("#define "+n+" "+s)}return e.join(`
`)}function y8(t,e){const n={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let o=0;o<s;o++){const l=t.getActiveAttrib(e,o),d=l.name;let u=1;l.type===t.FLOAT_MAT2&&(u=2),l.type===t.FLOAT_MAT3&&(u=3),l.type===t.FLOAT_MAT4&&(u=4),n[d]={type:l.type,location:t.getAttribLocation(e,d),locationSize:u}}return n}function ju(t){return t!==""}function BC(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function UC(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const v8=/^[ \t]*#include +<([\w\d./]+)>/gm;function pv(t){return t.replace(v8,b8)}const _8=new Map;function b8(t,e){let n=nn[e];if(n===void 0){const s=_8.get(e);if(s!==void 0)n=nn[s],$t('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,s);else throw new Error("Can not resolve #include <"+e+">")}return pv(n)}const S8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function HC(t){return t.replace(S8,M8)}function M8(t,e,n,s){let o="";for(let l=parseInt(e);l<parseInt(n);l++)o+=s.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return o}function VC(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const w8={[Tp]:"SHADOWMAP_TYPE_PCF",[Tu]:"SHADOWMAP_TYPE_VSM"};function C8(t){return w8[t.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const T8={[Rl]:"ENVMAP_TYPE_CUBE",[Qc]:"ENVMAP_TYPE_CUBE",[sm]:"ENVMAP_TYPE_CUBE_UV"};function j8(t){return t.envMap===!1?"ENVMAP_TYPE_CUBE":T8[t.envMapMode]||"ENVMAP_TYPE_CUBE"}const E8={[Qc]:"ENVMAP_MODE_REFRACTION"};function A8(t){return t.envMap===!1?"ENVMAP_MODE_REFLECTION":E8[t.envMapMode]||"ENVMAP_MODE_REFLECTION"}const R8={[Jv]:"ENVMAP_BLENDING_MULTIPLY",[hB]:"ENVMAP_BLENDING_MIX",[pB]:"ENVMAP_BLENDING_ADD"};function D8(t){return t.envMap===!1?"ENVMAP_BLENDING_NONE":R8[t.combine]||"ENVMAP_BLENDING_NONE"}function I8(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,s=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:s,maxMip:n}}function O8(t,e,n,s){const o=t.getContext(),l=n.defines;let d=n.vertexShader,u=n.fragmentShader;const h=C8(n),p=j8(n),m=A8(n),g=D8(n),v=I8(n),C=g8(n),b=x8(l),_=o.createProgram();let y,S,D=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b].filter(ju).join(`
`),y.length>0&&(y+=`
`),S=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b].filter(ju).join(`
`),S.length>0&&(S+=`
`)):(y=[VC(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ju).join(`
`),S=[VC(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,b,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.envMap?"#define "+m:"",n.envMap?"#define "+g:"",v?"#define CUBEUV_TEXEL_WIDTH "+v.texelWidth:"",v?"#define CUBEUV_TEXEL_HEIGHT "+v.texelHeight:"",v?"#define CUBEUV_MAX_MIP "+v.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Zs?"#define TONE_MAPPING":"",n.toneMapping!==Zs?nn.tonemapping_pars_fragment:"",n.toneMapping!==Zs?p8("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",nn.colorspace_pars_fragment,f8("linearToOutputTexel",n.outputColorSpace),m8(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(ju).join(`
`)),d=pv(d),d=BC(d,n),d=UC(d,n),u=pv(u),u=BC(u,n),u=UC(u,n),d=HC(d),u=HC(u),n.isRawShaderMaterial!==!0&&(D=`#version 300 es
`,y=[C,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,S=["#define varying in",n.glslVersion===eC?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===eC?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const L=D+y+d,N=D+S+u,T=FC(o,o.VERTEX_SHADER,L),j=FC(o,o.FRAGMENT_SHADER,N);o.attachShader(_,T),o.attachShader(_,j),n.index0AttributeName!==void 0?o.bindAttribLocation(_,0,n.index0AttributeName):n.morphTargets===!0&&o.bindAttribLocation(_,0,"position"),o.linkProgram(_);function E(z){if(t.debug.checkShaderErrors){const V=o.getProgramInfoLog(_)||"",O=o.getShaderInfoLog(T)||"",k=o.getShaderInfoLog(j)||"",F=V.trim(),A=O.trim(),q=k.trim();let B=!0,W=!0;if(o.getProgramParameter(_,o.LINK_STATUS)===!1)if(B=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(o,_,T,j);else{const Q=kC(o,T,"vertex"),ne=kC(o,j,"fragment");Sn("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(_,o.VALIDATE_STATUS)+`

Material Name: `+z.name+`
Material Type: `+z.type+`

Program Info Log: `+F+`
`+Q+`
`+ne)}else F!==""?$t("WebGLProgram: Program Info Log:",F):(A===""||q==="")&&(W=!1);W&&(z.diagnostics={runnable:B,programLog:F,vertexShader:{log:A,prefix:y},fragmentShader:{log:q,prefix:S}})}o.deleteShader(T),o.deleteShader(j),R=new Ip(o,_),M=y8(o,_)}let R;this.getUniforms=function(){return R===void 0&&E(this),R};let M;this.getAttributes=function(){return M===void 0&&E(this),M};let I=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return I===!1&&(I=o.getProgramParameter(_,l8)),I},this.destroy=function(){s.releaseStatesOfProgram(this),o.deleteProgram(_),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=c8++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=T,this.fragmentShader=j,this}let P8=0;class L8{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,s=e.fragmentShader,o=this._getShaderStage(n),l=this._getShaderStage(s),d=this._getShaderCacheForMaterial(e);return d.has(o)===!1&&(d.add(o),o.usedTimes++),d.has(l)===!1&&(d.add(l),l.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const s of n)s.usedTimes--,s.usedTimes===0&&this.shaderCache.delete(s.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let s=n.get(e);return s===void 0&&(s=new Set,n.set(e,s)),s}_getShaderStage(e){const n=this.shaderCache;let s=n.get(e);return s===void 0&&(s=new N8(e),n.set(e,s)),s}}class N8{constructor(e){this.id=P8++,this.code=e,this.usedTimes=0}}function F8(t,e,n,s,o,l,d){const u=new BE,h=new L8,p=new Set,m=[],g=new Map,v=o.logarithmicDepthBuffer;let C=o.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(M){return p.add(M),M===0?"uv":`uv${M}`}function y(M,I,z,V,O){const k=V.fog,F=O.geometry,A=M.isMeshStandardMaterial?V.environment:null,q=(M.isMeshStandardMaterial?n:e).get(M.envMap||A),B=q&&q.mapping===sm?q.image.height:null,W=b[M.type];M.precision!==null&&(C=o.getMaxPrecision(M.precision),C!==M.precision&&$t("WebGLProgram.getParameters:",M.precision,"not supported, using",C,"instead."));const Q=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,ne=Q!==void 0?Q.length:0;let de=0;F.morphAttributes.position!==void 0&&(de=1),F.morphAttributes.normal!==void 0&&(de=2),F.morphAttributes.color!==void 0&&(de=3);let $,X,le,oe;if(W){const Et=$s[W];$=Et.vertexShader,X=Et.fragmentShader}else $=M.vertexShader,X=M.fragmentShader,h.update(M),le=h.getVertexShaderID(M),oe=h.getFragmentShaderID(M);const ue=t.getRenderTarget(),Ye=t.state.buffers.depth.getReversed(),ae=O.isInstancedMesh===!0,fe=O.isBatchedMesh===!0,pt=!!M.map,_t=!!M.matcap,Se=!!q,$e=!!M.aoMap,jt=!!M.lightMap,Fe=!!M.bumpMap,Dt=!!M.normalMap,te=!!M.displacementMap,bt=!!M.emissiveMap,It=!!M.metalnessMap,tt=!!M.roughnessMap,nt=M.anisotropy>0,G=M.clearcoat>0,H=M.dispersion>0,ie=M.iridescence>0,we=M.sheen>0,Ce=M.transmission>0,ge=nt&&!!M.anisotropyMap,je=G&&!!M.clearcoatMap,He=G&&!!M.clearcoatNormalMap,dt=G&&!!M.clearcoatRoughnessMap,gt=ie&&!!M.iridescenceMap,We=ie&&!!M.iridescenceThicknessMap,qe=we&&!!M.sheenColorMap,at=we&&!!M.sheenRoughnessMap,ot=!!M.specularMap,st=!!M.specularColorMap,it=!!M.specularIntensityMap,re=Ce&&!!M.transmissionMap,rt=Ce&&!!M.thicknessMap,Ze=!!M.gradientMap,ht=!!M.alphaMap,Ke=M.alphaTest>0,Ue=!!M.alphaHash,Je=!!M.extensions;let ye=Zs;M.toneMapped&&(ue===null||ue.isXRRenderTarget===!0)&&(ye=t.toneMapping);const ut={shaderID:W,shaderType:M.type,shaderName:M.name,vertexShader:$,fragmentShader:X,defines:M.defines,customVertexShaderID:le,customFragmentShaderID:oe,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:C,batching:fe,batchingColor:fe&&O._colorsTexture!==null,instancing:ae,instancingColor:ae&&O.instanceColor!==null,instancingMorph:ae&&O.morphTexture!==null,outputColorSpace:ue===null?t.outputColorSpace:ue.isXRRenderTarget===!0?ue.texture.colorSpace:Jc,alphaToCoverage:!!M.alphaToCoverage,map:pt,matcap:_t,envMap:Se,envMapMode:Se&&q.mapping,envMapCubeUVHeight:B,aoMap:$e,lightMap:jt,bumpMap:Fe,normalMap:Dt,displacementMap:te,emissiveMap:bt,normalMapObjectSpace:Dt&&M.normalMapType===xB,normalMapTangentSpace:Dt&&M.normalMapType===NE,metalnessMap:It,roughnessMap:tt,anisotropy:nt,anisotropyMap:ge,clearcoat:G,clearcoatMap:je,clearcoatNormalMap:He,clearcoatRoughnessMap:dt,dispersion:H,iridescence:ie,iridescenceMap:gt,iridescenceThicknessMap:We,sheen:we,sheenColorMap:qe,sheenRoughnessMap:at,specularMap:ot,specularColorMap:st,specularIntensityMap:it,transmission:Ce,transmissionMap:re,thicknessMap:rt,gradientMap:Ze,opaque:M.transparent===!1&&M.blending===Uc&&M.alphaToCoverage===!1,alphaMap:ht,alphaTest:Ke,alphaHash:Ue,combine:M.combine,mapUv:pt&&_(M.map.channel),aoMapUv:$e&&_(M.aoMap.channel),lightMapUv:jt&&_(M.lightMap.channel),bumpMapUv:Fe&&_(M.bumpMap.channel),normalMapUv:Dt&&_(M.normalMap.channel),displacementMapUv:te&&_(M.displacementMap.channel),emissiveMapUv:bt&&_(M.emissiveMap.channel),metalnessMapUv:It&&_(M.metalnessMap.channel),roughnessMapUv:tt&&_(M.roughnessMap.channel),anisotropyMapUv:ge&&_(M.anisotropyMap.channel),clearcoatMapUv:je&&_(M.clearcoatMap.channel),clearcoatNormalMapUv:He&&_(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:dt&&_(M.clearcoatRoughnessMap.channel),iridescenceMapUv:gt&&_(M.iridescenceMap.channel),iridescenceThicknessMapUv:We&&_(M.iridescenceThicknessMap.channel),sheenColorMapUv:qe&&_(M.sheenColorMap.channel),sheenRoughnessMapUv:at&&_(M.sheenRoughnessMap.channel),specularMapUv:ot&&_(M.specularMap.channel),specularColorMapUv:st&&_(M.specularColorMap.channel),specularIntensityMapUv:it&&_(M.specularIntensityMap.channel),transmissionMapUv:re&&_(M.transmissionMap.channel),thicknessMapUv:rt&&_(M.thicknessMap.channel),alphaMapUv:ht&&_(M.alphaMap.channel),vertexTangents:!!F.attributes.tangent&&(Dt||nt),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,pointsUvs:O.isPoints===!0&&!!F.attributes.uv&&(pt||ht),fog:!!k,useFog:M.fog===!0,fogExp2:!!k&&k.isFogExp2,flatShading:M.flatShading===!0&&M.wireframe===!1,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:v,reversedDepthBuffer:Ye,skinning:O.isSkinnedMesh===!0,morphTargets:F.morphAttributes.position!==void 0,morphNormals:F.morphAttributes.normal!==void 0,morphColors:F.morphAttributes.color!==void 0,morphTargetsCount:ne,morphTextureStride:de,numDirLights:I.directional.length,numPointLights:I.point.length,numSpotLights:I.spot.length,numSpotLightMaps:I.spotLightMap.length,numRectAreaLights:I.rectArea.length,numHemiLights:I.hemi.length,numDirLightShadows:I.directionalShadowMap.length,numPointLightShadows:I.pointShadowMap.length,numSpotLightShadows:I.spotShadowMap.length,numSpotLightShadowsWithMaps:I.numSpotLightShadowsWithMaps,numLightProbes:I.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&z.length>0,shadowMapType:t.shadowMap.type,toneMapping:ye,decodeVideoTexture:pt&&M.map.isVideoTexture===!0&&yn.getTransfer(M.map.colorSpace)===On,decodeVideoTextureEmissive:bt&&M.emissiveMap.isVideoTexture===!0&&yn.getTransfer(M.emissiveMap.colorSpace)===On,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===Ys,flipSided:M.side===ja,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionClipCullDistance:Je&&M.extensions.clipCullDistance===!0&&s.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Je&&M.extensions.multiDraw===!0||fe)&&s.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:s.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()};return ut.vertexUv1s=p.has(1),ut.vertexUv2s=p.has(2),ut.vertexUv3s=p.has(3),p.clear(),ut}function S(M){const I=[];if(M.shaderID?I.push(M.shaderID):(I.push(M.customVertexShaderID),I.push(M.customFragmentShaderID)),M.defines!==void 0)for(const z in M.defines)I.push(z),I.push(M.defines[z]);return M.isRawShaderMaterial===!1&&(D(I,M),L(I,M),I.push(t.outputColorSpace)),I.push(M.customProgramCacheKey),I.join()}function D(M,I){M.push(I.precision),M.push(I.outputColorSpace),M.push(I.envMapMode),M.push(I.envMapCubeUVHeight),M.push(I.mapUv),M.push(I.alphaMapUv),M.push(I.lightMapUv),M.push(I.aoMapUv),M.push(I.bumpMapUv),M.push(I.normalMapUv),M.push(I.displacementMapUv),M.push(I.emissiveMapUv),M.push(I.metalnessMapUv),M.push(I.roughnessMapUv),M.push(I.anisotropyMapUv),M.push(I.clearcoatMapUv),M.push(I.clearcoatNormalMapUv),M.push(I.clearcoatRoughnessMapUv),M.push(I.iridescenceMapUv),M.push(I.iridescenceThicknessMapUv),M.push(I.sheenColorMapUv),M.push(I.sheenRoughnessMapUv),M.push(I.specularMapUv),M.push(I.specularColorMapUv),M.push(I.specularIntensityMapUv),M.push(I.transmissionMapUv),M.push(I.thicknessMapUv),M.push(I.combine),M.push(I.fogExp2),M.push(I.sizeAttenuation),M.push(I.morphTargetsCount),M.push(I.morphAttributeCount),M.push(I.numDirLights),M.push(I.numPointLights),M.push(I.numSpotLights),M.push(I.numSpotLightMaps),M.push(I.numHemiLights),M.push(I.numRectAreaLights),M.push(I.numDirLightShadows),M.push(I.numPointLightShadows),M.push(I.numSpotLightShadows),M.push(I.numSpotLightShadowsWithMaps),M.push(I.numLightProbes),M.push(I.shadowMapType),M.push(I.toneMapping),M.push(I.numClippingPlanes),M.push(I.numClipIntersection),M.push(I.depthPacking)}function L(M,I){u.disableAll(),I.instancing&&u.enable(0),I.instancingColor&&u.enable(1),I.instancingMorph&&u.enable(2),I.matcap&&u.enable(3),I.envMap&&u.enable(4),I.normalMapObjectSpace&&u.enable(5),I.normalMapTangentSpace&&u.enable(6),I.clearcoat&&u.enable(7),I.iridescence&&u.enable(8),I.alphaTest&&u.enable(9),I.vertexColors&&u.enable(10),I.vertexAlphas&&u.enable(11),I.vertexUv1s&&u.enable(12),I.vertexUv2s&&u.enable(13),I.vertexUv3s&&u.enable(14),I.vertexTangents&&u.enable(15),I.anisotropy&&u.enable(16),I.alphaHash&&u.enable(17),I.batching&&u.enable(18),I.dispersion&&u.enable(19),I.batchingColor&&u.enable(20),I.gradientMap&&u.enable(21),M.push(u.mask),u.disableAll(),I.fog&&u.enable(0),I.useFog&&u.enable(1),I.flatShading&&u.enable(2),I.logarithmicDepthBuffer&&u.enable(3),I.reversedDepthBuffer&&u.enable(4),I.skinning&&u.enable(5),I.morphTargets&&u.enable(6),I.morphNormals&&u.enable(7),I.morphColors&&u.enable(8),I.premultipliedAlpha&&u.enable(9),I.shadowMapEnabled&&u.enable(10),I.doubleSided&&u.enable(11),I.flipSided&&u.enable(12),I.useDepthPacking&&u.enable(13),I.dithering&&u.enable(14),I.transmission&&u.enable(15),I.sheen&&u.enable(16),I.opaque&&u.enable(17),I.pointsUvs&&u.enable(18),I.decodeVideoTexture&&u.enable(19),I.decodeVideoTextureEmissive&&u.enable(20),I.alphaToCoverage&&u.enable(21),M.push(u.mask)}function N(M){const I=b[M.type];let z;if(I){const V=$s[I];z=$B.clone(V.uniforms)}else z=M.uniforms;return z}function T(M,I){let z=g.get(I);return z!==void 0?++z.usedTimes:(z=new O8(t,I,M,l),m.push(z),g.set(I,z)),z}function j(M){if(--M.usedTimes===0){const I=m.indexOf(M);m[I]=m[m.length-1],m.pop(),g.delete(M.cacheKey),M.destroy()}}function E(M){h.remove(M)}function R(){h.dispose()}return{getParameters:y,getProgramCacheKey:S,getUniforms:N,acquireProgram:T,releaseProgram:j,releaseShaderCache:E,programs:m,dispose:R}}function z8(){let t=new WeakMap;function e(d){return t.has(d)}function n(d){let u=t.get(d);return u===void 0&&(u={},t.set(d,u)),u}function s(d){t.delete(d)}function o(d,u,h){t.get(d)[u]=h}function l(){t=new WeakMap}return{has:e,get:n,remove:s,update:o,dispose:l}}function k8(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function qC(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function GC(){const t=[];let e=0;const n=[],s=[],o=[];function l(){e=0,n.length=0,s.length=0,o.length=0}function d(g,v,C,b,_,y){let S=t[e];return S===void 0?(S={id:g.id,object:g,geometry:v,material:C,groupOrder:b,renderOrder:g.renderOrder,z:_,group:y},t[e]=S):(S.id=g.id,S.object=g,S.geometry=v,S.material=C,S.groupOrder=b,S.renderOrder=g.renderOrder,S.z=_,S.group=y),e++,S}function u(g,v,C,b,_,y){const S=d(g,v,C,b,_,y);C.transmission>0?s.push(S):C.transparent===!0?o.push(S):n.push(S)}function h(g,v,C,b,_,y){const S=d(g,v,C,b,_,y);C.transmission>0?s.unshift(S):C.transparent===!0?o.unshift(S):n.unshift(S)}function p(g,v){n.length>1&&n.sort(g||k8),s.length>1&&s.sort(v||qC),o.length>1&&o.sort(v||qC)}function m(){for(let g=e,v=t.length;g<v;g++){const C=t[g];if(C.id===null)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}}return{opaque:n,transmissive:s,transparent:o,init:l,push:u,unshift:h,finish:m,sort:p}}function B8(){let t=new WeakMap;function e(s,o){const l=t.get(s);let d;return l===void 0?(d=new GC,t.set(s,[d])):o>=l.length?(d=new GC,l.push(d)):d=l[o],d}function n(){t=new WeakMap}return{get:e,dispose:n}}function U8(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Re,color:new xn};break;case"SpotLight":n={position:new Re,direction:new Re,color:new xn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Re,color:new xn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Re,skyColor:new xn,groundColor:new xn};break;case"RectAreaLight":n={color:new xn,position:new Re,halfWidth:new Re,halfHeight:new Re};break}return t[e.id]=n,n}}}function H8(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xt};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let V8=0;function q8(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function G8(t){const e=new U8,n=H8(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)s.probe.push(new Re);const o=new Re,l=new ai,d=new ai;function u(p){let m=0,g=0,v=0;for(let M=0;M<9;M++)s.probe[M].set(0,0,0);let C=0,b=0,_=0,y=0,S=0,D=0,L=0,N=0,T=0,j=0,E=0;p.sort(q8);for(let M=0,I=p.length;M<I;M++){const z=p[M],V=z.color,O=z.intensity,k=z.distance;let F=null;if(z.shadow&&z.shadow.map&&(z.shadow.map.texture.format===Zc?F=z.shadow.map.texture:F=z.shadow.map.depthTexture||z.shadow.map.texture),z.isAmbientLight)m+=V.r*O,g+=V.g*O,v+=V.b*O;else if(z.isLightProbe){for(let A=0;A<9;A++)s.probe[A].addScaledVector(z.sh.coefficients[A],O);E++}else if(z.isDirectionalLight){const A=e.get(z);if(A.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const q=z.shadow,B=n.get(z);B.shadowIntensity=q.intensity,B.shadowBias=q.bias,B.shadowNormalBias=q.normalBias,B.shadowRadius=q.radius,B.shadowMapSize=q.mapSize,s.directionalShadow[C]=B,s.directionalShadowMap[C]=F,s.directionalShadowMatrix[C]=z.shadow.matrix,D++}s.directional[C]=A,C++}else if(z.isSpotLight){const A=e.get(z);A.position.setFromMatrixPosition(z.matrixWorld),A.color.copy(V).multiplyScalar(O),A.distance=k,A.coneCos=Math.cos(z.angle),A.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),A.decay=z.decay,s.spot[_]=A;const q=z.shadow;if(z.map&&(s.spotLightMap[T]=z.map,T++,q.updateMatrices(z),z.castShadow&&j++),s.spotLightMatrix[_]=q.matrix,z.castShadow){const B=n.get(z);B.shadowIntensity=q.intensity,B.shadowBias=q.bias,B.shadowNormalBias=q.normalBias,B.shadowRadius=q.radius,B.shadowMapSize=q.mapSize,s.spotShadow[_]=B,s.spotShadowMap[_]=F,N++}_++}else if(z.isRectAreaLight){const A=e.get(z);A.color.copy(V).multiplyScalar(O),A.halfWidth.set(z.width*.5,0,0),A.halfHeight.set(0,z.height*.5,0),s.rectArea[y]=A,y++}else if(z.isPointLight){const A=e.get(z);if(A.color.copy(z.color).multiplyScalar(z.intensity),A.distance=z.distance,A.decay=z.decay,z.castShadow){const q=z.shadow,B=n.get(z);B.shadowIntensity=q.intensity,B.shadowBias=q.bias,B.shadowNormalBias=q.normalBias,B.shadowRadius=q.radius,B.shadowMapSize=q.mapSize,B.shadowCameraNear=q.camera.near,B.shadowCameraFar=q.camera.far,s.pointShadow[b]=B,s.pointShadowMap[b]=F,s.pointShadowMatrix[b]=z.shadow.matrix,L++}s.point[b]=A,b++}else if(z.isHemisphereLight){const A=e.get(z);A.skyColor.copy(z.color).multiplyScalar(O),A.groundColor.copy(z.groundColor).multiplyScalar(O),s.hemi[S]=A,S++}}y>0&&(t.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=vt.LTC_FLOAT_1,s.rectAreaLTC2=vt.LTC_FLOAT_2):(s.rectAreaLTC1=vt.LTC_HALF_1,s.rectAreaLTC2=vt.LTC_HALF_2)),s.ambient[0]=m,s.ambient[1]=g,s.ambient[2]=v;const R=s.hash;(R.directionalLength!==C||R.pointLength!==b||R.spotLength!==_||R.rectAreaLength!==y||R.hemiLength!==S||R.numDirectionalShadows!==D||R.numPointShadows!==L||R.numSpotShadows!==N||R.numSpotMaps!==T||R.numLightProbes!==E)&&(s.directional.length=C,s.spot.length=_,s.rectArea.length=y,s.point.length=b,s.hemi.length=S,s.directionalShadow.length=D,s.directionalShadowMap.length=D,s.pointShadow.length=L,s.pointShadowMap.length=L,s.spotShadow.length=N,s.spotShadowMap.length=N,s.directionalShadowMatrix.length=D,s.pointShadowMatrix.length=L,s.spotLightMatrix.length=N+T-j,s.spotLightMap.length=T,s.numSpotLightShadowsWithMaps=j,s.numLightProbes=E,R.directionalLength=C,R.pointLength=b,R.spotLength=_,R.rectAreaLength=y,R.hemiLength=S,R.numDirectionalShadows=D,R.numPointShadows=L,R.numSpotShadows=N,R.numSpotMaps=T,R.numLightProbes=E,s.version=V8++)}function h(p,m){let g=0,v=0,C=0,b=0,_=0;const y=m.matrixWorldInverse;for(let S=0,D=p.length;S<D;S++){const L=p[S];if(L.isDirectionalLight){const N=s.directional[g];N.direction.setFromMatrixPosition(L.matrixWorld),o.setFromMatrixPosition(L.target.matrixWorld),N.direction.sub(o),N.direction.transformDirection(y),g++}else if(L.isSpotLight){const N=s.spot[C];N.position.setFromMatrixPosition(L.matrixWorld),N.position.applyMatrix4(y),N.direction.setFromMatrixPosition(L.matrixWorld),o.setFromMatrixPosition(L.target.matrixWorld),N.direction.sub(o),N.direction.transformDirection(y),C++}else if(L.isRectAreaLight){const N=s.rectArea[b];N.position.setFromMatrixPosition(L.matrixWorld),N.position.applyMatrix4(y),d.identity(),l.copy(L.matrixWorld),l.premultiply(y),d.extractRotation(l),N.halfWidth.set(L.width*.5,0,0),N.halfHeight.set(0,L.height*.5,0),N.halfWidth.applyMatrix4(d),N.halfHeight.applyMatrix4(d),b++}else if(L.isPointLight){const N=s.point[v];N.position.setFromMatrixPosition(L.matrixWorld),N.position.applyMatrix4(y),v++}else if(L.isHemisphereLight){const N=s.hemi[_];N.direction.setFromMatrixPosition(L.matrixWorld),N.direction.transformDirection(y),_++}}}return{setup:u,setupView:h,state:s}}function $C(t){const e=new G8(t),n=[],s=[];function o(m){p.camera=m,n.length=0,s.length=0}function l(m){n.push(m)}function d(m){s.push(m)}function u(){e.setup(n)}function h(m){e.setupView(n,m)}const p={lightsArray:n,shadowsArray:s,camera:null,lights:e,transmissionRenderTarget:{}};return{init:o,state:p,setupLights:u,setupLightsView:h,pushLight:l,pushShadow:d}}function $8(t){let e=new WeakMap;function n(o,l=0){const d=e.get(o);let u;return d===void 0?(u=new $C(t),e.set(o,[u])):l>=d.length?(u=new $C(t),d.push(u)):u=d[l],u}function s(){e=new WeakMap}return{get:n,dispose:s}}const W8=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Y8=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,K8=[new Re(1,0,0),new Re(-1,0,0),new Re(0,1,0),new Re(0,-1,0),new Re(0,0,1),new Re(0,0,-1)],X8=[new Re(0,-1,0),new Re(0,-1,0),new Re(0,0,1),new Re(0,0,-1),new Re(0,-1,0),new Re(0,-1,0)],WC=new ai,yu=new Re,jy=new Re;function Q8(t,e,n){let s=new d_;const o=new Xt,l=new Xt,d=new ii,u=new s4,h=new r4,p={},m=n.maxTextureSize,g={[Bo]:ja,[ja]:Bo,[Ys]:Ys},v=new sr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xt},radius:{value:4}},vertexShader:W8,fragmentShader:Y8}),C=v.clone();C.defines.HORIZONTAL_PASS=1;const b=new Ns;b.setAttribute("position",new $a(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new ar(b,v),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Tp;let S=this.type;this.render=function(j,E,R){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||j.length===0)return;j.type===Yk&&($t("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),j.type=Tp);const M=t.getRenderTarget(),I=t.getActiveCubeFace(),z=t.getActiveMipmapLevel(),V=t.state;V.setBlending(Vr),V.buffers.depth.getReversed()===!0?V.buffers.color.setClear(0,0,0,0):V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);const O=S!==this.type;O&&E.traverse(function(k){k.material&&(Array.isArray(k.material)?k.material.forEach(F=>F.needsUpdate=!0):k.material.needsUpdate=!0)});for(let k=0,F=j.length;k<F;k++){const A=j[k],q=A.shadow;if(q===void 0){$t("WebGLShadowMap:",A,"has no shadow.");continue}if(q.autoUpdate===!1&&q.needsUpdate===!1)continue;o.copy(q.mapSize);const B=q.getFrameExtents();if(o.multiply(B),l.copy(q.mapSize),(o.x>m||o.y>m)&&(o.x>m&&(l.x=Math.floor(m/B.x),o.x=l.x*B.x,q.mapSize.x=l.x),o.y>m&&(l.y=Math.floor(m/B.y),o.y=l.y*B.y,q.mapSize.y=l.y)),q.map===null||O===!0){if(q.map!==null&&(q.map.depthTexture!==null&&(q.map.depthTexture.dispose(),q.map.depthTexture=null),q.map.dispose()),this.type===Tu){if(A.isPointLight){$t("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}q.map=new Js(o.x,o.y,{format:Zc,type:Kr,minFilter:sa,magFilter:sa,generateMipmaps:!1}),q.map.texture.name=A.name+".shadowMap",q.map.depthTexture=new qu(o.x,o.y,Ks),q.map.depthTexture.name=A.name+".shadowMapDepth",q.map.depthTexture.format=Xr,q.map.depthTexture.compareFunction=null,q.map.depthTexture.minFilter=Ki,q.map.depthTexture.magFilter=Ki}else{A.isPointLight?(q.map=new YE(o.x),q.map.depthTexture=new n4(o.x,nr)):(q.map=new Js(o.x,o.y),q.map.depthTexture=new qu(o.x,o.y,nr)),q.map.depthTexture.name=A.name+".shadowMap",q.map.depthTexture.format=Xr;const Q=t.state.buffers.depth.getReversed();this.type===Tp?(q.map.depthTexture.compareFunction=Q?o_:r_,q.map.depthTexture.minFilter=sa,q.map.depthTexture.magFilter=sa):(q.map.depthTexture.compareFunction=null,q.map.depthTexture.minFilter=Ki,q.map.depthTexture.magFilter=Ki)}q.camera.updateProjectionMatrix()}const W=q.map.isWebGLCubeRenderTarget?6:1;for(let Q=0;Q<W;Q++){if(q.map.isWebGLCubeRenderTarget)t.setRenderTarget(q.map,Q),t.clear();else{Q===0&&(t.setRenderTarget(q.map),t.clear());const ne=q.getViewport(Q);d.set(l.x*ne.x,l.y*ne.y,l.x*ne.z,l.y*ne.w),V.viewport(d)}if(A.isPointLight){const ne=q.camera,de=q.matrix,$=A.distance||ne.far;$!==ne.far&&(ne.far=$,ne.updateProjectionMatrix()),yu.setFromMatrixPosition(A.matrixWorld),ne.position.copy(yu),jy.copy(ne.position),jy.add(K8[Q]),ne.up.copy(X8[Q]),ne.lookAt(jy),ne.updateMatrixWorld(),de.makeTranslation(-yu.x,-yu.y,-yu.z),WC.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),q._frustum.setFromProjectionMatrix(WC,ne.coordinateSystem,ne.reversedDepth)}else q.updateMatrices(A);s=q.getFrustum(),N(E,R,q.camera,A,this.type)}q.isPointLightShadow!==!0&&this.type===Tu&&D(q,R),q.needsUpdate=!1}S=this.type,y.needsUpdate=!1,t.setRenderTarget(M,I,z)};function D(j,E){const R=e.update(_);v.defines.VSM_SAMPLES!==j.blurSamples&&(v.defines.VSM_SAMPLES=j.blurSamples,C.defines.VSM_SAMPLES=j.blurSamples,v.needsUpdate=!0,C.needsUpdate=!0),j.mapPass===null&&(j.mapPass=new Js(o.x,o.y,{format:Zc,type:Kr})),v.uniforms.shadow_pass.value=j.map.depthTexture,v.uniforms.resolution.value=j.mapSize,v.uniforms.radius.value=j.radius,t.setRenderTarget(j.mapPass),t.clear(),t.renderBufferDirect(E,null,R,v,_,null),C.uniforms.shadow_pass.value=j.mapPass.texture,C.uniforms.resolution.value=j.mapSize,C.uniforms.radius.value=j.radius,t.setRenderTarget(j.map),t.clear(),t.renderBufferDirect(E,null,R,C,_,null)}function L(j,E,R,M){let I=null;const z=R.isPointLight===!0?j.customDistanceMaterial:j.customDepthMaterial;if(z!==void 0)I=z;else if(I=R.isPointLight===!0?h:u,t.localClippingEnabled&&E.clipShadows===!0&&Array.isArray(E.clippingPlanes)&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0||E.alphaToCoverage===!0){const V=I.uuid,O=E.uuid;let k=p[V];k===void 0&&(k={},p[V]=k);let F=k[O];F===void 0&&(F=I.clone(),k[O]=F,E.addEventListener("dispose",T)),I=F}if(I.visible=E.visible,I.wireframe=E.wireframe,M===Tu?I.side=E.shadowSide!==null?E.shadowSide:E.side:I.side=E.shadowSide!==null?E.shadowSide:g[E.side],I.alphaMap=E.alphaMap,I.alphaTest=E.alphaToCoverage===!0?.5:E.alphaTest,I.map=E.map,I.clipShadows=E.clipShadows,I.clippingPlanes=E.clippingPlanes,I.clipIntersection=E.clipIntersection,I.displacementMap=E.displacementMap,I.displacementScale=E.displacementScale,I.displacementBias=E.displacementBias,I.wireframeLinewidth=E.wireframeLinewidth,I.linewidth=E.linewidth,R.isPointLight===!0&&I.isMeshDistanceMaterial===!0){const V=t.properties.get(I);V.light=R}return I}function N(j,E,R,M,I){if(j.visible===!1)return;if(j.layers.test(E.layers)&&(j.isMesh||j.isLine||j.isPoints)&&(j.castShadow||j.receiveShadow&&I===Tu)&&(!j.frustumCulled||s.intersectsObject(j))){j.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,j.matrixWorld);const O=e.update(j),k=j.material;if(Array.isArray(k)){const F=O.groups;for(let A=0,q=F.length;A<q;A++){const B=F[A],W=k[B.materialIndex];if(W&&W.visible){const Q=L(j,W,M,I);j.onBeforeShadow(t,j,E,R,O,Q,B),t.renderBufferDirect(R,null,O,Q,j,B),j.onAfterShadow(t,j,E,R,O,Q,B)}}}else if(k.visible){const F=L(j,k,M,I);j.onBeforeShadow(t,j,E,R,O,F,null),t.renderBufferDirect(R,null,O,F,j,null),j.onAfterShadow(t,j,E,R,O,F,null)}}const V=j.children;for(let O=0,k=V.length;O<k;O++)N(V[O],E,R,M,I)}function T(j){j.target.removeEventListener("dispose",T);for(const R in p){const M=p[R],I=j.target.uuid;I in M&&(M[I].dispose(),delete M[I])}}}const Z8={[M0]:w0,[C0]:E0,[T0]:A0,[Xc]:j0,[w0]:M0,[E0]:C0,[A0]:T0,[j0]:Xc};function J8(t,e){function n(){let re=!1;const rt=new ii;let Ze=null;const ht=new ii(0,0,0,0);return{setMask:function(Ke){Ze!==Ke&&!re&&(t.colorMask(Ke,Ke,Ke,Ke),Ze=Ke)},setLocked:function(Ke){re=Ke},setClear:function(Ke,Ue,Je,ye,ut){ut===!0&&(Ke*=ye,Ue*=ye,Je*=ye),rt.set(Ke,Ue,Je,ye),ht.equals(rt)===!1&&(t.clearColor(Ke,Ue,Je,ye),ht.copy(rt))},reset:function(){re=!1,Ze=null,ht.set(-1,0,0,0)}}}function s(){let re=!1,rt=!1,Ze=null,ht=null,Ke=null;return{setReversed:function(Ue){if(rt!==Ue){const Je=e.get("EXT_clip_control");Ue?Je.clipControlEXT(Je.LOWER_LEFT_EXT,Je.ZERO_TO_ONE_EXT):Je.clipControlEXT(Je.LOWER_LEFT_EXT,Je.NEGATIVE_ONE_TO_ONE_EXT),rt=Ue;const ye=Ke;Ke=null,this.setClear(ye)}},getReversed:function(){return rt},setTest:function(Ue){Ue?ue(t.DEPTH_TEST):Ye(t.DEPTH_TEST)},setMask:function(Ue){Ze!==Ue&&!re&&(t.depthMask(Ue),Ze=Ue)},setFunc:function(Ue){if(rt&&(Ue=Z8[Ue]),ht!==Ue){switch(Ue){case M0:t.depthFunc(t.NEVER);break;case w0:t.depthFunc(t.ALWAYS);break;case C0:t.depthFunc(t.LESS);break;case Xc:t.depthFunc(t.LEQUAL);break;case T0:t.depthFunc(t.EQUAL);break;case j0:t.depthFunc(t.GEQUAL);break;case E0:t.depthFunc(t.GREATER);break;case A0:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}ht=Ue}},setLocked:function(Ue){re=Ue},setClear:function(Ue){Ke!==Ue&&(rt&&(Ue=1-Ue),t.clearDepth(Ue),Ke=Ue)},reset:function(){re=!1,Ze=null,ht=null,Ke=null,rt=!1}}}function o(){let re=!1,rt=null,Ze=null,ht=null,Ke=null,Ue=null,Je=null,ye=null,ut=null;return{setTest:function(Et){re||(Et?ue(t.STENCIL_TEST):Ye(t.STENCIL_TEST))},setMask:function(Et){rt!==Et&&!re&&(t.stencilMask(Et),rt=Et)},setFunc:function(Et,si,la){(Ze!==Et||ht!==si||Ke!==la)&&(t.stencilFunc(Et,si,la),Ze=Et,ht=si,Ke=la)},setOp:function(Et,si,la){(Ue!==Et||Je!==si||ye!==la)&&(t.stencilOp(Et,si,la),Ue=Et,Je=si,ye=la)},setLocked:function(Et){re=Et},setClear:function(Et){ut!==Et&&(t.clearStencil(Et),ut=Et)},reset:function(){re=!1,rt=null,Ze=null,ht=null,Ke=null,Ue=null,Je=null,ye=null,ut=null}}}const l=new n,d=new s,u=new o,h=new WeakMap,p=new WeakMap;let m={},g={},v=new WeakMap,C=[],b=null,_=!1,y=null,S=null,D=null,L=null,N=null,T=null,j=null,E=new xn(0,0,0),R=0,M=!1,I=null,z=null,V=null,O=null,k=null;const F=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let A=!1,q=0;const B=t.getParameter(t.VERSION);B.indexOf("WebGL")!==-1?(q=parseFloat(/^WebGL (\d)/.exec(B)[1]),A=q>=1):B.indexOf("OpenGL ES")!==-1&&(q=parseFloat(/^OpenGL ES (\d)/.exec(B)[1]),A=q>=2);let W=null,Q={};const ne=t.getParameter(t.SCISSOR_BOX),de=t.getParameter(t.VIEWPORT),$=new ii().fromArray(ne),X=new ii().fromArray(de);function le(re,rt,Ze,ht){const Ke=new Uint8Array(4),Ue=t.createTexture();t.bindTexture(re,Ue),t.texParameteri(re,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(re,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Je=0;Je<Ze;Je++)re===t.TEXTURE_3D||re===t.TEXTURE_2D_ARRAY?t.texImage3D(rt,0,t.RGBA,1,1,ht,0,t.RGBA,t.UNSIGNED_BYTE,Ke):t.texImage2D(rt+Je,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Ke);return Ue}const oe={};oe[t.TEXTURE_2D]=le(t.TEXTURE_2D,t.TEXTURE_2D,1),oe[t.TEXTURE_CUBE_MAP]=le(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),oe[t.TEXTURE_2D_ARRAY]=le(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),oe[t.TEXTURE_3D]=le(t.TEXTURE_3D,t.TEXTURE_3D,1,1),l.setClear(0,0,0,1),d.setClear(1),u.setClear(0),ue(t.DEPTH_TEST),d.setFunc(Xc),Fe(!1),Dt(Yw),ue(t.CULL_FACE),$e(Vr);function ue(re){m[re]!==!0&&(t.enable(re),m[re]=!0)}function Ye(re){m[re]!==!1&&(t.disable(re),m[re]=!1)}function ae(re,rt){return g[re]!==rt?(t.bindFramebuffer(re,rt),g[re]=rt,re===t.DRAW_FRAMEBUFFER&&(g[t.FRAMEBUFFER]=rt),re===t.FRAMEBUFFER&&(g[t.DRAW_FRAMEBUFFER]=rt),!0):!1}function fe(re,rt){let Ze=C,ht=!1;if(re){Ze=v.get(rt),Ze===void 0&&(Ze=[],v.set(rt,Ze));const Ke=re.textures;if(Ze.length!==Ke.length||Ze[0]!==t.COLOR_ATTACHMENT0){for(let Ue=0,Je=Ke.length;Ue<Je;Ue++)Ze[Ue]=t.COLOR_ATTACHMENT0+Ue;Ze.length=Ke.length,ht=!0}}else Ze[0]!==t.BACK&&(Ze[0]=t.BACK,ht=!0);ht&&t.drawBuffers(Ze)}function pt(re){return b!==re?(t.useProgram(re),b=re,!0):!1}const _t={[fl]:t.FUNC_ADD,[Xk]:t.FUNC_SUBTRACT,[Qk]:t.FUNC_REVERSE_SUBTRACT};_t[Zk]=t.MIN,_t[Jk]=t.MAX;const Se={[eB]:t.ZERO,[tB]:t.ONE,[nB]:t.SRC_COLOR,[b0]:t.SRC_ALPHA,[lB]:t.SRC_ALPHA_SATURATE,[rB]:t.DST_COLOR,[aB]:t.DST_ALPHA,[iB]:t.ONE_MINUS_SRC_COLOR,[S0]:t.ONE_MINUS_SRC_ALPHA,[oB]:t.ONE_MINUS_DST_COLOR,[sB]:t.ONE_MINUS_DST_ALPHA,[cB]:t.CONSTANT_COLOR,[dB]:t.ONE_MINUS_CONSTANT_COLOR,[uB]:t.CONSTANT_ALPHA,[fB]:t.ONE_MINUS_CONSTANT_ALPHA};function $e(re,rt,Ze,ht,Ke,Ue,Je,ye,ut,Et){if(re===Vr){_===!0&&(Ye(t.BLEND),_=!1);return}if(_===!1&&(ue(t.BLEND),_=!0),re!==Kk){if(re!==y||Et!==M){if((S!==fl||N!==fl)&&(t.blendEquation(t.FUNC_ADD),S=fl,N=fl),Et)switch(re){case Uc:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Kw:t.blendFunc(t.ONE,t.ONE);break;case Xw:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case Qw:t.blendFuncSeparate(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ZERO,t.ONE);break;default:Sn("WebGLState: Invalid blending: ",re);break}else switch(re){case Uc:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Kw:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE,t.ONE,t.ONE);break;case Xw:Sn("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Qw:Sn("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Sn("WebGLState: Invalid blending: ",re);break}D=null,L=null,T=null,j=null,E.set(0,0,0),R=0,y=re,M=Et}return}Ke=Ke||rt,Ue=Ue||Ze,Je=Je||ht,(rt!==S||Ke!==N)&&(t.blendEquationSeparate(_t[rt],_t[Ke]),S=rt,N=Ke),(Ze!==D||ht!==L||Ue!==T||Je!==j)&&(t.blendFuncSeparate(Se[Ze],Se[ht],Se[Ue],Se[Je]),D=Ze,L=ht,T=Ue,j=Je),(ye.equals(E)===!1||ut!==R)&&(t.blendColor(ye.r,ye.g,ye.b,ut),E.copy(ye),R=ut),y=re,M=!1}function jt(re,rt){re.side===Ys?Ye(t.CULL_FACE):ue(t.CULL_FACE);let Ze=re.side===ja;rt&&(Ze=!Ze),Fe(Ze),re.blending===Uc&&re.transparent===!1?$e(Vr):$e(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.blendColor,re.blendAlpha,re.premultipliedAlpha),d.setFunc(re.depthFunc),d.setTest(re.depthTest),d.setMask(re.depthWrite),l.setMask(re.colorWrite);const ht=re.stencilWrite;u.setTest(ht),ht&&(u.setMask(re.stencilWriteMask),u.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),u.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),bt(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),re.alphaToCoverage===!0?ue(t.SAMPLE_ALPHA_TO_COVERAGE):Ye(t.SAMPLE_ALPHA_TO_COVERAGE)}function Fe(re){I!==re&&(re?t.frontFace(t.CW):t.frontFace(t.CCW),I=re)}function Dt(re){re!==$k?(ue(t.CULL_FACE),re!==z&&(re===Yw?t.cullFace(t.BACK):re===Wk?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Ye(t.CULL_FACE),z=re}function te(re){re!==V&&(A&&t.lineWidth(re),V=re)}function bt(re,rt,Ze){re?(ue(t.POLYGON_OFFSET_FILL),(O!==rt||k!==Ze)&&(t.polygonOffset(rt,Ze),O=rt,k=Ze)):Ye(t.POLYGON_OFFSET_FILL)}function It(re){re?ue(t.SCISSOR_TEST):Ye(t.SCISSOR_TEST)}function tt(re){re===void 0&&(re=t.TEXTURE0+F-1),W!==re&&(t.activeTexture(re),W=re)}function nt(re,rt,Ze){Ze===void 0&&(W===null?Ze=t.TEXTURE0+F-1:Ze=W);let ht=Q[Ze];ht===void 0&&(ht={type:void 0,texture:void 0},Q[Ze]=ht),(ht.type!==re||ht.texture!==rt)&&(W!==Ze&&(t.activeTexture(Ze),W=Ze),t.bindTexture(re,rt||oe[re]),ht.type=re,ht.texture=rt)}function G(){const re=Q[W];re!==void 0&&re.type!==void 0&&(t.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function H(){try{t.compressedTexImage2D(...arguments)}catch(re){Sn("WebGLState:",re)}}function ie(){try{t.compressedTexImage3D(...arguments)}catch(re){Sn("WebGLState:",re)}}function we(){try{t.texSubImage2D(...arguments)}catch(re){Sn("WebGLState:",re)}}function Ce(){try{t.texSubImage3D(...arguments)}catch(re){Sn("WebGLState:",re)}}function ge(){try{t.compressedTexSubImage2D(...arguments)}catch(re){Sn("WebGLState:",re)}}function je(){try{t.compressedTexSubImage3D(...arguments)}catch(re){Sn("WebGLState:",re)}}function He(){try{t.texStorage2D(...arguments)}catch(re){Sn("WebGLState:",re)}}function dt(){try{t.texStorage3D(...arguments)}catch(re){Sn("WebGLState:",re)}}function gt(){try{t.texImage2D(...arguments)}catch(re){Sn("WebGLState:",re)}}function We(){try{t.texImage3D(...arguments)}catch(re){Sn("WebGLState:",re)}}function qe(re){$.equals(re)===!1&&(t.scissor(re.x,re.y,re.z,re.w),$.copy(re))}function at(re){X.equals(re)===!1&&(t.viewport(re.x,re.y,re.z,re.w),X.copy(re))}function ot(re,rt){let Ze=p.get(rt);Ze===void 0&&(Ze=new WeakMap,p.set(rt,Ze));let ht=Ze.get(re);ht===void 0&&(ht=t.getUniformBlockIndex(rt,re.name),Ze.set(re,ht))}function st(re,rt){const ht=p.get(rt).get(re);h.get(rt)!==ht&&(t.uniformBlockBinding(rt,ht,re.__bindingPointIndex),h.set(rt,ht))}function it(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),d.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),m={},W=null,Q={},g={},v=new WeakMap,C=[],b=null,_=!1,y=null,S=null,D=null,L=null,N=null,T=null,j=null,E=new xn(0,0,0),R=0,M=!1,I=null,z=null,V=null,O=null,k=null,$.set(0,0,t.canvas.width,t.canvas.height),X.set(0,0,t.canvas.width,t.canvas.height),l.reset(),d.reset(),u.reset()}return{buffers:{color:l,depth:d,stencil:u},enable:ue,disable:Ye,bindFramebuffer:ae,drawBuffers:fe,useProgram:pt,setBlending:$e,setMaterial:jt,setFlipSided:Fe,setCullFace:Dt,setLineWidth:te,setPolygonOffset:bt,setScissorTest:It,activeTexture:tt,bindTexture:nt,unbindTexture:G,compressedTexImage2D:H,compressedTexImage3D:ie,texImage2D:gt,texImage3D:We,updateUBOMapping:ot,uniformBlockBinding:st,texStorage2D:He,texStorage3D:dt,texSubImage2D:we,texSubImage3D:Ce,compressedTexSubImage2D:ge,compressedTexSubImage3D:je,scissor:qe,viewport:at,reset:it}}function eH(t,e,n,s,o,l,d){const u=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new Xt,m=new WeakMap;let g;const v=new WeakMap;let C=!1;try{C=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(G,H){return C?new OffscreenCanvas(G,H):Yp("canvas")}function _(G,H,ie){let we=1;const Ce=nt(G);if((Ce.width>ie||Ce.height>ie)&&(we=ie/Math.max(Ce.width,Ce.height)),we<1)if(typeof HTMLImageElement<"u"&&G instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&G instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&G instanceof ImageBitmap||typeof VideoFrame<"u"&&G instanceof VideoFrame){const ge=Math.floor(we*Ce.width),je=Math.floor(we*Ce.height);g===void 0&&(g=b(ge,je));const He=H?b(ge,je):g;return He.width=ge,He.height=je,He.getContext("2d").drawImage(G,0,0,ge,je),$t("WebGLRenderer: Texture has been resized from ("+Ce.width+"x"+Ce.height+") to ("+ge+"x"+je+")."),He}else return"data"in G&&$t("WebGLRenderer: Image in DataTexture is too big ("+Ce.width+"x"+Ce.height+")."),G;return G}function y(G){return G.generateMipmaps}function S(G){t.generateMipmap(G)}function D(G){return G.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:G.isWebGL3DRenderTarget?t.TEXTURE_3D:G.isWebGLArrayRenderTarget||G.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function L(G,H,ie,we,Ce=!1){if(G!==null){if(t[G]!==void 0)return t[G];$t("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+G+"'")}let ge=H;if(H===t.RED&&(ie===t.FLOAT&&(ge=t.R32F),ie===t.HALF_FLOAT&&(ge=t.R16F),ie===t.UNSIGNED_BYTE&&(ge=t.R8)),H===t.RED_INTEGER&&(ie===t.UNSIGNED_BYTE&&(ge=t.R8UI),ie===t.UNSIGNED_SHORT&&(ge=t.R16UI),ie===t.UNSIGNED_INT&&(ge=t.R32UI),ie===t.BYTE&&(ge=t.R8I),ie===t.SHORT&&(ge=t.R16I),ie===t.INT&&(ge=t.R32I)),H===t.RG&&(ie===t.FLOAT&&(ge=t.RG32F),ie===t.HALF_FLOAT&&(ge=t.RG16F),ie===t.UNSIGNED_BYTE&&(ge=t.RG8)),H===t.RG_INTEGER&&(ie===t.UNSIGNED_BYTE&&(ge=t.RG8UI),ie===t.UNSIGNED_SHORT&&(ge=t.RG16UI),ie===t.UNSIGNED_INT&&(ge=t.RG32UI),ie===t.BYTE&&(ge=t.RG8I),ie===t.SHORT&&(ge=t.RG16I),ie===t.INT&&(ge=t.RG32I)),H===t.RGB_INTEGER&&(ie===t.UNSIGNED_BYTE&&(ge=t.RGB8UI),ie===t.UNSIGNED_SHORT&&(ge=t.RGB16UI),ie===t.UNSIGNED_INT&&(ge=t.RGB32UI),ie===t.BYTE&&(ge=t.RGB8I),ie===t.SHORT&&(ge=t.RGB16I),ie===t.INT&&(ge=t.RGB32I)),H===t.RGBA_INTEGER&&(ie===t.UNSIGNED_BYTE&&(ge=t.RGBA8UI),ie===t.UNSIGNED_SHORT&&(ge=t.RGBA16UI),ie===t.UNSIGNED_INT&&(ge=t.RGBA32UI),ie===t.BYTE&&(ge=t.RGBA8I),ie===t.SHORT&&(ge=t.RGBA16I),ie===t.INT&&(ge=t.RGBA32I)),H===t.RGB&&(ie===t.UNSIGNED_INT_5_9_9_9_REV&&(ge=t.RGB9_E5),ie===t.UNSIGNED_INT_10F_11F_11F_REV&&(ge=t.R11F_G11F_B10F)),H===t.RGBA){const je=Ce?$p:yn.getTransfer(we);ie===t.FLOAT&&(ge=t.RGBA32F),ie===t.HALF_FLOAT&&(ge=t.RGBA16F),ie===t.UNSIGNED_BYTE&&(ge=je===On?t.SRGB8_ALPHA8:t.RGBA8),ie===t.UNSIGNED_SHORT_4_4_4_4&&(ge=t.RGBA4),ie===t.UNSIGNED_SHORT_5_5_5_1&&(ge=t.RGB5_A1)}return(ge===t.R16F||ge===t.R32F||ge===t.RG16F||ge===t.RG32F||ge===t.RGBA16F||ge===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ge}function N(G,H){let ie;return G?H===null||H===nr||H===Hu?ie=t.DEPTH24_STENCIL8:H===Ks?ie=t.DEPTH32F_STENCIL8:H===Uu&&(ie=t.DEPTH24_STENCIL8,$t("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):H===null||H===nr||H===Hu?ie=t.DEPTH_COMPONENT24:H===Ks?ie=t.DEPTH_COMPONENT32F:H===Uu&&(ie=t.DEPTH_COMPONENT16),ie}function T(G,H){return y(G)===!0||G.isFramebufferTexture&&G.minFilter!==Ki&&G.minFilter!==sa?Math.log2(Math.max(H.width,H.height))+1:G.mipmaps!==void 0&&G.mipmaps.length>0?G.mipmaps.length:G.isCompressedTexture&&Array.isArray(G.image)?H.mipmaps.length:1}function j(G){const H=G.target;H.removeEventListener("dispose",j),R(H),H.isVideoTexture&&m.delete(H)}function E(G){const H=G.target;H.removeEventListener("dispose",E),I(H)}function R(G){const H=s.get(G);if(H.__webglInit===void 0)return;const ie=G.source,we=v.get(ie);if(we){const Ce=we[H.__cacheKey];Ce.usedTimes--,Ce.usedTimes===0&&M(G),Object.keys(we).length===0&&v.delete(ie)}s.remove(G)}function M(G){const H=s.get(G);t.deleteTexture(H.__webglTexture);const ie=G.source,we=v.get(ie);delete we[H.__cacheKey],d.memory.textures--}function I(G){const H=s.get(G);if(G.depthTexture&&(G.depthTexture.dispose(),s.remove(G.depthTexture)),G.isWebGLCubeRenderTarget)for(let we=0;we<6;we++){if(Array.isArray(H.__webglFramebuffer[we]))for(let Ce=0;Ce<H.__webglFramebuffer[we].length;Ce++)t.deleteFramebuffer(H.__webglFramebuffer[we][Ce]);else t.deleteFramebuffer(H.__webglFramebuffer[we]);H.__webglDepthbuffer&&t.deleteRenderbuffer(H.__webglDepthbuffer[we])}else{if(Array.isArray(H.__webglFramebuffer))for(let we=0;we<H.__webglFramebuffer.length;we++)t.deleteFramebuffer(H.__webglFramebuffer[we]);else t.deleteFramebuffer(H.__webglFramebuffer);if(H.__webglDepthbuffer&&t.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&t.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let we=0;we<H.__webglColorRenderbuffer.length;we++)H.__webglColorRenderbuffer[we]&&t.deleteRenderbuffer(H.__webglColorRenderbuffer[we]);H.__webglDepthRenderbuffer&&t.deleteRenderbuffer(H.__webglDepthRenderbuffer)}const ie=G.textures;for(let we=0,Ce=ie.length;we<Ce;we++){const ge=s.get(ie[we]);ge.__webglTexture&&(t.deleteTexture(ge.__webglTexture),d.memory.textures--),s.remove(ie[we])}s.remove(G)}let z=0;function V(){z=0}function O(){const G=z;return G>=o.maxTextures&&$t("WebGLTextures: Trying to use "+G+" texture units while this GPU supports only "+o.maxTextures),z+=1,G}function k(G){const H=[];return H.push(G.wrapS),H.push(G.wrapT),H.push(G.wrapR||0),H.push(G.magFilter),H.push(G.minFilter),H.push(G.anisotropy),H.push(G.internalFormat),H.push(G.format),H.push(G.type),H.push(G.generateMipmaps),H.push(G.premultiplyAlpha),H.push(G.flipY),H.push(G.unpackAlignment),H.push(G.colorSpace),H.join()}function F(G,H){const ie=s.get(G);if(G.isVideoTexture&&It(G),G.isRenderTargetTexture===!1&&G.isExternalTexture!==!0&&G.version>0&&ie.__version!==G.version){const we=G.image;if(we===null)$t("WebGLRenderer: Texture marked for update but no image data found.");else if(we.complete===!1)$t("WebGLRenderer: Texture marked for update but image is incomplete");else{oe(ie,G,H);return}}else G.isExternalTexture&&(ie.__webglTexture=G.sourceTexture?G.sourceTexture:null);n.bindTexture(t.TEXTURE_2D,ie.__webglTexture,t.TEXTURE0+H)}function A(G,H){const ie=s.get(G);if(G.isRenderTargetTexture===!1&&G.version>0&&ie.__version!==G.version){oe(ie,G,H);return}else G.isExternalTexture&&(ie.__webglTexture=G.sourceTexture?G.sourceTexture:null);n.bindTexture(t.TEXTURE_2D_ARRAY,ie.__webglTexture,t.TEXTURE0+H)}function q(G,H){const ie=s.get(G);if(G.isRenderTargetTexture===!1&&G.version>0&&ie.__version!==G.version){oe(ie,G,H);return}n.bindTexture(t.TEXTURE_3D,ie.__webglTexture,t.TEXTURE0+H)}function B(G,H){const ie=s.get(G);if(G.isCubeDepthTexture!==!0&&G.version>0&&ie.__version!==G.version){ue(ie,G,H);return}n.bindTexture(t.TEXTURE_CUBE_MAP,ie.__webglTexture,t.TEXTURE0+H)}const W={[I0]:t.REPEAT,[zr]:t.CLAMP_TO_EDGE,[O0]:t.MIRRORED_REPEAT},Q={[Ki]:t.NEAREST,[mB]:t.NEAREST_MIPMAP_NEAREST,[Nh]:t.NEAREST_MIPMAP_LINEAR,[sa]:t.LINEAR,[Qx]:t.LINEAR_MIPMAP_NEAREST,[vl]:t.LINEAR_MIPMAP_LINEAR},ne={[yB]:t.NEVER,[MB]:t.ALWAYS,[vB]:t.LESS,[r_]:t.LEQUAL,[_B]:t.EQUAL,[o_]:t.GEQUAL,[bB]:t.GREATER,[SB]:t.NOTEQUAL};function de(G,H){if(H.type===Ks&&e.has("OES_texture_float_linear")===!1&&(H.magFilter===sa||H.magFilter===Qx||H.magFilter===Nh||H.magFilter===vl||H.minFilter===sa||H.minFilter===Qx||H.minFilter===Nh||H.minFilter===vl)&&$t("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(G,t.TEXTURE_WRAP_S,W[H.wrapS]),t.texParameteri(G,t.TEXTURE_WRAP_T,W[H.wrapT]),(G===t.TEXTURE_3D||G===t.TEXTURE_2D_ARRAY)&&t.texParameteri(G,t.TEXTURE_WRAP_R,W[H.wrapR]),t.texParameteri(G,t.TEXTURE_MAG_FILTER,Q[H.magFilter]),t.texParameteri(G,t.TEXTURE_MIN_FILTER,Q[H.minFilter]),H.compareFunction&&(t.texParameteri(G,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(G,t.TEXTURE_COMPARE_FUNC,ne[H.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(H.magFilter===Ki||H.minFilter!==Nh&&H.minFilter!==vl||H.type===Ks&&e.has("OES_texture_float_linear")===!1)return;if(H.anisotropy>1||s.get(H).__currentAnisotropy){const ie=e.get("EXT_texture_filter_anisotropic");t.texParameterf(G,ie.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(H.anisotropy,o.getMaxAnisotropy())),s.get(H).__currentAnisotropy=H.anisotropy}}}function $(G,H){let ie=!1;G.__webglInit===void 0&&(G.__webglInit=!0,H.addEventListener("dispose",j));const we=H.source;let Ce=v.get(we);Ce===void 0&&(Ce={},v.set(we,Ce));const ge=k(H);if(ge!==G.__cacheKey){Ce[ge]===void 0&&(Ce[ge]={texture:t.createTexture(),usedTimes:0},d.memory.textures++,ie=!0),Ce[ge].usedTimes++;const je=Ce[G.__cacheKey];je!==void 0&&(Ce[G.__cacheKey].usedTimes--,je.usedTimes===0&&M(H)),G.__cacheKey=ge,G.__webglTexture=Ce[ge].texture}return ie}function X(G,H,ie){return Math.floor(Math.floor(G/ie)/H)}function le(G,H,ie,we){const ge=G.updateRanges;if(ge.length===0)n.texSubImage2D(t.TEXTURE_2D,0,0,0,H.width,H.height,ie,we,H.data);else{ge.sort((We,qe)=>We.start-qe.start);let je=0;for(let We=1;We<ge.length;We++){const qe=ge[je],at=ge[We],ot=qe.start+qe.count,st=X(at.start,H.width,4),it=X(qe.start,H.width,4);at.start<=ot+1&&st===it&&X(at.start+at.count-1,H.width,4)===st?qe.count=Math.max(qe.count,at.start+at.count-qe.start):(++je,ge[je]=at)}ge.length=je+1;const He=t.getParameter(t.UNPACK_ROW_LENGTH),dt=t.getParameter(t.UNPACK_SKIP_PIXELS),gt=t.getParameter(t.UNPACK_SKIP_ROWS);t.pixelStorei(t.UNPACK_ROW_LENGTH,H.width);for(let We=0,qe=ge.length;We<qe;We++){const at=ge[We],ot=Math.floor(at.start/4),st=Math.ceil(at.count/4),it=ot%H.width,re=Math.floor(ot/H.width),rt=st,Ze=1;t.pixelStorei(t.UNPACK_SKIP_PIXELS,it),t.pixelStorei(t.UNPACK_SKIP_ROWS,re),n.texSubImage2D(t.TEXTURE_2D,0,it,re,rt,Ze,ie,we,H.data)}G.clearUpdateRanges(),t.pixelStorei(t.UNPACK_ROW_LENGTH,He),t.pixelStorei(t.UNPACK_SKIP_PIXELS,dt),t.pixelStorei(t.UNPACK_SKIP_ROWS,gt)}}function oe(G,H,ie){let we=t.TEXTURE_2D;(H.isDataArrayTexture||H.isCompressedArrayTexture)&&(we=t.TEXTURE_2D_ARRAY),H.isData3DTexture&&(we=t.TEXTURE_3D);const Ce=$(G,H),ge=H.source;n.bindTexture(we,G.__webglTexture,t.TEXTURE0+ie);const je=s.get(ge);if(ge.version!==je.__version||Ce===!0){n.activeTexture(t.TEXTURE0+ie);const He=yn.getPrimaries(yn.workingColorSpace),dt=H.colorSpace===Io?null:yn.getPrimaries(H.colorSpace),gt=H.colorSpace===Io||He===dt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,H.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,H.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,gt);let We=_(H.image,!1,o.maxTextureSize);We=tt(H,We);const qe=l.convert(H.format,H.colorSpace),at=l.convert(H.type);let ot=L(H.internalFormat,qe,at,H.colorSpace,H.isVideoTexture);de(we,H);let st;const it=H.mipmaps,re=H.isVideoTexture!==!0,rt=je.__version===void 0||Ce===!0,Ze=ge.dataReady,ht=T(H,We);if(H.isDepthTexture)ot=N(H.format===_l,H.type),rt&&(re?n.texStorage2D(t.TEXTURE_2D,1,ot,We.width,We.height):n.texImage2D(t.TEXTURE_2D,0,ot,We.width,We.height,0,qe,at,null));else if(H.isDataTexture)if(it.length>0){re&&rt&&n.texStorage2D(t.TEXTURE_2D,ht,ot,it[0].width,it[0].height);for(let Ke=0,Ue=it.length;Ke<Ue;Ke++)st=it[Ke],re?Ze&&n.texSubImage2D(t.TEXTURE_2D,Ke,0,0,st.width,st.height,qe,at,st.data):n.texImage2D(t.TEXTURE_2D,Ke,ot,st.width,st.height,0,qe,at,st.data);H.generateMipmaps=!1}else re?(rt&&n.texStorage2D(t.TEXTURE_2D,ht,ot,We.width,We.height),Ze&&le(H,We,qe,at)):n.texImage2D(t.TEXTURE_2D,0,ot,We.width,We.height,0,qe,at,We.data);else if(H.isCompressedTexture)if(H.isCompressedArrayTexture){re&&rt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,ht,ot,it[0].width,it[0].height,We.depth);for(let Ke=0,Ue=it.length;Ke<Ue;Ke++)if(st=it[Ke],H.format!==Ds)if(qe!==null)if(re){if(Ze)if(H.layerUpdates.size>0){const Je=wC(st.width,st.height,H.format,H.type);for(const ye of H.layerUpdates){const ut=st.data.subarray(ye*Je/st.data.BYTES_PER_ELEMENT,(ye+1)*Je/st.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ke,0,0,ye,st.width,st.height,1,qe,ut)}H.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ke,0,0,0,st.width,st.height,We.depth,qe,st.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Ke,ot,st.width,st.height,We.depth,0,st.data,0,0);else $t("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else re?Ze&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Ke,0,0,0,st.width,st.height,We.depth,qe,at,st.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Ke,ot,st.width,st.height,We.depth,0,qe,at,st.data)}else{re&&rt&&n.texStorage2D(t.TEXTURE_2D,ht,ot,it[0].width,it[0].height);for(let Ke=0,Ue=it.length;Ke<Ue;Ke++)st=it[Ke],H.format!==Ds?qe!==null?re?Ze&&n.compressedTexSubImage2D(t.TEXTURE_2D,Ke,0,0,st.width,st.height,qe,st.data):n.compressedTexImage2D(t.TEXTURE_2D,Ke,ot,st.width,st.height,0,st.data):$t("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):re?Ze&&n.texSubImage2D(t.TEXTURE_2D,Ke,0,0,st.width,st.height,qe,at,st.data):n.texImage2D(t.TEXTURE_2D,Ke,ot,st.width,st.height,0,qe,at,st.data)}else if(H.isDataArrayTexture)if(re){if(rt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,ht,ot,We.width,We.height,We.depth),Ze)if(H.layerUpdates.size>0){const Ke=wC(We.width,We.height,H.format,H.type);for(const Ue of H.layerUpdates){const Je=We.data.subarray(Ue*Ke/We.data.BYTES_PER_ELEMENT,(Ue+1)*Ke/We.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Ue,We.width,We.height,1,qe,at,Je)}H.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,We.width,We.height,We.depth,qe,at,We.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,ot,We.width,We.height,We.depth,0,qe,at,We.data);else if(H.isData3DTexture)re?(rt&&n.texStorage3D(t.TEXTURE_3D,ht,ot,We.width,We.height,We.depth),Ze&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,We.width,We.height,We.depth,qe,at,We.data)):n.texImage3D(t.TEXTURE_3D,0,ot,We.width,We.height,We.depth,0,qe,at,We.data);else if(H.isFramebufferTexture){if(rt)if(re)n.texStorage2D(t.TEXTURE_2D,ht,ot,We.width,We.height);else{let Ke=We.width,Ue=We.height;for(let Je=0;Je<ht;Je++)n.texImage2D(t.TEXTURE_2D,Je,ot,Ke,Ue,0,qe,at,null),Ke>>=1,Ue>>=1}}else if(it.length>0){if(re&&rt){const Ke=nt(it[0]);n.texStorage2D(t.TEXTURE_2D,ht,ot,Ke.width,Ke.height)}for(let Ke=0,Ue=it.length;Ke<Ue;Ke++)st=it[Ke],re?Ze&&n.texSubImage2D(t.TEXTURE_2D,Ke,0,0,qe,at,st):n.texImage2D(t.TEXTURE_2D,Ke,ot,qe,at,st);H.generateMipmaps=!1}else if(re){if(rt){const Ke=nt(We);n.texStorage2D(t.TEXTURE_2D,ht,ot,Ke.width,Ke.height)}Ze&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,qe,at,We)}else n.texImage2D(t.TEXTURE_2D,0,ot,qe,at,We);y(H)&&S(we),je.__version=ge.version,H.onUpdate&&H.onUpdate(H)}G.__version=H.version}function ue(G,H,ie){if(H.image.length!==6)return;const we=$(G,H),Ce=H.source;n.bindTexture(t.TEXTURE_CUBE_MAP,G.__webglTexture,t.TEXTURE0+ie);const ge=s.get(Ce);if(Ce.version!==ge.__version||we===!0){n.activeTexture(t.TEXTURE0+ie);const je=yn.getPrimaries(yn.workingColorSpace),He=H.colorSpace===Io?null:yn.getPrimaries(H.colorSpace),dt=H.colorSpace===Io||je===He?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,H.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,H.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,dt);const gt=H.isCompressedTexture||H.image[0].isCompressedTexture,We=H.image[0]&&H.image[0].isDataTexture,qe=[];for(let Ue=0;Ue<6;Ue++)!gt&&!We?qe[Ue]=_(H.image[Ue],!0,o.maxCubemapSize):qe[Ue]=We?H.image[Ue].image:H.image[Ue],qe[Ue]=tt(H,qe[Ue]);const at=qe[0],ot=l.convert(H.format,H.colorSpace),st=l.convert(H.type),it=L(H.internalFormat,ot,st,H.colorSpace),re=H.isVideoTexture!==!0,rt=ge.__version===void 0||we===!0,Ze=Ce.dataReady;let ht=T(H,at);de(t.TEXTURE_CUBE_MAP,H);let Ke;if(gt){re&&rt&&n.texStorage2D(t.TEXTURE_CUBE_MAP,ht,it,at.width,at.height);for(let Ue=0;Ue<6;Ue++){Ke=qe[Ue].mipmaps;for(let Je=0;Je<Ke.length;Je++){const ye=Ke[Je];H.format!==Ds?ot!==null?re?Ze&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je,0,0,ye.width,ye.height,ot,ye.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je,it,ye.width,ye.height,0,ye.data):$t("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):re?Ze&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je,0,0,ye.width,ye.height,ot,st,ye.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je,it,ye.width,ye.height,0,ot,st,ye.data)}}}else{if(Ke=H.mipmaps,re&&rt){Ke.length>0&&ht++;const Ue=nt(qe[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,ht,it,Ue.width,Ue.height)}for(let Ue=0;Ue<6;Ue++)if(We){re?Ze&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,qe[Ue].width,qe[Ue].height,ot,st,qe[Ue].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,it,qe[Ue].width,qe[Ue].height,0,ot,st,qe[Ue].data);for(let Je=0;Je<Ke.length;Je++){const ut=Ke[Je].image[Ue].image;re?Ze&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je+1,0,0,ut.width,ut.height,ot,st,ut.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je+1,it,ut.width,ut.height,0,ot,st,ut.data)}}else{re?Ze&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,ot,st,qe[Ue]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,it,ot,st,qe[Ue]);for(let Je=0;Je<Ke.length;Je++){const ye=Ke[Je];re?Ze&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je+1,0,0,ot,st,ye.image[Ue]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,Je+1,it,ot,st,ye.image[Ue])}}}y(H)&&S(t.TEXTURE_CUBE_MAP),ge.__version=Ce.version,H.onUpdate&&H.onUpdate(H)}G.__version=H.version}function Ye(G,H,ie,we,Ce,ge){const je=l.convert(ie.format,ie.colorSpace),He=l.convert(ie.type),dt=L(ie.internalFormat,je,He,ie.colorSpace),gt=s.get(H),We=s.get(ie);if(We.__renderTarget=H,!gt.__hasExternalTextures){const qe=Math.max(1,H.width>>ge),at=Math.max(1,H.height>>ge);Ce===t.TEXTURE_3D||Ce===t.TEXTURE_2D_ARRAY?n.texImage3D(Ce,ge,dt,qe,at,H.depth,0,je,He,null):n.texImage2D(Ce,ge,dt,qe,at,0,je,He,null)}n.bindFramebuffer(t.FRAMEBUFFER,G),bt(H)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,we,Ce,We.__webglTexture,0,te(H)):(Ce===t.TEXTURE_2D||Ce>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Ce<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,we,Ce,We.__webglTexture,ge),n.bindFramebuffer(t.FRAMEBUFFER,null)}function ae(G,H,ie){if(t.bindRenderbuffer(t.RENDERBUFFER,G),H.depthBuffer){const we=H.depthTexture,Ce=we&&we.isDepthTexture?we.type:null,ge=N(H.stencilBuffer,Ce),je=H.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;bt(H)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,te(H),ge,H.width,H.height):ie?t.renderbufferStorageMultisample(t.RENDERBUFFER,te(H),ge,H.width,H.height):t.renderbufferStorage(t.RENDERBUFFER,ge,H.width,H.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,je,t.RENDERBUFFER,G)}else{const we=H.textures;for(let Ce=0;Ce<we.length;Ce++){const ge=we[Ce],je=l.convert(ge.format,ge.colorSpace),He=l.convert(ge.type),dt=L(ge.internalFormat,je,He,ge.colorSpace);bt(H)?u.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,te(H),dt,H.width,H.height):ie?t.renderbufferStorageMultisample(t.RENDERBUFFER,te(H),dt,H.width,H.height):t.renderbufferStorage(t.RENDERBUFFER,dt,H.width,H.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function fe(G,H,ie){const we=H.isWebGLCubeRenderTarget===!0;if(n.bindFramebuffer(t.FRAMEBUFFER,G),!(H.depthTexture&&H.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Ce=s.get(H.depthTexture);if(Ce.__renderTarget=H,(!Ce.__webglTexture||H.depthTexture.image.width!==H.width||H.depthTexture.image.height!==H.height)&&(H.depthTexture.image.width=H.width,H.depthTexture.image.height=H.height,H.depthTexture.needsUpdate=!0),we){if(Ce.__webglInit===void 0&&(Ce.__webglInit=!0,H.depthTexture.addEventListener("dispose",j)),Ce.__webglTexture===void 0){Ce.__webglTexture=t.createTexture(),n.bindTexture(t.TEXTURE_CUBE_MAP,Ce.__webglTexture),de(t.TEXTURE_CUBE_MAP,H.depthTexture);const gt=l.convert(H.depthTexture.format),We=l.convert(H.depthTexture.type);let qe;H.depthTexture.format===Xr?qe=t.DEPTH_COMPONENT24:H.depthTexture.format===_l&&(qe=t.DEPTH24_STENCIL8);for(let at=0;at<6;at++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+at,0,qe,H.width,H.height,0,gt,We,null)}}else F(H.depthTexture,0);const ge=Ce.__webglTexture,je=te(H),He=we?t.TEXTURE_CUBE_MAP_POSITIVE_X+ie:t.TEXTURE_2D,dt=H.depthTexture.format===_l?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(H.depthTexture.format===Xr)bt(H)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,dt,He,ge,0,je):t.framebufferTexture2D(t.FRAMEBUFFER,dt,He,ge,0);else if(H.depthTexture.format===_l)bt(H)?u.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,dt,He,ge,0,je):t.framebufferTexture2D(t.FRAMEBUFFER,dt,He,ge,0);else throw new Error("Unknown depthTexture format")}function pt(G){const H=s.get(G),ie=G.isWebGLCubeRenderTarget===!0;if(H.__boundDepthTexture!==G.depthTexture){const we=G.depthTexture;if(H.__depthDisposeCallback&&H.__depthDisposeCallback(),we){const Ce=()=>{delete H.__boundDepthTexture,delete H.__depthDisposeCallback,we.removeEventListener("dispose",Ce)};we.addEventListener("dispose",Ce),H.__depthDisposeCallback=Ce}H.__boundDepthTexture=we}if(G.depthTexture&&!H.__autoAllocateDepthBuffer)if(ie)for(let we=0;we<6;we++)fe(H.__webglFramebuffer[we],G,we);else{const we=G.texture.mipmaps;we&&we.length>0?fe(H.__webglFramebuffer[0],G,0):fe(H.__webglFramebuffer,G,0)}else if(ie){H.__webglDepthbuffer=[];for(let we=0;we<6;we++)if(n.bindFramebuffer(t.FRAMEBUFFER,H.__webglFramebuffer[we]),H.__webglDepthbuffer[we]===void 0)H.__webglDepthbuffer[we]=t.createRenderbuffer(),ae(H.__webglDepthbuffer[we],G,!1);else{const Ce=G.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ge=H.__webglDepthbuffer[we];t.bindRenderbuffer(t.RENDERBUFFER,ge),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ce,t.RENDERBUFFER,ge)}}else{const we=G.texture.mipmaps;if(we&&we.length>0?n.bindFramebuffer(t.FRAMEBUFFER,H.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,H.__webglFramebuffer),H.__webglDepthbuffer===void 0)H.__webglDepthbuffer=t.createRenderbuffer(),ae(H.__webglDepthbuffer,G,!1);else{const Ce=G.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ge=H.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,ge),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ce,t.RENDERBUFFER,ge)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function _t(G,H,ie){const we=s.get(G);H!==void 0&&Ye(we.__webglFramebuffer,G,G.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),ie!==void 0&&pt(G)}function Se(G){const H=G.texture,ie=s.get(G),we=s.get(H);G.addEventListener("dispose",E);const Ce=G.textures,ge=G.isWebGLCubeRenderTarget===!0,je=Ce.length>1;if(je||(we.__webglTexture===void 0&&(we.__webglTexture=t.createTexture()),we.__version=H.version,d.memory.textures++),ge){ie.__webglFramebuffer=[];for(let He=0;He<6;He++)if(H.mipmaps&&H.mipmaps.length>0){ie.__webglFramebuffer[He]=[];for(let dt=0;dt<H.mipmaps.length;dt++)ie.__webglFramebuffer[He][dt]=t.createFramebuffer()}else ie.__webglFramebuffer[He]=t.createFramebuffer()}else{if(H.mipmaps&&H.mipmaps.length>0){ie.__webglFramebuffer=[];for(let He=0;He<H.mipmaps.length;He++)ie.__webglFramebuffer[He]=t.createFramebuffer()}else ie.__webglFramebuffer=t.createFramebuffer();if(je)for(let He=0,dt=Ce.length;He<dt;He++){const gt=s.get(Ce[He]);gt.__webglTexture===void 0&&(gt.__webglTexture=t.createTexture(),d.memory.textures++)}if(G.samples>0&&bt(G)===!1){ie.__webglMultisampledFramebuffer=t.createFramebuffer(),ie.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,ie.__webglMultisampledFramebuffer);for(let He=0;He<Ce.length;He++){const dt=Ce[He];ie.__webglColorRenderbuffer[He]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,ie.__webglColorRenderbuffer[He]);const gt=l.convert(dt.format,dt.colorSpace),We=l.convert(dt.type),qe=L(dt.internalFormat,gt,We,dt.colorSpace,G.isXRRenderTarget===!0),at=te(G);t.renderbufferStorageMultisample(t.RENDERBUFFER,at,qe,G.width,G.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+He,t.RENDERBUFFER,ie.__webglColorRenderbuffer[He])}t.bindRenderbuffer(t.RENDERBUFFER,null),G.depthBuffer&&(ie.__webglDepthRenderbuffer=t.createRenderbuffer(),ae(ie.__webglDepthRenderbuffer,G,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(ge){n.bindTexture(t.TEXTURE_CUBE_MAP,we.__webglTexture),de(t.TEXTURE_CUBE_MAP,H);for(let He=0;He<6;He++)if(H.mipmaps&&H.mipmaps.length>0)for(let dt=0;dt<H.mipmaps.length;dt++)Ye(ie.__webglFramebuffer[He][dt],G,H,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+He,dt);else Ye(ie.__webglFramebuffer[He],G,H,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+He,0);y(H)&&S(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(je){for(let He=0,dt=Ce.length;He<dt;He++){const gt=Ce[He],We=s.get(gt);let qe=t.TEXTURE_2D;(G.isWebGL3DRenderTarget||G.isWebGLArrayRenderTarget)&&(qe=G.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(qe,We.__webglTexture),de(qe,gt),Ye(ie.__webglFramebuffer,G,gt,t.COLOR_ATTACHMENT0+He,qe,0),y(gt)&&S(qe)}n.unbindTexture()}else{let He=t.TEXTURE_2D;if((G.isWebGL3DRenderTarget||G.isWebGLArrayRenderTarget)&&(He=G.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(He,we.__webglTexture),de(He,H),H.mipmaps&&H.mipmaps.length>0)for(let dt=0;dt<H.mipmaps.length;dt++)Ye(ie.__webglFramebuffer[dt],G,H,t.COLOR_ATTACHMENT0,He,dt);else Ye(ie.__webglFramebuffer,G,H,t.COLOR_ATTACHMENT0,He,0);y(H)&&S(He),n.unbindTexture()}G.depthBuffer&&pt(G)}function $e(G){const H=G.textures;for(let ie=0,we=H.length;ie<we;ie++){const Ce=H[ie];if(y(Ce)){const ge=D(G),je=s.get(Ce).__webglTexture;n.bindTexture(ge,je),S(ge),n.unbindTexture()}}}const jt=[],Fe=[];function Dt(G){if(G.samples>0){if(bt(G)===!1){const H=G.textures,ie=G.width,we=G.height;let Ce=t.COLOR_BUFFER_BIT;const ge=G.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,je=s.get(G),He=H.length>1;if(He)for(let gt=0;gt<H.length;gt++)n.bindFramebuffer(t.FRAMEBUFFER,je.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+gt,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,je.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+gt,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,je.__webglMultisampledFramebuffer);const dt=G.texture.mipmaps;dt&&dt.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,je.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,je.__webglFramebuffer);for(let gt=0;gt<H.length;gt++){if(G.resolveDepthBuffer&&(G.depthBuffer&&(Ce|=t.DEPTH_BUFFER_BIT),G.stencilBuffer&&G.resolveStencilBuffer&&(Ce|=t.STENCIL_BUFFER_BIT)),He){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,je.__webglColorRenderbuffer[gt]);const We=s.get(H[gt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,We,0)}t.blitFramebuffer(0,0,ie,we,0,0,ie,we,Ce,t.NEAREST),h===!0&&(jt.length=0,Fe.length=0,jt.push(t.COLOR_ATTACHMENT0+gt),G.depthBuffer&&G.resolveDepthBuffer===!1&&(jt.push(ge),Fe.push(ge),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,Fe)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,jt))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),He)for(let gt=0;gt<H.length;gt++){n.bindFramebuffer(t.FRAMEBUFFER,je.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+gt,t.RENDERBUFFER,je.__webglColorRenderbuffer[gt]);const We=s.get(H[gt]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,je.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+gt,t.TEXTURE_2D,We,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,je.__webglMultisampledFramebuffer)}else if(G.depthBuffer&&G.resolveDepthBuffer===!1&&h){const H=G.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[H])}}}function te(G){return Math.min(o.maxSamples,G.samples)}function bt(G){const H=s.get(G);return G.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&H.__useRenderToTexture!==!1}function It(G){const H=d.render.frame;m.get(G)!==H&&(m.set(G,H),G.update())}function tt(G,H){const ie=G.colorSpace,we=G.format,Ce=G.type;return G.isCompressedTexture===!0||G.isVideoTexture===!0||ie!==Jc&&ie!==Io&&(yn.getTransfer(ie)===On?(we!==Ds||Ce!==Va)&&$t("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Sn("WebGLTextures: Unsupported texture color space:",ie)),H}function nt(G){return typeof HTMLImageElement<"u"&&G instanceof HTMLImageElement?(p.width=G.naturalWidth||G.width,p.height=G.naturalHeight||G.height):typeof VideoFrame<"u"&&G instanceof VideoFrame?(p.width=G.displayWidth,p.height=G.displayHeight):(p.width=G.width,p.height=G.height),p}this.allocateTextureUnit=O,this.resetTextureUnits=V,this.setTexture2D=F,this.setTexture2DArray=A,this.setTexture3D=q,this.setTextureCube=B,this.rebindTextures=_t,this.setupRenderTarget=Se,this.updateRenderTargetMipmap=$e,this.updateMultisampleRenderTarget=Dt,this.setupDepthRenderbuffer=pt,this.setupFrameBufferTexture=Ye,this.useMultisampledRTT=bt,this.isReversedDepthBuffer=function(){return n.buffers.depth.getReversed()}}function tH(t,e){function n(s,o=Io){let l;const d=yn.getTransfer(o);if(s===Va)return t.UNSIGNED_BYTE;if(s===t_)return t.UNSIGNED_SHORT_4_4_4_4;if(s===n_)return t.UNSIGNED_SHORT_5_5_5_1;if(s===DE)return t.UNSIGNED_INT_5_9_9_9_REV;if(s===IE)return t.UNSIGNED_INT_10F_11F_11F_REV;if(s===AE)return t.BYTE;if(s===RE)return t.SHORT;if(s===Uu)return t.UNSIGNED_SHORT;if(s===e_)return t.INT;if(s===nr)return t.UNSIGNED_INT;if(s===Ks)return t.FLOAT;if(s===Kr)return t.HALF_FLOAT;if(s===OE)return t.ALPHA;if(s===PE)return t.RGB;if(s===Ds)return t.RGBA;if(s===Xr)return t.DEPTH_COMPONENT;if(s===_l)return t.DEPTH_STENCIL;if(s===LE)return t.RED;if(s===i_)return t.RED_INTEGER;if(s===Zc)return t.RG;if(s===a_)return t.RG_INTEGER;if(s===s_)return t.RGBA_INTEGER;if(s===jp||s===Ep||s===Ap||s===Rp)if(d===On)if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),l!==null){if(s===jp)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Ep)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Ap)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Rp)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(l=e.get("WEBGL_compressed_texture_s3tc"),l!==null){if(s===jp)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Ep)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Ap)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Rp)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===P0||s===L0||s===N0||s===F0)if(l=e.get("WEBGL_compressed_texture_pvrtc"),l!==null){if(s===P0)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===L0)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===N0)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===F0)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===z0||s===k0||s===B0||s===U0||s===H0||s===V0||s===q0)if(l=e.get("WEBGL_compressed_texture_etc"),l!==null){if(s===z0||s===k0)return d===On?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(s===B0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC;if(s===U0)return l.COMPRESSED_R11_EAC;if(s===H0)return l.COMPRESSED_SIGNED_R11_EAC;if(s===V0)return l.COMPRESSED_RG11_EAC;if(s===q0)return l.COMPRESSED_SIGNED_RG11_EAC}else return null;if(s===G0||s===$0||s===W0||s===Y0||s===K0||s===X0||s===Q0||s===Z0||s===J0||s===ev||s===tv||s===nv||s===iv||s===av)if(l=e.get("WEBGL_compressed_texture_astc"),l!==null){if(s===G0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===$0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===W0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Y0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===K0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===X0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===Q0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Z0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===J0)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===ev)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===tv)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===nv)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===iv)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===av)return d===On?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===sv||s===rv||s===ov)if(l=e.get("EXT_texture_compression_bptc"),l!==null){if(s===sv)return d===On?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===rv)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===ov)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===lv||s===cv||s===dv||s===uv)if(l=e.get("EXT_texture_compression_rgtc"),l!==null){if(s===lv)return l.COMPRESSED_RED_RGTC1_EXT;if(s===cv)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===dv)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===uv)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Hu?t.UNSIGNED_INT_24_8:t[s]!==void 0?t[s]:null}return{convert:n}}const nH=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,iH=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class aH{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n){if(this.texture===null){const s=new KE(e.texture);(e.depthNear!==n.depthNear||e.depthFar!==n.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,s=new sr({vertexShader:nH,fragmentShader:iH,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new ar(new rm(20,20),s)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class sH extends Pl{constructor(e,n){super();const s=this;let o=null,l=1,d=null,u="local-floor",h=1,p=null,m=null,g=null,v=null,C=null,b=null;const _=typeof XRWebGLBinding<"u",y=new aH,S={},D=n.getContextAttributes();let L=null,N=null;const T=[],j=[],E=new Xt;let R=null;const M=new ds;M.viewport=new ii;const I=new ds;I.viewport=new ii;const z=[M,I],V=new p4;let O=null,k=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(oe){let ue=T[oe];return ue===void 0&&(ue=new vy,T[oe]=ue),ue.getTargetRaySpace()},this.getControllerGrip=function(oe){let ue=T[oe];return ue===void 0&&(ue=new vy,T[oe]=ue),ue.getGripSpace()},this.getHand=function(oe){let ue=T[oe];return ue===void 0&&(ue=new vy,T[oe]=ue),ue.getHandSpace()};function F(oe){const ue=j.indexOf(oe.inputSource);if(ue===-1)return;const Ye=T[ue];Ye!==void 0&&(Ye.update(oe.inputSource,oe.frame,p||d),Ye.dispatchEvent({type:oe.type,data:oe.inputSource}))}function A(){o.removeEventListener("select",F),o.removeEventListener("selectstart",F),o.removeEventListener("selectend",F),o.removeEventListener("squeeze",F),o.removeEventListener("squeezestart",F),o.removeEventListener("squeezeend",F),o.removeEventListener("end",A),o.removeEventListener("inputsourceschange",q);for(let oe=0;oe<T.length;oe++){const ue=j[oe];ue!==null&&(j[oe]=null,T[oe].disconnect(ue))}O=null,k=null,y.reset();for(const oe in S)delete S[oe];e.setRenderTarget(L),C=null,v=null,g=null,o=null,N=null,le.stop(),s.isPresenting=!1,e.setPixelRatio(R),e.setSize(E.width,E.height,!1),s.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(oe){l=oe,s.isPresenting===!0&&$t("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){u=oe,s.isPresenting===!0&&$t("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||d},this.setReferenceSpace=function(oe){p=oe},this.getBaseLayer=function(){return v!==null?v:C},this.getBinding=function(){return g===null&&_&&(g=new XRWebGLBinding(o,n)),g},this.getFrame=function(){return b},this.getSession=function(){return o},this.setSession=async function(oe){if(o=oe,o!==null){if(L=e.getRenderTarget(),o.addEventListener("select",F),o.addEventListener("selectstart",F),o.addEventListener("selectend",F),o.addEventListener("squeeze",F),o.addEventListener("squeezestart",F),o.addEventListener("squeezeend",F),o.addEventListener("end",A),o.addEventListener("inputsourceschange",q),D.xrCompatible!==!0&&await n.makeXRCompatible(),R=e.getPixelRatio(),e.getSize(E),_&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ye=null,ae=null,fe=null;D.depth&&(fe=D.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Ye=D.stencil?_l:Xr,ae=D.stencil?Hu:nr);const pt={colorFormat:n.RGBA8,depthFormat:fe,scaleFactor:l};g=this.getBinding(),v=g.createProjectionLayer(pt),o.updateRenderState({layers:[v]}),e.setPixelRatio(1),e.setSize(v.textureWidth,v.textureHeight,!1),N=new Js(v.textureWidth,v.textureHeight,{format:Ds,type:Va,depthTexture:new qu(v.textureWidth,v.textureHeight,ae,void 0,void 0,void 0,void 0,void 0,void 0,Ye),stencilBuffer:D.stencil,colorSpace:e.outputColorSpace,samples:D.antialias?4:0,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}else{const Ye={antialias:D.antialias,alpha:!0,depth:D.depth,stencil:D.stencil,framebufferScaleFactor:l};C=new XRWebGLLayer(o,n,Ye),o.updateRenderState({baseLayer:C}),e.setPixelRatio(1),e.setSize(C.framebufferWidth,C.framebufferHeight,!1),N=new Js(C.framebufferWidth,C.framebufferHeight,{format:Ds,type:Va,colorSpace:e.outputColorSpace,stencilBuffer:D.stencil,resolveDepthBuffer:C.ignoreDepthValues===!1,resolveStencilBuffer:C.ignoreDepthValues===!1})}N.isXRRenderTarget=!0,this.setFoveation(h),p=null,d=await o.requestReferenceSpace(u),le.setContext(o),le.start(),s.isPresenting=!0,s.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(o!==null)return o.environmentBlendMode},this.getDepthTexture=function(){return y.getDepthTexture()};function q(oe){for(let ue=0;ue<oe.removed.length;ue++){const Ye=oe.removed[ue],ae=j.indexOf(Ye);ae>=0&&(j[ae]=null,T[ae].disconnect(Ye))}for(let ue=0;ue<oe.added.length;ue++){const Ye=oe.added[ue];let ae=j.indexOf(Ye);if(ae===-1){for(let pt=0;pt<T.length;pt++)if(pt>=j.length){j.push(Ye),ae=pt;break}else if(j[pt]===null){j[pt]=Ye,ae=pt;break}if(ae===-1)break}const fe=T[ae];fe&&fe.connect(Ye)}}const B=new Re,W=new Re;function Q(oe,ue,Ye){B.setFromMatrixPosition(ue.matrixWorld),W.setFromMatrixPosition(Ye.matrixWorld);const ae=B.distanceTo(W),fe=ue.projectionMatrix.elements,pt=Ye.projectionMatrix.elements,_t=fe[14]/(fe[10]-1),Se=fe[14]/(fe[10]+1),$e=(fe[9]+1)/fe[5],jt=(fe[9]-1)/fe[5],Fe=(fe[8]-1)/fe[0],Dt=(pt[8]+1)/pt[0],te=_t*Fe,bt=_t*Dt,It=ae/(-Fe+Dt),tt=It*-Fe;if(ue.matrixWorld.decompose(oe.position,oe.quaternion,oe.scale),oe.translateX(tt),oe.translateZ(It),oe.matrixWorld.compose(oe.position,oe.quaternion,oe.scale),oe.matrixWorldInverse.copy(oe.matrixWorld).invert(),fe[10]===-1)oe.projectionMatrix.copy(ue.projectionMatrix),oe.projectionMatrixInverse.copy(ue.projectionMatrixInverse);else{const nt=_t+It,G=Se+It,H=te-tt,ie=bt+(ae-tt),we=$e*Se/G*nt,Ce=jt*Se/G*nt;oe.projectionMatrix.makePerspective(H,ie,we,Ce,nt,G),oe.projectionMatrixInverse.copy(oe.projectionMatrix).invert()}}function ne(oe,ue){ue===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(ue.matrixWorld,oe.matrix),oe.matrixWorldInverse.copy(oe.matrixWorld).invert()}this.updateCamera=function(oe){if(o===null)return;let ue=oe.near,Ye=oe.far;y.texture!==null&&(y.depthNear>0&&(ue=y.depthNear),y.depthFar>0&&(Ye=y.depthFar)),V.near=I.near=M.near=ue,V.far=I.far=M.far=Ye,(O!==V.near||k!==V.far)&&(o.updateRenderState({depthNear:V.near,depthFar:V.far}),O=V.near,k=V.far),V.layers.mask=oe.layers.mask|6,M.layers.mask=V.layers.mask&3,I.layers.mask=V.layers.mask&5;const ae=oe.parent,fe=V.cameras;ne(V,ae);for(let pt=0;pt<fe.length;pt++)ne(fe[pt],ae);fe.length===2?Q(V,M,I):V.projectionMatrix.copy(M.projectionMatrix),de(oe,V,ae)};function de(oe,ue,Ye){Ye===null?oe.matrix.copy(ue.matrixWorld):(oe.matrix.copy(Ye.matrixWorld),oe.matrix.invert(),oe.matrix.multiply(ue.matrixWorld)),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale),oe.updateMatrixWorld(!0),oe.projectionMatrix.copy(ue.projectionMatrix),oe.projectionMatrixInverse.copy(ue.projectionMatrixInverse),oe.isPerspectiveCamera&&(oe.fov=fv*2*Math.atan(1/oe.projectionMatrix.elements[5]),oe.zoom=1)}this.getCamera=function(){return V},this.getFoveation=function(){if(!(v===null&&C===null))return h},this.setFoveation=function(oe){h=oe,v!==null&&(v.fixedFoveation=oe),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=oe)},this.hasDepthSensing=function(){return y.texture!==null},this.getDepthSensingMesh=function(){return y.getMesh(V)},this.getCameraTexture=function(oe){return S[oe]};let $=null;function X(oe,ue){if(m=ue.getViewerPose(p||d),b=ue,m!==null){const Ye=m.views;C!==null&&(e.setRenderTargetFramebuffer(N,C.framebuffer),e.setRenderTarget(N));let ae=!1;Ye.length!==V.cameras.length&&(V.cameras.length=0,ae=!0);for(let Se=0;Se<Ye.length;Se++){const $e=Ye[Se];let jt=null;if(C!==null)jt=C.getViewport($e);else{const Dt=g.getViewSubImage(v,$e);jt=Dt.viewport,Se===0&&(e.setRenderTargetTextures(N,Dt.colorTexture,Dt.depthStencilTexture),e.setRenderTarget(N))}let Fe=z[Se];Fe===void 0&&(Fe=new ds,Fe.layers.enable(Se),Fe.viewport=new ii,z[Se]=Fe),Fe.matrix.fromArray($e.transform.matrix),Fe.matrix.decompose(Fe.position,Fe.quaternion,Fe.scale),Fe.projectionMatrix.fromArray($e.projectionMatrix),Fe.projectionMatrixInverse.copy(Fe.projectionMatrix).invert(),Fe.viewport.set(jt.x,jt.y,jt.width,jt.height),Se===0&&(V.matrix.copy(Fe.matrix),V.matrix.decompose(V.position,V.quaternion,V.scale)),ae===!0&&V.cameras.push(Fe)}const fe=o.enabledFeatures;if(fe&&fe.includes("depth-sensing")&&o.depthUsage=="gpu-optimized"&&_){g=s.getBinding();const Se=g.getDepthInformation(Ye[0]);Se&&Se.isValid&&Se.texture&&y.init(Se,o.renderState)}if(fe&&fe.includes("camera-access")&&_){e.state.unbindTexture(),g=s.getBinding();for(let Se=0;Se<Ye.length;Se++){const $e=Ye[Se].camera;if($e){let jt=S[$e];jt||(jt=new KE,S[$e]=jt);const Fe=g.getCameraImage($e);jt.sourceTexture=Fe}}}}for(let Ye=0;Ye<T.length;Ye++){const ae=j[Ye],fe=T[Ye];ae!==null&&fe!==void 0&&fe.update(ae,ue,p||d)}$&&$(oe,ue),ue.detectedPlanes&&s.dispatchEvent({type:"planesdetected",data:ue}),b=null}const le=new QE;le.setAnimationLoop(X),this.setAnimationLoop=function(oe){$=oe},this.dispose=function(){}}}const cl=new ir,rH=new ai;function oH(t,e){function n(y,S){y.matrixAutoUpdate===!0&&y.updateMatrix(),S.value.copy(y.matrix)}function s(y,S){S.color.getRGB(y.fogColor.value,GE(t)),S.isFog?(y.fogNear.value=S.near,y.fogFar.value=S.far):S.isFogExp2&&(y.fogDensity.value=S.density)}function o(y,S,D,L,N){S.isMeshBasicMaterial||S.isMeshLambertMaterial?l(y,S):S.isMeshToonMaterial?(l(y,S),g(y,S)):S.isMeshPhongMaterial?(l(y,S),m(y,S)):S.isMeshStandardMaterial?(l(y,S),v(y,S),S.isMeshPhysicalMaterial&&C(y,S,N)):S.isMeshMatcapMaterial?(l(y,S),b(y,S)):S.isMeshDepthMaterial?l(y,S):S.isMeshDistanceMaterial?(l(y,S),_(y,S)):S.isMeshNormalMaterial?l(y,S):S.isLineBasicMaterial?(d(y,S),S.isLineDashedMaterial&&u(y,S)):S.isPointsMaterial?h(y,S,D,L):S.isSpriteMaterial?p(y,S):S.isShadowMaterial?(y.color.value.copy(S.color),y.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function l(y,S){y.opacity.value=S.opacity,S.color&&y.diffuse.value.copy(S.color),S.emissive&&y.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(y.map.value=S.map,n(S.map,y.mapTransform)),S.alphaMap&&(y.alphaMap.value=S.alphaMap,n(S.alphaMap,y.alphaMapTransform)),S.bumpMap&&(y.bumpMap.value=S.bumpMap,n(S.bumpMap,y.bumpMapTransform),y.bumpScale.value=S.bumpScale,S.side===ja&&(y.bumpScale.value*=-1)),S.normalMap&&(y.normalMap.value=S.normalMap,n(S.normalMap,y.normalMapTransform),y.normalScale.value.copy(S.normalScale),S.side===ja&&y.normalScale.value.negate()),S.displacementMap&&(y.displacementMap.value=S.displacementMap,n(S.displacementMap,y.displacementMapTransform),y.displacementScale.value=S.displacementScale,y.displacementBias.value=S.displacementBias),S.emissiveMap&&(y.emissiveMap.value=S.emissiveMap,n(S.emissiveMap,y.emissiveMapTransform)),S.specularMap&&(y.specularMap.value=S.specularMap,n(S.specularMap,y.specularMapTransform)),S.alphaTest>0&&(y.alphaTest.value=S.alphaTest);const D=e.get(S),L=D.envMap,N=D.envMapRotation;L&&(y.envMap.value=L,cl.copy(N),cl.x*=-1,cl.y*=-1,cl.z*=-1,L.isCubeTexture&&L.isRenderTargetTexture===!1&&(cl.y*=-1,cl.z*=-1),y.envMapRotation.value.setFromMatrix4(rH.makeRotationFromEuler(cl)),y.flipEnvMap.value=L.isCubeTexture&&L.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=S.reflectivity,y.ior.value=S.ior,y.refractionRatio.value=S.refractionRatio),S.lightMap&&(y.lightMap.value=S.lightMap,y.lightMapIntensity.value=S.lightMapIntensity,n(S.lightMap,y.lightMapTransform)),S.aoMap&&(y.aoMap.value=S.aoMap,y.aoMapIntensity.value=S.aoMapIntensity,n(S.aoMap,y.aoMapTransform))}function d(y,S){y.diffuse.value.copy(S.color),y.opacity.value=S.opacity,S.map&&(y.map.value=S.map,n(S.map,y.mapTransform))}function u(y,S){y.dashSize.value=S.dashSize,y.totalSize.value=S.dashSize+S.gapSize,y.scale.value=S.scale}function h(y,S,D,L){y.diffuse.value.copy(S.color),y.opacity.value=S.opacity,y.size.value=S.size*D,y.scale.value=L*.5,S.map&&(y.map.value=S.map,n(S.map,y.uvTransform)),S.alphaMap&&(y.alphaMap.value=S.alphaMap,n(S.alphaMap,y.alphaMapTransform)),S.alphaTest>0&&(y.alphaTest.value=S.alphaTest)}function p(y,S){y.diffuse.value.copy(S.color),y.opacity.value=S.opacity,y.rotation.value=S.rotation,S.map&&(y.map.value=S.map,n(S.map,y.mapTransform)),S.alphaMap&&(y.alphaMap.value=S.alphaMap,n(S.alphaMap,y.alphaMapTransform)),S.alphaTest>0&&(y.alphaTest.value=S.alphaTest)}function m(y,S){y.specular.value.copy(S.specular),y.shininess.value=Math.max(S.shininess,1e-4)}function g(y,S){S.gradientMap&&(y.gradientMap.value=S.gradientMap)}function v(y,S){y.metalness.value=S.metalness,S.metalnessMap&&(y.metalnessMap.value=S.metalnessMap,n(S.metalnessMap,y.metalnessMapTransform)),y.roughness.value=S.roughness,S.roughnessMap&&(y.roughnessMap.value=S.roughnessMap,n(S.roughnessMap,y.roughnessMapTransform)),S.envMap&&(y.envMapIntensity.value=S.envMapIntensity)}function C(y,S,D){y.ior.value=S.ior,S.sheen>0&&(y.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),y.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(y.sheenColorMap.value=S.sheenColorMap,n(S.sheenColorMap,y.sheenColorMapTransform)),S.sheenRoughnessMap&&(y.sheenRoughnessMap.value=S.sheenRoughnessMap,n(S.sheenRoughnessMap,y.sheenRoughnessMapTransform))),S.clearcoat>0&&(y.clearcoat.value=S.clearcoat,y.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(y.clearcoatMap.value=S.clearcoatMap,n(S.clearcoatMap,y.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,n(S.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(y.clearcoatNormalMap.value=S.clearcoatNormalMap,n(S.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===ja&&y.clearcoatNormalScale.value.negate())),S.dispersion>0&&(y.dispersion.value=S.dispersion),S.iridescence>0&&(y.iridescence.value=S.iridescence,y.iridescenceIOR.value=S.iridescenceIOR,y.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(y.iridescenceMap.value=S.iridescenceMap,n(S.iridescenceMap,y.iridescenceMapTransform)),S.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=S.iridescenceThicknessMap,n(S.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),S.transmission>0&&(y.transmission.value=S.transmission,y.transmissionSamplerMap.value=D.texture,y.transmissionSamplerSize.value.set(D.width,D.height),S.transmissionMap&&(y.transmissionMap.value=S.transmissionMap,n(S.transmissionMap,y.transmissionMapTransform)),y.thickness.value=S.thickness,S.thicknessMap&&(y.thicknessMap.value=S.thicknessMap,n(S.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=S.attenuationDistance,y.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(y.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(y.anisotropyMap.value=S.anisotropyMap,n(S.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=S.specularIntensity,y.specularColor.value.copy(S.specularColor),S.specularColorMap&&(y.specularColorMap.value=S.specularColorMap,n(S.specularColorMap,y.specularColorMapTransform)),S.specularIntensityMap&&(y.specularIntensityMap.value=S.specularIntensityMap,n(S.specularIntensityMap,y.specularIntensityMapTransform))}function b(y,S){S.matcap&&(y.matcap.value=S.matcap)}function _(y,S){const D=e.get(S).light;y.referencePosition.value.setFromMatrixPosition(D.matrixWorld),y.nearDistance.value=D.shadow.camera.near,y.farDistance.value=D.shadow.camera.far}return{refreshFogUniforms:s,refreshMaterialUniforms:o}}function lH(t,e,n,s){let o={},l={},d=[];const u=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function h(D,L){const N=L.program;s.uniformBlockBinding(D,N)}function p(D,L){let N=o[D.id];N===void 0&&(b(D),N=m(D),o[D.id]=N,D.addEventListener("dispose",y));const T=L.program;s.updateUBOMapping(D,T);const j=e.render.frame;l[D.id]!==j&&(v(D),l[D.id]=j)}function m(D){const L=g();D.__bindingPointIndex=L;const N=t.createBuffer(),T=D.__size,j=D.usage;return t.bindBuffer(t.UNIFORM_BUFFER,N),t.bufferData(t.UNIFORM_BUFFER,T,j),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,L,N),N}function g(){for(let D=0;D<u;D++)if(d.indexOf(D)===-1)return d.push(D),D;return Sn("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function v(D){const L=o[D.id],N=D.uniforms,T=D.__cache;t.bindBuffer(t.UNIFORM_BUFFER,L);for(let j=0,E=N.length;j<E;j++){const R=Array.isArray(N[j])?N[j]:[N[j]];for(let M=0,I=R.length;M<I;M++){const z=R[M];if(C(z,j,M,T)===!0){const V=z.__offset,O=Array.isArray(z.value)?z.value:[z.value];let k=0;for(let F=0;F<O.length;F++){const A=O[F],q=_(A);typeof A=="number"||typeof A=="boolean"?(z.__data[0]=A,t.bufferSubData(t.UNIFORM_BUFFER,V+k,z.__data)):A.isMatrix3?(z.__data[0]=A.elements[0],z.__data[1]=A.elements[1],z.__data[2]=A.elements[2],z.__data[3]=0,z.__data[4]=A.elements[3],z.__data[5]=A.elements[4],z.__data[6]=A.elements[5],z.__data[7]=0,z.__data[8]=A.elements[6],z.__data[9]=A.elements[7],z.__data[10]=A.elements[8],z.__data[11]=0):(A.toArray(z.__data,k),k+=q.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,V,z.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function C(D,L,N,T){const j=D.value,E=L+"_"+N;if(T[E]===void 0)return typeof j=="number"||typeof j=="boolean"?T[E]=j:T[E]=j.clone(),!0;{const R=T[E];if(typeof j=="number"||typeof j=="boolean"){if(R!==j)return T[E]=j,!0}else if(R.equals(j)===!1)return R.copy(j),!0}return!1}function b(D){const L=D.uniforms;let N=0;const T=16;for(let E=0,R=L.length;E<R;E++){const M=Array.isArray(L[E])?L[E]:[L[E]];for(let I=0,z=M.length;I<z;I++){const V=M[I],O=Array.isArray(V.value)?V.value:[V.value];for(let k=0,F=O.length;k<F;k++){const A=O[k],q=_(A),B=N%T,W=B%q.boundary,Q=B+W;N+=W,Q!==0&&T-Q<q.storage&&(N+=T-Q),V.__data=new Float32Array(q.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=N,N+=q.storage}}}const j=N%T;return j>0&&(N+=T-j),D.__size=N,D.__cache={},this}function _(D){const L={boundary:0,storage:0};return typeof D=="number"||typeof D=="boolean"?(L.boundary=4,L.storage=4):D.isVector2?(L.boundary=8,L.storage=8):D.isVector3||D.isColor?(L.boundary=16,L.storage=12):D.isVector4?(L.boundary=16,L.storage=16):D.isMatrix3?(L.boundary=48,L.storage=48):D.isMatrix4?(L.boundary=64,L.storage=64):D.isTexture?$t("WebGLRenderer: Texture samplers can not be part of an uniforms group."):$t("WebGLRenderer: Unsupported uniform value type.",D),L}function y(D){const L=D.target;L.removeEventListener("dispose",y);const N=d.indexOf(L.__bindingPointIndex);d.splice(N,1),t.deleteBuffer(o[L.id]),delete o[L.id],delete l[L.id]}function S(){for(const D in o)t.deleteBuffer(o[D]);d=[],o={},l={}}return{bind:h,update:p,dispose:S}}const cH=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let qs=null;function dH(){return qs===null&&(qs=new ZB(cH,16,16,Zc,Kr),qs.name="DFG_LUT",qs.minFilter=sa,qs.magFilter=sa,qs.wrapS=zr,qs.wrapT=zr,qs.generateMipmaps=!1,qs.needsUpdate=!0),qs}class uH{constructor(e={}){const{canvas:n=wB(),context:s=null,depth:o=!0,stencil:l=!1,alpha:d=!1,antialias:u=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:p=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:g=!1,reversedDepthBuffer:v=!1,outputBufferType:C=Va}=e;this.isWebGLRenderer=!0;let b;if(s!==null){if(typeof WebGLRenderingContext<"u"&&s instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");b=s.getContextAttributes().alpha}else b=d;const _=C,y=new Set([s_,a_,i_]),S=new Set([Va,nr,Uu,Hu,t_,n_]),D=new Uint32Array(4),L=new Int32Array(4);let N=null,T=null;const j=[],E=[];let R=null;this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Zs,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const M=this;let I=!1;this._outputColorSpace=Ha;let z=0,V=0,O=null,k=-1,F=null;const A=new ii,q=new ii;let B=null;const W=new xn(0);let Q=0,ne=n.width,de=n.height,$=1,X=null,le=null;const oe=new ii(0,0,ne,de),ue=new ii(0,0,ne,de);let Ye=!1;const ae=new d_;let fe=!1,pt=!1;const _t=new ai,Se=new Re,$e=new ii,jt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Fe=!1;function Dt(){return O===null?$:1}let te=s;function bt(K,xe){return n.getContext(K,xe)}try{const K={alpha:!0,depth:o,stencil:l,antialias:u,premultipliedAlpha:h,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:g};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${Zv}`),n.addEventListener("webglcontextlost",ye,!1),n.addEventListener("webglcontextrestored",ut,!1),n.addEventListener("webglcontextcreationerror",Et,!1),te===null){const xe="webgl2";if(te=bt(xe,K),te===null)throw bt(xe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(K){throw Sn("WebGLRenderer: "+K.message),K}let It,tt,nt,G,H,ie,we,Ce,ge,je,He,dt,gt,We,qe,at,ot,st,it,re,rt,Ze,ht,Ke;function Ue(){It=new d5(te),It.init(),Ze=new tH(te,It),tt=new t5(te,It,e,Ze),nt=new J8(te,It),tt.reversedDepthBuffer&&v&&nt.buffers.depth.setReversed(!0),G=new h5(te),H=new z8,ie=new eH(te,It,nt,H,tt,Ze,G),we=new i5(M),Ce=new c5(M),ge=new x4(te),ht=new J6(te,ge),je=new u5(te,ge,G,ht),He=new m5(te,je,ge,G),it=new p5(te,tt,ie),at=new n5(H),dt=new F8(M,we,Ce,It,tt,ht,at),gt=new oH(M,H),We=new B8,qe=new $8(It),st=new Z6(M,we,Ce,nt,He,b,h),ot=new Q8(M,He,tt),Ke=new lH(te,G,tt,nt),re=new e5(te,It,G),rt=new f5(te,It,G),G.programs=dt.programs,M.capabilities=tt,M.extensions=It,M.properties=H,M.renderLists=We,M.shadowMap=ot,M.state=nt,M.info=G}Ue(),_!==Va&&(R=new x5(_,n.width,n.height,o,l));const Je=new sH(M,te);this.xr=Je,this.getContext=function(){return te},this.getContextAttributes=function(){return te.getContextAttributes()},this.forceContextLoss=function(){const K=It.get("WEBGL_lose_context");K&&K.loseContext()},this.forceContextRestore=function(){const K=It.get("WEBGL_lose_context");K&&K.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(K){K!==void 0&&($=K,this.setSize(ne,de,!1))},this.getSize=function(K){return K.set(ne,de)},this.setSize=function(K,xe,Oe=!0){if(Je.isPresenting){$t("WebGLRenderer: Can't change size while VR device is presenting.");return}ne=K,de=xe,n.width=Math.floor(K*$),n.height=Math.floor(xe*$),Oe===!0&&(n.style.width=K+"px",n.style.height=xe+"px"),R!==null&&R.setSize(n.width,n.height),this.setViewport(0,0,K,xe)},this.getDrawingBufferSize=function(K){return K.set(ne*$,de*$).floor()},this.setDrawingBufferSize=function(K,xe,Oe){ne=K,de=xe,$=Oe,n.width=Math.floor(K*Oe),n.height=Math.floor(xe*Oe),this.setViewport(0,0,K,xe)},this.setEffects=function(K){if(_===Va){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(K){for(let xe=0;xe<K.length;xe++)if(K[xe].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}R.setEffects(K||[])},this.getCurrentViewport=function(K){return K.copy(A)},this.getViewport=function(K){return K.copy(oe)},this.setViewport=function(K,xe,Oe,De){K.isVector4?oe.set(K.x,K.y,K.z,K.w):oe.set(K,xe,Oe,De),nt.viewport(A.copy(oe).multiplyScalar($).round())},this.getScissor=function(K){return K.copy(ue)},this.setScissor=function(K,xe,Oe,De){K.isVector4?ue.set(K.x,K.y,K.z,K.w):ue.set(K,xe,Oe,De),nt.scissor(q.copy(ue).multiplyScalar($).round())},this.getScissorTest=function(){return Ye},this.setScissorTest=function(K){nt.setScissorTest(Ye=K)},this.setOpaqueSort=function(K){X=K},this.setTransparentSort=function(K){le=K},this.getClearColor=function(K){return K.copy(st.getClearColor())},this.setClearColor=function(){st.setClearColor(...arguments)},this.getClearAlpha=function(){return st.getClearAlpha()},this.setClearAlpha=function(){st.setClearAlpha(...arguments)},this.clear=function(K=!0,xe=!0,Oe=!0){let De=0;if(K){let Te=!1;if(O!==null){const mt=O.texture.format;Te=y.has(mt)}if(Te){const mt=O.texture.type,St=S.has(mt),xt=st.getClearColor(),Ct=st.getClearAlpha(),Ot=xt.r,kt=xt.g,Pt=xt.b;St?(D[0]=Ot,D[1]=kt,D[2]=Pt,D[3]=Ct,te.clearBufferuiv(te.COLOR,0,D)):(L[0]=Ot,L[1]=kt,L[2]=Pt,L[3]=Ct,te.clearBufferiv(te.COLOR,0,L))}else De|=te.COLOR_BUFFER_BIT}xe&&(De|=te.DEPTH_BUFFER_BIT),Oe&&(De|=te.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),te.clear(De)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",ye,!1),n.removeEventListener("webglcontextrestored",ut,!1),n.removeEventListener("webglcontextcreationerror",Et,!1),st.dispose(),We.dispose(),qe.dispose(),H.dispose(),we.dispose(),Ce.dispose(),He.dispose(),ht.dispose(),Ke.dispose(),dt.dispose(),Je.dispose(),Je.removeEventListener("sessionstart",ze),Je.removeEventListener("sessionend",Qe),Ht.stop()};function ye(K){K.preventDefault(),nC("WebGLRenderer: Context Lost."),I=!0}function ut(){nC("WebGLRenderer: Context Restored."),I=!1;const K=G.autoReset,xe=ot.enabled,Oe=ot.autoUpdate,De=ot.needsUpdate,Te=ot.type;Ue(),G.autoReset=K,ot.enabled=xe,ot.autoUpdate=Oe,ot.needsUpdate=De,ot.type=Te}function Et(K){Sn("WebGLRenderer: A WebGL context could not be created. Reason: ",K.statusMessage)}function si(K){const xe=K.target;xe.removeEventListener("dispose",si),la(xe)}function la(K){hs(K),H.remove(K)}function hs(K){const xe=H.get(K).programs;xe!==void 0&&(xe.forEach(function(Oe){dt.releaseProgram(Oe)}),K.isShaderMaterial&&dt.releaseShaderCache(K))}this.renderBufferDirect=function(K,xe,Oe,De,Te,mt){xe===null&&(xe=jt);const St=Te.isMesh&&Te.matrixWorld.determinant()<0,xt=Ea(K,xe,Oe,De,Te);nt.setMaterial(De,St);let Ct=Oe.index,Ot=1;if(De.wireframe===!0){if(Ct=je.getWireframeAttribute(Oe),Ct===void 0)return;Ot=2}const kt=Oe.drawRange,Pt=Oe.attributes.position;let Bt=kt.start*Ot,Mn=(kt.start+kt.count)*Ot;mt!==null&&(Bt=Math.max(Bt,mt.start*Ot),Mn=Math.min(Mn,(mt.start+mt.count)*Ot)),Ct!==null?(Bt=Math.max(Bt,0),Mn=Math.min(Mn,Ct.count)):Pt!=null&&(Bt=Math.max(Bt,0),Mn=Math.min(Mn,Pt.count));const Kn=Mn-Bt;if(Kn<0||Kn===1/0)return;ht.setup(Te,De,xt,Oe,Ct);let qn,En=re;if(Ct!==null&&(qn=ge.get(Ct),En=rt,En.setIndex(qn)),Te.isMesh)De.wireframe===!0?(nt.setLineWidth(De.wireframeLinewidth*Dt()),En.setMode(te.LINES)):En.setMode(te.TRIANGLES);else if(Te.isLine){let Ft=De.linewidth;Ft===void 0&&(Ft=1),nt.setLineWidth(Ft*Dt()),Te.isLineSegments?En.setMode(te.LINES):Te.isLineLoop?En.setMode(te.LINE_LOOP):En.setMode(te.LINE_STRIP)}else Te.isPoints?En.setMode(te.POINTS):Te.isSprite&&En.setMode(te.TRIANGLES);if(Te.isBatchedMesh)if(Te._multiDrawInstances!==null)Vu("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),En.renderMultiDrawInstances(Te._multiDrawStarts,Te._multiDrawCounts,Te._multiDrawCount,Te._multiDrawInstances);else if(It.get("WEBGL_multi_draw"))En.renderMultiDraw(Te._multiDrawStarts,Te._multiDrawCounts,Te._multiDrawCount);else{const Ft=Te._multiDrawStarts,wn=Te._multiDrawCounts,Wt=Te._multiDrawCount,Fi=Ct?ge.get(Ct).bytesPerElement:1,lr=H.get(De).currentProgram.getUniforms();for(let zi=0;zi<Wt;zi++)lr.setValue(te,"_gl_DrawID",zi),En.render(Ft[zi]/Fi,wn[zi])}else if(Te.isInstancedMesh)En.renderInstances(Bt,Kn,Te.count);else if(Oe.isInstancedBufferGeometry){const Ft=Oe._maxInstanceCount!==void 0?Oe._maxInstanceCount:1/0,wn=Math.min(Oe.instanceCount,Ft);En.renderInstances(Bt,Kn,wn)}else En.render(Bt,Kn)};function or(K,xe,Oe){K.transparent===!0&&K.side===Ys&&K.forceSinglePass===!1?(K.side=ja,K.needsUpdate=!0,jn(K,xe,Oe),K.side=Bo,K.needsUpdate=!0,jn(K,xe,Oe),K.side=Ys):jn(K,xe,Oe)}this.compile=function(K,xe,Oe=null){Oe===null&&(Oe=K),T=qe.get(Oe),T.init(xe),E.push(T),Oe.traverseVisible(function(Te){Te.isLight&&Te.layers.test(xe.layers)&&(T.pushLight(Te),Te.castShadow&&T.pushShadow(Te))}),K!==Oe&&K.traverseVisible(function(Te){Te.isLight&&Te.layers.test(xe.layers)&&(T.pushLight(Te),Te.castShadow&&T.pushShadow(Te))}),T.setupLights();const De=new Set;return K.traverse(function(Te){if(!(Te.isMesh||Te.isPoints||Te.isLine||Te.isSprite))return;const mt=Te.material;if(mt)if(Array.isArray(mt))for(let St=0;St<mt.length;St++){const xt=mt[St];or(xt,Oe,Te),De.add(xt)}else or(mt,Oe,Te),De.add(mt)}),T=E.pop(),De},this.compileAsync=function(K,xe,Oe=null){const De=this.compile(K,xe,Oe);return new Promise(Te=>{function mt(){if(De.forEach(function(St){H.get(St).currentProgram.isReady()&&De.delete(St)}),De.size===0){Te(K);return}setTimeout(mt,10)}It.get("KHR_parallel_shader_compile")!==null?mt():setTimeout(mt,10)})};let be=null;function et(K){be&&be(K)}function ze(){Ht.stop()}function Qe(){Ht.start()}const Ht=new QE;Ht.setAnimationLoop(et),typeof self<"u"&&Ht.setContext(self),this.setAnimationLoop=function(K){be=K,Je.setAnimationLoop(K),K===null?Ht.stop():Ht.start()},Je.addEventListener("sessionstart",ze),Je.addEventListener("sessionend",Qe),this.render=function(K,xe){if(xe!==void 0&&xe.isCamera!==!0){Sn("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(I===!0)return;const Oe=Je.enabled===!0&&Je.isPresenting===!0,De=R!==null&&(O===null||Oe)&&R.begin(M,O);if(K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),xe.parent===null&&xe.matrixWorldAutoUpdate===!0&&xe.updateMatrixWorld(),Je.enabled===!0&&Je.isPresenting===!0&&(R===null||R.isCompositing()===!1)&&(Je.cameraAutoUpdate===!0&&Je.updateCamera(xe),xe=Je.getCamera()),K.isScene===!0&&K.onBeforeRender(M,K,xe,O),T=qe.get(K,E.length),T.init(xe),E.push(T),_t.multiplyMatrices(xe.projectionMatrix,xe.matrixWorldInverse),ae.setFromProjectionMatrix(_t,Xs,xe.reversedDepth),pt=this.localClippingEnabled,fe=at.init(this.clippingPlanes,pt),N=We.get(K,j.length),N.init(),j.push(N),Je.enabled===!0&&Je.isPresenting===!0){const St=M.xr.getDepthSensingMesh();St!==null&&Gt(St,xe,-1/0,M.sortObjects)}Gt(K,xe,0,M.sortObjects),N.finish(),M.sortObjects===!0&&N.sort(X,le),Fe=Je.enabled===!1||Je.isPresenting===!1||Je.hasDepthSensing()===!1,Fe&&st.addToRenderList(N,K),this.info.render.frame++,fe===!0&&at.beginShadows();const Te=T.state.shadowsArray;if(ot.render(Te,K,xe),fe===!0&&at.endShadows(),this.info.autoReset===!0&&this.info.reset(),(De&&R.hasRenderPass())===!1){const St=N.opaque,xt=N.transmissive;if(T.setupLights(),xe.isArrayCamera){const Ct=xe.cameras;if(xt.length>0)for(let Ot=0,kt=Ct.length;Ot<kt;Ot++){const Pt=Ct[Ot];gn(St,xt,K,Pt)}Fe&&st.render(K);for(let Ot=0,kt=Ct.length;Ot<kt;Ot++){const Pt=Ct[Ot];dn(N,K,Pt,Pt.viewport)}}else xt.length>0&&gn(St,xt,K,xe),Fe&&st.render(K),dn(N,K,xe)}O!==null&&V===0&&(ie.updateMultisampleRenderTarget(O),ie.updateRenderTargetMipmap(O)),De&&R.end(M),K.isScene===!0&&K.onAfterRender(M,K,xe),ht.resetDefaultState(),k=-1,F=null,E.pop(),E.length>0?(T=E[E.length-1],fe===!0&&at.setGlobalState(M.clippingPlanes,T.state.camera)):T=null,j.pop(),j.length>0?N=j[j.length-1]:N=null};function Gt(K,xe,Oe,De){if(K.visible===!1)return;if(K.layers.test(xe.layers)){if(K.isGroup)Oe=K.renderOrder;else if(K.isLOD)K.autoUpdate===!0&&K.update(xe);else if(K.isLight)T.pushLight(K),K.castShadow&&T.pushShadow(K);else if(K.isSprite){if(!K.frustumCulled||ae.intersectsSprite(K)){De&&$e.setFromMatrixPosition(K.matrixWorld).applyMatrix4(_t);const St=He.update(K),xt=K.material;xt.visible&&N.push(K,St,xt,Oe,$e.z,null)}}else if((K.isMesh||K.isLine||K.isPoints)&&(!K.frustumCulled||ae.intersectsObject(K))){const St=He.update(K),xt=K.material;if(De&&(K.boundingSphere!==void 0?(K.boundingSphere===null&&K.computeBoundingSphere(),$e.copy(K.boundingSphere.center)):(St.boundingSphere===null&&St.computeBoundingSphere(),$e.copy(St.boundingSphere.center)),$e.applyMatrix4(K.matrixWorld).applyMatrix4(_t)),Array.isArray(xt)){const Ct=St.groups;for(let Ot=0,kt=Ct.length;Ot<kt;Ot++){const Pt=Ct[Ot],Bt=xt[Pt.materialIndex];Bt&&Bt.visible&&N.push(K,St,Bt,Oe,$e.z,Pt)}}else xt.visible&&N.push(K,St,xt,Oe,$e.z,null)}}const mt=K.children;for(let St=0,xt=mt.length;St<xt;St++)Gt(mt[St],xe,Oe,De)}function dn(K,xe,Oe,De){const{opaque:Te,transmissive:mt,transparent:St}=K;T.setupLightsView(Oe),fe===!0&&at.setGlobalState(M.clippingPlanes,Oe),De&&nt.viewport(A.copy(De)),Te.length>0&&yt(Te,xe,Oe),mt.length>0&&yt(mt,xe,Oe),St.length>0&&yt(St,xe,Oe),nt.buffers.depth.setTest(!0),nt.buffers.depth.setMask(!0),nt.buffers.color.setMask(!0),nt.setPolygonOffset(!1)}function gn(K,xe,Oe,De){if((Oe.isScene===!0?Oe.overrideMaterial:null)!==null)return;if(T.state.transmissionRenderTarget[De.id]===void 0){const Bt=It.has("EXT_color_buffer_half_float")||It.has("EXT_color_buffer_float");T.state.transmissionRenderTarget[De.id]=new Js(1,1,{generateMipmaps:!0,type:Bt?Kr:Va,minFilter:vl,samples:tt.samples,stencilBuffer:l,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:yn.workingColorSpace})}const mt=T.state.transmissionRenderTarget[De.id],St=De.viewport||A;mt.setSize(St.z*M.transmissionResolutionScale,St.w*M.transmissionResolutionScale);const xt=M.getRenderTarget(),Ct=M.getActiveCubeFace(),Ot=M.getActiveMipmapLevel();M.setRenderTarget(mt),M.getClearColor(W),Q=M.getClearAlpha(),Q<1&&M.setClearColor(16777215,.5),M.clear(),Fe&&st.render(Oe);const kt=M.toneMapping;M.toneMapping=Zs;const Pt=De.viewport;if(De.viewport!==void 0&&(De.viewport=void 0),T.setupLightsView(De),fe===!0&&at.setGlobalState(M.clippingPlanes,De),yt(K,Oe,De),ie.updateMultisampleRenderTarget(mt),ie.updateRenderTargetMipmap(mt),It.has("WEBGL_multisampled_render_to_texture")===!1){let Bt=!1;for(let Mn=0,Kn=xe.length;Mn<Kn;Mn++){const qn=xe[Mn],{object:En,geometry:Ft,material:wn,group:Wt}=qn;if(wn.side===Ys&&En.layers.test(De.layers)){const Fi=wn.side;wn.side=ja,wn.needsUpdate=!0,an(En,Oe,De,Ft,wn,Wt),wn.side=Fi,wn.needsUpdate=!0,Bt=!0}}Bt===!0&&(ie.updateMultisampleRenderTarget(mt),ie.updateRenderTargetMipmap(mt))}M.setRenderTarget(xt,Ct,Ot),M.setClearColor(W,Q),Pt!==void 0&&(De.viewport=Pt),M.toneMapping=kt}function yt(K,xe,Oe){const De=xe.isScene===!0?xe.overrideMaterial:null;for(let Te=0,mt=K.length;Te<mt;Te++){const St=K[Te],{object:xt,geometry:Ct,group:Ot}=St;let kt=St.material;kt.allowOverride===!0&&De!==null&&(kt=De),xt.layers.test(Oe.layers)&&an(xt,xe,Oe,Ct,kt,Ot)}}function an(K,xe,Oe,De,Te,mt){K.onBeforeRender(M,xe,Oe,De,Te,mt),K.modelViewMatrix.multiplyMatrices(Oe.matrixWorldInverse,K.matrixWorld),K.normalMatrix.getNormalMatrix(K.modelViewMatrix),Te.onBeforeRender(M,xe,Oe,De,K,mt),Te.transparent===!0&&Te.side===Ys&&Te.forceSinglePass===!1?(Te.side=ja,Te.needsUpdate=!0,M.renderBufferDirect(Oe,xe,De,Te,K,mt),Te.side=Bo,Te.needsUpdate=!0,M.renderBufferDirect(Oe,xe,De,Te,K,mt),Te.side=Ys):M.renderBufferDirect(Oe,xe,De,Te,K,mt),K.onAfterRender(M,xe,Oe,De,Te,mt)}function jn(K,xe,Oe){xe.isScene!==!0&&(xe=jt);const De=H.get(K),Te=T.state.lights,mt=T.state.shadowsArray,St=Te.state.version,xt=dt.getParameters(K,Te.state,mt,xe,Oe),Ct=dt.getProgramCacheKey(xt);let Ot=De.programs;De.environment=K.isMeshStandardMaterial?xe.environment:null,De.fog=xe.fog,De.envMap=(K.isMeshStandardMaterial?Ce:we).get(K.envMap||De.environment),De.envMapRotation=De.environment!==null&&K.envMap===null?xe.environmentRotation:K.envMapRotation,Ot===void 0&&(K.addEventListener("dispose",si),Ot=new Map,De.programs=Ot);let kt=Ot.get(Ct);if(kt!==void 0){if(De.currentProgram===kt&&De.lightsStateVersion===St)return ca(K,xt),kt}else xt.uniforms=dt.getUniforms(K),K.onBeforeCompile(xt,M),kt=dt.acquireProgram(xt,Ct),Ot.set(Ct,kt),De.uniforms=xt.uniforms;const Pt=De.uniforms;return(!K.isShaderMaterial&&!K.isRawShaderMaterial||K.clipping===!0)&&(Pt.clippingPlanes=at.uniform),ca(K,xt),De.needsLights=ms(K),De.lightsStateVersion=St,De.needsLights&&(Pt.ambientLightColor.value=Te.state.ambient,Pt.lightProbe.value=Te.state.probe,Pt.directionalLights.value=Te.state.directional,Pt.directionalLightShadows.value=Te.state.directionalShadow,Pt.spotLights.value=Te.state.spot,Pt.spotLightShadows.value=Te.state.spotShadow,Pt.rectAreaLights.value=Te.state.rectArea,Pt.ltc_1.value=Te.state.rectAreaLTC1,Pt.ltc_2.value=Te.state.rectAreaLTC2,Pt.pointLights.value=Te.state.point,Pt.pointLightShadows.value=Te.state.pointShadow,Pt.hemisphereLights.value=Te.state.hemi,Pt.directionalShadowMap.value=Te.state.directionalShadowMap,Pt.directionalShadowMatrix.value=Te.state.directionalShadowMatrix,Pt.spotShadowMap.value=Te.state.spotShadowMap,Pt.spotLightMatrix.value=Te.state.spotLightMatrix,Pt.spotLightMap.value=Te.state.spotLightMap,Pt.pointShadowMap.value=Te.state.pointShadowMap,Pt.pointShadowMatrix.value=Te.state.pointShadowMatrix),De.currentProgram=kt,De.uniformsList=null,kt}function Vt(K){if(K.uniformsList===null){const xe=K.currentProgram.getUniforms();K.uniformsList=Ip.seqWithValue(xe.seq,K.uniforms)}return K.uniformsList}function ca(K,xe){const Oe=H.get(K);Oe.outputColorSpace=xe.outputColorSpace,Oe.batching=xe.batching,Oe.batchingColor=xe.batchingColor,Oe.instancing=xe.instancing,Oe.instancingColor=xe.instancingColor,Oe.instancingMorph=xe.instancingMorph,Oe.skinning=xe.skinning,Oe.morphTargets=xe.morphTargets,Oe.morphNormals=xe.morphNormals,Oe.morphColors=xe.morphColors,Oe.morphTargetsCount=xe.morphTargetsCount,Oe.numClippingPlanes=xe.numClippingPlanes,Oe.numIntersection=xe.numClipIntersection,Oe.vertexAlphas=xe.vertexAlphas,Oe.vertexTangents=xe.vertexTangents,Oe.toneMapping=xe.toneMapping}function Ea(K,xe,Oe,De,Te){xe.isScene!==!0&&(xe=jt),ie.resetTextureUnits();const mt=xe.fog,St=De.isMeshStandardMaterial?xe.environment:null,xt=O===null?M.outputColorSpace:O.isXRRenderTarget===!0?O.texture.colorSpace:Jc,Ct=(De.isMeshStandardMaterial?Ce:we).get(De.envMap||St),Ot=De.vertexColors===!0&&!!Oe.attributes.color&&Oe.attributes.color.itemSize===4,kt=!!Oe.attributes.tangent&&(!!De.normalMap||De.anisotropy>0),Pt=!!Oe.morphAttributes.position,Bt=!!Oe.morphAttributes.normal,Mn=!!Oe.morphAttributes.color;let Kn=Zs;De.toneMapped&&(O===null||O.isXRRenderTarget===!0)&&(Kn=M.toneMapping);const qn=Oe.morphAttributes.position||Oe.morphAttributes.normal||Oe.morphAttributes.color,En=qn!==void 0?qn.length:0,Ft=H.get(De),wn=T.state.lights;if(fe===!0&&(pt===!0||K!==F)){const Bi=K===F&&De.id===k;at.setState(De,K,Bi)}let Wt=!1;De.version===Ft.__version?(Ft.needsLights&&Ft.lightsStateVersion!==wn.state.version||Ft.outputColorSpace!==xt||Te.isBatchedMesh&&Ft.batching===!1||!Te.isBatchedMesh&&Ft.batching===!0||Te.isBatchedMesh&&Ft.batchingColor===!0&&Te.colorTexture===null||Te.isBatchedMesh&&Ft.batchingColor===!1&&Te.colorTexture!==null||Te.isInstancedMesh&&Ft.instancing===!1||!Te.isInstancedMesh&&Ft.instancing===!0||Te.isSkinnedMesh&&Ft.skinning===!1||!Te.isSkinnedMesh&&Ft.skinning===!0||Te.isInstancedMesh&&Ft.instancingColor===!0&&Te.instanceColor===null||Te.isInstancedMesh&&Ft.instancingColor===!1&&Te.instanceColor!==null||Te.isInstancedMesh&&Ft.instancingMorph===!0&&Te.morphTexture===null||Te.isInstancedMesh&&Ft.instancingMorph===!1&&Te.morphTexture!==null||Ft.envMap!==Ct||De.fog===!0&&Ft.fog!==mt||Ft.numClippingPlanes!==void 0&&(Ft.numClippingPlanes!==at.numPlanes||Ft.numIntersection!==at.numIntersection)||Ft.vertexAlphas!==Ot||Ft.vertexTangents!==kt||Ft.morphTargets!==Pt||Ft.morphNormals!==Bt||Ft.morphColors!==Mn||Ft.toneMapping!==Kn||Ft.morphTargetsCount!==En)&&(Wt=!0):(Wt=!0,Ft.__version=De.version);let Fi=Ft.currentProgram;Wt===!0&&(Fi=jn(De,xe,Te));let lr=!1,zi=!1,Xa=!1;const Rn=Fi.getUniforms(),ki=Ft.uniforms;if(nt.useProgram(Fi.program)&&(lr=!0,zi=!0,Xa=!0),De.id!==k&&(k=De.id,zi=!0),lr||F!==K){nt.buffers.depth.getReversed()&&K.reversedDepth!==!0&&(K._reversedDepth=!0,K.updateProjectionMatrix()),Rn.setValue(te,"projectionMatrix",K.projectionMatrix),Rn.setValue(te,"viewMatrix",K.matrixWorldInverse);const Ui=Rn.map.cameraPosition;Ui!==void 0&&Ui.setValue(te,Se.setFromMatrixPosition(K.matrixWorld)),tt.logarithmicDepthBuffer&&Rn.setValue(te,"logDepthBufFC",2/(Math.log(K.far+1)/Math.LN2)),(De.isMeshPhongMaterial||De.isMeshToonMaterial||De.isMeshLambertMaterial||De.isMeshBasicMaterial||De.isMeshStandardMaterial||De.isShaderMaterial)&&Rn.setValue(te,"isOrthographic",K.isOrthographicCamera===!0),F!==K&&(F=K,zi=!0,Xa=!0)}if(Ft.needsLights&&(wn.state.directionalShadowMap.length>0&&Rn.setValue(te,"directionalShadowMap",wn.state.directionalShadowMap,ie),wn.state.spotShadowMap.length>0&&Rn.setValue(te,"spotShadowMap",wn.state.spotShadowMap,ie),wn.state.pointShadowMap.length>0&&Rn.setValue(te,"pointShadowMap",wn.state.pointShadowMap,ie)),Te.isSkinnedMesh){Rn.setOptional(te,Te,"bindMatrix"),Rn.setOptional(te,Te,"bindMatrixInverse");const Bi=Te.skeleton;Bi&&(Bi.boneTexture===null&&Bi.computeBoneTexture(),Rn.setValue(te,"boneTexture",Bi.boneTexture,ie))}Te.isBatchedMesh&&(Rn.setOptional(te,Te,"batchingTexture"),Rn.setValue(te,"batchingTexture",Te._matricesTexture,ie),Rn.setOptional(te,Te,"batchingIdTexture"),Rn.setValue(te,"batchingIdTexture",Te._indirectTexture,ie),Rn.setOptional(te,Te,"batchingColorTexture"),Te._colorsTexture!==null&&Rn.setValue(te,"batchingColorTexture",Te._colorsTexture,ie));const xi=Oe.morphAttributes;if((xi.position!==void 0||xi.normal!==void 0||xi.color!==void 0)&&it.update(Te,Oe,Fi),(zi||Ft.receiveShadow!==Te.receiveShadow)&&(Ft.receiveShadow=Te.receiveShadow,Rn.setValue(te,"receiveShadow",Te.receiveShadow)),De.isMeshGouraudMaterial&&De.envMap!==null&&(ki.envMap.value=Ct,ki.flipEnvMap.value=Ct.isCubeTexture&&Ct.isRenderTargetTexture===!1?-1:1),De.isMeshStandardMaterial&&De.envMap===null&&xe.environment!==null&&(ki.envMapIntensity.value=xe.environmentIntensity),ki.dfgLUT!==void 0&&(ki.dfgLUT.value=dH()),zi&&(Rn.setValue(te,"toneMappingExposure",M.toneMappingExposure),Ft.needsLights&&ps(ki,Xa),mt&&De.fog===!0&&gt.refreshFogUniforms(ki,mt),gt.refreshMaterialUniforms(ki,De,$,de,T.state.transmissionRenderTarget[K.id]),Ip.upload(te,Vt(Ft),ki,ie)),De.isShaderMaterial&&De.uniformsNeedUpdate===!0&&(Ip.upload(te,Vt(Ft),ki,ie),De.uniformsNeedUpdate=!1),De.isSpriteMaterial&&Rn.setValue(te,"center",Te.center),Rn.setValue(te,"modelViewMatrix",Te.modelViewMatrix),Rn.setValue(te,"normalMatrix",Te.normalMatrix),Rn.setValue(te,"modelMatrix",Te.matrixWorld),De.isShaderMaterial||De.isRawShaderMaterial){const Bi=De.uniformsGroups;for(let Ui=0,Ll=Bi.length;Ui<Ll;Ui++){const xs=Bi[Ui];Ke.update(xs,Fi),Ke.bind(xs,Fi)}}return Fi}function ps(K,xe){K.ambientLightColor.needsUpdate=xe,K.lightProbe.needsUpdate=xe,K.directionalLights.needsUpdate=xe,K.directionalLightShadows.needsUpdate=xe,K.pointLights.needsUpdate=xe,K.pointLightShadows.needsUpdate=xe,K.spotLights.needsUpdate=xe,K.spotLightShadows.needsUpdate=xe,K.rectAreaLights.needsUpdate=xe,K.hemisphereLights.needsUpdate=xe}function ms(K){return K.isMeshLambertMaterial||K.isMeshToonMaterial||K.isMeshPhongMaterial||K.isMeshStandardMaterial||K.isShadowMaterial||K.isShaderMaterial&&K.lights===!0}this.getActiveCubeFace=function(){return z},this.getActiveMipmapLevel=function(){return V},this.getRenderTarget=function(){return O},this.setRenderTargetTextures=function(K,xe,Oe){const De=H.get(K);De.__autoAllocateDepthBuffer=K.resolveDepthBuffer===!1,De.__autoAllocateDepthBuffer===!1&&(De.__useRenderToTexture=!1),H.get(K.texture).__webglTexture=xe,H.get(K.depthTexture).__webglTexture=De.__autoAllocateDepthBuffer?void 0:Oe,De.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(K,xe){const Oe=H.get(K);Oe.__webglFramebuffer=xe,Oe.__useDefaultFramebuffer=xe===void 0};const gs=te.createFramebuffer();this.setRenderTarget=function(K,xe=0,Oe=0){O=K,z=xe,V=Oe;let De=null,Te=!1,mt=!1;if(K){const xt=H.get(K);if(xt.__useDefaultFramebuffer!==void 0){nt.bindFramebuffer(te.FRAMEBUFFER,xt.__webglFramebuffer),A.copy(K.viewport),q.copy(K.scissor),B=K.scissorTest,nt.viewport(A),nt.scissor(q),nt.setScissorTest(B),k=-1;return}else if(xt.__webglFramebuffer===void 0)ie.setupRenderTarget(K);else if(xt.__hasExternalTextures)ie.rebindTextures(K,H.get(K.texture).__webglTexture,H.get(K.depthTexture).__webglTexture);else if(K.depthBuffer){const kt=K.depthTexture;if(xt.__boundDepthTexture!==kt){if(kt!==null&&H.has(kt)&&(K.width!==kt.image.width||K.height!==kt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ie.setupDepthRenderbuffer(K)}}const Ct=K.texture;(Ct.isData3DTexture||Ct.isDataArrayTexture||Ct.isCompressedArrayTexture)&&(mt=!0);const Ot=H.get(K).__webglFramebuffer;K.isWebGLCubeRenderTarget?(Array.isArray(Ot[xe])?De=Ot[xe][Oe]:De=Ot[xe],Te=!0):K.samples>0&&ie.useMultisampledRTT(K)===!1?De=H.get(K).__webglMultisampledFramebuffer:Array.isArray(Ot)?De=Ot[Oe]:De=Ot,A.copy(K.viewport),q.copy(K.scissor),B=K.scissorTest}else A.copy(oe).multiplyScalar($).floor(),q.copy(ue).multiplyScalar($).floor(),B=Ye;if(Oe!==0&&(De=gs),nt.bindFramebuffer(te.FRAMEBUFFER,De)&&nt.drawBuffers(K,De),nt.viewport(A),nt.scissor(q),nt.setScissorTest(B),Te){const xt=H.get(K.texture);te.framebufferTexture2D(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_CUBE_MAP_POSITIVE_X+xe,xt.__webglTexture,Oe)}else if(mt){const xt=xe;for(let Ct=0;Ct<K.textures.length;Ct++){const Ot=H.get(K.textures[Ct]);te.framebufferTextureLayer(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0+Ct,Ot.__webglTexture,Oe,xt)}}else if(K!==null&&Oe!==0){const xt=H.get(K.texture);te.framebufferTexture2D(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,xt.__webglTexture,Oe)}k=-1},this.readRenderTargetPixels=function(K,xe,Oe,De,Te,mt,St,xt=0){if(!(K&&K.isWebGLRenderTarget)){Sn("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ct=H.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&St!==void 0&&(Ct=Ct[St]),Ct){nt.bindFramebuffer(te.FRAMEBUFFER,Ct);try{const Ot=K.textures[xt],kt=Ot.format,Pt=Ot.type;if(!tt.textureFormatReadable(kt)){Sn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!tt.textureTypeReadable(Pt)){Sn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}xe>=0&&xe<=K.width-De&&Oe>=0&&Oe<=K.height-Te&&(K.textures.length>1&&te.readBuffer(te.COLOR_ATTACHMENT0+xt),te.readPixels(xe,Oe,De,Te,Ze.convert(kt),Ze.convert(Pt),mt))}finally{const Ot=O!==null?H.get(O).__webglFramebuffer:null;nt.bindFramebuffer(te.FRAMEBUFFER,Ot)}}},this.readRenderTargetPixelsAsync=async function(K,xe,Oe,De,Te,mt,St,xt=0){if(!(K&&K.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ct=H.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&St!==void 0&&(Ct=Ct[St]),Ct)if(xe>=0&&xe<=K.width-De&&Oe>=0&&Oe<=K.height-Te){nt.bindFramebuffer(te.FRAMEBUFFER,Ct);const Ot=K.textures[xt],kt=Ot.format,Pt=Ot.type;if(!tt.textureFormatReadable(kt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!tt.textureTypeReadable(Pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Bt=te.createBuffer();te.bindBuffer(te.PIXEL_PACK_BUFFER,Bt),te.bufferData(te.PIXEL_PACK_BUFFER,mt.byteLength,te.STREAM_READ),K.textures.length>1&&te.readBuffer(te.COLOR_ATTACHMENT0+xt),te.readPixels(xe,Oe,De,Te,Ze.convert(kt),Ze.convert(Pt),0);const Mn=O!==null?H.get(O).__webglFramebuffer:null;nt.bindFramebuffer(te.FRAMEBUFFER,Mn);const Kn=te.fenceSync(te.SYNC_GPU_COMMANDS_COMPLETE,0);return te.flush(),await CB(te,Kn,4),te.bindBuffer(te.PIXEL_PACK_BUFFER,Bt),te.getBufferSubData(te.PIXEL_PACK_BUFFER,0,mt),te.deleteBuffer(Bt),te.deleteSync(Kn),mt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(K,xe=null,Oe=0){const De=Math.pow(2,-Oe),Te=Math.floor(K.image.width*De),mt=Math.floor(K.image.height*De),St=xe!==null?xe.x:0,xt=xe!==null?xe.y:0;ie.setTexture2D(K,0),te.copyTexSubImage2D(te.TEXTURE_2D,Oe,0,0,St,xt,Te,mt),nt.unbindTexture()};const Qr=te.createFramebuffer(),da=te.createFramebuffer();this.copyTextureToTexture=function(K,xe,Oe=null,De=null,Te=0,mt=null){mt===null&&(Te!==0?(Vu("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),mt=Te,Te=0):mt=0);let St,xt,Ct,Ot,kt,Pt,Bt,Mn,Kn;const qn=K.isCompressedTexture?K.mipmaps[mt]:K.image;if(Oe!==null)St=Oe.max.x-Oe.min.x,xt=Oe.max.y-Oe.min.y,Ct=Oe.isBox3?Oe.max.z-Oe.min.z:1,Ot=Oe.min.x,kt=Oe.min.y,Pt=Oe.isBox3?Oe.min.z:0;else{const xi=Math.pow(2,-Te);St=Math.floor(qn.width*xi),xt=Math.floor(qn.height*xi),K.isDataArrayTexture?Ct=qn.depth:K.isData3DTexture?Ct=Math.floor(qn.depth*xi):Ct=1,Ot=0,kt=0,Pt=0}De!==null?(Bt=De.x,Mn=De.y,Kn=De.z):(Bt=0,Mn=0,Kn=0);const En=Ze.convert(xe.format),Ft=Ze.convert(xe.type);let wn;xe.isData3DTexture?(ie.setTexture3D(xe,0),wn=te.TEXTURE_3D):xe.isDataArrayTexture||xe.isCompressedArrayTexture?(ie.setTexture2DArray(xe,0),wn=te.TEXTURE_2D_ARRAY):(ie.setTexture2D(xe,0),wn=te.TEXTURE_2D),te.pixelStorei(te.UNPACK_FLIP_Y_WEBGL,xe.flipY),te.pixelStorei(te.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),te.pixelStorei(te.UNPACK_ALIGNMENT,xe.unpackAlignment);const Wt=te.getParameter(te.UNPACK_ROW_LENGTH),Fi=te.getParameter(te.UNPACK_IMAGE_HEIGHT),lr=te.getParameter(te.UNPACK_SKIP_PIXELS),zi=te.getParameter(te.UNPACK_SKIP_ROWS),Xa=te.getParameter(te.UNPACK_SKIP_IMAGES);te.pixelStorei(te.UNPACK_ROW_LENGTH,qn.width),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,qn.height),te.pixelStorei(te.UNPACK_SKIP_PIXELS,Ot),te.pixelStorei(te.UNPACK_SKIP_ROWS,kt),te.pixelStorei(te.UNPACK_SKIP_IMAGES,Pt);const Rn=K.isDataArrayTexture||K.isData3DTexture,ki=xe.isDataArrayTexture||xe.isData3DTexture;if(K.isDepthTexture){const xi=H.get(K),Bi=H.get(xe),Ui=H.get(xi.__renderTarget),Ll=H.get(Bi.__renderTarget);nt.bindFramebuffer(te.READ_FRAMEBUFFER,Ui.__webglFramebuffer),nt.bindFramebuffer(te.DRAW_FRAMEBUFFER,Ll.__webglFramebuffer);for(let xs=0;xs<Ct;xs++)Rn&&(te.framebufferTextureLayer(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,H.get(K).__webglTexture,Te,Pt+xs),te.framebufferTextureLayer(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,H.get(xe).__webglTexture,mt,Kn+xs)),te.blitFramebuffer(Ot,kt,St,xt,Bt,Mn,St,xt,te.DEPTH_BUFFER_BIT,te.NEAREST);nt.bindFramebuffer(te.READ_FRAMEBUFFER,null),nt.bindFramebuffer(te.DRAW_FRAMEBUFFER,null)}else if(Te!==0||K.isRenderTargetTexture||H.has(K)){const xi=H.get(K),Bi=H.get(xe);nt.bindFramebuffer(te.READ_FRAMEBUFFER,Qr),nt.bindFramebuffer(te.DRAW_FRAMEBUFFER,da);for(let Ui=0;Ui<Ct;Ui++)Rn?te.framebufferTextureLayer(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,xi.__webglTexture,Te,Pt+Ui):te.framebufferTexture2D(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,xi.__webglTexture,Te),ki?te.framebufferTextureLayer(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,Bi.__webglTexture,mt,Kn+Ui):te.framebufferTexture2D(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,Bi.__webglTexture,mt),Te!==0?te.blitFramebuffer(Ot,kt,St,xt,Bt,Mn,St,xt,te.COLOR_BUFFER_BIT,te.NEAREST):ki?te.copyTexSubImage3D(wn,mt,Bt,Mn,Kn+Ui,Ot,kt,St,xt):te.copyTexSubImage2D(wn,mt,Bt,Mn,Ot,kt,St,xt);nt.bindFramebuffer(te.READ_FRAMEBUFFER,null),nt.bindFramebuffer(te.DRAW_FRAMEBUFFER,null)}else ki?K.isDataTexture||K.isData3DTexture?te.texSubImage3D(wn,mt,Bt,Mn,Kn,St,xt,Ct,En,Ft,qn.data):xe.isCompressedArrayTexture?te.compressedTexSubImage3D(wn,mt,Bt,Mn,Kn,St,xt,Ct,En,qn.data):te.texSubImage3D(wn,mt,Bt,Mn,Kn,St,xt,Ct,En,Ft,qn):K.isDataTexture?te.texSubImage2D(te.TEXTURE_2D,mt,Bt,Mn,St,xt,En,Ft,qn.data):K.isCompressedTexture?te.compressedTexSubImage2D(te.TEXTURE_2D,mt,Bt,Mn,qn.width,qn.height,En,qn.data):te.texSubImage2D(te.TEXTURE_2D,mt,Bt,Mn,St,xt,En,Ft,qn);te.pixelStorei(te.UNPACK_ROW_LENGTH,Wt),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,Fi),te.pixelStorei(te.UNPACK_SKIP_PIXELS,lr),te.pixelStorei(te.UNPACK_SKIP_ROWS,zi),te.pixelStorei(te.UNPACK_SKIP_IMAGES,Xa),mt===0&&xe.generateMipmaps&&te.generateMipmap(wn),nt.unbindTexture()},this.initRenderTarget=function(K){H.get(K).__webglFramebuffer===void 0&&ie.setupRenderTarget(K)},this.initTexture=function(K){K.isCubeTexture?ie.setTextureCube(K,0):K.isData3DTexture?ie.setTexture3D(K,0):K.isDataArrayTexture||K.isCompressedArrayTexture?ie.setTexture2DArray(K,0):ie.setTexture2D(K,0),nt.unbindTexture()},this.resetState=function(){z=0,V=0,O=null,nt.reset(),ht.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Xs}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=yn._getDrawingBufferColorSpace(e),n.unpackColorSpace=yn._getUnpackColorSpace()}}class fH extends u_{constructor(e){super(e)}load(e,n,s,o){const l=this,d=new d4(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(u){try{n(l.parse(u))}catch(h){o?o(h):console.error(h),l.manager.itemError(e)}},s,o)}parse(e){function n(p){const m=new DataView(p),g=32/8*3+32/8*3*3+16/8,v=m.getUint32(80,!0);if(80+32/8+v*g===m.byteLength)return!0;const b=[115,111,108,105,100];for(let _=0;_<5;_++)if(s(b,m,_))return!1;return!0}function s(p,m,g){for(let v=0,C=p.length;v<C;v++)if(p[v]!==m.getUint8(g+v))return!1;return!0}function o(p){const m=new DataView(p),g=m.getUint32(80,!0);let v,C,b,_=!1,y,S,D,L,N;for(let z=0;z<70;z++)m.getUint32(z,!1)==1129270351&&m.getUint8(z+4)==82&&m.getUint8(z+5)==61&&(_=!0,y=new Float32Array(g*3*3),S=m.getUint8(z+6)/255,D=m.getUint8(z+7)/255,L=m.getUint8(z+8)/255,N=m.getUint8(z+9)/255);const T=84,j=50,E=new Ns,R=new Float32Array(g*3*3),M=new Float32Array(g*3*3),I=new xn;for(let z=0;z<g;z++){const V=T+z*j,O=m.getFloat32(V,!0),k=m.getFloat32(V+4,!0),F=m.getFloat32(V+8,!0);if(_){const A=m.getUint16(V+48,!0);(A&32768)===0?(v=(A&31)/31,C=(A>>5&31)/31,b=(A>>10&31)/31):(v=S,C=D,b=L)}for(let A=1;A<=3;A++){const q=V+A*12,B=z*3*3+(A-1)*3;R[B]=m.getFloat32(q,!0),R[B+1]=m.getFloat32(q+4,!0),R[B+2]=m.getFloat32(q+8,!0),M[B]=O,M[B+1]=k,M[B+2]=F,_&&(I.setRGB(v,C,b,Ha),y[B]=I.r,y[B+1]=I.g,y[B+2]=I.b)}}return E.setAttribute("position",new $a(R,3)),E.setAttribute("normal",new $a(M,3)),_&&(E.setAttribute("color",new $a(y,3)),E.hasColors=!0,E.alpha=N),E}function l(p){const m=new Ns,g=/solid([\s\S]*?)endsolid/g,v=/facet([\s\S]*?)endfacet/g,C=/solid\s(.+)/;let b=0;const _=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,y=new RegExp("vertex"+_+_+_,"g"),S=new RegExp("normal"+_+_+_,"g"),D=[],L=[],N=[],T=new Re;let j,E=0,R=0,M=0;for(;(j=g.exec(p))!==null;){R=M;const I=j[0],z=(j=C.exec(I))!==null?j[1]:"";for(N.push(z);(j=v.exec(I))!==null;){let k=0,F=0;const A=j[0];for(;(j=S.exec(A))!==null;)T.x=parseFloat(j[1]),T.y=parseFloat(j[2]),T.z=parseFloat(j[3]),F++;for(;(j=y.exec(A))!==null;)D.push(parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3])),L.push(T.x,T.y,T.z),k++,M++;F!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+b),k!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+b),b++}const V=R,O=M-R;m.userData.groupNames=N,m.addGroup(V,O,E),E++}return m.setAttribute("position",new Os(D,3)),m.setAttribute("normal",new Os(L,3)),m}function d(p){return typeof p!="string"?new TextDecoder().decode(p):p}function u(p){if(typeof p=="string"){const m=new Uint8Array(p.length);for(let g=0;g<p.length;g++)m[g]=p.charCodeAt(g)&255;return m.buffer||m}else return p}const h=u(e);return n(h)?o(h):l(d(e))}}const YC={type:"change"},h_={type:"start"},n2={type:"end"},ip=new kE,KC=new Do,hH=Math.cos(70*jB.DEG2RAD),vi=new Re,Ma=2*Math.PI,kn={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Ey=1e-6;class pH extends m4{constructor(e,n=null){super(e,n),this.state=kn.NONE,this.target=new Re,this.cursor=new Re,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Bc.ROTATE,MIDDLE:Bc.DOLLY,RIGHT:Bc.PAN},this.touches={ONE:Pc.ROTATE,TWO:Pc.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Re,this._lastQuaternion=new Dl,this._lastTargetPosition=new Re,this._quat=new Dl().setFromUnitVectors(e.up,new Re(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new MC,this._sphericalDelta=new MC,this._scale=1,this._panOffset=new Re,this._rotateStart=new Xt,this._rotateEnd=new Xt,this._rotateDelta=new Xt,this._panStart=new Xt,this._panEnd=new Xt,this._panDelta=new Xt,this._dollyStart=new Xt,this._dollyEnd=new Xt,this._dollyDelta=new Xt,this._dollyDirection=new Re,this._mouse=new Xt,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=gH.bind(this),this._onPointerDown=mH.bind(this),this._onPointerUp=xH.bind(this),this._onContextMenu=wH.bind(this),this._onMouseWheel=_H.bind(this),this._onKeyDown=bH.bind(this),this._onTouchStart=SH.bind(this),this._onTouchMove=MH.bind(this),this._onMouseDown=yH.bind(this),this._onMouseMove=vH.bind(this),this._interceptControlDown=CH.bind(this),this._interceptControlUp=TH.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(YC),this.update(),this.state=kn.NONE}update(e=null){const n=this.object.position;vi.copy(n).sub(this.target),vi.applyQuaternion(this._quat),this._spherical.setFromVector3(vi),this.autoRotate&&this.state===kn.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let s=this.minAzimuthAngle,o=this.maxAzimuthAngle;isFinite(s)&&isFinite(o)&&(s<-Math.PI?s+=Ma:s>Math.PI&&(s-=Ma),o<-Math.PI?o+=Ma:o>Math.PI&&(o-=Ma),s<=o?this._spherical.theta=Math.max(s,Math.min(o,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(s+o)/2?Math.max(s,this._spherical.theta):Math.min(o,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let l=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const d=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),l=d!=this._spherical.radius}if(vi.setFromSpherical(this._spherical),vi.applyQuaternion(this._quatInverse),n.copy(this.target).add(vi),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let d=null;if(this.object.isPerspectiveCamera){const u=vi.length();d=this._clampDistance(u*this._scale);const h=u-d;this.object.position.addScaledVector(this._dollyDirection,h),this.object.updateMatrixWorld(),l=!!h}else if(this.object.isOrthographicCamera){const u=new Re(this._mouse.x,this._mouse.y,0);u.unproject(this.object);const h=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),l=h!==this.object.zoom;const p=new Re(this._mouse.x,this._mouse.y,0);p.unproject(this.object),this.object.position.sub(p).add(u),this.object.updateMatrixWorld(),d=vi.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;d!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(d).add(this.object.position):(ip.origin.copy(this.object.position),ip.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(ip.direction))<hH?this.object.lookAt(this.target):(KC.setFromNormalAndCoplanarPoint(this.object.up,this.target),ip.intersectPlane(KC,this.target))))}else if(this.object.isOrthographicCamera){const d=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),d!==this.object.zoom&&(this.object.updateProjectionMatrix(),l=!0)}return this._scale=1,this._performCursorZoom=!1,l||this._lastPosition.distanceToSquared(this.object.position)>Ey||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Ey||this._lastTargetPosition.distanceToSquared(this.target)>Ey?(this.dispatchEvent(YC),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Ma/60*this.autoRotateSpeed*e:Ma/60/60*this.autoRotateSpeed}_getZoomScale(e){const n=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*n)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,n){vi.setFromMatrixColumn(n,0),vi.multiplyScalar(-e),this._panOffset.add(vi)}_panUp(e,n){this.screenSpacePanning===!0?vi.setFromMatrixColumn(n,1):(vi.setFromMatrixColumn(n,0),vi.crossVectors(this.object.up,vi)),vi.multiplyScalar(e),this._panOffset.add(vi)}_pan(e,n){const s=this.domElement;if(this.object.isPerspectiveCamera){const o=this.object.position;vi.copy(o).sub(this.target);let l=vi.length();l*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*l/s.clientHeight,this.object.matrix),this._panUp(2*n*l/s.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/s.clientWidth,this.object.matrix),this._panUp(n*(this.object.top-this.object.bottom)/this.object.zoom/s.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,n){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const s=this.domElement.getBoundingClientRect(),o=e-s.left,l=n-s.top,d=s.width,u=s.height;this._mouse.x=o/d*2-1,this._mouse.y=-(l/u)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(Ma*this._rotateDelta.x/n.clientHeight),this._rotateUp(Ma*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let n=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Ma*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),n=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Ma*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),n=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Ma*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),n=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Ma*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),n=!0;break}n&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),o=.5*(e.pageY+n.y);this._rotateStart.set(s,o)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),o=.5*(e.pageY+n.y);this._panStart.set(s,o)}}_handleTouchStartDolly(e){const n=this._getSecondPointerPosition(e),s=e.pageX-n.x,o=e.pageY-n.y,l=Math.sqrt(s*s+o*o);this._dollyStart.set(0,l)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),o=.5*(e.pageX+s.x),l=.5*(e.pageY+s.y);this._rotateEnd.set(o,l)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(Ma*this._rotateDelta.x/n.clientHeight),this._rotateUp(Ma*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),o=.5*(e.pageY+n.y);this._panEnd.set(s,o)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const n=this._getSecondPointerPosition(e),s=e.pageX-n.x,o=e.pageY-n.y,l=Math.sqrt(s*s+o*o);this._dollyEnd.set(0,l),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const d=(e.pageX+n.x)*.5,u=(e.pageY+n.y)*.5;this._updateZoomParameters(d,u)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId){this._pointers.splice(n,1);return}}_isTrackingPointer(e){for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId)return!0;return!1}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new Xt,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[n]}_customWheelEvent(e){const n=e.deltaMode,s={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(n){case 1:s.deltaY*=16;break;case 2:s.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(s.deltaY*=10),s}}function mH(t){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(t.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(t)&&(this._addPointer(t),t.pointerType==="touch"?this._onTouchStart(t):this._onMouseDown(t)))}function gH(t){this.enabled!==!1&&(t.pointerType==="touch"?this._onTouchMove(t):this._onMouseMove(t))}function xH(t){switch(this._removePointer(t),this._pointers.length){case 0:this.domElement.releasePointerCapture(t.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(n2),this.state=kn.NONE;break;case 1:const e=this._pointers[0],n=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:n.x,pageY:n.y});break}}function yH(t){let e;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Bc.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(t),this.state=kn.DOLLY;break;case Bc.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=kn.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=kn.ROTATE}break;case Bc.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=kn.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=kn.PAN}break;default:this.state=kn.NONE}this.state!==kn.NONE&&this.dispatchEvent(h_)}function vH(t){switch(this.state){case kn.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(t);break;case kn.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(t);break;case kn.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(t);break}}function _H(t){this.enabled===!1||this.enableZoom===!1||this.state!==kn.NONE||(t.preventDefault(),this.dispatchEvent(h_),this._handleMouseWheel(this._customWheelEvent(t)),this.dispatchEvent(n2))}function bH(t){this.enabled!==!1&&this._handleKeyDown(t)}function SH(t){switch(this._trackPointer(t),this._pointers.length){case 1:switch(this.touches.ONE){case Pc.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(t),this.state=kn.TOUCH_ROTATE;break;case Pc.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(t),this.state=kn.TOUCH_PAN;break;default:this.state=kn.NONE}break;case 2:switch(this.touches.TWO){case Pc.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(t),this.state=kn.TOUCH_DOLLY_PAN;break;case Pc.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(t),this.state=kn.TOUCH_DOLLY_ROTATE;break;default:this.state=kn.NONE}break;default:this.state=kn.NONE}this.state!==kn.NONE&&this.dispatchEvent(h_)}function MH(t){switch(this._trackPointer(t),this.state){case kn.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(t),this.update();break;case kn.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(t),this.update();break;case kn.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(t),this.update();break;case kn.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(t),this.update();break;default:this.state=kn.NONE}}function wH(t){this.enabled!==!1&&t.preventDefault()}function CH(t){t.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function TH(t){t.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const jH=({open:t,onClose:e,fileUrl:n,fileName:s})=>{const o=P.useRef(null),[l,d]=P.useState(!0),[u,h]=P.useState(null),p=P.useRef(null);return P.useEffect(()=>{if(!t||!o.current)return;d(!0),h(null);const m=o.current,g=m.clientWidth||780,v=500,C=new QB;C.background=new xn(15790320);const b=new ds(50,g/v,.1,1e4),_=new uH({antialias:!0});_.setSize(g,v),_.setPixelRatio(window.devicePixelRatio),m.appendChild(_.domElement);const y=new h4(6710886);C.add(y);const S=new SC(16777215,1);S.position.set(1,1,1).normalize(),C.add(S);const D=new SC(16777215,.5);D.position.set(-1,-.5,-1).normalize(),C.add(D);const L=new pH(b,_.domElement);L.enableDamping=!0,L.dampingFactor=.1;const N=localStorage.getItem("access_token"),T=new fH,j=new XMLHttpRequest;j.open("GET",n,!0),j.responseType="arraybuffer",N&&j.setRequestHeader("Authorization",`Bearer ${N}`),j.onload=()=>{if(j.status!==200){h(` (${j.status})`),d(!1);return}try{const I=T.parse(j.response);I.computeVertexNormals();const z=new a4({color:8952234,specular:3355443,shininess:40,side:Ys}),V=new ar(I,z);C.add(V),I.computeBoundingBox();const O=I.boundingBox,k=new Re;O.getCenter(k),V.position.sub(k);const F=new Re;O.getSize(F);const A=Math.max(F.x,F.y,F.z),q=b.fov*(Math.PI/180),B=A/(2*Math.tan(q/2))*1.5;b.position.set(B*.7,B*.5,B*.7),b.lookAt(0,0,0),L.target.set(0,0,0),L.update(),d(!1)}catch{h("STL"),d(!1)}},j.onerror=()=>{h(""),d(!1)},j.send();let E;const R=()=>{E=requestAnimationFrame(R),L.update(),_.render(C,b)};R();const M=()=>{const I=m.clientWidth||780;b.aspect=I/v,b.updateProjectionMatrix(),_.setSize(I,v)};return window.addEventListener("resize",M),p.current=()=>{cancelAnimationFrame(E),window.removeEventListener("resize",M),L.dispose(),_.dispose(),m.contains(_.domElement)&&m.removeChild(_.domElement),C.traverse(I=>{if(I.geometry&&I.geometry.dispose(),I.material){const z=I.material;Array.isArray(z)?z.forEach(V=>V.dispose()):z.dispose()}})},()=>{p.current?.(),p.current=null}},[t,n]),i.jsxs(Nt,{open:t,onCancel:e,title:`3D - ${s}`,footer:null,width:830,destroyOnClose:!0,children:[u&&i.jsx(Ur,{message:u,type:"error",showIcon:!0,style:{marginBottom:8}}),i.jsxs("div",{style:{position:"relative",minHeight:500},children:[l&&i.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,background:"rgba(240,240,240,0.8)"},children:i.jsx(tn,{size:"large",tip:"3D..."})}),i.jsx("div",{ref:o,style:{width:"100%",height:500}})]})]})},{Text:Ao}=An,ap=t=>t<1024?`${t}B`:t<1024*1024?`${(t/1024).toFixed(0)}KB`:`${(t/(1024*1024)).toFixed(1)}MB`,Ac=10,EH=({url:t})=>{const[e,n]=P.useState(!1),[s,o]=P.useState(0),[l,d]=P.useState(t),[u,h]=P.useState(!1),[p,m]=P.useState({x:0,y:0}),g=6;return P.useEffect(()=>{if(e||s>=g)return;const v=new window.Image;let C;return v.onload=()=>{n(!0),d(t+"?t="+Date.now())},v.onerror=()=>{C=setTimeout(()=>o(b=>b+1),2e3)},v.src=t+"?t="+Date.now(),()=>clearTimeout(C)},[t,s,e]),!e&&s<g?i.jsx("div",{style:{width:60,height:45,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4},children:i.jsx(d3,{style:{color:"#1677ff",fontSize:16}})}):e?i.jsxs("div",{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),onMouseMove:v=>m({x:v.clientX,y:v.clientY}),style:{position:"relative",display:"inline-block"},children:[i.jsx("img",{src:l,width:60,height:45,style:{objectFit:"contain",cursor:"pointer",background:"#fff",borderRadius:2}}),u&&i.jsx("div",{style:{position:"fixed",left:p.x+16,top:p.y-120,zIndex:9999,pointerEvents:"none",background:"#ffffff",borderRadius:8,boxShadow:"0 4px 20px rgba(0,0,0,0.15)",padding:8},children:i.jsx("img",{src:l,width:300,height:225,style:{objectFit:"contain",display:"block"}})})]}):i.jsx("div",{style:{width:60,height:45,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4},children:i.jsx(rr,{style:{color:"#d9d9d9",fontSize:16}})})},i2=({bomType:t,items:e,onChange:n,showAddDelete:s=!0,readonly:o=!1,showMaterialCode:l=!1,onItemSave:d,onMaterialSearch:u,renderDrawingColumn:h,actionColumn:p,scrollX:m,scrollY:g,noPagination:v=!1,rowClassName:C,attrTemplates:b})=>{const[_,y]=P.useState(null),[S,D]=P.useState(1),[L,N]=P.useState(null),T=Pn.useMemo(()=>e.map($=>({...$,...$.extended_attrs||{}})),[e]),j=$=>e.length>Ac?(S-1)*Ac+$:$,E=($,X,le)=>{const oe=j($);if(T[oe]&&T[oe][X]===le){y(null);return}if(d&&e[oe]?.id)d(e[oe].id,X,le);else{const ue=e.map((Ye,ae)=>ae===oe?{...Ye,[X]:le}:Ye);n(ue)}y(null)},R=$=>{const X=j($);n(e.filter((le,oe)=>oe!==X))},M=()=>{const X={item_number:e.length>0?Math.max(...e.map(oe=>oe.item_number||0))+1:1,name:"",quantity:1,unit:"pcs"},le=[...e,X];n(le),le.length>Ac&&D(Math.ceil(le.length/Ac))},I=($,X,le,oe="text",ue)=>{const Ye=j(X);if(oe==="checkbox")return i.jsx(pa,{checked:!!$,disabled:o,onChange:pt=>E(X,le,pt.target.checked)});let ae=$;return oe==="select"&&ue&&$&&(ae=ue.find(pt=>pt.value===$)?.label?.split("")[0]||$),oe==="number"&&$!=null&&$!==""&&(le==="unit_price"||le==="extended_cost")&&(ae=Number($).toFixed(2)),o?i.jsx("div",{style:{minHeight:22,padding:"0 2px"},children:ae??i.jsx(Ao,{type:"secondary",style:{fontSize:11},children:"-"})}):_?.rowIdx===Ye&&_?.field===le?oe==="number"?i.jsx(en,{size:"small",autoFocus:!0,defaultValue:typeof $=="string"?parseFloat($)||0:$,style:{width:"100%"},onBlur:pt=>E(X,le,parseFloat(pt.target.value)||0),onPressEnter:pt=>E(X,le,parseFloat(pt.target.value)||0)}):oe==="select"&&ue?i.jsx(Xe,{size:"small",autoFocus:!0,defaultValue:$,defaultOpen:!0,style:{width:"100%"},options:ue,onChange:pt=>E(X,le,pt),onBlur:()=>y(null)}):i.jsx(Pe,{size:"small",autoFocus:!0,defaultValue:$,onBlur:pt=>E(X,le,pt.target.value),onPressEnter:pt=>E(X,le,pt.target.value)}):i.jsx("div",{style:{cursor:"pointer",minHeight:22,padding:"0 2px",borderRadius:2},className:"editable-cell",onClick:()=>y({rowIdx:Ye,field:le}),children:ae??i.jsx(Ao,{type:"secondary",style:{fontSize:11},children:"-"})})},z=$=>/\.(stp|step)$/i.test($),V=($,X,le)=>$&&z(X)?i.jsxs("a",{style:le,onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),N({fileId:$,fileName:X})},children:[X,i.jsx(u3,{style:{fontSize:10,marginLeft:3}})]}):i.jsx("a",{href:$?`/uploads/${$}/${X}`:"#",target:"_blank",rel:"noreferrer",style:le,children:X}),O=($,X,le,oe,ue)=>{const Ye=j(X),ae=$?.[oe],fe=$?.[ue],pt=$?.[le];return o?ae?i.jsxs(rn,{title:`${ae}${fe?" "+ap(fe):""}`,children:[V(pt,ae,{fontSize:11,maxWidth:100,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),fe>0&&i.jsx(Ao,{type:"secondary",style:{fontSize:10,marginLeft:4},children:ap(fe)})]}):i.jsx(Ao,{type:"secondary",style:{fontSize:11},children:"-"}):i.jsxs(Be,{size:4,style:{width:"100%"},children:[ae?i.jsxs(rn,{title:`${ae}${fe?" "+ap(fe):""}`,children:[V(pt,ae,{fontSize:11,maxWidth:70,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle"}),fe>0&&i.jsx(Ao,{type:"secondary",style:{fontSize:10},children:ap(fe)})]}):i.jsx(Ao,{type:"secondary",style:{fontSize:11},children:"-"}),i.jsx(Zi,{showUploadList:!1,customRequest:()=>{},beforeUpload:_t=>(Vn.uploadFile(_t).then(Se=>{const $e={[le]:Se.id,[oe]:Se.filename,[ue]:_t.size};Se.thumbnail_url&&($e.thumbnail_url=Se.thumbnail_url);const jt=e.map((Fe,Dt)=>Dt===Ye?{...Fe,...$e}:Fe);n(jt),me.success("")}).catch(()=>{me.error("")}),Zi.LIST_IGNORE),children:i.jsx(Li,{style:{color:"#1677ff",cursor:"pointer",fontSize:12}})}),ae&&i.jsx($r,{style:{color:"#ff4d4f",cursor:"pointer",fontSize:11},onClick:()=>{const _t=e.map((Se,$e)=>$e===Ye?{...Se,[le]:void 0,[oe]:void 0,[ue]:void 0}:Se);n(_t)}})]})},k=[{title:"",dataIndex:"item_number",width:55,align:"center",render:($,X,le)=>I($,le,"item_number","number")},{title:"",dataIndex:"name",width:120,render:($,X,le)=>I($,le,"name")},{title:"",dataIndex:"quantity",width:60,align:"right",render:($,X,le)=>I($,le,"quantity","number")},{title:"",dataIndex:"unit",width:55,render:($,X,le)=>I($,le,"unit")},{title:"",dataIndex:"supplier",width:100,ellipsis:!0,render:($,X,le)=>I($,le,"supplier")},{title:"",dataIndex:"unit_price",width:80,align:"right",render:($,X,le)=>I($,le,"unit_price","number")},{title:"",dataIndex:"extended_cost",width:80,align:"right",render:($,X)=>{const le=$??(X.quantity||0)*(X.unit_price||0);return le>0?Number(le).toFixed(2):i.jsx(Ao,{type:"secondary",style:{fontSize:11},children:"-"})}},{title:"",dataIndex:"notes",width:120,ellipsis:!0,render:($,X,le)=>I($,le,"notes")}],F=t==="PBOM"?[{title:"",dataIndex:"thumbnail_url",width:70,align:"center",render:$=>$?i.jsx(EH,{url:$}):i.jsx("div",{style:{width:60,height:45,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4},children:i.jsx(rr,{style:{color:"#d9d9d9",fontSize:16}})})},{title:"2D",dataIndex:"drawing_2d_file_name",width:h?150:140,render:h?($,X)=>h(X,"2D"):($,X,le)=>O(X,le,"drawing_2d_file_id","drawing_2d_file_name","drawing_2d_file_size")},{title:"3D",dataIndex:"drawing_3d_file_name",width:h?150:140,render:h?($,X)=>h(X,"3D"):($,X,le)=>O(X,le,"drawing_3d_file_id","drawing_3d_file_name","drawing_3d_file_size")}]:[],A=l?[{title:"",width:120,render:($,X)=>{const le=X.material?.code||X.specification;return i.jsxs(Be,{size:4,children:[i.jsx(Ao,{code:!0,style:{fontSize:11},children:le||"-"}),!o&&u&&i.jsx(gi,{style:{color:"#1677ff",cursor:"pointer",fontSize:12},onClick:()=>u(X.id)})]})}}]:[],q=Pn.useMemo(()=>!b||b.length===0?[]:b.filter($=>$.show_in_table).sort(($,X)=>$.sort_order-X.sort_order).map($=>{const X=$.field_type==="number"?"number":$.field_type==="select"?"select":$.field_type==="boolean"?"checkbox":"text",le=$.field_type==="select"&&$.options?.values?$.options.values.map(ue=>({label:ue,value:ue})):void 0;return{title:$.unit?`${$.field_name}(${$.unit})`:$.field_name,dataIndex:$.field_key,width:X==="checkbox"?60:X==="number"?80:100,align:X==="checkbox"?"center":X==="number"?"right":void 0,ellipsis:X==="text",render:(ue,Ye,ae)=>I(ue,ae,$.field_key,X,le)}}),[b,o,_]),B=[...k.slice(0,1),...A,...F.slice(0,1),...k.slice(1,2),...k.slice(2),...F.slice(1),...q];p?B.push({title:"",width:80,align:"center",fixed:"right",render:($,X)=>p(X)}):s&&B.push({title:"",width:40,align:"center",fixed:"right",render:($,X,le)=>i.jsx(Bn,{title:"",onConfirm:()=>R(le),children:i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{})})})});const W=t==="PBOM"?1100:700,Q=q.reduce(($,X)=>$+(X.width||100),0),ne=W+Q,de=m??ne;return i.jsxs("div",{children:[s&&i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:8},children:i.jsx(J,{type:"dashed",size:"small",icon:i.jsx(Yt,{}),onClick:M,children:""})}),i.jsx(sn,{columns:B,dataSource:T,rowKey:($,X)=>$.id||String(X),size:"small",pagination:v?!1:e.length>Ac?{pageSize:Ac,size:"small",showTotal:$=>` ${$} `,current:S,onChange:$=>D($)}:!1,scroll:{x:de,...g?{y:g}:{}},style:{fontSize:12},rowClassName:C,locale:{emptyText:i.jsx(ft,{description:'""""',image:ft.PRESENTED_IMAGE_SIMPLE})}}),i.jsx("style",{children:`
        .editable-cell:hover {
          background: #f0f5ff;
        }
      `}),L&&i.jsx(jH,{open:!0,fileUrl:`/api/v1/files/${L.fileId}/3d`,fileName:L.fileName,onClose:()=>N(null)})]})},{Text:Ba}=An,AH=["(ENIG)","(HASL)","","OSP","","",""],RH=["FR4","FR4 Tg","","CEM-3","Rogers","PI()"],DH=t=>{if(!t)return[];if(Array.isArray(t))return t;try{return JSON.parse(t)}catch{return[]}},dl=t=>t==null||isNaN(t)?"-":`${t.toFixed(2)}`,_i=({value:t,field:e,record:n,onSave:s,type:o="text",options:l,placeholder:d,width:u})=>o==="number"?i.jsx(en,{size:"small",value:t,placeholder:d,style:{width:u||"100%"},onChange:h=>s(n.id,e,h)}):o==="select"&&l?i.jsx(Xe,{size:"small",value:t||void 0,placeholder:d,style:{width:u||"100%"},allowClear:!0,showSearch:!0,options:l,onChange:h=>s(n.id,e,h)}):o==="textarea"?i.jsx(Pe.TextArea,{size:"small",value:t||"",placeholder:d,rows:1,style:{width:u||"100%"},onBlur:h=>{h.target.value!==(t||"")&&s(n.id,e,h.target.value)},onChange:()=>{},defaultValue:t||""}):i.jsx(Pe,{size:"small",defaultValue:t||"",placeholder:d,style:{width:u||"100%"},onBlur:h=>{h.target.value!==(t||"")&&s(n.id,e,h.target.value)}}),XC=({record:t,onSave:e,readonly:n})=>{const[s,o]=P.useState(!1),l=DH(t.attachments),d=async h=>{o(!0);try{const p=await Vn.uploadFile(h),m={file_id:p.id,file_name:p.filename||h.name,file_type:h.name.split(".").pop()||"",url:p.url},g=[...l,m];e(t.id,"attachments",JSON.stringify(g))}catch{me.error("")}finally{o(!1)}return!1},u=h=>{const p=l.filter(m=>m.file_id!==h);e(t.id,"attachments",JSON.stringify(p))};return i.jsxs("div",{children:[l.map(h=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:12,marginBottom:2},children:[i.jsx(Yu,{style:{color:"#1677ff"}}),i.jsx("a",{href:h.url,target:"_blank",rel:"noopener noreferrer",style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:h.file_name}),!n&&i.jsx(Bn,{title:"",onConfirm:()=>u(h.file_id),children:i.jsx(Zn,{style:{color:"#ff4d4f",cursor:"pointer",fontSize:11}})})]},h.file_id)),!n&&i.jsx(Zi,{showUploadList:!1,beforeUpload:h=>(d(h),!1),children:i.jsx(J,{size:"small",type:"dashed",icon:i.jsx(Li,{}),loading:s,style:{fontSize:11},children:""})})]})},a2=({items:t,onChange:e,mode:n="view",onItemSave:s,onImportExcel:o})=>{const l=n==="edit",{components:d,pcbs:u,services:h}=P.useMemo(()=>{const T=[],j=[],E=[];for(const R of t){const M=R.item_type||"component";M==="pcb"?j.push(R):M==="service"?E.push(R):T.push(R)}return{components:T,pcbs:j,services:E}},[t]),p=d.reduce((T,j)=>T+(j.quantity||0)*(j.unit_price||0),0),m=u.reduce((T,j)=>T+(j.quantity||0)*(j.unit_price||0),0),g=h.reduce((T,j)=>T+(j.quantity||0)*(j.unit_price||0),0),v=p+m+g,C=(T,j,E)=>{if(s)s(T,j,E);else{const R=t.map(M=>M.id===T?{...M,[j]:E}:M);e(R)}},b=T=>{const j=t.reduce((R,M)=>Math.max(R,M.item_number||0),0),E={id:`new-${Date.now()}`,item_number:j+1,item_type:T,name:T==="pcb"?"PCB":T==="service"?"SMT":"",quantity:1,unit:T==="service"?"":"pcs",attachments:"[]"};e([...t,E])},_=T=>{e(t.filter(j=>j.id!==T))},y=[{title:"#",dataIndex:"item_number",width:45,align:"center"},...l?[]:[{title:"",width:110,render:(T,j)=>i.jsx(Ba,{code:!0,style:{fontSize:11},children:j.material?.code||"-"})}],{title:"",dataIndex:"name",width:140,render:(T,j)=>l?i.jsx(_i,{value:T,field:"name",record:j,onSave:C,placeholder:""}):T},{title:"",dataIndex:"quantity",width:60,align:"right",render:(T,j)=>l?i.jsx(_i,{value:T,field:"quantity",record:j,onSave:C,type:"number"}):T},{title:"",dataIndex:"designator",width:120,ellipsis:!0,render:(T,j)=>l?i.jsx(_i,{value:T,field:"designator",record:j,onSave:C,placeholder:"R1,R2..."}):T||"-"},{title:"",dataIndex:"package",width:80,render:(T,j)=>l?i.jsx(_i,{value:T,field:"package",record:j,onSave:C,placeholder:"0402"}):T||"-"},{title:"",dataIndex:"specification",width:120,ellipsis:!0,render:(T,j)=>l?i.jsx(_i,{value:T,field:"specification",record:j,onSave:C,placeholder:"10k 1%"}):T||"-"},{title:"",dataIndex:"unit_price",width:80,align:"right",render:(T,j)=>l?i.jsx(_i,{value:T,field:"unit_price",record:j,onSave:C,type:"number",placeholder:"0.00"}):dl(T)}],S=[{title:"#",dataIndex:"item_number",width:45,align:"center"},...l?[]:[{title:"",width:110,render:(T,j)=>i.jsx(Ba,{code:!0,style:{fontSize:11},children:j.material?.code||"-"})}],{title:"",dataIndex:"name",width:120,render:(T,j)=>l?i.jsx(_i,{value:T,field:"name",record:j,onSave:C,placeholder:"PCB"}):T},{title:"",dataIndex:"quantity",width:55,align:"right",render:(T,j)=>l?i.jsx(_i,{value:T,field:"quantity",record:j,onSave:C,type:"number"}):T},{title:"",dataIndex:"pcb_layers",width:55,align:"center",render:(T,j)=>l?i.jsx(_i,{value:T,field:"pcb_layers",record:j,onSave:C,type:"number",placeholder:"4"}):T??"-"},{title:"",dataIndex:"pcb_thickness",width:70,render:(T,j)=>l?i.jsx(_i,{value:T,field:"pcb_thickness",record:j,onSave:C,placeholder:"1.6mm"}):T||"-"},{title:"",dataIndex:"pcb_material",width:80,render:(T,j)=>l?i.jsx(_i,{value:T,field:"pcb_material",record:j,onSave:C,type:"select",options:RH.map(E=>({label:E,value:E})),placeholder:"FR4"}):T||"-"},{title:"",dataIndex:"pcb_dimensions",width:85,render:(T,j)=>l?i.jsx(_i,{value:T,field:"pcb_dimensions",record:j,onSave:C,placeholder:"50x30mm"}):T||"-"},{title:"",dataIndex:"pcb_surface_finish",width:100,render:(T,j)=>l?i.jsx(_i,{value:T,field:"pcb_surface_finish",record:j,onSave:C,type:"select",options:AH.map(E=>({label:E,value:E})),placeholder:""}):T||"-"},{title:"",dataIndex:"unit_price",width:75,align:"right",render:(T,j)=>l?i.jsx(_i,{value:T,field:"unit_price",record:j,onSave:C,type:"number",placeholder:"0.00"}):dl(T)},{title:"",width:120,render:(T,j)=>i.jsx(XC,{record:j,onSave:C,readonly:!l})}],D=[{title:"#",dataIndex:"item_number",width:45,align:"center"},...l?[]:[{title:"",width:110,render:(T,j)=>i.jsx(Ba,{code:!0,style:{fontSize:11},children:j.material?.code||"-"})}],{title:"",dataIndex:"name",width:120,render:(T,j)=>l?i.jsx(_i,{value:T,field:"name",record:j,onSave:C,placeholder:""}):T},{title:"",dataIndex:"quantity",width:55,align:"right",render:(T,j)=>l?i.jsx(_i,{value:T,field:"quantity",record:j,onSave:C,type:"number"}):T},{title:"",dataIndex:"process_requirements",width:160,render:(T,j)=>l?i.jsx(_i,{value:T,field:"process_requirements",record:j,onSave:C,placeholder:"+"}):T||"-"},{title:"",dataIndex:"service_type",width:100,render:(T,j)=>l?i.jsx(_i,{value:T,field:"service_type",record:j,onSave:C,placeholder:"/"}):T||"-"},{title:"",dataIndex:"unit_price",width:80,align:"right",render:(T,j)=>l?i.jsx(_i,{value:T,field:"unit_price",record:j,onSave:C,type:"number",placeholder:"0.00"}):dl(T)},{title:"",width:120,render:(T,j)=>i.jsx(XC,{record:j,onSave:C,readonly:!l})}],L=T=>l?[...T,{title:"",width:40,align:"center",render:(j,E)=>i.jsx(Bn,{title:"",onConfirm:()=>_(E.id),children:i.jsx(Zn,{style:{color:"#ff4d4f",cursor:"pointer"}})})}]:T,N=(T,j,E,R,M,I)=>E.length===0&&!l?null:i.jsxs("div",{style:{marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 12px",background:M,borderRadius:"6px 6px 0 0",borderBottom:"1px solid #f0f0f0"},children:[j,i.jsx(Ba,{strong:!0,style:{fontSize:13},children:T}),i.jsxs(_e,{style:{fontSize:11},children:[I??E.length," "]})]}),E.length===0?i.jsx("div",{style:{padding:"16px 0",textAlign:"center",background:M,borderRadius:"0 0 6px 6px"},children:i.jsxs(Ba,{type:"secondary",style:{fontSize:12},children:["",T]})}):i.jsx(sn,{columns:L(R),dataSource:E,rowKey:"id",size:"small",pagination:!1,style:{background:M},rowClassName:()=>"ebom-row"})]});return i.jsxs("div",{children:[l&&i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[o&&i.jsx(J,{size:"small",icon:i.jsx(nd,{}),onClick:o,children:"Excel"}),i.jsx(J,{size:"small",icon:i.jsx(Yt,{}),onClick:()=>b("component"),children:""}),i.jsx(J,{size:"small",icon:i.jsx(Yt,{}),style:{borderColor:"#91caff",color:"#1677ff"},onClick:()=>b("pcb"),children:"PCB"})]}),t.length===0&&!l&&i.jsx(ft,{description:"BOM"}),N("",i.jsx(Ps,{style:{color:"#595959"}}),d,y,"#ffffff",d.length),N("PCB",i.jsx(f3,{style:{color:"#1677ff"}}),u,S,"#f0f8ff"),N("",i.jsx(Li,{style:{color:"#d48806"}}),h,D,"#fffdf0"),t.length>0&&i.jsxs("div",{style:{display:"flex",gap:24,padding:"10px 16px",background:"#fafafa",borderRadius:6,border:"1px solid #f0f0f0",flexWrap:"wrap"},children:[i.jsxs(Ba,{style:{fontSize:12},children:[": ",i.jsx(Ba,{strong:!0,children:dl(p)})]}),i.jsxs(Ba,{style:{fontSize:12},children:["PCB: ",i.jsx(Ba,{strong:!0,children:dl(m)})]}),i.jsxs(Ba,{style:{fontSize:12},children:[": ",i.jsx(Ba,{strong:!0,children:dl(g)})]}),i.jsxs(Ba,{style:{fontSize:13},children:["PCBA: ",i.jsx(Ba,{strong:!0,style:{color:"#1677ff"},children:dl(v)})]})]})]})},{Text:Eu}=An,IH=[{value:"",label:""},{value:"",label:""},{value:"/",label:"/"},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""}],OH=[{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""},{value:"",label:""}],QC=t=>t==null||isNaN(t)?"-":`${t.toFixed(2)}`,PH=({fileId:t,fileName:e,record:n,onSave:s,readonly:o})=>{const[l,d]=P.useState(!1),u=async h=>{d(!0);try{const p=await Vn.uploadFile(h);s(n.id,"design_file_id",p.id),s(n.id,"design_file_name",p.filename||h.name)}catch{me.error("")}finally{d(!1)}return!1};return t&&e?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:12},children:[i.jsx(Yu,{style:{color:"#1677ff"}}),i.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e}),!o&&i.jsx(Zn,{style:{color:"#ff4d4f",cursor:"pointer",fontSize:11},onClick:()=>{s(n.id,"design_file_id",""),s(n.id,"design_file_name","")}})]}):o?i.jsx(Eu,{style:{fontSize:12},children:"-"}):i.jsx(Zi,{showUploadList:!1,beforeUpload:h=>(u(h),!1),children:i.jsx(J,{size:"small",type:"dashed",icon:i.jsx(Li,{}),loading:l,style:{fontSize:11},children:""})})},s2=({items:t,onChange:e,mode:n="view",onItemSave:s})=>{const o=n==="edit",l=t.reduce((m,g)=>m+(g.quantity||0)*(g.unit_price||0),0),d=(m,g,v)=>{if(s)s(m,g,v);else{const C=t.map(b=>b.id===m?{...b,[g]:v}:b);e(C)}},u=()=>{const m=t.reduce((v,C)=>Math.max(v,C.item_number||0),0),g={id:`new-${Date.now()}`,item_number:m+1,category:"",name:"",quantity:1,unit:"pcs",language_code:""};e([...t,g])},h=m=>{e(t.filter(g=>g.id!==m))},p=[{title:"",dataIndex:"item_number",width:50,align:"center"},...o?[]:[{title:"",width:110,render:(m,g)=>i.jsx(Eu,{code:!0,style:{fontSize:11},children:g.material?.code||"-"})}],{title:"",dataIndex:"name",width:140,render:(m,g)=>o?i.jsx(Pe,{size:"small",defaultValue:m||"",placeholder:"",onBlur:v=>{v.target.value!==(m||"")&&d(g.id,"name",v.target.value)}}):m||"-"},{title:"",dataIndex:"category",width:120,render:(m,g)=>o?i.jsx(Xe,{size:"small",value:m||void 0,placeholder:"",style:{width:"100%"},options:IH,onChange:v=>d(g.id,"category",v)}):m||"-"},{title:"",dataIndex:"quantity",width:70,align:"right",render:(m,g)=>o?i.jsx(en,{size:"small",value:m,min:1,style:{width:"100%"},onChange:v=>d(g.id,"quantity",v)}):m},{title:"",dataIndex:"unit_price",width:80,align:"right",render:(m,g)=>o?i.jsx(en,{size:"small",value:m,min:0,step:.01,placeholder:"0.00",style:{width:"100%"},onChange:v=>d(g.id,"unit_price",v)}):QC(m)},{title:"",width:130,render:(m,g)=>i.jsx(PH,{fileId:g.design_file_id,fileName:g.design_file_name,record:g,onSave:d,readonly:!o})},{title:"",dataIndex:"language_code",width:100,render:(m,g)=>o?i.jsx(Xe,{size:"small",value:m||"",style:{width:"100%"},options:OH,onChange:v=>d(g.id,"language_code",v)}):m||""}];return o&&p.push({title:"",width:40,align:"center",render:(m,g)=>i.jsx(Bn,{title:"",onConfirm:()=>h(g.id),children:i.jsx(Zn,{style:{color:"#ff4d4f",cursor:"pointer"}})})}),i.jsxs("div",{children:[o&&i.jsx("div",{style:{marginBottom:12},children:i.jsx(J,{icon:i.jsx(Yt,{}),onClick:u,children:""})}),t.length===0&&!o?i.jsx(ft,{description:"BOM(PBOM)"}):i.jsx(sn,{columns:p,dataSource:t,rowKey:"id",size:"small",pagination:!1}),t.length>0&&i.jsxs("div",{style:{display:"flex",gap:24,padding:"10px 16px",marginTop:12,background:"#fafafa",borderRadius:6,border:"1px solid #f0f0f0"},children:[i.jsxs(Eu,{style:{fontSize:13},children:[": ",i.jsx(Eu,{strong:!0,style:{color:"#1677ff"},children:QC(l)})]}),i.jsxs(Eu,{style:{fontSize:12},type:"secondary",children:[" ",t.length," "]})]})]})},{Text:Ay}=An,r2=({value:t,onChange:e,onSaveDraft:n,readonly:s=!1,title:o=""})=>{const[l,d]=P.useState(null),u=t?.items||[],h=b=>{e?.({items:b,item_count:b.length}),n?.()},p=(b,_,y)=>{if(u[b]&&u[b][_]===y){d(null);return}const S=u.map((D,L)=>L===b?{...D,[_]:y}:D);h(S),d(null)},m=()=>{h([...u,{name:"",unit:"pcs",quantity:1,unit_price:0}])},g=b=>{h(u.filter((_,y)=>y!==b))},v=(b,_,y,S="text")=>s?i.jsx("div",{style:{minHeight:22,padding:"0 2px"},children:b??i.jsx(Ay,{type:"secondary",style:{fontSize:11},children:"-"})}):l?.rowIdx===_&&l?.field===y?S==="number"?i.jsx(en,{size:"small",autoFocus:!0,defaultValue:typeof b=="string"?parseFloat(b)||0:b,style:{width:"100%"},onBlur:L=>p(_,y,parseFloat(L.target.value)||0),onPressEnter:L=>p(_,y,parseFloat(L.target.value)||0)}):i.jsx(Pe,{size:"small",autoFocus:!0,defaultValue:b,onBlur:L=>p(_,y,L.target.value),onPressEnter:L=>p(_,y,L.target.value)}):i.jsx("div",{style:{cursor:"pointer",minHeight:22,padding:"0 2px",borderRadius:2},className:"editable-cell",onClick:()=>d({rowIdx:_,field:y}),children:b??i.jsx(Ay,{type:"secondary",style:{fontSize:11},children:"-"})}),C=[{title:"",width:55,align:"center",render:(b,_,y)=>y+1},{title:"",dataIndex:"name",width:200,render:(b,_,y)=>v(b,y,"name")},{title:"",dataIndex:"unit",width:80,render:(b,_,y)=>v(b,y,"unit")},{title:"",dataIndex:"quantity",width:100,align:"right",render:(b,_,y)=>v(b,y,"quantity","number")},{title:"",dataIndex:"unit_price",width:100,align:"right",render:(b,_,y)=>v(b,y,"unit_price","number")}];return s||C.push({title:"",width:40,align:"center",render:(b,_,y)=>i.jsx(Bn,{title:"",onConfirm:()=>g(y),children:i.jsx(J,{type:"text",size:"small",danger:!0,icon:i.jsx(Zn,{})})})}),i.jsxs("div",{children:[!s&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx(Ay,{strong:!0,style:{fontSize:13},children:o}),i.jsx(J,{type:"dashed",size:"small",icon:i.jsx(Yt,{}),onClick:m,children:""})]}),i.jsx(sn,{columns:C,dataSource:u,rowKey:(b,_)=>String(_),size:"small",pagination:!1,scroll:{x:575},style:{fontSize:12},locale:{emptyText:i.jsx(ft,{description:s?"":'""',image:ft.PRESENTED_IMAGE_SIMPLE})}}),!s&&i.jsx("style",{children:".editable-cell:hover { background: #f0f5ff; }"})]})},o2=t=>i.jsx(r2,{...t,title:""}),l2=t=>i.jsx(r2,{...t,title:""}),{Text:us,Title:mv}=An,Lc={pending:{color:"#bfbfbf",text:"",tagColor:"default"},in_progress:{color:"#1677ff",text:"",tagColor:"blue"},submitted:{color:"#fa8c16",text:"",tagColor:"orange"},completed:{color:"#52c41a",text:"",tagColor:"green"},reviewing:{color:"#faad14",text:"",tagColor:"gold"},rejected:{color:"#ff4d4f",text:"",tagColor:"red"}},ZC=[{key:"all",label:""},{key:"pending",label:""},{key:"in_progress",label:""},{key:"submitted",label:""},{key:"completed",label:""},{key:"rejected",label:""}],Nc=({name:t,avatarUrl:e})=>t?i.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,background:"#f0f0f0",borderRadius:12,padding:"2px 8px 2px 2px"},children:[i.jsx(Pi,{size:20,src:e,style:{background:"#1677ff",fontSize:11,flexShrink:0},children:t[0]}),i.jsx("span",{style:{fontSize:12,lineHeight:"20px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:60},children:t})]}):i.jsx(us,{type:"secondary",style:{fontSize:11},children:"-"}),LH=({value:t={},onChange:e,allUsers:n,projectId:s})=>{const{data:o=[]}=ct({queryKey:["task-roles"],queryFn:()=>Wv.list()}),{data:l=[]}=ct({queryKey:["project-tasks",s],queryFn:()=>Ci.listTasks(s),enabled:!!s}),d=P.useMemo(()=>{const p={};for(const m of o)p[m.code]=m.name;return p},[o]),u=P.useMemo(()=>{if(s&&l.length>0){const p=new Set;for(const m of l){const g=m.default_assignee_role;g&&p.add(g)}return Array.from(p).sort().map(m=>({code:m,label:d[m]||m}))}return o.map(p=>({code:p.code,label:p.name}))},[s,l,o,d]),h=(p,m)=>{e?.({...t,[p]:m})};return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:u.map(p=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("div",{style:{width:90,fontWeight:500,fontSize:13,flexShrink:0},children:p.label}),i.jsx(Xe,{showSearch:!0,optionFilterProp:"children",placeholder:"",value:t[p.code]||void 0,onChange:m=>h(p.code,m),allowClear:!0,onClear:()=>{const m={...t};delete m[p.code],e?.(m)},style:{flex:1},children:n.map(m=>i.jsx(Xe.Option,{value:m.id,children:i.jsxs(Be,{size:8,children:[i.jsx(Pi,{size:20,src:m.avatar_url,icon:i.jsx(wi,{}),children:m.name?.[0]}),i.jsx("span",{children:m.name})]})},m.id))})]},p.code))})},NH=({value:t,onChange:e,bomType:n="EBOM",onSaveDraft:s})=>{const[o,l]=P.useState(!1),[d,u]=P.useState(null),h=t?.items||[],p=(g,v)=>{e?.({filename:v||t?.filename||"",items:g,item_count:g.length}),s?.()},m=async g=>{u(null),l(!0);try{const C=(await Vn.parseBOM(g)).items||[];p(C,g.name)}catch(v){const C=v?.response?.data?.error||v?.response?.data?.message||"BOM";u(C)}finally{l(!1)}};return i.jsxs("div",{children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:i.jsxs(Be,{size:8,children:[i.jsx(Zi,{accept:".rep,.xlsx,.xls",showUploadList:!1,beforeUpload:g=>(m(g),!1),disabled:o,children:i.jsx(J,{size:"small",icon:i.jsx(Li,{}),loading:o,children:""})}),t?.filename&&t.filename!==""&&i.jsxs("span",{style:{fontSize:12,color:"#999"},children:[i.jsx(nd,{style:{color:"#52c41a",marginRight:4}}),t.filename]})]})}),d&&i.jsx(Ur,{message:d,type:"error",showIcon:!0,style:{marginBottom:8},closable:!0,onClose:()=>u(null)}),n==="EBOM"?i.jsx(a2,{items:h,onChange:g=>p(g),mode:"edit"}):n==="PBOM"?i.jsx(s2,{items:h,onChange:g=>p(g),mode:"edit"}):i.jsx(i2,{bomType:n,items:h,onChange:g=>p(g)})]})},FH=({data:t,bomType:e="EBOM"})=>{const[n,s]=P.useState(!1),o=e==="PBOM"?"BOM":e==="MBOM"?"BOM":"BOM";return i.jsxs("div",{children:[i.jsxs(Be,{size:8,style:{marginBottom:4},children:[i.jsx(nd,{style:{color:"#52c41a"}}),i.jsx("span",{style:{fontSize:13},children:t.filename}),i.jsxs(_e,{color:"blue",children:[t.item_count," "]}),i.jsx(_e,{children:o}),i.jsx(J,{type:"link",size:"small",onClick:()=>s(!n),style:{padding:0},children:n?"":""})]}),n&&i.jsx("div",{style:{marginTop:8},children:e==="EBOM"?i.jsx(a2,{items:t.items||[],onChange:()=>{},mode:"view"}):e==="PBOM"?i.jsx(s2,{items:t.items||[],onChange:()=>{},mode:"view"}):i.jsx(i2,{bomType:e,items:t.items||[],onChange:()=>{},showAddDelete:!1,readonly:!0})})]})},JC=({projectId:t,taskId:e})=>{const[n,s]=P.useState(null),[o,l]=P.useState(null),[d,u]=P.useState(!0),[h,p]=P.useState({}),m=Tn();if(Pn.useEffect(()=>{u(!0),Promise.all([Vn.getForm(t,e),Vn.getSubmission(t,e)]).then(([_,y])=>{s(_),l(y),_?.fields?.some(S=>S.type==="user"||S.type==="role_assignment")&&ef.list().then(S=>{const D={};S.forEach(L=>{D[L.id]=L.name}),p(D)})}).catch(()=>{}).finally(()=>u(!1))},[t,e]),d)return i.jsx("div",{style:{color:"#999",fontSize:12,padding:8},children:"..."});if(!n||!o)return null;const g=n.fields||[],v=o.data||{},C=_=>{let y=v[_.key];if(_.type==="bom_upload"&&y&&typeof y=="object"&&y.items)return{key:_.key,label:_.label,complex:!0,node:i.jsx(FH,{data:y,bomType:_.bom_type||"EBOM"})};if(["ebom_control","pbom_control","mbom_control"].includes(_.type)&&Array.isArray(y)){const S=_.type==="ebom_control"?sf:_.type==="pbom_control"?rf:of;return{key:_.key,label:_.label,complex:!0,node:i.jsx(S,{config:_.config||{},value:y,onChange:()=>{},readonly:!0})}}if(_.type==="cmf")return{key:_.key,label:_.label,complex:!0,node:i.jsx(Yv,{projectId:t,taskId:e,readonly:!0})};if((_.type==="tooling_list"||_.type==="consumable_list")&&y&&typeof y=="object"&&y.items){const S=_.type==="tooling_list"?o2:l2;return{key:_.key,label:_.label,complex:!0,node:i.jsx(S,{value:y,readonly:!0})}}return _.type==="procurement_control"&&y&&typeof y=="object"?{key:_.key,label:_.label,complex:!0,node:i.jsx(Xv,{value:y})}:(y==null?y="-":_.type==="role_assignment"&&typeof y=="object"&&!Array.isArray(y)?y=Object.entries(y).map(([S,D])=>`${S}: ${h[D]||D}`).join("; ")||"-":_.type==="user"?y=h[y]||y:typeof y=="boolean"?y=y?"":"":Array.isArray(y)&&(y=y.length>0&&typeof y[0]=="object"&&y[0].filename?y.map(S=>S.filename).join(", "):y.join(", ")),{key:_.key,label:_.label,complex:!1,text:String(y)})},b=g.map(C);return m?i.jsxs("div",{children:[i.jsx("div",{className:"ds-section-title",children:""}),b.map(_=>_.complex?i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("div",{style:{fontSize:12,color:"var(--ds-text-secondary)",marginBottom:4},children:_.label}),_.node]},_.key):i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:_.label}),i.jsx("span",{className:"ds-info-value",children:_.text})]},_.key)),o.submitted_at&&i.jsxs("div",{style:{fontSize:11,color:"var(--ds-text-secondary)",marginTop:8},children:[": ",lt(o.submitted_at).format("YYYY-MM-DD HH:mm")]})]}):i.jsxs("div",{children:[i.jsx(us,{strong:!0,style:{fontSize:14,marginBottom:12,display:"block"},children:""}),i.jsx(pe,{size:"small",column:1,bordered:!0,children:b.map(_=>_.complex?i.jsx(pe.Item,{label:_.label,children:_.node},_.key):i.jsx(pe.Item,{label:_.label,children:_.text},_.key))}),o.submitted_at&&i.jsxs(us,{type:"secondary",style:{fontSize:11,marginTop:8,display:"block"},children:[": ",lt(o.submitted_at).format("YYYY-MM-DD HH:mm")]})]})},zH=({task:t,onBack:e,onRefresh:n})=>{const[s,o]=P.useState(null),[l,d]=P.useState(!0),[u,h]=P.useState({}),[p,m]=P.useState(!1),[g,v]=P.useState(!1),[C]=ee.useForm(),b=Tn(),{data:_=[]}=ct({queryKey:["users"],queryFn:()=>ef.list()}),y=P.useRef(null),S=P.useRef(!1);P.useEffect(()=>(d(!0),C.resetFields(),h({}),Promise.all([Vn.getForm(t.project_id,t.id),t.status==="in_progress"?Vn.getDraft(t.id):Promise.resolve(null)]).then(async([O,k])=>{if(o(O),k?.data&&O?.fields?.length&&C.setFieldsValue(k.data),O?.fields?.some(F=>F.type==="procurement_control"))try{const F=await Vn.getSubmission(t.project_id,t.id);if(F?.data){const A={};for(const q of O.fields)q.type==="procurement_control"&&F.data[q.key]&&(A[q.key]=F.data[q.key]);Object.keys(A).length>0&&C.setFieldsValue(A)}}catch{}}).catch(()=>o(null)).finally(()=>d(!1)),()=>{y.current&&clearTimeout(y.current)}),[t.project_id,t.id]);const D=P.useCallback(()=>{console.log("[Draft] saveDraftDebounced called"),y.current&&clearTimeout(y.current),y.current=setTimeout(async()=>{if(console.log("[Draft] setTimeout fired, draftSaving:",S.current),!S.current){S.current=!0;try{const O=C.getFieldsValue();console.log("[Draft] form values:",JSON.stringify(O).slice(0,200)),console.log("[Draft] task.id:",t.id),await Vn.saveDraft(t.id,O),console.log("[Draft] save success")}catch(O){const k=O?.response?.status;console.error("[Draft Save] failed:",k,O?.response?.data||O),k===401?me.warning(""):me.warning("")}finally{S.current=!1}}},1e3)},[t.id,C]),L=O=>{const k=O?.response?.status,F=O?.response?.data?.error||O?.response?.data?.message||"";k===400?me.error(`${F}`):me.error(F)},N=async()=>{v(!0);try{await wu.startTask(t.project_id,t.id),me.success(""),n()}catch(O){L(O)}finally{v(!1)}},T=async()=>{m(!0);try{let O;if(s?.fields?.length){const k=await C.validateFields();for(const F of s.fields){if(F.type==="file"&&u[F.key]){const A=[];for(const q of u[F.key])if(q.response)A.push(q.response);else if(q.originFileObj)try{const B=await Vn.uploadFile(q.originFileObj);A.push(B)}catch{me.error(` ${q.name} `),m(!1);return}k[F.key]=A}F.type==="date"&&k[F.key]&&(k[F.key]=lt(k[F.key]).format("YYYY-MM-DD"))}O=k}await Vn.completeMyTask(t.id,O),me.success(""),n()}catch(O){if(O?.errorFields)return;L(O)}finally{m(!1)}},j=O=>{switch(O.type){case"text":return i.jsx(Pe,{placeholder:O.placeholder});case"textarea":return i.jsx(Pe.TextArea,{rows:3,placeholder:O.placeholder});case"number":return i.jsx(en,{style:{width:"100%"},placeholder:O.placeholder});case"select":return i.jsx(Xe,{placeholder:O.placeholder,children:(O.options||[]).map(k=>i.jsx(Xe.Option,{value:k,children:k},k))});case"multiselect":return i.jsx(Xe,{mode:"multiple",placeholder:O.placeholder,children:(O.options||[]).map(k=>i.jsx(Xe.Option,{value:k,children:k},k))});case"date":return i.jsx(qa,{style:{width:"100%"}});case"file":return i.jsx(Zi,{fileList:u[O.key]||[],onChange:({fileList:k})=>h(F=>({...F,[O.key]:k})),beforeUpload:()=>!1,multiple:O.multiple,accept:O.accept,children:i.jsx(J,{icon:i.jsx(Li,{}),children:""})});case"checkbox":return i.jsx(pa,{children:O.description||O.label});case"user":return i.jsx(Xe,{showSearch:!0,optionFilterProp:"children",placeholder:"",children:_.map(k=>i.jsx(Xe.Option,{value:k.id,children:i.jsxs(Be,{size:8,children:[i.jsx(Pi,{size:20,src:k.avatar_url,icon:i.jsx(wi,{}),children:k.name?.[0]}),i.jsx("span",{children:k.name})]})},k.id))});case"role_assignment":return i.jsx(LH,{allUsers:_,projectId:t.project_id});case"bom_upload":return i.jsx(NH,{bomType:O.bom_type||"EBOM",onSaveDraft:D});case"ebom_control":return i.jsx(sf,{config:O.config||{},value:[],onChange:k=>{C.setFieldValue(O.key,k),D?.()}});case"pbom_control":return i.jsx(rf,{config:O.config||{},value:[],onChange:k=>{C.setFieldValue(O.key,k),D?.()}});case"mbom_control":return i.jsx(of,{config:O.config||{},value:[],onChange:k=>{C.setFieldValue(O.key,k),D?.()}});case"cmf":return i.jsx(Yv,{projectId:t.project_id,taskId:t.id});case"tooling_list":return i.jsx(o2,{onSaveDraft:D});case"consumable_list":return i.jsx(l2,{onSaveDraft:D});case"procurement_control":return i.jsx(Xv,{value:C.getFieldValue(O.key)});default:return i.jsx(Pe,{placeholder:O.placeholder})}},E=Lc[t.status]||Lc.pending,R=!!(s?.fields&&s.fields.length>0),M=t.status==="in_progress",I=t.status==="submitted"||t.status==="completed"||t.status==="reviewing",z=t.project?.name||t.project_name||"-",V=t.due_date?lt(t.due_date).diff(lt(),"day"):null;if(b){const O=E.tagColor==="blue"?"ds-tag-processing":E.tagColor==="green"?"ds-tag-success":E.tagColor==="orange"||E.tagColor==="gold"?"ds-tag-warning":E.tagColor==="red"?"ds-tag-danger":"ds-tag-default";return i.jsxs("div",{className:"ds-detail-page",children:[i.jsx(J,{type:"link",icon:i.jsx(Ls,{}),onClick:e,style:{padding:0,marginBottom:8},children:""}),i.jsxs("div",{className:"ds-detail-header",children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[i.jsx("div",{className:"ds-card-title",style:{flex:1},children:t.title}),i.jsx("span",{className:`ds-tag ${O}`,children:E.text})]}),(t.code||t.task_code)&&i.jsx("div",{className:"ds-card-subtitle",style:{fontFamily:"monospace",marginBottom:8},children:t.code||t.task_code}),i.jsx("div",{className:"ds-card-meta",style:{marginTop:0},children:i.jsxs("span",{children:[i.jsx(qy,{})," ",z]})})]}),i.jsxs("div",{className:"ds-detail-section",children:[i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:i.jsx(Nc,{name:t.assignee?.name||t.assignee_name,avatarUrl:t.assignee?.avatar_url})})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:i.jsx(Nc,{name:t.creator?.name,avatarUrl:t.creator?.avatar_url})})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",style:{color:V==null?"#999":V<0?"#ff4d4f":V<=3?"#fa8c16":"#52c41a"},children:V!=null?`${V}`:"-"})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsxs("span",{className:"ds-info-value",children:[t.start_date?lt(t.start_date).format("MM-DD"):"-"," ~ ",t.due_date?lt(t.due_date).format("MM-DD"):"-"]})]}),i.jsxs("div",{className:"ds-info-row",children:[i.jsx("span",{className:"ds-info-label",children:""}),i.jsx("span",{className:"ds-info-value",children:i.jsx(Mi,{percent:t.progress,size:"small",style:{width:80}})})]}),t.description&&i.jsx("div",{style:{paddingTop:8,fontSize:13,color:"var(--ds-text-secondary)"},children:t.description})]}),i.jsx("div",{className:"ds-detail-section",children:l?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):R&&M?i.jsxs("div",{children:[i.jsx("div",{className:"ds-section-title",children:""}),s.description&&i.jsx("div",{style:{marginBottom:12,color:"#666",fontSize:13},children:s.description}),i.jsx(ee,{form:C,layout:"vertical",preserve:!1,onFieldsChange:D,children:s.fields.map(k=>i.jsx(ee.Item,{name:k.key,label:k.label,rules:k.type!=="checkbox"&&k.required?[{required:!0,message:`${k.label}`}]:void 0,valuePropName:k.type==="checkbox"?"checked":"value",extra:k.type!=="checkbox"?k.description:void 0,children:j(k)},k.key))})]}):I?i.jsx(JC,{projectId:t.project_id,taskId:t.id}):i.jsx(ft,{description:""})}),(t.status==="pending"||t.status==="in_progress"||t.status==="rejected")&&i.jsxs("div",{className:"bom-mobile-action-bar",children:[t.status==="pending"&&i.jsx(J,{type:"primary",loading:g,onClick:N,block:!0,style:{background:"#52c41a",borderColor:"#52c41a"},children:""}),t.status==="in_progress"&&i.jsx(J,{type:"primary",loading:p,onClick:T,block:!0,icon:i.jsx(ra,{}),style:{background:"#52c41a",borderColor:"#52c41a"},children:R?"":""}),t.status==="rejected"&&i.jsx(J,{type:"primary",loading:g,onClick:N,block:!0,style:{background:"#fa8c16",borderColor:"#fa8c16"},children:""})]})]})}return i.jsxs("div",{style:{padding:24},children:[i.jsx(J,{type:"link",icon:i.jsx(Ls,{}),onClick:e,style:{padding:0,marginBottom:16},children:""}),i.jsxs(Mt,{style:{marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[i.jsxs("div",{children:[i.jsxs(mv,{level:4,style:{margin:0},children:[t.title,i.jsx(_e,{color:E.tagColor,style:{marginLeft:8,verticalAlign:"middle"},children:E.text})]}),i.jsxs(Be,{size:8,style:{marginTop:4},wrap:!0,children:[(t.code||t.task_code)&&i.jsx(us,{code:!0,style:{fontSize:12},children:t.code||t.task_code}),i.jsxs(us,{type:"secondary",style:{fontSize:12},children:[i.jsx(qy,{style:{marginRight:4}}),z]})]})]}),i.jsxs("div",{style:{display:"flex",gap:8},children:[t.status==="pending"&&i.jsx(J,{type:"primary",loading:g,onClick:N,style:{background:"#52c41a",borderColor:"#52c41a"},children:""}),t.status==="in_progress"&&i.jsx(J,{type:"primary",loading:p,onClick:T,icon:i.jsx(ra,{}),style:{background:"#52c41a",borderColor:"#52c41a"},children:R?"":""}),t.status==="rejected"&&i.jsx(J,{type:"primary",loading:g,onClick:N,style:{background:"#fa8c16",borderColor:"#fa8c16"},children:""})]})]}),i.jsxs(pe,{column:3,size:"small",bordered:!0,children:[i.jsx(pe.Item,{label:"",children:i.jsx(Nc,{name:t.assignee?.name||t.assignee_name,avatarUrl:t.assignee?.avatar_url})}),i.jsx(pe.Item,{label:"",children:i.jsx(Nc,{name:t.creator?.name,avatarUrl:t.creator?.avatar_url})}),i.jsx(pe.Item,{label:"",children:i.jsx("span",{style:{fontWeight:600,color:V==null?"#999":V<0?"#ff4d4f":V<=3?"#fa8c16":"#52c41a"},children:V!=null?`${V}`:"-"})}),i.jsx(pe.Item,{label:"",children:t.start_date?lt(t.start_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",children:t.due_date?lt(t.due_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",children:i.jsx(Mi,{percent:t.progress,size:"small",style:{width:120}})})]}),t.description&&i.jsx("div",{style:{marginTop:12},children:i.jsx(us,{type:"secondary",style:{fontSize:12},children:t.description})})]}),i.jsx(Mt,{children:l?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):R&&M?i.jsxs("div",{children:[i.jsx(mv,{level:5,style:{marginBottom:16},children:""}),s.description&&i.jsx("div",{style:{marginBottom:12,color:"#666",fontSize:13},children:s.description}),i.jsx(ee,{form:C,layout:"vertical",preserve:!1,onFieldsChange:D,children:s.fields.map(O=>i.jsx(ee.Item,{name:O.key,label:O.label,rules:O.type!=="checkbox"&&O.required?[{required:!0,message:`${O.label}`}]:void 0,valuePropName:O.type==="checkbox"?"checked":"value",extra:O.type!=="checkbox"?O.description:void 0,children:j(O)},O.key))})]}):I?i.jsx(JC,{projectId:t.project_id,taskId:t.id}):i.jsx(ft,{description:""})})]})},kH=()=>{const t=Ln(),e=Tn(),[n,s]=P.useState("all"),[o,l]=P.useState(null),[d,u]=P.useState(1),h=50,p=n==="all"?void 0:n,{data:m,isLoading:g}=ct({queryKey:["my-tasks",p,d,h],queryFn:()=>Ci.myTasks({status:p,page:d,page_size:h})}),v=m?.items||[],C=m?.pagination?.total||0,b=P.useMemo(()=>v.find(S=>S.id===o)||null,[v,o]),_=P.useCallback(()=>{t.invalidateQueries({queryKey:["my-tasks"]})},[t]);$v({onTaskUpdate:P.useCallback(()=>{t.invalidateQueries({queryKey:["my-tasks"]})},[t]),onMyTaskUpdate:P.useCallback(()=>{t.invalidateQueries({queryKey:["my-tasks"]})},[t])});const y=[{title:"",dataIndex:"title",ellipsis:!0,render:(S,D)=>{const L=Lc[D.status]||Lc.pending,N=D.project?.name||D.project_name||"";return i.jsxs(Be,{size:6,children:[i.jsx(_e,{color:L.tagColor,style:{fontSize:10,padding:"0 4px",margin:0,lineHeight:"18px"},children:L.text}),i.jsx(rn,{title:S,children:i.jsx("span",{style:{fontWeight:500,fontSize:13,color:D.status==="completed"?"#999":"#333",textDecoration:D.status==="completed"?"line-through":"none"},children:S})}),N&&i.jsxs("span",{style:{fontSize:12,color:"#999"},children:[" ",N]})]})}},{title:"",dataIndex:"assignee",width:120,align:"center",render:(S,D)=>i.jsx(Nc,{name:D.assignee?.name||D.assignee_name,avatarUrl:D.assignee?.avatar_url})},{title:"",dataIndex:"due_date",width:85,align:"center",render:S=>{if(!S)return i.jsx(us,{type:"secondary",style:{fontSize:12},children:"-"});const D=lt(S).diff(lt(),"day");return i.jsx("span",{style:{fontWeight:500,fontSize:12,color:D<0?"#ff4d4f":D<=3?"#fa8c16":"#52c41a"},children:D})}},{title:"",dataIndex:"start_date",width:90,align:"center",render:S=>S?i.jsx(us,{style:{fontSize:12},children:lt(S).format("MM-DD")}):i.jsx(us,{type:"secondary",style:{fontSize:12},children:"-"})},{title:"",dataIndex:"due_date",width:90,align:"center",key:"due_date_display",render:S=>S?i.jsx(us,{style:{fontSize:12},children:lt(S).format("MM-DD")}):i.jsx(us,{type:"secondary",style:{fontSize:12},children:"-"})},{title:"",dataIndex:"creator",width:120,align:"center",render:(S,D)=>i.jsx(Nc,{name:D.creator?.name,avatarUrl:D.creator?.avatar_url})}];return b?i.jsx(zH,{task:b,onBack:()=>l(null),onRefresh:_}):e?i.jsxs("div",{children:[i.jsx("div",{className:"mobile-filter-pills",children:ZC.map(S=>i.jsx("div",{className:`mobile-filter-pill ${n===S.key?"active":""}`,onClick:()=>{s(S.key),u(1)},children:S.label},S.key))}),i.jsxs("div",{className:"ds-page-content",children:[g?i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(tn,{})}):v.length===0?i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(ft,{description:""})}):v.map(S=>{const D=Lc[S.status]||Lc.pending,L=S.project?.name||S.project_name||"",N=S.due_date,T=N?lt(N).diff(lt(),"day"):null,j=D.tagColor==="blue"?"ds-tag-processing":D.tagColor==="green"?"ds-tag-success":D.tagColor==="orange"||D.tagColor==="gold"?"ds-tag-warning":D.tagColor==="red"?"ds-tag-danger":"ds-tag-default";return i.jsxs("div",{className:"ds-list-card",onClick:()=>l(S.id),children:[i.jsxs("div",{className:"ds-card-header",children:[i.jsx("div",{style:{flex:1,minWidth:0},children:i.jsx("div",{className:"ds-card-title",style:{color:S.status==="completed"?"#999":void 0,textDecoration:S.status==="completed"?"line-through":"none"},children:S.title})}),i.jsx("span",{className:`ds-tag ${j}`,children:D.text})]}),i.jsxs("div",{className:"ds-card-meta",children:[L&&i.jsxs("span",{children:[i.jsx(qy,{})," ",L]}),N&&i.jsxs("span",{style:{color:T!=null&&T<0?"#ff4d4f":T!=null&&T<=3?"#fa8c16":void 0},children:[i.jsx(zp,{})," ",lt(N).format("MM-DD")]}),S.assignee?.name&&i.jsxs("span",{children:[i.jsx(wi,{})," ",S.assignee.name]})]})]},S.id)}),C>h&&i.jsx("div",{style:{textAlign:"center",padding:"16px 0"},children:i.jsx(J,{onClick:()=>u(d+1),children:""})})]})]}):i.jsxs("div",{style:{padding:24},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsxs(Be,{size:8,children:[i.jsx(mv,{level:4,style:{margin:0},children:""}),i.jsxs(us,{type:"secondary",children:[C," "]})]}),i.jsx(Be,{size:4,children:ZC.map(S=>i.jsx(J,{type:n===S.key?"primary":"default",size:"small",onClick:()=>{s(S.key),u(1)},children:S.label},S.key))})]}),i.jsx(sn,{columns:y,dataSource:v,rowKey:"id",size:"small",loading:g,locale:{emptyText:i.jsx(ft,{description:""})},pagination:C>h?{current:d,pageSize:h,total:C,onChange:S=>u(S),size:"small",showTotal:S=>` ${S} `}:!1,onRow:S=>({onClick:()=>l(S.id),style:{cursor:"pointer"}})})]})},ul={list:async()=>(await Z.get("/roles")).data.data?.items||[],create:async t=>(await Z.post("/roles",t)).data.data,update:async(t,e)=>(await Z.put(`/roles/${t}`,e)).data.data,delete:async t=>(await Z.delete(`/roles/${t}`)).data,listMembers:async t=>(await Z.get(`/roles/${t}/members`)).data.data?.items||[],addMembers:async(t,e)=>(await Z.post(`/roles/${t}/members`,{user_ids:e})).data,removeMembers:async(t,e)=>(await Z.delete(`/roles/${t}/members`,{data:{user_ids:e}})).data},BH={tree:async()=>(await Z.get("/departments")).data.data?.items||[]},UH={list:async()=>(await Z.get("/users")).data.data?.items||[]},HH=()=>{const{modal:t,message:e}=Ya.useApp(),n=Ln(),[s,o]=P.useState(""),[l,d]=P.useState(""),[u,h]=P.useState(""),[p,m]=P.useState([]),[g,v]=P.useState(!1),[C,b]=P.useState(!1),[_,y]=P.useState(null),[S]=ee.useForm(),{data:D=[],isLoading:L}=ct({queryKey:["roles"],queryFn:ul.list}),N=D.find(B=>B.id===s);Pn.useEffect(()=>{D.length>0&&!s&&o(D[0].id)},[D,s]);const{data:T=[],isLoading:j}=ct({queryKey:["role-members",s],queryFn:()=>ul.listMembers(s),enabled:!!s}),E=Rt({mutationFn:B=>ul.create(B),onSuccess:()=>{n.invalidateQueries({queryKey:["roles"]}),e.success(""),b(!1),S.resetFields()},onError:()=>e.error("")}),R=Rt({mutationFn:({id:B,data:W})=>ul.update(B,W),onSuccess:()=>{n.invalidateQueries({queryKey:["roles"]}),e.success(""),b(!1),y(null),S.resetFields()},onError:()=>e.error("")}),M=Rt({mutationFn:B=>ul.delete(B),onSuccess:(B,W)=>{n.invalidateQueries({queryKey:["roles"]}),e.success(""),s===W&&o("")},onError:()=>e.error("")}),I=Rt({mutationFn:B=>ul.addMembers(s,B),onSuccess:()=>{n.invalidateQueries({queryKey:["role-members",s]}),e.success(""),v(!1)},onError:()=>e.error("")}),z=Rt({mutationFn:B=>ul.removeMembers(s,B),onSuccess:()=>{n.invalidateQueries({queryKey:["role-members",s]}),m([]),e.success("")},onError:()=>e.error("")}),V=P.useMemo(()=>l?D.filter(B=>B.name.includes(l)):D,[D,l]),O=P.useMemo(()=>u?T.filter(B=>B.name.includes(u)):T,[T,u]),k=()=>{S.validateFields().then(B=>{_?R.mutate({id:_.id,data:B}):E.mutate(B)})},F=B=>{y(B),S.setFieldsValue({name:B.name}),b(!0)},A=()=>{y(null),S.resetFields(),b(!0)},q=[{title:"",dataIndex:"name",key:"name",render:(B,W)=>i.jsxs(Be,{children:[i.jsx(Pi,{size:"small",src:W.avatar_url,icon:i.jsx(wi,{})}),B]})},{title:"",dataIndex:"email",key:"email"},{title:"",dataIndex:"department_name",key:"department_name",render:B=>B||"-"}];return i.jsxs("div",{style:{display:"flex",height:"calc(100vh - 56px)",background:"#f5f5f5"},children:[i.jsxs("div",{style:{width:280,minWidth:280,background:"#fff",borderRight:"1px solid #f0f0f0",display:"flex",flexDirection:"column"},children:[i.jsx("div",{style:{padding:"16px 16px 8px"},children:i.jsx(Pe,{placeholder:"",prefix:i.jsx(gi,{style:{color:"#bfbfbf"}}),value:l,onChange:B=>d(B.target.value),allowClear:!0})}),i.jsx("div",{style:{flex:1,overflow:"auto",padding:"0 8px"},children:L?i.jsx("div",{style:{textAlign:"center",paddingTop:40},children:i.jsx(tn,{})}):V.length===0?i.jsx(ft,{description:"",style:{marginTop:40}}):V.map(B=>i.jsxs("div",{onClick:()=>o(B.id),style:{display:"flex",alignItems:"center",padding:"10px 12px",borderRadius:6,cursor:"pointer",marginBottom:2,background:s===B.id?"#e6f7ff":"transparent",transition:"background 0.2s"},children:[i.jsx(Pp,{style:{fontSize:16,color:"#8c8c8c",marginRight:10}}),i.jsx("div",{style:{flex:1,minWidth:0},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("span",{style:{fontSize:14,fontWeight:s===B.id?500:400,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B.name}),B.is_system&&i.jsx(_e,{color:"blue",style:{fontSize:11,lineHeight:"18px",padding:"0 4px",margin:0},children:""})]})}),i.jsx(CT,{trigger:["click"],menu:{items:[{key:"edit",label:""},{key:"delete",label:"",danger:!0}],onClick:({key:W})=>{W==="edit"&&F(B),W==="delete"&&t.confirm({title:"",content:`${B.name}`,onOk:()=>M.mutate(B.id)})}},children:i.jsx(h3,{onClick:W=>W.stopPropagation(),style:{fontSize:16,color:"#8c8c8c",padding:4}})})]},B.id))}),i.jsx("div",{style:{padding:16,borderTop:"1px solid #f0f0f0"},children:i.jsx(J,{type:"dashed",block:!0,icon:i.jsx(Yt,{}),onClick:A,children:""})})]}),i.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:N?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{padding:"20px 24px 16px",background:"#fff",borderBottom:"1px solid #f0f0f0"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{children:i.jsx("h2",{style:{margin:0,fontSize:20},children:N.name})}),i.jsxs(Be,{children:[i.jsx(Pp,{style:{fontSize:16,color:"#8c8c8c"}}),i.jsxs("span",{style:{color:"#8c8c8c"},children:[T.length," "]})]})]})}),i.jsxs("div",{style:{padding:"12px 24px",background:"#fff",display:"flex",alignItems:"center",gap:12},children:[i.jsx(Pe,{placeholder:"",prefix:i.jsx(gi,{style:{color:"#bfbfbf"}}),style:{width:240},value:u,onChange:B=>h(B.target.value),allowClear:!0}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>v(!0),children:""}),p.length>0&&i.jsx(Bn,{title:` ${p.length} `,onConfirm:()=>z.mutate(p),children:i.jsxs(J,{danger:!0,icon:i.jsx(Zn,{}),children:[" (",p.length,")"]})})]}),i.jsx("div",{style:{flex:1,padding:"0 24px 24px",overflow:"auto"},children:i.jsx(sn,{rowKey:"user_id",columns:q,dataSource:O,loading:j,pagination:!1,size:"middle",rowSelection:{selectedRowKeys:p,onChange:B=>m(B)},locale:{emptyText:i.jsx(ft,{description:""})}})})]}):i.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",background:"#fff"},children:i.jsx(ft,{description:""})})}),i.jsx(Nt,{title:_?"":"",open:C,onOk:k,onCancel:()=>{b(!1),y(null),S.resetFields()},confirmLoading:E.isPending||R.isPending,children:i.jsx(ee,{form:S,layout:"vertical",style:{marginTop:16},children:i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:" "})})})}),g&&i.jsx(VH,{open:g,existingMemberIds:T.map(B=>B.user_id),onOk:B=>I.mutate(B),onCancel:()=>v(!1),confirmLoading:I.isPending})]})},VH=({open:t,existingMemberIds:e,onOk:n,onCancel:s,confirmLoading:o})=>{const{message:l}=Ya.useApp(),[d,u]=P.useState(""),[h,p]=P.useState(new Map),[m,g]=P.useState([]),{data:v=[],isLoading:C}=ct({queryKey:["department-tree"],queryFn:BH.tree,enabled:t}),{data:b=[],isLoading:_}=ct({queryKey:["system-users"],queryFn:UH.list,enabled:t}),y=C||_;Pn.useEffect(()=>{v.length>0&&m.length===0&&g(v.map(E=>E.id))},[v,m.length]);const S=P.useMemo(()=>{const E=new Map,R=M=>{for(const I of M){for(const z of I.users)E.set(z.id,I.name);R(I.children)}};return R(v),b.map(M=>({...M,deptName:E.get(M.id)||""}))},[b,v]),D=P.useMemo(()=>d?S.filter(E=>E.name.includes(d)||E.email&&E.email.includes(d)):null,[S,d]),L=E=>{p(R=>{const M=new Map(R);return M.has(E.id)?M.delete(E.id):M.set(E.id,E),M})},N=E=>{p(R=>{const M=new Map(R);return M.delete(E),M})},T=()=>{const E=Array.from(h.keys());if(E.length===0){l.warning("");return}n(E)},j=P.useMemo(()=>{const E=R=>R.map(M=>({title:M.name,key:`dept-${M.id}`,selectable:!1,children:[...M.users.map(I=>({title:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"2px 0",cursor:"pointer"},onClick:()=>L(I),children:[i.jsx(pa,{checked:h.has(I.id),disabled:e.includes(I.id)}),i.jsx(Pi,{size:"small",src:I.avatar_url,icon:i.jsx(wi,{})}),i.jsx("span",{children:I.name}),e.includes(I.id)&&i.jsx(_e,{color:"default",style:{fontSize:11,margin:0},children:""})]}),key:`user-${I.id}`,isLeaf:!0,selectable:!1})),...E(M.children)]}));return E(v)},[v,h,e]);return i.jsx(Nt,{title:"",open:t,onOk:T,onCancel:s,confirmLoading:o,width:720,styles:{body:{padding:0}},children:i.jsxs("div",{style:{display:"flex",height:480,borderTop:"1px solid #f0f0f0"},children:[i.jsxs("div",{style:{flex:1,borderRight:"1px solid #f0f0f0",display:"flex",flexDirection:"column",overflow:"hidden"},children:[i.jsx("div",{style:{padding:"12px 16px 8px"},children:i.jsx(Pe,{placeholder:"",prefix:i.jsx(gi,{style:{color:"#bfbfbf"}}),value:d,onChange:E=>u(E.target.value),allowClear:!0})}),i.jsx("div",{style:{flex:1,overflow:"auto",padding:"0 8px"},children:y?i.jsx("div",{style:{textAlign:"center",paddingTop:40},children:i.jsx(tn,{})}):D!==null?D.length===0?i.jsx(ft,{description:"",style:{marginTop:40}}):D.map(E=>i.jsxs("div",{onClick:()=>!e.includes(E.id)&&L(E),style:{display:"flex",alignItems:"center",gap:8,padding:"8px 12px",borderRadius:4,cursor:e.includes(E.id)?"not-allowed":"pointer",opacity:e.includes(E.id)?.5:1},children:[i.jsx(pa,{checked:h.has(E.id),disabled:e.includes(E.id)}),i.jsx(Pi,{size:"small",src:E.avatar_url,icon:i.jsx(wi,{})}),i.jsxs("div",{children:[i.jsx("div",{children:E.name}),i.jsx("div",{style:{fontSize:12,color:"#8c8c8c"},children:E.deptName})]})]},E.id)):i.jsx(p3,{treeData:j,expandedKeys:m,onExpand:E=>g(E),selectable:!1,blockNode:!0})})]}),i.jsxs("div",{style:{width:240,display:"flex",flexDirection:"column",overflow:"hidden"},children:[i.jsxs("div",{style:{padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #f0f0f0"},children:[i.jsxs("span",{style:{fontWeight:500},children:["",h.size," "]}),h.size>0&&i.jsx(J,{type:"link",size:"small",onClick:()=>p(new Map),children:""})]}),i.jsx("div",{style:{flex:1,overflow:"auto",padding:8},children:h.size===0?i.jsx(ft,{description:"",style:{marginTop:40}}):Array.from(h.values()).map(E=>i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",borderRadius:4},children:[i.jsxs(Be,{size:8,children:[i.jsx(Pi,{size:"small",src:E.avatar_url,icon:i.jsx(wi,{})}),i.jsx("span",{children:E.name})]}),i.jsx(Wu,{onClick:()=>N(E.id),style:{fontSize:12,color:"#8c8c8c",cursor:"pointer"}})]},E.id))})]})]})})},qH={concept:"purple",evt:"blue",dvt:"cyan",pvt:"orange",mp:"green"},GH=()=>{const t=Ni(),{data:e}=ct({queryKey:["srm-prs-dashboard-stats"],queryFn:()=>wt.listPRs({page_size:200})}),{data:n}=ct({queryKey:["plm-projects-dashboard"],queryFn:()=>Ci.list({page_size:100})}),{data:s}=ct({queryKey:["srm-projects-dashboard"],queryFn:()=>wt.listProjects({page_size:100})}),o=Pn.useMemo(()=>{const h={};return(n?.items||[]).forEach(p=>{h[p.id]={name:p.name,code:p.code,phase:p.phase||""}}),h},[n]),l=Pn.useMemo(()=>{const h={};return(s?.items||[]).forEach(p=>{p.plm_project_id&&(h[p.plm_project_id]=p.id)}),h},[s]),d=Pn.useMemo(()=>{const h=e?.items||[],p={};return h.forEach(m=>{const g=m.project_id;g&&(p[g]||(p[g]=[]),(m.items||[]).forEach(v=>p[g].push(v)))}),Object.entries(p).map(([m,g])=>{const v=o[m];let C=0,b=0,_=0;return g.forEach(y=>{["ordered","shipped","received","inspecting","passed"].includes(y.status)&&C++,["received","inspecting","passed"].includes(y.status)&&b++,y.status==="passed"&&_++}),{id:m,name:v?.name||m.slice(0,8),code:v?.code||"",phase:v?.phase||"",totalItems:g.length,orderedCount:C,receivedCount:b,passedCount:_,srmProjectId:l[m]}}).sort((m,g)=>g.totalItems-m.totalItems)},[e,o,l]),u=Pn.useMemo(()=>{let h=0,p=0,m=0;d.forEach(b=>{h+=b.totalItems,m+=b.passedCount});const g=e?.items||[],v=lt();g.forEach(b=>{(b.items||[]).forEach(_=>{_.expected_date&&_.status!=="passed"&&_.status!=="failed"&&lt(_.expected_date).isBefore(v,"day")&&p++})});const C=h>0?Math.round(m/h*100):0;return{projectCount:d.length,totalItems:h,overdueItems:p,passRate:C}},[d,e]);return i.jsxs("div",{children:[i.jsx("h2",{style:{marginBottom:24},children:""}),i.jsxs(kr,{gutter:[16,16],style:{marginBottom:24},children:[i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{children:i.jsx(na,{title:"",value:u.projectCount,prefix:i.jsx(Iu,{style:{color:"#1890ff"}})})})}),i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{children:i.jsx(na,{title:"",value:u.totalItems,prefix:i.jsx(Qp,{style:{color:"#52c41a"}})})})}),i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{children:i.jsx(na,{title:"",value:u.overdueItems,valueStyle:u.overdueItems>0?{color:"#ff4d4f"}:void 0,prefix:i.jsx(PT,{style:{color:u.overdueItems>0?"#ff4d4f":"#999"}})})})}),i.jsx(ni,{xs:12,sm:6,children:i.jsx(Mt,{children:i.jsx(na,{title:"",value:u.passRate,suffix:"%",prefix:i.jsx(ra,{style:{color:"#52c41a"}})})})})]}),i.jsx(Mt,{title:"",extra:i.jsx(J,{type:"link",onClick:()=>t("/srm/projects"),children:""}),style:{marginBottom:24},children:d.length===0?i.jsx(ft,{description:""}):i.jsx(kr,{gutter:[16,16],children:d.map(h=>{const p=h.totalItems>0?Math.round(h.passedCount/h.totalItems*100):0;return i.jsx(ni,{xs:24,sm:12,lg:8,children:i.jsxs(Mt,{size:"small",hoverable:!0,onClick:()=>{t(`/srm/kanban?project=${h.srmProjectId||h.id}`)},style:{cursor:"pointer"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("strong",{style:{fontSize:14},children:h.name}),h.phase&&i.jsx(_e,{color:qH[h.phase]||"default",children:h.phase.toUpperCase()})]}),h.code&&i.jsx("div",{style:{fontSize:12,color:"#999",marginBottom:8},children:h.code}),i.jsx(Mi,{percent:p,size:"small",strokeColor:"#52c41a"}),i.jsxs(kr,{gutter:8,style:{marginTop:8},children:[i.jsx(ni,{span:6,children:i.jsx(na,{title:"",value:h.totalItems,valueStyle:{fontSize:14}})}),i.jsx(ni,{span:6,children:i.jsx(na,{title:"",value:h.orderedCount,valueStyle:{fontSize:14,color:"#1890ff"}})}),i.jsx(ni,{span:6,children:i.jsx(na,{title:"",value:h.receivedCount,valueStyle:{fontSize:14}})}),i.jsx(ni,{span:6,children:i.jsx(na,{title:"",value:h.passedCount,valueStyle:{fontSize:14,color:"#52c41a"}})})]})]})},h.id)})})}),i.jsx($H,{})]})},$H=()=>{const{data:t}=ct({queryKey:["srm-projects-for-activity"],queryFn:()=>wt.listProjects({page_size:10})}),e=(t?.items||[])[0]?.id,{data:n}=ct({queryKey:["srm-recent-activities",e],queryFn:()=>wt.listProjectActivities(e,{page_size:15}),enabled:!!e}),s=n?.items||[];return i.jsx(Mt,{title:"",children:s.length===0?i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE}):i.jsx(Il,{items:s.map(o=>({children:i.jsxs("div",{children:[i.jsxs("div",{style:{fontSize:13},children:[o.entity_code&&i.jsx(_e,{style:{fontSize:11,marginRight:6},children:o.entity_code}),o.content]}),i.jsxs("div",{style:{fontSize:12,color:"#999"},children:[o.operator_name,"  ",lt(o.created_at).format("MM-DD HH:mm")]})]})}))})})},{Search:WH}=Pe,sp=[{value:"structural",label:""},{value:"electronic",label:""},{value:"optical",label:""},{value:"packaging",label:""},{value:"other",label:""}],rp={structural:"",electronic:"",optical:"",packaging:"",other:""},op={structural:"blue",electronic:"green",optical:"purple",packaging:"orange",other:"default"},YH=[{value:"potential",label:""},{value:"qualified",label:""},{value:"preferred",label:""},{value:"strategic",label:""}],lp={potential:"default",qualified:"blue",preferred:"green",strategic:"gold"},cp={potential:"",qualified:"",preferred:"",strategic:""},KH=[{value:"pending",label:""},{value:"active",label:""},{value:"suspended",label:""},{value:"blacklisted",label:""}],Rc={pending:{text:"",status:"warning"},active:{text:"",status:"success"},suspended:{text:"",status:"error"},blacklisted:{text:"",status:"default"}},XH=()=>{const t=Tn(),e=Ln(),[n,s]=P.useState(""),[o,l]=P.useState(),[d,u]=P.useState(),[h,p]=P.useState(),[m,g]=P.useState(1),[v,C]=P.useState(20),[b,_]=P.useState(!1),[y,S]=P.useState(!1),[D,L]=P.useState(null),[N]=ee.useForm(),[T]=ee.useForm(),{data:j,isLoading:E}=ct({queryKey:["srm-suppliers",n,o,d,h,m,v],queryFn:()=>wt.listSuppliers({search:n||void 0,category:o,level:d,status:h,page:m,page_size:v})}),{data:R}=ct({queryKey:["srm-supplier",D?.id],queryFn:()=>wt.getSupplier(D.id),enabled:!!D?.id&&y}),{data:M,refetch:I}=ct({queryKey:["srm-supplier-contacts",D?.id],queryFn:()=>wt.listContacts(D.id),enabled:!!D?.id&&y}),z=Rt({mutationFn:B=>wt.createSupplier(B),onSuccess:()=>{me.success(""),_(!1),T.resetFields(),e.invalidateQueries({queryKey:["srm-suppliers"]})},onError:()=>me.error("")}),V=Rt({mutationFn:B=>wt.createContact(D.id,B),onSuccess:()=>{me.success(""),N.resetFields(),I()},onError:()=>me.error("")}),O=Rt({mutationFn:B=>wt.deleteContact(D.id,B),onSuccess:()=>{me.success(""),I()},onError:()=>me.error("")}),k=[{title:"",dataIndex:"code",key:"code",width:130,render:B=>i.jsx("span",{style:{fontFamily:"monospace"},children:B})},{title:"",dataIndex:"name",key:"name",width:200,ellipsis:!0},{title:"",dataIndex:"category",key:"category",width:110,render:B=>i.jsx(_e,{color:op[B]||"default",children:rp[B]||B})},{title:"",dataIndex:"level",key:"level",width:80,render:B=>i.jsx(_e,{color:lp[B]||"default",children:cp[B]||B})},{title:"",dataIndex:"status",key:"status",width:90,render:B=>{const W=Rc[B]||{text:B,status:"default"};return i.jsx(Ii,{status:W.status,text:W.text})}},{title:"",dataIndex:"overall_score",key:"overall_score",width:90,render:B=>B!=null?B.toFixed(1):"-"},{title:"",dataIndex:"city",key:"city",width:100,ellipsis:!0},{title:"",key:"action",width:80,render:(B,W)=>i.jsx(J,{type:"link",size:"small",onClick:()=>{L(W),S(!0)},children:""})}],F=[{title:"",dataIndex:"name",key:"name",width:100},{title:"",dataIndex:"title",key:"title",width:100},{title:"",dataIndex:"phone",key:"phone",width:130},{title:"",dataIndex:"email",key:"email",width:180},{title:"",key:"action",width:60,render:(B,W)=>i.jsx(Bn,{title:"",onConfirm:()=>O.mutate(W.id),children:i.jsx(J,{type:"link",size:"small",danger:!0,icon:i.jsx(Zn,{})})})}],A=R||D,q=j?.items||[];return t?i.jsxs("div",{style:{background:"#f5f5f5",minHeight:"100vh"},children:[i.jsx("div",{style:{padding:"12px 16px",background:"#fff",position:"sticky",top:0,zIndex:10},children:i.jsx(Pe,{placeholder:"/",prefix:i.jsx(gi,{style:{color:"#bbb"}}),value:n,onChange:B=>s(B.target.value),onPressEnter:()=>g(1),allowClear:!0,style:{borderRadius:20}})}),i.jsx("div",{className:"mobile-filter-pills",style:{padding:"8px 12px"},children:[{label:"",value:void 0},...sp].map(B=>i.jsx("div",{className:`mobile-filter-pill ${o===B.value?"active":""}`,onClick:()=>{l(B.value),g(1)},children:B.label},B.value||"all"))}),i.jsxs("div",{style:{padding:"0 12px"},children:[E?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(Ii,{status:"processing",text:"..."})}):q.map(B=>{const W=Rc[B.status]||{text:B.status,status:"default"};return i.jsxs("div",{onClick:()=>{L(B),S(!0)},style:{background:"#fff",borderRadius:10,padding:"12px 14px",marginBottom:8,boxShadow:"0 1px 3px rgba(0,0,0,0.04)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[i.jsx("span",{style:{fontWeight:600,fontSize:15,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B.name}),i.jsx(Ii,{status:W.status,text:W.text})]}),i.jsx("div",{style:{fontSize:12,fontFamily:"monospace",color:"#1677ff",marginBottom:6},children:B.code}),i.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:13,color:"#666",gap:8},children:[i.jsx(_e,{color:op[B.category],style:{margin:0,fontSize:11},children:rp[B.category]||B.category}),i.jsx(_e,{color:lp[B.level],style:{margin:0,fontSize:11},children:cp[B.level]||B.level}),B.overall_score!=null&&i.jsxs("span",{style:{marginLeft:"auto",fontWeight:500},children:[B.overall_score.toFixed(1),""]}),i.jsx(Oi,{style:{fontSize:10,color:"#ccc"}})]})]},B.id)}),q.length===0&&!E&&i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:""})]}),i.jsx("div",{onClick:()=>_(!0),style:{position:"fixed",bottom:80,right:20,width:52,height:52,borderRadius:26,background:"#1677ff",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(22,119,255,0.4)",zIndex:100,fontSize:22,cursor:"pointer"},children:i.jsx(Yt,{})}),i.jsx(Nt,{title:"",open:b,onOk:()=>T.validateFields().then(B=>z.mutate(B)),onCancel:()=>{_(!1),T.resetFields()},confirmLoading:z.isPending,width:600,children:i.jsxs(ee,{form:T,layout:"vertical",children:[i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"short_name",label:"",children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"category",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",options:sp})}),i.jsx(ee.Item,{name:"city",label:"",children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"business_scope",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})})]})}),i.jsx(ci,{title:A?.name||"",open:y,onClose:()=>{S(!1),L(null)},width:"100%",children:A&&i.jsxs(pe,{column:1,bordered:!0,size:"small",children:[i.jsx(pe.Item,{label:"",children:A.code}),i.jsx(pe.Item,{label:"",children:A.name}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:op[A.category],children:rp[A.category]})}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:lp[A.level],children:cp[A.level]})}),i.jsx(pe.Item,{label:"",children:i.jsx(Ii,{status:Rc[A.status]?.status||"default",text:Rc[A.status]?.text||A.status})}),i.jsx(pe.Item,{label:"",children:A.overall_score?.toFixed(1)||"-"}),i.jsx(pe.Item,{label:"",children:A.city||"-"}),i.jsx(pe.Item,{label:"",children:A.business_scope||"-"}),i.jsx(pe.Item,{label:"",children:A.payment_terms||"-"})]})})]}):i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:120},options:sp,value:o,onChange:B=>{l(B),g(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:100},options:YH,value:d,onChange:B=>{u(B),g(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:100},options:KH,value:h,onChange:B=>{p(B),g(1)}}),i.jsx(WH,{placeholder:"/",allowClear:!0,style:{width:200},value:n,onChange:B=>s(B.target.value),onSearch:()=>g(1)}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>e.invalidateQueries({queryKey:["srm-suppliers"]}),children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>_(!0),children:""})]}),children:i.jsx(sn,{columns:k,dataSource:j?.items||[],rowKey:"id",loading:E,scroll:{x:900},pagination:{current:m,pageSize:v,total:j?.pagination?.total||0,showSizeChanger:!0,showQuickJumper:!0,showTotal:B=>` ${B} `,onChange:(B,W)=>{g(B),C(W)}},onRow:B=>({onClick:()=>{L(B),S(!0)},style:{cursor:"pointer"}})})}),i.jsx(Nt,{title:"",open:b,onOk:()=>T.validateFields().then(B=>z.mutate(B)),onCancel:()=>{_(!1),T.resetFields()},confirmLoading:z.isPending,width:600,children:i.jsxs(ee,{form:T,layout:"vertical",children:[i.jsx(ee.Item,{name:"name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"short_name",label:"",children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"category",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",options:sp})}),i.jsxs(Be,{style:{width:"100%"},size:"middle",children:[i.jsx(ee.Item,{name:"country",label:"",style:{width:180},children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"city",label:"",style:{width:180},children:i.jsx(Pe,{placeholder:""})})]}),i.jsx(ee.Item,{name:"address",label:"",children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"business_scope",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})}),i.jsx(ee.Item,{name:"payment_terms",label:"",children:i.jsx(Pe,{placeholder:": 30"})})]})}),i.jsx(ci,{title:A?.name||"",open:y,onClose:()=>{S(!1),L(null)},width:640,children:A&&i.jsx(Ol,{items:[{key:"info",label:"",children:i.jsxs(pe,{column:2,bordered:!0,size:"small",children:[i.jsx(pe.Item,{label:"",children:A.code}),i.jsx(pe.Item,{label:"",children:A.short_name||"-"}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:op[A.category],children:rp[A.category]||A.category})}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:lp[A.level],children:cp[A.level]||A.level})}),i.jsx(pe.Item,{label:"",children:i.jsx(Ii,{status:Rc[A.status]?.status||"default",text:Rc[A.status]?.text||A.status})}),i.jsx(pe.Item,{label:"",children:A.overall_score?.toFixed(1)||"-"}),i.jsx(pe.Item,{label:"",children:A.country||"-"}),i.jsx(pe.Item,{label:"",children:A.city||"-"}),i.jsx(pe.Item,{label:"",span:2,children:A.address||"-"}),i.jsx(pe.Item,{label:"",span:2,children:A.business_scope||"-"}),i.jsx(pe.Item,{label:"",children:A.payment_terms||"-"}),i.jsx(pe.Item,{label:"",children:lt(A.created_at).format("YYYY-MM-DD")})]})},{key:"contacts",label:"",children:i.jsxs("div",{children:[i.jsxs(ee,{form:N,layout:"inline",style:{marginBottom:16},children:[i.jsx(ee.Item,{name:"name",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:"",style:{width:100}})}),i.jsx(ee.Item,{name:"title",children:i.jsx(Pe,{placeholder:"",style:{width:100}})}),i.jsx(ee.Item,{name:"phone",children:i.jsx(Pe,{placeholder:"",style:{width:130}})}),i.jsx(ee.Item,{name:"email",children:i.jsx(Pe,{placeholder:"",style:{width:160}})}),i.jsx(ee.Item,{children:i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),loading:V.isPending,onClick:()=>N.validateFields().then(B=>V.mutate(B)),children:""})})]}),i.jsx(sn,{columns:F,dataSource:M||[],rowKey:"id",size:"small",pagination:!1})]})}]})})]})},{Search:QH}=Pe,Dc={low:"",medium:"",high:"",urgent:""},dp={low:"default",medium:"blue",high:"orange",urgent:"red"},Ic={draft:"",pending:"",approved:"",rejected:"",sourcing:"",in_progress:"",completed:"",cancelled:""},up={draft:"default",pending:"processing",approved:"success",rejected:"error",sourcing:"cyan",in_progress:"processing",completed:"success",cancelled:"default"},ZH={pending:"",sourcing:"",ordered:"",received:"",inspecting:"",passed:"",failed:""},JH={pending:"default",sourcing:"cyan",ordered:"processing",received:"blue",inspecting:"orange",passed:"success",failed:"error"},e9=()=>{const t=Ln(),e=Tn(),[n,s]=P.useState(""),[o,l]=P.useState(),[d,u]=P.useState(1),[h,p]=P.useState(20),[m,g]=P.useState(!1),[v,C]=P.useState(!1),[b,_]=P.useState(!1),[y,S]=P.useState(null),[D,L]=P.useState(),[N,T]=P.useState(!1),[j,E]=P.useState(null),[R]=ee.useForm(),[M]=ee.useForm(),[I]=ee.useForm(),{data:z,isLoading:V}=ct({queryKey:["srm-prs",n,o,d,h],queryFn:()=>wt.listPRs({search:n||void 0,status:o,page:d,page_size:h})}),{data:O}=ct({queryKey:["srm-pr",y?.id],queryFn:()=>wt.getPR(y.id),enabled:!!y?.id&&b}),{data:k}=ct({queryKey:["projects"],queryFn:()=>Ci.list({page_size:100})}),{data:F}=ct({queryKey:["project-boms",D],queryFn:()=>Zt.list(D),enabled:!!D}),{data:A}=ct({queryKey:["srm-suppliers-select"],queryFn:()=>wt.listSuppliers({page_size:200})}),q=P.useMemo(()=>{const ae={};return(A?.items||[]).forEach(fe=>{ae[fe.id]=fe.name}),ae},[A]),B=Rt({mutationFn:ae=>{const fe={...ae,required_date:ae.required_date?.toISOString()};return wt.createPR(fe)},onSuccess:()=>{me.success(""),g(!1),R.resetFields(),t.invalidateQueries({queryKey:["srm-prs"]})},onError:()=>me.error("")}),W=Rt({mutationFn:ae=>wt.createPRFromBOM(ae),onSuccess:()=>{me.success("BOM"),C(!1),M.resetFields(),t.invalidateQueries({queryKey:["srm-prs"]})},onError:()=>me.error("")}),Q=Rt({mutationFn:ae=>wt.assignSupplier(y.id,j.id,ae),onSuccess:()=>{me.success(""),T(!1),I.resetFields(),E(null),t.invalidateQueries({queryKey:["srm-pr",y?.id]})},onError:()=>me.error("")}),ne=Rt({mutationFn:()=>wt.generatePOs(y.id),onSuccess:ae=>{me.success(` ${ae.length} `),t.invalidateQueries({queryKey:["srm-pr",y?.id]}),t.invalidateQueries({queryKey:["srm-prs"]}),t.invalidateQueries({queryKey:["srm-pos"]})},onError:()=>me.error("")}),de=P.useMemo(()=>(O?.items||[]).filter(fe=>fe.supplier_id),[O]),$=P.useMemo(()=>new Set(de.map(fe=>fe.supplier_id)).size,[de]),X=()=>{Nt.confirm({title:"",content:` ${$}  ${$} `,okText:"",cancelText:"",onOk:()=>ne.mutate()})},le=[{title:"PR",dataIndex:"pr_code",key:"pr_code",width:140,render:ae=>i.jsx("span",{style:{fontFamily:"monospace"},children:ae})},{title:"",dataIndex:"title",key:"title",width:200,ellipsis:!0},{title:"",dataIndex:"priority",key:"priority",width:80,render:ae=>i.jsx(_e,{color:dp[ae],children:Dc[ae]||ae})},{title:"",dataIndex:"status",key:"status",width:90,render:ae=>i.jsx(_e,{color:up[ae],children:Ic[ae]||ae})},{title:"",dataIndex:"project_id",key:"project_id",width:120,render:ae=>ae?k?.items?.find(pt=>pt.id===ae)?.name||ae.slice(0,8):"-"},{title:"",dataIndex:"phase",key:"phase",width:80,render:ae=>ae?.toUpperCase()||"-"},{title:"",dataIndex:"required_date",key:"required_date",width:110,render:ae=>ae?lt(ae).format("YYYY-MM-DD"):"-"},{title:"",key:"action",width:80,render:(ae,fe)=>i.jsx(J,{type:"link",size:"small",onClick:()=>{S(fe),_(!0)},children:""})}],oe=[{title:"",dataIndex:"material_code",key:"material_code",width:120,render:ae=>i.jsx("span",{style:{fontFamily:"monospace"},children:ae||"-"})},{title:"",dataIndex:"material_name",key:"material_name",width:140,ellipsis:!0},{title:"",dataIndex:"specification",key:"specification",width:100,ellipsis:!0},{title:"",dataIndex:"quantity",key:"quantity",width:60},{title:"",dataIndex:"status",key:"status",width:80,render:ae=>i.jsx(_e,{color:JH[ae],children:ZH[ae]||ae})},{title:"",dataIndex:"supplier_id",key:"supplier_id",width:120,render:ae=>ae?q[ae]||ae.slice(0,8):"-"},{title:"",dataIndex:"unit_price",key:"unit_price",width:80,render:ae=>ae!=null?`${ae.toFixed(2)}`:"-"},{title:"",key:"action",width:100,render:(ae,fe)=>i.jsx(J,{type:"link",size:"small",onClick:pt=>{pt.stopPropagation(),E(fe),I.setFieldsValue({supplier_id:fe.supplier_id||void 0,unit_price:fe.unit_price,expected_date:fe.expected_date?lt(fe.expected_date):void 0}),T(!0)},children:""})}],ue=O||y,Ye=z?.items||[];return e?i.jsxs("div",{style:{background:"#f5f5f5",minHeight:"100vh"},children:[i.jsx("div",{style:{padding:"12px 16px",background:"#fff",position:"sticky",top:0,zIndex:10},children:i.jsx(Pe,{placeholder:"/",prefix:i.jsx(gi,{style:{color:"#bbb"}}),value:n,onChange:ae=>s(ae.target.value),onPressEnter:()=>u(1),allowClear:!0,style:{borderRadius:20}})}),i.jsx("div",{className:"mobile-filter-pills",style:{padding:"8px 12px"},children:[{label:"",value:void 0},...Object.entries(Ic).map(([ae,fe])=>({value:ae,label:fe}))].map(ae=>i.jsx("div",{className:`mobile-filter-pill ${o===ae.value?"active":""}`,onClick:()=>{l(ae.value),u(1)},children:ae.label},ae.value||"all"))}),i.jsxs("div",{style:{padding:"0 12px"},children:[V?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{})}):Ye.map(ae=>{const fe=k?.items?.find(pt=>pt.id===ae.project_id);return i.jsxs("div",{onClick:()=>{S(ae),_(!0)},style:{background:"#fff",borderRadius:10,padding:"12px 14px",marginBottom:8,boxShadow:"0 1px 3px rgba(0,0,0,0.04)",cursor:"pointer"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[i.jsx("span",{style:{fontWeight:600,fontSize:15,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ae.title}),i.jsx(_e,{color:up[ae.status],style:{margin:0,fontSize:11},children:Ic[ae.status]||ae.status})]}),i.jsx("div",{style:{fontSize:12,fontFamily:"monospace",color:"#1677ff",marginBottom:6},children:ae.pr_code}),i.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:13,color:"#666",gap:8,flexWrap:"wrap"},children:[i.jsx(_e,{color:dp[ae.priority],style:{margin:0,fontSize:11},children:Dc[ae.priority]||ae.priority}),fe&&i.jsx("span",{style:{fontSize:12},children:fe.name}),ae.required_date&&i.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#999"},children:lt(ae.required_date).format("YYYY-MM-DD")}),i.jsx(Oi,{style:{fontSize:10,color:"#ccc"}})]})]},ae.id)}),Ye.length===0&&!V&&i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:""})]}),i.jsx("div",{onClick:()=>g(!0),style:{position:"fixed",bottom:80,right:20,width:52,height:52,borderRadius:26,background:"#1677ff",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(22,119,255,0.4)",zIndex:100,fontSize:22,cursor:"pointer"},children:i.jsx(Yt,{})}),i.jsx(Nt,{title:"",open:m,onOk:()=>R.validateFields().then(ae=>B.mutate(ae)),onCancel:()=>{g(!1),R.resetFields()},confirmLoading:B.isPending,width:520,children:i.jsxs(ee,{form:R,layout:"vertical",initialValues:{priority:"medium"},children:[i.jsx(ee.Item,{name:"title",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"priority",label:"",children:i.jsx(Xe,{style:{width:140},options:Object.entries(Dc).map(([ae,fe])=>({value:ae,label:fe}))})}),i.jsx(ee.Item,{name:"project_id",label:"",children:i.jsx(Xe,{placeholder:"",allowClear:!0,showSearch:!0,optionFilterProp:"label",options:(k?.items||[]).map(ae=>({value:ae.id,label:ae.name}))})}),i.jsx(ee.Item,{name:"required_date",label:"",children:i.jsx(qa,{style:{width:"100%"}})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})})]})}),i.jsx(Nt,{title:"BOM",open:v,onOk:()=>M.validateFields().then(ae=>W.mutate(ae)),onCancel:()=>{C(!1),M.resetFields(),L(void 0)},confirmLoading:W.isPending,width:480,children:i.jsxs(ee,{form:M,layout:"vertical",children:[i.jsx(ee.Item,{name:"project_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:(k?.items||[]).map(ae=>({value:ae.id,label:ae.name})),onChange:ae=>{L(ae),M.setFieldValue("bom_id",void 0)}})}),i.jsx(ee.Item,{name:"bom_id",label:"BOM",rules:[{required:!0,message:"BOM"}],children:i.jsx(Xe,{placeholder:D?"BOM":"",disabled:!D,options:(F||[]).map(ae=>({value:ae.id,label:`${ae.name||"BOM"} - v${ae.version||"1"}`}))})})]})}),i.jsx(Nt,{title:` - ${j?.material_name||""}`,open:N,onOk:()=>I.validateFields().then(ae=>{const fe={...ae,expected_date:ae.expected_date?.toISOString()};Q.mutate(fe)}),onCancel:()=>{T(!1),I.resetFields(),E(null)},confirmLoading:Q.isPending,width:480,children:i.jsxs(ee,{form:I,layout:"vertical",children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:(A?.items||[]).map(ae=>({value:ae.id,label:`${ae.name} (${ae.code})`}))})}),i.jsx(ee.Item,{name:"unit_price",label:"",children:i.jsx(en,{placeholder:"",min:0,precision:4,style:{width:"100%"},addonBefore:""})}),i.jsx(ee.Item,{name:"expected_date",label:"",children:i.jsx(qa,{style:{width:"100%"}})})]})}),i.jsx(ci,{title:i.jsxs(Be,{children:[i.jsx("span",{children:ue?.pr_code||""}),ue&&de.length>0&&i.jsx(J,{type:"primary",icon:i.jsx(zo,{}),size:"small",loading:ne.isPending,onClick:X,children:""})]}),open:b,onClose:()=>{_(!1),S(null)},width:"100%",children:ue&&i.jsxs(i.Fragment,{children:[i.jsxs(pe,{column:1,bordered:!0,size:"small",style:{marginBottom:24},children:[i.jsx(pe.Item,{label:"PR",children:ue.pr_code}),i.jsx(pe.Item,{label:"",children:ue.title}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:dp[ue.priority],children:Dc[ue.priority]||ue.priority})}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:up[ue.status],children:Ic[ue.status]||ue.status})}),i.jsx(pe.Item,{label:"",children:ue.phase?.toUpperCase()||"-"}),i.jsx(pe.Item,{label:"",children:ue.required_date?lt(ue.required_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",children:lt(ue.created_at).format("YYYY-MM-DD")}),i.jsx(pe.Item,{label:"",children:ue.notes||"-"})]}),i.jsx("h4",{children:""}),i.jsx(sn,{columns:oe,dataSource:O?.items||[],rowKey:"id",size:"small",scroll:{x:800},pagination:!1})]})})]}):i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:110},options:Object.entries(Ic).map(([ae,fe])=>({value:ae,label:fe})),value:o,onChange:ae=>{l(ae),u(1)}}),i.jsx(QH,{placeholder:"",allowClear:!0,style:{width:180},value:n,onChange:ae=>s(ae.target.value),onSearch:()=>u(1)}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>t.invalidateQueries({queryKey:["srm-prs"]}),children:""}),i.jsx(J,{icon:i.jsx(m3,{}),onClick:()=>C(!0),children:"BOM"}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>g(!0),children:""})]}),children:i.jsx(sn,{columns:le,dataSource:z?.items||[],rowKey:"id",loading:V,scroll:{x:1e3},pagination:{current:d,pageSize:h,total:z?.pagination?.total||0,showSizeChanger:!0,showQuickJumper:!0,showTotal:ae=>` ${ae} `,onChange:(ae,fe)=>{u(ae),p(fe)}},onRow:ae=>({onClick:()=>{S(ae),_(!0)},style:{cursor:"pointer"}})})}),i.jsx(Nt,{title:"",open:m,onOk:()=>R.validateFields().then(ae=>B.mutate(ae)),onCancel:()=>{g(!1),R.resetFields()},confirmLoading:B.isPending,width:520,children:i.jsxs(ee,{form:R,layout:"vertical",initialValues:{priority:"medium"},children:[i.jsx(ee.Item,{name:"title",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"priority",label:"",children:i.jsx(Xe,{style:{width:140},options:Object.entries(Dc).map(([ae,fe])=>({value:ae,label:fe}))})}),i.jsx(ee.Item,{name:"project_id",label:"",children:i.jsx(Xe,{placeholder:"",allowClear:!0,showSearch:!0,optionFilterProp:"label",options:(k?.items||[]).map(ae=>({value:ae.id,label:ae.name}))})}),i.jsx(ee.Item,{name:"required_date",label:"",children:i.jsx(qa,{style:{width:"100%"}})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})})]})}),i.jsx(Nt,{title:"BOM",open:v,onOk:()=>M.validateFields().then(ae=>W.mutate(ae)),onCancel:()=>{C(!1),M.resetFields(),L(void 0)},confirmLoading:W.isPending,width:480,children:i.jsxs(ee,{form:M,layout:"vertical",children:[i.jsx(ee.Item,{name:"project_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:(k?.items||[]).map(ae=>({value:ae.id,label:ae.name})),onChange:ae=>{L(ae),M.setFieldValue("bom_id",void 0)}})}),i.jsx(ee.Item,{name:"bom_id",label:"BOM",rules:[{required:!0,message:"BOM"}],children:i.jsx(Xe,{placeholder:D?"BOM":"",disabled:!D,options:(F||[]).map(ae=>({value:ae.id,label:`${ae.name||"BOM"} - v${ae.version||"1"}`}))})})]})}),i.jsx(Nt,{title:` - ${j?.material_name||""}`,open:N,onOk:()=>I.validateFields().then(ae=>{const fe={...ae,expected_date:ae.expected_date?.toISOString()};Q.mutate(fe)}),onCancel:()=>{T(!1),I.resetFields(),E(null)},confirmLoading:Q.isPending,width:480,children:i.jsxs(ee,{form:I,layout:"vertical",children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:(A?.items||[]).map(ae=>({value:ae.id,label:`${ae.name} (${ae.code})`}))})}),i.jsx(ee.Item,{name:"unit_price",label:"",children:i.jsx(en,{placeholder:"",min:0,precision:4,style:{width:"100%"},addonBefore:""})}),i.jsx(ee.Item,{name:"expected_date",label:"",children:i.jsx(qa,{style:{width:"100%"}})})]})}),i.jsx(ci,{title:i.jsxs(Be,{children:[i.jsx("span",{children:ue?.pr_code||""}),ue&&de.length>0&&i.jsx(J,{type:"primary",icon:i.jsx(zo,{}),size:"small",loading:ne.isPending,onClick:X,children:""})]}),open:b,onClose:()=>{_(!1),S(null)},width:820,children:ue&&i.jsxs(i.Fragment,{children:[i.jsxs(pe,{column:2,bordered:!0,size:"small",style:{marginBottom:24},children:[i.jsx(pe.Item,{label:"PR",children:ue.pr_code}),i.jsx(pe.Item,{label:"",children:ue.title}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:dp[ue.priority],children:Dc[ue.priority]||ue.priority})}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:up[ue.status],children:Ic[ue.status]||ue.status})}),i.jsx(pe.Item,{label:"",children:ue.phase?.toUpperCase()||"-"}),i.jsx(pe.Item,{label:"",children:ue.required_date?lt(ue.required_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",children:lt(ue.created_at).format("YYYY-MM-DD")}),i.jsx(pe.Item,{label:"",span:2,children:ue.notes||"-"})]}),i.jsx("h4",{children:""}),i.jsx(sn,{columns:oe,dataSource:O?.items||[],rowKey:"id",size:"small",scroll:{x:800},pagination:!1})]})})]})},{Search:t9}=Pe,Ry={sample:"",production:""},Dy={sample:"blue",production:"green"},vu={draft:"",submitted:"",pending:"",approved:"",rejected:"",in_progress:"",sent:"",shipped:"",partial:"",received:"",completed:"",cancelled:""},fp={draft:"default",submitted:"processing",pending:"processing",approved:"success",rejected:"error",in_progress:"processing",sent:"blue",shipped:"cyan",partial:"orange",received:"blue",completed:"success",cancelled:"default"},n9=()=>{const t=Ln(),e=Tn(),[n,s]=P.useState(""),[o,l]=P.useState(),[d,u]=P.useState(),[h,p]=P.useState(1),[m,g]=P.useState(20),[v,C]=P.useState(!1),[b,_]=P.useState(!1),[y,S]=P.useState(null),[D,L]=P.useState(0),[N]=ee.useForm(),{data:T,isLoading:j}=ct({queryKey:["srm-pos",n,o,d,h,m],queryFn:()=>wt.listPOs({search:n||void 0,type:o,status:d,page:h,page_size:m})}),{data:E}=ct({queryKey:["srm-po",y?.id],queryFn:()=>wt.getPO(y.id),enabled:!!y?.id&&b}),{data:R}=ct({queryKey:["srm-suppliers-select"],queryFn:()=>wt.listSuppliers({page_size:100})}),M=Rt({mutationFn:B=>{const W={...B,expected_date:B.expected_date?.toISOString()};return wt.createPO(W)},onSuccess:()=>{me.success(""),C(!1),N.resetFields(),t.invalidateQueries({queryKey:["srm-pos"]})},onError:()=>me.error("")}),I=Rt({mutationFn:({itemId:B,qty:W})=>wt.receivePOItem(y.id,B,W),onSuccess:()=>{me.success(""),t.invalidateQueries({queryKey:["srm-po",y?.id]}),t.invalidateQueries({queryKey:["srm-pos"]})},onError:()=>me.error("")}),z=Rt({mutationFn:B=>wt.submitPO(B),onSuccess:()=>{me.success(""),t.invalidateQueries({queryKey:["srm-pos"]}),t.invalidateQueries({queryKey:["srm-po",y?.id]})},onError:()=>me.error("")}),V=Rt({mutationFn:B=>wt.deletePO(B),onSuccess:()=>{me.success(""),_(!1),S(null),t.invalidateQueries({queryKey:["srm-pos"]})},onError:()=>me.error("")}),O=[{title:"PO",dataIndex:"po_code",key:"po_code",width:140,render:B=>i.jsx("span",{style:{fontFamily:"monospace"},children:B})},{title:"",dataIndex:"supplier",key:"supplier",width:160,ellipsis:!0,render:B=>B?.name||"-"},{title:"",dataIndex:"type",key:"type",width:80,render:B=>i.jsx(_e,{color:Dy[B],children:Ry[B]||B})},{title:"",dataIndex:"status",key:"status",width:90,render:B=>i.jsx(_e,{color:fp[B],children:vu[B]||B})},{title:"",dataIndex:"total_amount",key:"total_amount",width:110,render:B=>B!=null?`${B.toFixed(2)}`:"-"},{title:"",dataIndex:"expected_date",key:"expected_date",width:110,render:B=>B?lt(B).format("YYYY-MM-DD"):"-"},{title:"",key:"action",width:80,render:(B,W)=>i.jsx(J,{type:"link",size:"small",onClick:()=>{S(W),_(!0)},children:""})}],k=[{title:"",dataIndex:"material_code",key:"material_code",width:120,render:B=>i.jsx("span",{style:{fontFamily:"monospace"},children:B||"-"})},{title:"",dataIndex:"material_name",key:"material_name",width:150,ellipsis:!0},{title:"",dataIndex:"specification",key:"specification",width:120,ellipsis:!0},{title:"",dataIndex:"quantity",key:"quantity",width:70},{title:"",dataIndex:"unit_price",key:"unit_price",width:90,render:B=>B!=null?`${B.toFixed(2)}`:"-"},{title:"",dataIndex:"received_qty",key:"received_qty",width:70,render:B=>B||0},{title:"",dataIndex:"status",key:"status",width:80,render:B=>i.jsx(_e,{color:fp[B]||"default",children:B})},{title:"",key:"receive",width:140,render:(B,W)=>{const Q=W.quantity-(W.received_qty||0);return Q<=0?i.jsx(_e,{color:"success",children:""}):i.jsx(Bn,{title:"",description:i.jsx(en,{min:.01,max:Q,defaultValue:Q,style:{width:"100%"},onChange:ne=>L(ne||0),addonAfter:W.unit}),onConfirm:()=>I.mutate({itemId:W.id,qty:D||Q}),children:i.jsxs(J,{type:"link",size:"small",children:[" (",Q,")"]})})}}],F=E||y,A=T?.items||[],q=i.jsxs(i.Fragment,{children:[i.jsx(Nt,{title:"",open:v,onOk:()=>N.validateFields().then(B=>M.mutate(B)),onCancel:()=>{C(!1),N.resetFields()},confirmLoading:M.isPending,width:680,children:i.jsxs(ee,{form:N,layout:"vertical",initialValues:{type:"sample",items:[{}]},children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:(R?.items||[]).map(B=>({value:B.id,label:`${B.name} (${B.code})`}))})}),i.jsxs(Be,{style:{width:"100%"},size:"middle",children:[i.jsx(ee.Item,{name:"type",label:"",rules:[{required:!0}],children:i.jsx(Xe,{style:{width:140},options:[{value:"sample",label:""},{value:"production",label:""}]})}),i.jsx(ee.Item,{name:"expected_date",label:"",children:i.jsx(qa,{})})]}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2})}),i.jsx("h4",{children:""}),i.jsx(ee.List,{name:"items",children:(B,{add:W,remove:Q})=>i.jsxs(i.Fragment,{children:[B.map(({key:ne,name:de,...$})=>i.jsxs(Be,{align:"baseline",style:{display:"flex",marginBottom:8},children:[i.jsx(ee.Item,{...$,name:[de,"material_name"],rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:"",style:{width:140}})}),i.jsx(ee.Item,{...$,name:[de,"specification"],children:i.jsx(Pe,{placeholder:"",style:{width:120}})}),i.jsx(ee.Item,{...$,name:[de,"quantity"],rules:[{required:!0,message:""}],children:i.jsx(en,{placeholder:"",min:.01,style:{width:90}})}),i.jsx(ee.Item,{...$,name:[de,"unit_price"],children:i.jsx(en,{placeholder:"",min:0,precision:2,style:{width:100}})}),B.length>1&&i.jsx(g3,{onClick:()=>Q(de),style:{color:"#ff4d4f"}})]},ne)),i.jsx(J,{type:"dashed",onClick:()=>W(),block:!0,icon:i.jsx(Yt,{}),children:""})]})})]})}),i.jsx(ci,{title:F?.po_code||"",open:b,onClose:()=>{_(!1),S(null)},width:e?"100%":760,children:F&&i.jsxs(i.Fragment,{children:[F.status==="draft"&&i.jsxs(Be,{style:{marginBottom:16},children:[i.jsx(Bn,{title:"",onConfirm:()=>z.mutate(F.id),children:i.jsx(J,{type:"primary",loading:z.isPending,children:""})}),i.jsx(Bn,{title:"",onConfirm:()=>V.mutate(F.id),children:i.jsx(J,{danger:!0,loading:V.isPending,children:""})})]}),F.status==="submitted"&&i.jsx(Be,{style:{marginBottom:16},children:i.jsx(J,{type:"primary",onClick:()=>wt.approvePO(F.id).then(()=>{me.success(""),t.invalidateQueries({queryKey:["srm-pos"]}),t.invalidateQueries({queryKey:["srm-po",F.id]})}).catch(()=>me.error("")),children:""})}),i.jsxs(pe,{column:e?1:2,bordered:!0,size:"small",style:{marginBottom:24},children:[i.jsx(pe.Item,{label:"PO",children:F.po_code}),i.jsx(pe.Item,{label:"",children:F.supplier?.name||"-"}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:Dy[F.type],children:Ry[F.type]||F.type})}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:fp[F.status],children:vu[F.status]||F.status})}),i.jsx(pe.Item,{label:"",children:F.total_amount!=null?`${F.total_amount.toFixed(2)}`:"-"}),i.jsx(pe.Item,{label:"",children:F.expected_date?lt(F.expected_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",children:F.payment_terms||"-"}),i.jsx(pe.Item,{label:"",children:lt(F.created_at).format("YYYY-MM-DD")}),i.jsx(pe.Item,{label:"",span:e?1:2,children:F.notes||"-"})]}),i.jsx("h4",{children:""}),i.jsx(sn,{columns:k,dataSource:E?.items||[],rowKey:"id",size:"small",scroll:{x:800},pagination:!1})]})})]});return e?i.jsxs("div",{style:{background:"#f5f5f5",minHeight:"100vh"},children:[i.jsx("div",{style:{padding:"12px 16px",background:"#fff",position:"sticky",top:0,zIndex:10},children:i.jsx(Pe,{placeholder:"PO/",prefix:i.jsx(gi,{style:{color:"#bbb"}}),value:n,onChange:B=>s(B.target.value),onPressEnter:()=>p(1),allowClear:!0,style:{borderRadius:20}})}),i.jsx("div",{className:"mobile-filter-pills",style:{padding:"8px 12px"},children:[{label:"",value:void 0},...Object.entries(vu).map(([B,W])=>({label:W,value:B}))].map(B=>i.jsx("div",{className:`mobile-filter-pill ${d===B.value?"active":""}`,onClick:()=>{u(B.value),p(1)},children:B.label},B.value||"all"))}),i.jsxs("div",{style:{padding:"0 12px"},children:[j?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{tip:"..."})}):A.map(B=>i.jsxs("div",{onClick:()=>{S(B),_(!0)},style:{background:"#fff",borderRadius:10,padding:"12px 14px",marginBottom:8,boxShadow:"0 1px 3px rgba(0,0,0,0.04)",cursor:"pointer"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[i.jsx("span",{style:{fontFamily:"monospace",color:"#1677ff",fontSize:14,flex:1},children:B.po_code}),i.jsx(_e,{color:fp[B.status],style:{margin:0},children:vu[B.status]||B.status})]}),i.jsx("div",{style:{fontWeight:600,fontSize:15,marginBottom:6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B.supplier?.name||"-"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:13,color:"#666",gap:8},children:[i.jsx(_e,{color:Dy[B.type],style:{margin:0,fontSize:11},children:Ry[B.type]||B.type}),B.expected_date&&i.jsx("span",{children:lt(B.expected_date).format("YYYY-MM-DD")}),i.jsx("span",{style:{marginLeft:"auto",fontWeight:700,color:"#cf1322",fontSize:14},children:B.total_amount!=null?`${B.total_amount.toFixed(2)}`:""}),i.jsx(Oi,{style:{fontSize:10,color:"#ccc"}})]})]},B.id)),A.length===0&&!j&&i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:""})]}),i.jsx("div",{onClick:()=>C(!0),style:{position:"fixed",bottom:80,right:20,width:52,height:52,borderRadius:26,background:"#1677ff",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(22,119,255,0.4)",zIndex:100,fontSize:22,cursor:"pointer"},children:i.jsx(Yt,{})}),q]}):i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:100},options:[{value:"sample",label:""},{value:"production",label:""}],value:o,onChange:B=>{l(B),p(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:110},options:Object.entries(vu).map(([B,W])=>({value:B,label:W})),value:d,onChange:B=>{u(B),p(1)}}),i.jsx(t9,{placeholder:"",allowClear:!0,style:{width:180},value:n,onChange:B=>s(B.target.value),onSearch:()=>p(1)}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>t.invalidateQueries({queryKey:["srm-pos"]}),children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>C(!0),children:""})]}),children:i.jsx(sn,{columns:O,dataSource:A,rowKey:"id",loading:j,scroll:{x:800},pagination:{current:h,pageSize:m,total:T?.pagination?.total||0,showSizeChanger:!0,showQuickJumper:!0,showTotal:B=>` ${B} `,onChange:(B,W)=>{p(B),g(W)}},onRow:B=>({onClick:()=>{S(B),_(!0)},style:{cursor:"pointer"}})})}),q]})},{Search:i9}=Pe,_u={pending:"",inspecting:"",in_progress:"",completed:""},Iy={pending:"default",inspecting:"processing",in_progress:"processing",completed:"success"},hp={passed:"",failed:"",conditional:"","":""},pp={passed:"green",failed:"red",conditional:"orange"},a9=()=>{const t=Ln(),e=Tn(),[n,s]=P.useState(""),[o,l]=P.useState(),[d,u]=P.useState(),[h,p]=P.useState(1),[m,g]=P.useState(20),[v,C]=P.useState(!1),[b,_]=P.useState(null),[y]=ee.useForm(),[S,D]=P.useState({}),{data:L,isLoading:N}=ct({queryKey:["srm-inspections",n,o,d,h,m],queryFn:()=>wt.listInspections({status:o,result:d,page:h,page_size:m})}),{data:T}=ct({queryKey:["srm-inspection",b?.id],queryFn:()=>wt.getInspection(b.id),enabled:!!b?.id&&v}),j=Rt({mutationFn:F=>wt.completeInspection(b.id,F),onSuccess:()=>{me.success(""),y.resetFields(),D({}),t.invalidateQueries({queryKey:["srm-inspections"]}),t.invalidateQueries({queryKey:["srm-inspection",b?.id]})},onError:()=>me.error("")}),E=[{title:"",dataIndex:"inspection_code",key:"inspection_code",width:140,render:F=>i.jsx("span",{style:{fontFamily:"monospace"},children:F})},{title:"PO",key:"po_code",width:130,render:(F,A)=>{const q=A.po?.po_code;return q?i.jsx("span",{style:{fontFamily:"monospace"},children:q}):"-"}},{title:"",dataIndex:"material_name",key:"material_name",width:160,ellipsis:!0},{title:"",key:"supplier_name",width:120,render:(F,A)=>A.supplier?.name||A.supplier?.short_name||"-"},{title:"",dataIndex:"quantity",key:"quantity",width:80,render:F=>F??"-"},{title:"",dataIndex:"status",key:"status",width:90,render:F=>i.jsx(_e,{color:Iy[F],children:_u[F]||F})},{title:"",key:"result",width:90,render:(F,A)=>{const q=A.overall_result||A.result;return q?i.jsx(_e,{color:pp[q],children:hp[q]||q}):i.jsx(_e,{children:""})}},{title:"",key:"inspector",width:100,render:(F,A)=>A.inspector||"-"},{title:"",key:"action",width:80,render:(F,A)=>i.jsx(J,{type:"link",size:"small",onClick:()=>{_(A),C(!0)},children:""})}],R=T||b,M=R?.status!=="completed",I=L?.items||[],z=T?.items||[],V=F=>{const A=z.map(q=>({id:q.id,inspected_quantity:S[q.id]?.inspected_quantity??q.inspected_quantity,qualified_quantity:S[q.id]?.qualified_quantity??q.qualified_quantity,defect_quantity:S[q.id]?.defect_quantity??q.defect_quantity,defect_description:S[q.id]?.defect_description??q.defect_description??"",result:S[q.id]?.result??q.result??F.result}));j.mutate({result:F.result,notes:F.notes,items:A.length>0?A:void 0})},O=[{title:"",dataIndex:"material_name",key:"material_name",width:120,ellipsis:!0},{title:"",dataIndex:"material_code",key:"material_code",width:90},{title:"",dataIndex:"inspected_quantity",key:"inspected_quantity",width:90,render:(F,A)=>M?i.jsx(en,{size:"small",min:0,defaultValue:F,style:{width:70},onChange:q=>D(B=>({...B,[A.id]:{...B[A.id],inspected_quantity:q||0}}))}):F},{title:"",dataIndex:"qualified_quantity",key:"qualified_quantity",width:90,render:(F,A)=>M?i.jsx(en,{size:"small",min:0,defaultValue:F,style:{width:70},onChange:q=>D(B=>({...B,[A.id]:{...B[A.id],qualified_quantity:q||0}}))}):F},{title:"",dataIndex:"defect_quantity",key:"defect_quantity",width:90,render:(F,A)=>M?i.jsx(en,{size:"small",min:0,defaultValue:F,style:{width:70},onChange:q=>D(B=>({...B,[A.id]:{...B[A.id],defect_quantity:q||0}}))}):i.jsx("span",{style:{color:F>0?"#cf1322":void 0},children:F})},{title:"",key:"result",width:90,render:(F,A)=>{if(M)return i.jsx(Xe,{size:"small",defaultValue:A.result||void 0,placeholder:"",style:{width:80},onChange:B=>D(W=>({...W,[A.id]:{...W[A.id],result:B}})),options:[{value:"passed",label:""},{value:"failed",label:""},{value:"conditional",label:""}]});const q=A.result;return q?i.jsx(_e,{color:pp[q],children:hp[q]||q}):"-"}}],k=i.jsx(ci,{title:R?.inspection_code||"",open:v,onClose:()=>{C(!1),_(null),y.resetFields(),D({})},width:e?"100%":760,children:R&&i.jsxs(i.Fragment,{children:[i.jsxs(pe,{column:e?1:2,bordered:!0,size:"small",style:{marginBottom:16},children:[i.jsx(pe.Item,{label:"",children:R.inspection_code}),i.jsx(pe.Item,{label:"PO",children:R.po?.po_code||"-"}),i.jsx(pe.Item,{label:"",children:R.supplier?.name||"-"}),i.jsx(pe.Item,{label:"",children:R.quantity??"-"}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:Iy[R.status],children:_u[R.status]||R.status})}),i.jsx(pe.Item,{label:"",children:R.overall_result||R.result?i.jsx(_e,{color:pp[R.overall_result||R.result],children:hp[R.overall_result||R.result]||R.overall_result||R.result}):""}),i.jsx(pe.Item,{label:"",children:R.inspector||"-"}),i.jsx(pe.Item,{label:"",children:R.inspection_date?lt(R.inspection_date).format("YYYY-MM-DD HH:mm"):R.inspected_at?lt(R.inspected_at).format("YYYY-MM-DD HH:mm"):"-"}),i.jsx(pe.Item,{label:"",span:e?1:2,children:R.notes||"-"})]}),z.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("h4",{style:{marginBottom:8},children:[" (",z.length,")"]}),i.jsx(sn,{columns:O,dataSource:z,rowKey:"id",size:"small",scroll:{x:600},pagination:!1,style:{marginBottom:16}})]}),M&&i.jsxs(i.Fragment,{children:[i.jsx("h4",{children:""}),i.jsxs(ee,{form:y,layout:"vertical",onFinish:V,children:[i.jsx(ee.Item,{name:"result",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",options:[{value:"passed",label:""},{value:"failed",label:""},{value:"conditional",label:""}]})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})}),i.jsx(J,{type:"primary",htmlType:"submit",icon:i.jsx(ra,{}),loading:j.isPending,children:""})]})]})]})});if(e){const F=[{label:"",value:void 0},...Object.entries(_u).filter(([A])=>A!=="in_progress").map(([A,q])=>({label:q,value:A}))];return i.jsxs("div",{style:{background:"#f5f5f5",minHeight:"100vh"},children:[i.jsx("div",{style:{padding:"12px 16px",background:"#fff",position:"sticky",top:0,zIndex:10},children:i.jsx(Pe,{placeholder:"/",prefix:i.jsx(gi,{style:{color:"#bbb"}}),value:n,onChange:A=>s(A.target.value),onPressEnter:()=>p(1),allowClear:!0,style:{borderRadius:20}})}),i.jsx("div",{className:"mobile-filter-pills",style:{padding:"8px 12px"},children:F.map(A=>i.jsx("div",{className:`mobile-filter-pill ${o===A.value?"active":""}`,onClick:()=>{l(A.value),p(1)},children:A.label},A.value||"all"))}),i.jsx("div",{style:{padding:"0 12px"},children:N?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{tip:"..."})}):I.length===0?i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:""}):I.map(A=>i.jsxs("div",{onClick:()=>{_(A),C(!0)},style:{background:"#fff",borderRadius:10,padding:"12px 14px",marginBottom:8,boxShadow:"0 1px 3px rgba(0,0,0,0.04)",cursor:"pointer"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[i.jsx("span",{style:{fontFamily:"monospace",color:"#1677ff",fontSize:13,flex:1},children:A.inspection_code}),i.jsx(_e,{color:Iy[A.status],style:{margin:0},children:_u[A.status]||A.status})]}),i.jsx("div",{style:{fontWeight:600,fontSize:15,marginBottom:6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:A.material_name||"-"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:13,color:"#666",gap:8,flexWrap:"wrap"},children:[A.po?.po_code&&i.jsxs("span",{style:{fontFamily:"monospace",fontSize:12},children:["PO: ",A.po.po_code]}),A.supplier?.name&&i.jsx("span",{children:A.supplier.name}),A.quantity!=null&&i.jsxs("span",{children:["x",A.quantity]}),A.overall_result||A.result?i.jsx(_e,{color:pp[A.overall_result||A.result],style:{margin:0,fontSize:11},children:hp[A.overall_result||A.result]}):null,i.jsx(Oi,{style:{fontSize:10,color:"#ccc",marginLeft:"auto"}})]})]},A.id))}),k]})}return i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:110},options:Object.entries(_u).filter(([F])=>F!=="in_progress").map(([F,A])=>({value:F,label:A})),value:o,onChange:F=>{l(F),p(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:110},options:[{value:"passed",label:""},{value:"failed",label:""},{value:"conditional",label:""}],value:d,onChange:F=>{u(F),p(1)}}),i.jsx(i9,{placeholder:"",allowClear:!0,style:{width:180},value:n,onChange:F=>s(F.target.value),onSearch:()=>p(1)}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>t.invalidateQueries({queryKey:["srm-inspections"]}),children:""})]}),children:i.jsx(sn,{columns:E,dataSource:I,rowKey:"id",loading:N,scroll:{x:1050},pagination:{current:h,pageSize:m,total:L?.pagination?.total||0,showSizeChanger:!0,showQuickJumper:!0,showTotal:F=>` ${F} `,onChange:(F,A)=>{p(F),g(A)}},onRow:F=>({onClick:()=>{_(F),C(!0)},style:{cursor:"pointer"}})})}),k]})},{Search:s9}=Pe,eT={sample:"",production:""},r9={sample:"blue",production:"green"},o9={concept:"Concept",evt:"EVT",dvt:"DVT",pvt:"PVT",mp:"MP"},l9={concept:"purple",evt:"blue",dvt:"cyan",pvt:"orange",mp:"green"},tT={active:"",completed:"",cancelled:""},c9={active:"processing",completed:"success",cancelled:"default"};function d9(t){if(t.groups)return t.groups;const e=t.total_items||0,n=t.passed_count||0,s=e>0?Math.round(n/e*100):0,o=Math.min(100,s+Math.floor(Math.random()*10)),l=Math.min(100,Math.max(0,s-5+Math.floor(Math.random()*15))),d=Math.max(1,Math.floor(e*.5)),u=Math.max(1,Math.floor(e*.2)),h=Math.max(1,Math.floor(e*.2)),p=Math.max(1,e-d-u-h);return{electronic:{total:d,passed:Math.floor(d*o/100),percent:o},structural:{total:u,passed:Math.floor(u*l/100),percent:l},assembly:{total:h,passed:Math.floor(h*s/100),percent:s},tooling:{total:p,passed:Math.floor(p*Math.max(0,s-10)/100),percent:Math.max(0,s-10)}}}const u9=[{key:"electronic",label:"",color:"#1890ff"},{key:"structural",label:"",color:"#52c41a"},{key:"assembly",label:"",color:"#722ed1"},{key:"tooling",label:"",color:"#faad14"}],f9=()=>{const t=Ni(),e=Ln(),[n,s]=P.useState(""),[o,l]=P.useState(),[d,u]=P.useState(),[h,p]=P.useState(1),[m]=P.useState(20),{data:g,isLoading:v}=ct({queryKey:["srm-projects",n,o,d,h,m],queryFn:()=>wt.listProjects({search:n||void 0,status:o,type:d,page:h,page_size:m})}),C=g?.items||[];return i.jsx("div",{children:i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:100},options:Object.entries(eT).map(([b,_])=>({value:b,label:_})),value:d,onChange:b=>{u(b),p(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:110},options:Object.entries(tT).map(([b,_])=>({value:b,label:_})),value:o,onChange:b=>{l(b),p(1)}}),i.jsx(s9,{placeholder:"",allowClear:!0,style:{width:180},value:n,onChange:b=>s(b.target.value),onSearch:()=>p(1)}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>e.invalidateQueries({queryKey:["srm-projects"]}),children:""})]}),children:v?i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(tn,{size:"large"})}):C.length===0?i.jsx(ft,{description:""}):i.jsx(kr,{gutter:[16,16],children:C.map(b=>{const _=d9(b),y=b.overdue_count||0;return i.jsx(ni,{xs:24,sm:12,lg:8,xl:6,children:i.jsxs(Mt,{hoverable:!0,onClick:()=>t(`/srm/projects/${b.id}`),style:{height:"100%"},styles:{body:{padding:16}},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[i.jsx("h3",{style:{margin:0,fontSize:16},children:b.name}),i.jsxs(Be,{size:4,children:[b.phase&&i.jsx(_e,{color:l9[b.phase],children:o9[b.phase]||b.phase.toUpperCase()}),i.jsx(_e,{color:c9[b.status],children:tT[b.status]||b.status})]})]}),b.type&&i.jsx(_e,{color:r9[b.type],style:{marginBottom:12},children:eT[b.type]||b.type}),u9.map(S=>{const D=_[S.key]||{total:0,passed:0,percent:0};return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[i.jsx("span",{style:{width:42,fontSize:12,color:"#666",flexShrink:0},children:S.label}),i.jsx(Mi,{percent:D.percent,size:"small",strokeColor:S.color,style:{flex:1,margin:0},showInfo:!1}),i.jsxs("span",{style:{fontSize:12,color:"#999",flexShrink:0,width:40,textAlign:"right"},children:[D.passed,"/",D.total]})]},S.key)}),y>0&&i.jsx("div",{style:{marginTop:8},children:i.jsxs(_e,{color:"red",children:["",y,""]})})]})},b.id)})})})})},Oy=[{key:"pending",label:"",color:"#d9d9d9"},{key:"quoting",label:"",color:"#faad14"},{key:"sourcing",label:"",color:"#13c2c2"},{key:"ordered",label:"",color:"#1890ff"},{key:"shipped",label:"",color:"#722ed1"},{key:"received",label:"",color:"#2f54eb"},{key:"inspecting",label:"",color:"#fa8c16"},{key:"passed",label:"",color:"#52c41a"}],h9=new Set(["","","","","","","electronic"]),c2=t=>h9.has(t),Kp={IC:0,_passive_:1,:2,structural:2,:3,:4},nT=t=>c2(t)?Kp._passive_:Kp[t]??2.5,d2=[{value:"all",label:""},{value:"EBOM",label:"EBOM"},{value:"PBOM",label:"PBOM"},{value:"PBOM",label:"PBOM"},{value:"TOOLING",label:""},{value:"AUXILIARY",label:""},{value:"LICENSE",label:"License"}],mp=d2.filter(t=>t.value!=="all").map(t=>t.value),Py={pending:"",quoting:"",sourcing:"",ordered:"",shipped:"",received:"",inspecting:"",passed:"",failed:""},iT={pending:[{label:"",toStatus:"quoting",primary:!0}],quoting:[{label:"",toStatus:"sourcing",primary:!0}],sourcing:[{label:"",toStatus:"ordered",primary:!0}],ordered:[{label:"",toStatus:"shipped",primary:!0}],shipped:[{label:"",toStatus:"received",primary:!0}],received:[{label:"",toStatus:"inspecting",primary:!0}],inspecting:[{label:"",toStatus:"passed",primary:!0},{label:"",toStatus:"failed",danger:!0}]},p9=()=>{const{message:t}=Ya.useApp(),e=Ln(),n=Tn(),[s,o]=Xp(),l=s.get("project")||"",[d,u]=P.useState(null),[h,p]=P.useState(null),[m,g]=P.useState(!1),[v]=ee.useForm(),[C,b]=P.useState(null),[_,y]=P.useState([]),[S,D]=P.useState(!1),[L,N]=P.useState(!1),[T]=ee.useForm(),[j,E]=P.useState(""),[R,M]=P.useState(null),[I]=ee.useForm(),[z,V]=P.useState(["all",...mp]),{data:O,isLoading:k}=ct({queryKey:["srm-projects-list"],queryFn:()=>wt.listProjects({page_size:100})}),{data:F}=ct({queryKey:["plm-projects-kanban"],queryFn:()=>Ci.list({page_size:100})}),{data:A}=ct({queryKey:["srm-project",l],queryFn:()=>wt.getProject(l).catch(()=>null),enabled:!!l}),{data:q,isLoading:B}=ct({queryKey:["srm-prs-kanban",l],queryFn:()=>wt.listPRs({project_id:l,page_size:200}),enabled:!!l}),{data:W}=ct({queryKey:["srm-suppliers-select"],queryFn:()=>wt.listSuppliers({page_size:200})}),Q=P.useMemo(()=>{const G={};return(W?.items||[]).forEach(H=>{G[H.id]=H.name}),G},[W]),ne=P.useMemo(()=>W?.items||[],[W]),de=P.useMemo(()=>{const G=q?.items||[],H=[];G.forEach(we=>{(we.items||[]).forEach(Ce=>{H.push({...Ce,pr_code:we.pr_code,pr_title:we.title,project_target_date:A?.target_date})})});const ie=z.filter(we=>we!=="all");return ie.length===mp.length?H:H.filter(we=>{const Ce=(we.source_bom_type||"").toUpperCase(),ge=(we.material_group||"").toLowerCase();return!!(Ce==="EBOM"&&ie.includes("EBOM")||Ce==="PBOM"&&ie.includes("PBOM")||Ce==="PBOM"&&ie.includes("PBOM")||ge==="tooling"&&ie.includes("TOOLING")||ge==="auxiliary"&&ie.includes("AUXILIARY")||ge==="license"&&ie.includes("LICENSE")||!Ce&&!ge&&ie.includes("EBOM"))})},[q,A,z]),$=P.useMemo(()=>{const G={};return Oy.forEach(H=>{G[H.key]=[]}),de.forEach(H=>{const ie=H.status;G[ie]?G[ie].push(H):H.status==="failed"?G.inspecting.push(H):H.status==="sampling"?G.quoting.push(H):G.pending.push(H)}),G},[de]),X=P.useMemo(()=>{const G={};return Oy.forEach(H=>{const ie=$[H.key]||[],we=[],Ce=[];ie.forEach(je=>{c2(je.category)?we.push(je):Ce.push(je)});const ge=Ce.map(je=>({type:"single",item:je}));we.length>0&&ge.push({type:"passive_group",items:we,status:H.key}),ge.sort((je,He)=>{const dt=je.type==="single"?nT(je.item.category):Kp._passive_,gt=He.type==="single"?nT(He.item.category):Kp._passive_;return dt-gt}),G[H.key]=ge}),G},[$]),le=P.useMemo(()=>{const G=de.length,H=$.pending?.length||0,ie=$.ordered?.length||0,we=$.received?.length||0,Ce=$.passed?.length||0,ge=G>0?Math.round(Ce/G*100):0;return{total:G,pending:H,ordered:ie,received:we,passed:Ce,pct:ge}},[de,$]),{data:oe}=ct({queryKey:["srm-activities","pr_item",d?.id],queryFn:()=>wt.listActivities("pr_item",d.id,{page_size:20}),enabled:!!d?.id}),{data:ue}=ct({queryKey:["srm-sampling",d?.id],queryFn:()=>wt.listSampling(d.id),enabled:!!d?.id}),Ye=G=>{o({project:G})},ae=G=>{const H=z.includes("all"),ie=G.includes("all"),we=G.filter(Ce=>Ce!=="all");ie&&!H?V(["all",...mp]):!ie&&H?V([]):we.length===mp.length?V(["all",...we]):V(we)},fe=()=>{e.invalidateQueries({queryKey:["srm-prs-kanban"]}),e.invalidateQueries({queryKey:["srm-project"]}),d&&(e.invalidateQueries({queryKey:["srm-activities","pr_item",d.id]}),e.invalidateQueries({queryKey:["srm-sampling",d.id]}))},pt=async(G,H)=>{g(!0);try{await wt.updatePRItemStatus(G.id,H),t.success(""),u(null),fe()}catch{t.error("")}finally{g(!1)}},_t=async()=>{if(h)try{const G=await v.validateFields();g(!0),await wt.assignSupplier(h.pr_id,h.id,{supplier_id:G.supplier_id,unit_price:G.unit_price,expected_date:G.expected_date?G.expected_date.toISOString():void 0}),t.success(""),p(null),v.resetFields(),u(null),fe()}catch{t.error("")}finally{g(!1)}},Se=async()=>{if(_.length!==0)try{const G=await T.validateFields();g(!0);const H=C?.items.filter(ie=>_.includes(ie.id))||[];await Promise.all(H.map(ie=>wt.assignSupplier(ie.pr_id,ie.id,{supplier_id:G.supplier_id,unit_price:G.unit_price,expected_date:G.expected_date?G.expected_date.toISOString():void 0}))),t.success(` ${H.length} `),D(!1),T.resetFields(),y([]),b(null),fe()}catch{t.error("")}finally{g(!1)}},$e=async()=>{if(!(_.length===0||!j)){g(!0);try{const G=C?.items.filter(H=>_.includes(H.id))||[];await Promise.all(G.map(H=>wt.updatePRItemStatus(H.id,j))),t.success(` ${G.length} `),N(!1),E(""),y([]),b(null),fe()}catch{t.error("")}finally{g(!1)}}},jt=async()=>{if(R)try{const G=await I.validateFields();g(!0),await wt.createSampling(R.id,{supplier_id:G.supplier_id,sample_qty:G.sample_qty,notes:G.notes}),t.success(""),M(null),I.resetFields(),u(null),fe()}catch{t.error("")}finally{g(!1)}},Fe=async(G,H)=>{g(!0);try{await wt.updateSamplingStatus(G,H),t.success(""),fe(),e.invalidateQueries({queryKey:["srm-sampling"]})}catch{t.error("")}finally{g(!1)}},Dt=P.useMemo(()=>{const G=O?.items||[],H=F?.items||[],ie=[],we=new Set;return G.forEach(Ce=>{ie.push({value:Ce.id,label:`${Ce.code} - ${Ce.name}`}),we.add(Ce.id),Ce.plm_project_id&&we.add(Ce.plm_project_id)}),H.forEach(Ce=>{we.has(Ce.id)||ie.push({value:Ce.id,label:`${Ce.code} - ${Ce.name}`})}),ie},[O,F]),te=k||B,bt=(G,H="small")=>{const ie=iT[G.status]||[],we=G.status==="pending"&&!G.supplier_id;return ie.length===0&&!we?null:i.jsxs("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[we&&i.jsx(J,{size:H,type:"link",style:{padding:"0 4px",fontSize:H==="small"?12:13,height:"auto"},onClick:Ce=>{Ce.stopPropagation(),p(G)},children:""}),ie.map(Ce=>Ce.special==="sampling"?i.jsx(J,{size:H,type:"link",style:{padding:"0 4px",fontSize:H==="small"?12:13,height:"auto",color:"#eb2f96"},onClick:ge=>{ge.stopPropagation(),M(G)},children:Ce.label},Ce.toStatus):Ce.danger?i.jsx(Bn,{title:"",description:`${Ce.label}`,onConfirm:ge=>{ge?.stopPropagation(),pt(G,Ce.toStatus)},onCancel:ge=>ge?.stopPropagation(),okText:"",cancelText:"",okButtonProps:{danger:!0},children:i.jsx(J,{size:H,type:"link",danger:!0,style:{padding:"0 4px",fontSize:H==="small"?12:13,height:"auto"},loading:m,onClick:ge=>ge.stopPropagation(),children:Ce.label})},Ce.toStatus):i.jsx(J,{size:H,type:"link",style:{padding:"0 4px",fontSize:H==="small"?12:13,height:"auto",color:Ce.primary?"#1890ff":void 0},loading:m,onClick:ge=>{ge.stopPropagation(),pt(G,Ce.toStatus)},children:Ce.label},Ce.toStatus))]})},It=G=>iT[G.status]||[],tt=G=>$[G]?.length||0,nt=[{title:"",dataIndex:"material_name",key:"material_name",ellipsis:!0},{title:"",dataIndex:"specification",key:"specification",ellipsis:!0,render:G=>G||"-"},{title:"",dataIndex:"category",key:"category",width:70},{title:"",dataIndex:"quantity",key:"quantity",width:60,render:(G,H)=>`${G} ${H.unit||""}`},{title:"",key:"supplier",width:100,render:(G,H)=>H.supplier_id?Q[H.supplier_id]||"-":i.jsx(_e,{color:"orange",children:""})},{title:"",dataIndex:"status",key:"status",width:80,render:G=>i.jsx(_e,{children:Py[G]||G})}];return i.jsxs("div",{style:{padding:n?8:0},children:[i.jsxs("div",{style:{marginBottom:n?12:16,display:"flex",flexDirection:n?"column":"row",alignItems:n?"stretch":"center",gap:n?10:16,flexWrap:"wrap"},children:[i.jsxs("div",{style:{display:"flex",alignItems:n?"stretch":"center",gap:8,flexDirection:n?"column":"row"},children:[!n&&i.jsx("span",{style:{fontWeight:600,fontSize:16},children:""}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(Xe,{placeholder:"",style:{width:n?"100%":260,flex:n?1:void 0},value:l||void 0,onChange:Ye,loading:k,showSearch:!0,optionFilterProp:"label",options:Dt}),i.jsx(Ka,{style:{cursor:"pointer",color:"#1890ff",fontSize:16},onClick:()=>fe()})]}),i.jsx(Xe,{mode:"multiple",placeholder:"",style:{width:n?"100%":320},value:z,onChange:ae,maxTagCount:n?1:2,maxTagPlaceholder:G=>`+${G.length}`,options:d2})]}),l&&de.length>0&&(n?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:8},children:[i.jsxs("div",{style:{background:"#f6ffed",borderRadius:8,padding:"8px 10px",textAlign:"center"},children:[i.jsxs("div",{style:{fontSize:18,fontWeight:700,color:"#52c41a"},children:[le.passed,"/",le.total]}),i.jsx("div",{style:{fontSize:11,color:"#999"},children:""})]}),i.jsxs("div",{style:{background:"#e6f7ff",borderRadius:8,padding:"8px 10px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1890ff"},children:le.ordered}),i.jsx("div",{style:{fontSize:11,color:"#999"},children:""})]}),i.jsxs("div",{style:{background:"#fff7e6",borderRadius:8,padding:"8px 10px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#faad14"},children:le.pending}),i.jsx("div",{style:{fontSize:11,color:"#999"},children:""})]}),i.jsx("div",{style:{gridColumn:"1 / -1"},children:i.jsx(Mi,{percent:le.pct,size:"small",strokeColor:"#52c41a"})})]}):i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,flex:1},children:[i.jsxs("span",{style:{color:"#666",fontSize:13},children:[": ",i.jsx("strong",{children:le.total})," | : ",i.jsx("strong",{children:le.pending})," | : ",i.jsx("strong",{children:le.ordered})," | : ",i.jsx("strong",{children:le.received})," | : ",i.jsxs("strong",{children:[le.passed,"/",le.total]})," (",le.pct,"%)"]}),i.jsx(Mi,{percent:le.pct,size:"small",style:{width:160,margin:0},strokeColor:"#52c41a"})]}))]}),l?te?i.jsx("div",{style:{textAlign:"center",padding:80},children:i.jsx(tn,{size:"large"})}):de.length===0?i.jsx(Mt,{children:i.jsx(ft,{description:""})}):i.jsx("div",{style:{display:"flex",gap:12,overflowX:"auto",paddingBottom:16,height:"calc(100vh - 200px)"},children:Oy.map(G=>{const H=X[G.key]||[],ie=tt(G.key);return i.jsxs("div",{style:{minWidth:220,maxWidth:280,flex:"1 0 220px",background:"#fafafa",borderRadius:8,padding:12,display:"flex",flexDirection:"column",minHeight:0},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,paddingBottom:8,borderBottom:`3px solid ${G.color}`},children:[i.jsx("span",{style:{fontWeight:600,fontSize:14},children:G.label}),i.jsx(Ii,{count:ie,style:{backgroundColor:G.color},overflowCount:999})]}),i.jsxs("div",{style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:8,minHeight:0},children:[H.map(we=>we.type==="passive_group"?i.jsx(m9,{group:we,supplierMap:Q,onClick:()=>{b(we),y([])}},`passive-${G.key}`):i.jsx(x9,{item:we.item,supplierMap:Q,onClick:()=>u(we.item),actions:bt(we.item)},we.item.id)),H.length===0&&i.jsx("div",{style:{color:"#bbb",textAlign:"center",padding:24,fontSize:13},children:""})]})]},G.key)})}):i.jsx(Mt,{children:i.jsx(ft,{description:""})}),i.jsx(ci,{title:d?.material_name||"",open:!!d,onClose:()=>u(null),width:520,children:d&&i.jsxs(i.Fragment,{children:[i.jsxs(pe,{column:1,bordered:!0,size:"small",style:{marginBottom:24},children:[i.jsx(pe.Item,{label:"",children:d.material_name}),i.jsx(pe.Item,{label:"",children:i.jsx("span",{style:{fontFamily:"monospace"},children:d.material_code||"-"})}),i.jsx(pe.Item,{label:"",children:d.specification||"-"}),i.jsx(pe.Item,{label:"",children:d.category||"-"}),i.jsxs(pe.Item,{label:"",children:[d.quantity," ",d.unit]}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{children:Py[d.status]||d.status})}),i.jsx(pe.Item,{label:"",children:d.supplier_id?Q[d.supplier_id]||"-":""}),i.jsx(pe.Item,{label:"",children:d.unit_price!=null?`${d.unit_price.toFixed(2)}`:"-"}),i.jsx(pe.Item,{label:"",children:d.expected_date?lt(d.expected_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"",children:d.actual_date?lt(d.actual_date).format("YYYY-MM-DD"):"-"}),i.jsx(pe.Item,{label:"PR",children:d.pr_code}),i.jsx(pe.Item,{label:"",children:d.notes||"-"})]}),bt(d,"middle")&&i.jsxs(i.Fragment,{children:[i.jsx(vp,{style:{margin:"16px 0 12px"}}),i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h4",{style:{marginBottom:8},children:""}),bt(d,"middle")]})]}),(ue||[]).length>0&&i.jsxs(i.Fragment,{children:[i.jsx(vp,{style:{margin:"16px 0 12px"}}),i.jsx("h4",{style:{marginBottom:12},children:""}),(ue||[]).map(G=>i.jsxs(Mt,{size:"small",style:{marginBottom:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[i.jsxs("span",{style:{fontWeight:600,fontSize:13},children:["R",G.round]}),i.jsx(_e,{color:G.status==="passed"?"green":G.status==="failed"?"red":G.status==="verifying"?"orange":G.status==="arrived"?"blue":G.status==="shipping"?"purple":"default",children:G.status==="preparing"?"":G.status==="shipping"?"":G.status==="arrived"?"":G.status==="verifying"?"":G.status==="passed"?"":G.status==="failed"?"":G.status})]}),i.jsxs("div",{style:{fontSize:12,color:"#666"},children:[": ",G.supplier_name||"-"," | : ",G.sample_qty]}),G.notes&&i.jsx("div",{style:{fontSize:12,color:"#999",marginTop:2},children:G.notes}),G.verify_result&&i.jsxs("div",{style:{fontSize:12,marginTop:2},children:[": ",i.jsx(_e,{color:G.verify_result==="passed"?"green":"red",style:{fontSize:11},children:G.verify_result==="passed"?"":""}),G.reject_reason&&i.jsx("span",{style:{color:"#999"},children:G.reject_reason})]}),i.jsx("div",{style:{fontSize:11,color:"#bbb",marginTop:4},children:lt(G.created_at).format("YYYY-MM-DD HH:mm")}),(G.status==="preparing"||G.status==="shipping")&&i.jsxs("div",{style:{marginTop:6,borderTop:"1px solid #f0f0f0",paddingTop:6},children:[G.status==="preparing"&&i.jsx(J,{size:"small",type:"link",loading:m,onClick:()=>Fe(G.id,"shipping"),children:""}),G.status==="shipping"&&i.jsx(J,{size:"small",type:"link",loading:m,onClick:()=>Fe(G.id,"arrived"),children:""})]})]},G.id))]}),i.jsx(vp,{style:{margin:"16px 0 12px"}}),i.jsx("h4",{style:{marginBottom:12},children:""}),(oe?.items||[]).length===0?i.jsx(ft,{description:"",image:ft.PRESENTED_IMAGE_SIMPLE}):i.jsx(Il,{items:(oe?.items||[]).map(G=>({children:i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:13},children:G.content}),i.jsxs("div",{style:{fontSize:12,color:"#999"},children:[G.operator_name,"  ",lt(G.created_at).format("MM-DD HH:mm")]})]})}))})]})}),i.jsx(ci,{title:` (${C?.items.length||0})`,open:!!C,onClose:()=>{b(null),y([])},width:720,children:C&&i.jsxs(i.Fragment,{children:[i.jsx(sn,{dataSource:C.items,columns:nt,rowKey:"id",size:"small",pagination:!1,rowSelection:{selectedRowKeys:_,onChange:G=>y(G)}}),_.length>0&&i.jsxs("div",{style:{position:"sticky",bottom:0,background:"#fff",borderTop:"1px solid #f0f0f0",padding:"12px 0",marginTop:16,display:"flex",alignItems:"center",gap:12},children:[i.jsx(pa,{checked:_.length===C.items.length,indeterminate:_.length>0&&_.length<C.items.length,onChange:G=>{y(G.target.checked?C.items.map(H=>H.id):[])},children:""}),i.jsxs("span",{style:{color:"#666",fontSize:13},children:[" ",_.length," "]}),i.jsx("div",{style:{flex:1}}),C.status==="pending"&&i.jsx(J,{type:"primary",size:"small",onClick:()=>D(!0),children:""}),It(C).map(G=>i.jsxs(J,{size:"small",type:G.primary?"primary":"default",danger:G.danger,onClick:()=>{E(G.toStatus),N(!0)},children:["",G.label]},G.toStatus))]})]})}),i.jsxs(Nt,{title:"",open:!!h,onCancel:()=>{p(null),v.resetFields()},onOk:_t,confirmLoading:m,okText:"",cancelText:"",destroyOnClose:!0,children:[h&&i.jsxs("div",{style:{marginBottom:16,color:"#666",fontSize:13},children:[": ",i.jsx("strong",{children:h.material_name})," (",h.material_code||"-",")"]}),i.jsxs(ee,{form:v,layout:"vertical",children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:ne.map(G=>({value:G.id,label:`${G.code} - ${G.name}`}))})}),i.jsx(ee.Item,{name:"unit_price",label:" ()",children:i.jsx(en,{style:{width:"100%"},min:0,precision:2,placeholder:""})}),i.jsx(ee.Item,{name:"expected_date",label:"",children:i.jsx(qa,{style:{width:"100%"},placeholder:""})})]})]}),i.jsx(Nt,{title:` (${_.length})`,open:S,onCancel:()=>{D(!1),T.resetFields()},onOk:Se,confirmLoading:m,okText:"",cancelText:"",destroyOnClose:!0,children:i.jsxs(ee,{form:T,layout:"vertical",children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:ne.map(G=>({value:G.id,label:`${G.code} - ${G.name}`}))})}),i.jsx(ee.Item,{name:"unit_price",label:" ()",children:i.jsx(en,{style:{width:"100%"},min:0,precision:2,placeholder:""})}),i.jsx(ee.Item,{name:"expected_date",label:"",children:i.jsx(qa,{style:{width:"100%"},placeholder:""})})]})}),i.jsx(Nt,{title:"",open:L,onCancel:()=>{N(!1),E("")},onOk:$e,confirmLoading:m,okText:"",cancelText:"",children:i.jsxs("p",{children:[" ",i.jsx("strong",{children:_.length}),"  ",i.jsx("strong",{children:Py[j]||j}),""]})}),i.jsxs(Nt,{title:"",open:!!R,onCancel:()=>{M(null),I.resetFields()},onOk:jt,confirmLoading:m,okText:"",cancelText:"",destroyOnClose:!0,children:[R&&i.jsxs("div",{style:{marginBottom:16,color:"#666",fontSize:13},children:[": ",i.jsx("strong",{children:R.material_name})," (",R.material_code||"-",")"]}),i.jsxs(ee,{form:I,layout:"vertical",children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:ne.map(G=>({value:G.id,label:`${G.code} - ${G.name}`}))})}),i.jsx(ee.Item,{name:"sample_qty",label:"",rules:[{required:!0,message:""}],children:i.jsx(en,{style:{width:"100%"},min:1,placeholder:""})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})})]})]})]})},m9=({group:t,onClick:e})=>{const n=t.items.length,s=t.items.filter(l=>!!l.supplier_id).length,o=n>0?Math.round(s/n*100):0;return i.jsxs("div",{onClick:e,"data-testid":"passive-group-card",style:{background:"linear-gradient(135deg, #e6f7ff 0%, #f0f5ff 100%)",borderRadius:6,padding:"10px 12px",borderLeft:"4px solid #1890ff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)",cursor:"pointer",transition:"box-shadow 0.2s"},onMouseEnter:l=>{l.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"},onMouseLeave:l=>{l.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.08)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[i.jsx(Qp,{style:{color:"#1890ff",fontSize:14}}),i.jsx("span",{style:{fontWeight:600,fontSize:13},children:""}),i.jsxs(_e,{color:"blue",style:{fontSize:11,lineHeight:"18px",padding:"0 4px",margin:0},children:[n,""]})]}),i.jsx("div",{style:{fontSize:11,color:"#666",marginBottom:6},children:Array.from(new Set(t.items.map(l=>l.category))).map(l=>{const d=t.items.filter(u=>u.category===l).length;return`${l}(${d})`}).join(" / ")}),i.jsx(Mi,{percent:o,size:"small",strokeColor:"#1890ff",format:()=>`${s}/${n}`,style:{margin:0}})]})},g9=t=>{const e=(t.source_bom_type||"").toUpperCase(),n=(t.material_group||"").toLowerCase();return e==="EBOM"?{label:"",color:"blue"}:e==="PBOM"?{label:"",color:"green"}:e==="PBOM"?{label:"",color:"orange"}:n==="tooling"||e==="TOOLING"?{label:"",color:"purple"}:n==="auxiliary"||n==="consumable"||e==="CONSUMABLE"?{label:"",color:"default"}:null},x9=({item:t,supplierMap:e,onClick:n,actions:s})=>{const o=t.expected_date||t.project_target_date;let l="#e8e8e8",d="";if(o&&t.status!=="passed"){const p=lt(),g=lt(o).diff(p,"day");g<0?(l="#ff4d4f",d=`${Math.abs(g)}`):g<=3?(l="#faad14",d=`${g}`):(l="#52c41a",d=`${g}`)}const u=t.notes?.match(/R(\d+)/),h=u?parseInt(u[1]):0;return i.jsxs("div",{onClick:n,style:{background:"#fff",borderRadius:6,padding:"10px 12px",borderLeft:`4px solid ${l}`,boxShadow:"0 1px 3px rgba(0,0,0,0.08)",cursor:"pointer",transition:"box-shadow 0.2s"},onMouseEnter:p=>{p.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"},onMouseLeave:p=>{p.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.08)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[i.jsx("span",{style:{fontWeight:600,fontSize:13,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:4},children:t.material_name}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,flexShrink:0},children:[(()=>{const p=g9(t);return p?i.jsx(_e,{color:p.color,style:{fontSize:11,lineHeight:"18px",padding:"0 4px",margin:0},children:p.label}):null})(),h>1&&i.jsxs(_e,{color:"purple",style:{fontSize:11,lineHeight:"18px",padding:"0 4px",margin:0},children:["R",h]})]})]}),i.jsx("div",{style:{marginBottom:6},children:i.jsx("span",{style:{fontSize:12,color:"#999",fontFamily:"monospace"},children:t.material_code||"-"})}),t.supplier_id&&i.jsx("div",{style:{fontSize:12,color:"#666",marginBottom:4},children:e[t.supplier_id]||""}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:4},children:[d&&i.jsx("span",{style:{fontSize:11},children:d}),t.category&&i.jsx(_e,{style:{fontSize:11,lineHeight:"18px",padding:"0 4px",margin:0},children:t.category})]}),s&&i.jsx("div",{style:{marginTop:6,borderTop:"1px solid #f0f0f0",paddingTop:6},children:s})]})},{RangePicker:aT}=qa,{TextArea:sT}=Pe,Ly={draft:{text:"",color:"default",status:"default"},confirmed:{text:"",color:"blue",status:"processing"},invoiced:{text:"",color:"orange",status:"warning"},paid:{text:"",color:"green",status:"success"}},y9={price_diff:"",quantity_diff:"",quality_deduction:"",other:""},v9=[{value:"price_diff",label:""},{value:"quantity_diff",label:""},{value:"quality_deduction",label:""},{value:"other",label:""}];function _9(){const t=Ln(),[e,n]=P.useState(),[s,o]=P.useState(),[l,d]=P.useState(1),[u,h]=P.useState(20),[p,m]=P.useState(!1),[g,v]=P.useState(!1),[C,b]=P.useState(!1),[_,y]=P.useState(null),[S,D]=P.useState(!1),[L]=ee.useForm(),[N]=ee.useForm(),[T]=ee.useForm(),{data:j}=ct({queryKey:["srm-suppliers-all"],queryFn:()=>wt.listSuppliers({page_size:100})}),{data:E,isLoading:R,refetch:M}=ct({queryKey:["srm-settlements",e,s,l,u],queryFn:()=>wt.listSettlements({supplier_id:e,status:s,page:l,page_size:u})}),{data:I,refetch:z}=ct({queryKey:["srm-settlement",_?.id],queryFn:()=>wt.getSettlement(_.id),enabled:!!_?.id&&C}),V=Rt({mutationFn:X=>wt.createSettlement(X),onSuccess:()=>{me.success(""),m(!1),L.resetFields(),t.invalidateQueries({queryKey:["srm-settlements"]})},onError:()=>me.error("")}),O=Rt({mutationFn:X=>wt.generateSettlement(X),onSuccess:()=>{me.success(""),v(!1),N.resetFields(),t.invalidateQueries({queryKey:["srm-settlements"]})},onError:()=>me.error("")}),k=Rt({mutationFn:X=>wt.deleteSettlement(X),onSuccess:()=>{me.success(""),t.invalidateQueries({queryKey:["srm-settlements"]})},onError:()=>me.error("")}),F=Rt({mutationFn:X=>wt.confirmSettlementBuyer(X),onSuccess:()=>{me.success(""),z(),t.invalidateQueries({queryKey:["srm-settlements"]})},onError:()=>me.error("")}),A=Rt({mutationFn:X=>wt.confirmSettlementSupplier(X),onSuccess:()=>{me.success(""),z(),t.invalidateQueries({queryKey:["srm-settlements"]})},onError:()=>me.error("")}),q=Rt({mutationFn:X=>wt.addSettlementDispute(_.id,X),onSuccess:()=>{me.success(""),D(!1),T.resetFields(),z()},onError:()=>me.error("")}),B=Rt({mutationFn:({disputeId:X,resolution:le})=>wt.updateSettlementDispute(_.id,X,{status:"resolved",resolution:le}),onSuccess:()=>{me.success(""),z()},onError:()=>me.error("")}),W=(j?.items||[]).map(X=>({value:X.id,label:X.name})),Q=X=>X==null?"-":`${X.toLocaleString("zh-CN",{minimumFractionDigits:2})}`,ne=[{title:"",dataIndex:"settlement_code",key:"settlement_code",width:180,render:X=>i.jsx("span",{style:{fontFamily:"monospace"},children:X})},{title:"",key:"supplier",width:160,ellipsis:!0,render:(X,le)=>le.supplier?.name||"-"},{title:"",key:"period",width:200,render:(X,le)=>{const oe=le.period_start?lt(le.period_start).format("YYYY-MM-DD"):"",ue=le.period_end?lt(le.period_end).format("YYYY-MM-DD"):"";return oe&&ue?`${oe} ~ ${ue}`:"-"}},{title:"PO",dataIndex:"po_amount",key:"po_amount",width:120,align:"right",render:X=>Q(X)},{title:"",dataIndex:"deduction",key:"deduction",width:100,align:"right",render:X=>X?i.jsx("span",{style:{color:"#f5222d"},children:Q(X)}):"-"},{title:"",dataIndex:"final_amount",key:"final_amount",width:120,align:"right",render:X=>i.jsx("strong",{children:Q(X)})},{title:"",dataIndex:"status",key:"status",width:100,render:X=>{const le=Ly[X]||{text:X,status:"default"};return i.jsx(Ii,{status:le.status,text:le.text})}},{title:"",dataIndex:"created_at",key:"created_at",width:110,render:X=>lt(X).format("YYYY-MM-DD")},{title:"",key:"action",width:120,render:(X,le)=>i.jsxs(Be,{size:"small",children:[i.jsx(J,{type:"link",size:"small",onClick:()=>{y(le),b(!0)},children:""}),le.status==="draft"&&i.jsx(Bn,{title:"",onConfirm:()=>k.mutate(le.id),children:i.jsx(J,{type:"link",size:"small",danger:!0,children:""})})]})}],de=[{title:"",dataIndex:"dispute_type",key:"dispute_type",width:100,render:X=>i.jsx(_e,{children:y9[X]||X})},{title:"",dataIndex:"description",key:"description",ellipsis:!0},{title:"",dataIndex:"amount_diff",key:"amount_diff",width:120,render:X=>X!=null?Q(X):"-"},{title:"",dataIndex:"status",key:"status",width:80,render:X=>i.jsx(_e,{color:X==="resolved"?"green":"orange",children:X==="resolved"?"":""})},{title:"",dataIndex:"resolution",key:"resolution",width:160,ellipsis:!0},{title:"",key:"action",width:80,render:(X,le)=>le.status==="resolved"?null:i.jsx(J,{type:"link",size:"small",onClick:()=>{Nt.confirm({title:"",content:i.jsx(Pe.TextArea,{id:"resolve-input",placeholder:"",rows:3}),onOk:()=>{const oe=document.getElementById("resolve-input");B.mutate({disputeId:le.id,resolution:oe?.value||""})}})},children:""})}],$=I||_;return i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{placeholder:"",allowClear:!0,showSearch:!0,optionFilterProp:"label",style:{width:160},options:W,value:e,onChange:X=>{n(X),d(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:120},options:[{value:"draft",label:""},{value:"confirmed",label:""},{value:"invoiced",label:""},{value:"paid",label:""}],value:s,onChange:X=>{o(X),d(1)}}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>M(),children:""}),i.jsx(J,{icon:i.jsx(NT,{}),onClick:()=>v(!0),children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>m(!0),children:""})]}),children:i.jsx(sn,{rowKey:"id",columns:ne,dataSource:E?.items||[],loading:R,pagination:{current:l,pageSize:u,total:E?.pagination?.total||0,showSizeChanger:!0,showTotal:X=>` ${X} `,onChange:(X,le)=>{d(X),h(le)}},scroll:{x:1200},size:"middle"})}),i.jsx(Nt,{title:"",open:p,onCancel:()=>{m(!1),L.resetFields()},onOk:()=>L.submit(),confirmLoading:V.isPending,children:i.jsxs(ee,{form:L,layout:"vertical",onFinish:X=>{const le={supplier_id:X.supplier_id,notes:X.notes};X.period?.[0]&&(le.period_start=X.period[0].format("YYYY-MM-DD")),X.period?.[1]&&(le.period_end=X.period[1].format("YYYY-MM-DD")),V.mutate(le)},children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:W})}),i.jsx(ee.Item,{name:"period",label:"",children:i.jsx(aT,{style:{width:"100%"}})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(sT,{rows:2})})]})}),i.jsx(Nt,{title:"",open:g,onCancel:()=>{v(!1),N.resetFields()},onOk:()=>N.submit(),confirmLoading:O.isPending,children:i.jsxs(ee,{form:N,layout:"vertical",onFinish:X=>{O.mutate({supplier_id:X.supplier_id,period_start:X.period[0].format("YYYY-MM-DD"),period_end:X.period[1].format("YYYY-MM-DD")})},children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:W})}),i.jsx(ee.Item,{name:"period",label:"",rules:[{required:!0,message:""}],children:i.jsx(aT,{style:{width:"100%"}})})]})}),i.jsx(ci,{title:` - ${$?.settlement_code||""}`,open:C,onClose:()=>{b(!1),y(null)},width:720,extra:$?.status==="draft"&&i.jsxs(Be,{children:[i.jsx(J,{onClick:()=>F.mutate($.id),children:""}),i.jsx(J,{onClick:()=>A.mutate($.id),children:""})]}),children:$&&i.jsxs(i.Fragment,{children:[i.jsxs(pe,{column:2,bordered:!0,size:"small",style:{marginBottom:24},children:[i.jsx(pe.Item,{label:"",children:$.settlement_code}),i.jsx(pe.Item,{label:"",children:$.supplier?.name||"-"}),i.jsx(pe.Item,{label:"",children:$.period_start&&$.period_end?`${lt($.period_start).format("YYYY-MM-DD")} ~ ${lt($.period_end).format("YYYY-MM-DD")}`:"-"}),i.jsx(pe.Item,{label:"",children:i.jsx(Ii,{status:Ly[$.status]?.status||"default",text:Ly[$.status]?.text||$.status})}),i.jsx(pe.Item,{label:"PO",children:Q($.po_amount)}),i.jsx(pe.Item,{label:"",children:Q($.received_amount)}),i.jsx(pe.Item,{label:"",children:Q($.deduction)}),i.jsx(pe.Item,{label:"",children:i.jsx("strong",{children:Q($.final_amount)})}),i.jsx(pe.Item,{label:"",children:$.invoice_no||"-"}),i.jsx(pe.Item,{label:"",children:Q($.invoice_amount)}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:$.confirmed_by_buyer?"green":"default",children:$.confirmed_by_buyer?"":""})}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:$.confirmed_by_supplier?"green":"default",children:$.confirmed_by_supplier?"":""})}),$.notes&&i.jsx(pe.Item,{label:"",span:2,children:$.notes})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h4",{style:{margin:0},children:""}),i.jsx(J,{type:"primary",size:"small",icon:i.jsx(Yt,{}),onClick:()=>D(!0),children:""})]}),i.jsx(sn,{rowKey:"id",columns:de,dataSource:$.disputes||[],pagination:!1,size:"small"})]})}),i.jsx(Nt,{title:"",open:S,onCancel:()=>{D(!1),T.resetFields()},onOk:()=>T.submit(),confirmLoading:q.isPending,children:i.jsxs(ee,{form:T,layout:"vertical",onFinish:X=>q.mutate(X),children:[i.jsx(ee.Item,{name:"dispute_type",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{options:v9,placeholder:""})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(sT,{rows:3,placeholder:""})}),i.jsx(ee.Item,{name:"amount_diff",label:"",children:i.jsx(en,{style:{width:"100%"},precision:2,placeholder:""})})]})})]})}function b9(){return i.jsx("div",{children:"Corrective Actions"})}const{TextArea:S9}=Pe,bu={draft:{text:"",status:"default"},submitted:{text:"",status:"processing"},approved:{text:"",status:"success"}},Ny={monthly:"",quarterly:"",annual:""},Fy={A:"green",B:"blue",C:"orange",D:"red"},M9=t=>t==null?0:Math.round(t/20);function w9(){const t=Ln(),[e,n]=P.useState(),[s,o]=P.useState(),[l,d]=P.useState(1),[u,h]=P.useState(20),[p,m]=P.useState(!1),[g,v]=P.useState(!1),[C,b]=P.useState(null),[_,y]=P.useState(!1),[S,D]=P.useState(""),[L]=ee.useForm(),{data:N}=ct({queryKey:["srm-suppliers-all"],queryFn:()=>wt.listSuppliers({page_size:100})}),{data:T,isLoading:j,refetch:E}=ct({queryKey:["srm-evaluations",e,s,l,u],queryFn:()=>wt.listEvaluations({supplier_id:e,status:s,page:l,page_size:u})}),{data:R}=ct({queryKey:["srm-evaluation",C?.id],queryFn:()=>wt.getEvaluation(C.id),enabled:!!C?.id&&g}),{data:M}=ct({queryKey:["srm-evaluation-history",S],queryFn:()=>wt.getSupplierEvaluationHistory(S),enabled:!!S&&_}),I=Rt({mutationFn:A=>wt.createEvaluation(A),onSuccess:()=>{me.success(""),m(!1),L.resetFields(),t.invalidateQueries({queryKey:["srm-evaluations"]})},onError:()=>me.error("")}),z=Rt({mutationFn:A=>wt.submitEvaluation(A),onSuccess:()=>{me.success(""),t.invalidateQueries({queryKey:["srm-evaluations"]}),t.invalidateQueries({queryKey:["srm-evaluation"]})},onError:()=>me.error("")}),V=Rt({mutationFn:A=>wt.approveEvaluation(A),onSuccess:()=>{me.success(""),t.invalidateQueries({queryKey:["srm-evaluations"]}),t.invalidateQueries({queryKey:["srm-evaluation"]})},onError:()=>me.error("")}),O=(N?.items||[]).map(A=>({value:A.id,label:A.name})),k=[{title:"",key:"supplier",width:160,ellipsis:!0,render:(A,q)=>i.jsx(J,{type:"link",size:"small",style:{padding:0},onClick:()=>{D(q.supplier_id),y(!0)},children:q.supplier?.name||"-"})},{title:"",dataIndex:"period",key:"period",width:110},{title:"",dataIndex:"eval_type",key:"eval_type",width:100,render:A=>Ny[A]||A},{title:"",dataIndex:"quality_score",key:"quality_score",width:80,align:"center",render:A=>A!=null?A.toFixed(0):"-"},{title:"",dataIndex:"delivery_score",key:"delivery_score",width:80,align:"center",render:A=>A!=null?A.toFixed(0):"-"},{title:"",dataIndex:"price_score",key:"price_score",width:80,align:"center",render:A=>A!=null?A.toFixed(0):"-"},{title:"",dataIndex:"service_score",key:"service_score",width:80,align:"center",render:A=>A!=null?A.toFixed(0):"-"},{title:"",dataIndex:"total_score",key:"total_score",width:100,align:"center",render:A=>A!=null?i.jsx("strong",{children:A.toFixed(1)}):"-"},{title:"",dataIndex:"grade",key:"grade",width:60,align:"center",render:A=>A?i.jsx(_e,{color:Fy[A]||"default",children:A}):"-"},{title:"",dataIndex:"status",key:"status",width:90,render:A=>{const q=bu[A]||{text:A,status:"default"};return i.jsx(Ii,{status:q.status,text:q.text})}},{title:"",key:"action",width:160,render:(A,q)=>i.jsxs(Be,{size:"small",children:[i.jsx(J,{type:"link",size:"small",onClick:()=>{b(q),v(!0)},children:""}),q.status==="draft"&&i.jsx(J,{type:"link",size:"small",onClick:()=>z.mutate(q.id),children:""}),q.status==="submitted"&&i.jsx(J,{type:"link",size:"small",onClick:()=>V.mutate(q.id),children:""})]})}],F=R||C;return i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{placeholder:"",allowClear:!0,showSearch:!0,optionFilterProp:"label",style:{width:160},options:O,value:e,onChange:A=>{n(A),d(1)}}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:120},options:[{value:"draft",label:""},{value:"submitted",label:""},{value:"approved",label:""}],value:s,onChange:A=>{o(A),d(1)}}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>E(),children:""}),i.jsx(J,{type:"primary",icon:i.jsx(Yt,{}),onClick:()=>m(!0),children:""})]}),children:i.jsx(sn,{rowKey:"id",columns:k,dataSource:T?.items||[],loading:j,pagination:{current:l,pageSize:u,total:T?.pagination?.total||0,showSizeChanger:!0,showTotal:A=>` ${A} `,onChange:(A,q)=>{d(A),h(q)}},scroll:{x:1200},size:"middle"})}),i.jsx(Nt,{title:"",open:p,onCancel:()=>{m(!1),L.resetFields()},onOk:()=>L.submit(),confirmLoading:I.isPending,width:560,children:i.jsxs(ee,{form:L,layout:"vertical",onFinish:A=>I.mutate(A),children:[i.jsx(ee.Item,{name:"supplier_id",label:"",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:O})}),i.jsx(ee.Item,{name:"period",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:" 2026-Q1  2026-01"})}),i.jsx(ee.Item,{name:"eval_type",label:"",initialValue:"quarterly",children:i.jsx(Xe,{options:[{value:"monthly",label:""},{value:"quarterly",label:""},{value:"annual",label:""}]})}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0 16px"},children:[i.jsx(ee.Item,{name:"quality_score",label:" (0-100)",children:i.jsx(en,{min:0,max:100,style:{width:"100%"},placeholder:"0-100"})}),i.jsx(ee.Item,{name:"delivery_score",label:" (0-100)",children:i.jsx(en,{min:0,max:100,style:{width:"100%"},placeholder:"0-100"})}),i.jsx(ee.Item,{name:"price_score",label:" (0-100)",children:i.jsx(en,{min:0,max:100,style:{width:"100%"},placeholder:"0-100"})}),i.jsx(ee.Item,{name:"service_score",label:" (0-100)",children:i.jsx(en,{min:0,max:100,style:{width:"100%"},placeholder:"0-100"})})]}),i.jsx(ee.Item,{name:"remarks",label:"",children:i.jsx(S9,{rows:3,placeholder:""})})]})}),i.jsx(ci,{title:` - ${F?.supplier?.name||""}`,open:g,onClose:()=>{v(!1),b(null)},width:600,extra:i.jsxs(Be,{children:[F?.status==="draft"&&i.jsx(J,{type:"primary",onClick:()=>z.mutate(F.id),children:""}),F?.status==="submitted"&&i.jsx(J,{type:"primary",onClick:()=>V.mutate(F.id),children:""})]}),children:F&&i.jsxs(i.Fragment,{children:[i.jsxs(pe,{column:2,bordered:!0,size:"small",style:{marginBottom:24},children:[i.jsx(pe.Item,{label:"",children:F.supplier?.name||"-"}),i.jsx(pe.Item,{label:"",children:F.period}),i.jsx(pe.Item,{label:"",children:Ny[F.eval_type]||F.eval_type}),i.jsx(pe.Item,{label:"",children:i.jsx(Ii,{status:bu[F.status]?.status||"default",text:bu[F.status]?.text||F.status})}),i.jsx(pe.Item,{label:"",span:2,children:i.jsxs(Be,{children:[i.jsx("strong",{style:{fontSize:20},children:F.total_score?.toFixed(1)||"-"}),F.grade&&i.jsxs(_e,{color:Fy[F.grade],children:[F.grade,""]}),F.total_score!=null&&i.jsx(x3,{disabled:!0,value:M9(F.total_score)})]})})]}),i.jsx("h4",{style:{marginBottom:16},children:""}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[i.jsxs("span",{children:[" ( ",((F.quality_weight||.3)*100).toFixed(0),"%)"]}),i.jsx("span",{children:F.quality_score?.toFixed(0)||"-"})]}),i.jsx(Mi,{percent:F.quality_score||0,showInfo:!1,strokeColor:"#52c41a"})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[i.jsxs("span",{children:[" ( ",((F.delivery_weight||.25)*100).toFixed(0),"%)"]}),i.jsx("span",{children:F.delivery_score?.toFixed(0)||"-"})]}),i.jsx(Mi,{percent:F.delivery_score||0,showInfo:!1,strokeColor:"#1890ff"})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[i.jsxs("span",{children:[" ( ",((F.price_weight||.25)*100).toFixed(0),"%)"]}),i.jsx("span",{children:F.price_score?.toFixed(0)||"-"})]}),i.jsx(Mi,{percent:F.price_score||0,showInfo:!1,strokeColor:"#faad14"})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[i.jsxs("span",{children:[" ( ",((F.service_weight||.2)*100).toFixed(0),"%)"]}),i.jsx("span",{children:F.service_score?.toFixed(0)||"-"})]}),i.jsx(Mi,{percent:F.service_score||0,showInfo:!1,strokeColor:"#722ed1"})]})]}),F.remarks&&i.jsxs("div",{style:{marginTop:24},children:[i.jsx("h4",{children:""}),i.jsx("p",{style:{color:"#666"},children:F.remarks})]}),i.jsxs("div",{style:{marginTop:24,color:"#999",fontSize:12},children:["",lt(F.created_at).format("YYYY-MM-DD HH:mm")]})]})}),i.jsx(Nt,{title:"",open:_,onCancel:()=>{y(!1),D("")},footer:null,width:700,children:M&&M.length>0?i.jsx(sn,{rowKey:"id",dataSource:M,pagination:!1,size:"small",columns:[{title:"",dataIndex:"period",key:"period",width:100},{title:"",dataIndex:"eval_type",key:"eval_type",width:90,render:A=>Ny[A]||A},{title:"",dataIndex:"quality_score",key:"quality_score",width:70,align:"center",render:A=>A?.toFixed(0)||"-"},{title:"",dataIndex:"delivery_score",key:"delivery_score",width:70,align:"center",render:A=>A?.toFixed(0)||"-"},{title:"",dataIndex:"price_score",key:"price_score",width:70,align:"center",render:A=>A?.toFixed(0)||"-"},{title:"",dataIndex:"service_score",key:"service_score",width:70,align:"center",render:A=>A?.toFixed(0)||"-"},{title:"",dataIndex:"total_score",key:"total_score",width:80,align:"center",render:A=>A!=null?i.jsx("strong",{children:A.toFixed(1)}):"-"},{title:"",dataIndex:"grade",key:"grade",width:60,align:"center",render:A=>A?i.jsx(_e,{color:Fy[A],children:A}):"-"},{title:"",dataIndex:"status",key:"status",width:80,render:A=>i.jsx(Ii,{status:bu[A]?.status||"default",text:bu[A]?.text||A})}]}):i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:""})})]})}function C9(){return i.jsx("div",{children:"Project Detail"})}function T9(){return i.jsx("div",{children:"Equipment"})}const{Search:j9}=Pe,{Text:os}=An,E9={in:"",out:"",adjust:""},A9={in:"green",out:"red",adjust:"blue"},R9=()=>{const t=Ln(),e=Tn(),[n,s]=P.useState(""),[o,l]=P.useState(!1),[d,u]=P.useState(1),[h,p]=P.useState(20),[m,g]=P.useState(!1),[v,C]=P.useState(null),[b,_]=P.useState(null),[y]=ee.useForm(),{data:S,isLoading:D}=ct({queryKey:["srm-inventory",n,o,d,h],queryFn:()=>wt.listInventory({search:n||void 0,low_stock:o?"true":void 0,page:d,page_size:h})}),{data:L}=ct({queryKey:["srm-inventory-tx",v?.id],queryFn:()=>wt.getInventoryTransactions(v.id,{page:1,page_size:50}),enabled:!!v?.id&&m}),N=Rt({mutationFn:O=>wt.stockIn(O),onSuccess:()=>{me.success(""),_(null),y.resetFields(),t.invalidateQueries({queryKey:["srm-inventory"]})},onError:()=>me.error("")}),T=Rt({mutationFn:O=>wt.stockOut(O),onSuccess:()=>{me.success(""),_(null),y.resetFields(),t.invalidateQueries({queryKey:["srm-inventory"]}),t.invalidateQueries({queryKey:["srm-inventory-tx",v?.id]})},onError:O=>me.error(O?.response?.data?.message||"")}),j=Rt({mutationFn:O=>wt.stockAdjust(O),onSuccess:()=>{me.success(""),_(null),y.resetFields(),t.invalidateQueries({queryKey:["srm-inventory"]}),t.invalidateQueries({queryKey:["srm-inventory-tx",v?.id]})},onError:()=>me.error("")}),E=S?.items||[],R=L?.items||[],M=O=>O.safety_stock>0&&O.quantity<O.safety_stock,I=[{title:"",dataIndex:"material_name",key:"material_name",width:160,ellipsis:!0,render:(O,k)=>i.jsx(os,{strong:!0,style:{color:M(k)?"#cf1322":void 0},children:O})},{title:"",dataIndex:"material_code",key:"material_code",width:100,ellipsis:!0},{title:"MPN",dataIndex:"mpn",key:"mpn",width:110,ellipsis:!0},{title:"",dataIndex:"quantity",key:"quantity",width:100,align:"right",render:(O,k)=>i.jsxs(os,{strong:!0,style:{color:M(k)?"#cf1322":"#389e0d",fontSize:14},children:[O," ",k.unit]})},{title:"",dataIndex:"safety_stock",key:"safety_stock",width:90,align:"right",render:O=>O>0?O:"-"},{title:"",key:"stock_status",width:80,render:(O,k)=>M(k)?i.jsx(_e,{color:"red",children:""}):i.jsx(_e,{color:"green",children:""})},{title:"",dataIndex:"warehouse",key:"warehouse",width:80},{title:"",key:"supplier",width:100,ellipsis:!0,render:(O,k)=>k.supplier?.name||"-"},{title:"",dataIndex:"last_in_date",key:"last_in_date",width:100,render:O=>O?lt(O).format("MM-DD HH:mm"):"-"},{title:"",key:"action",width:120,render:(O,k)=>i.jsxs(Be,{size:"small",children:[i.jsx(J,{type:"link",size:"small",onClick:F=>{F.stopPropagation(),C(k),g(!0)},children:""}),i.jsx(J,{type:"link",size:"small",onClick:F=>{F.stopPropagation(),C(k),_("out")},children:""})]})}],z=[{title:"",dataIndex:"type",key:"type",width:60,render:O=>i.jsx(_e,{color:A9[O],children:E9[O]||O})},{title:"",dataIndex:"quantity",key:"quantity",width:80,render:O=>i.jsx(os,{style:{color:O>=0?"#389e0d":"#cf1322",fontWeight:600},children:O>=0?`+${O}`:O})},{title:"",dataIndex:"reference_type",key:"reference_type",width:70},{title:"",dataIndex:"operator",key:"operator",width:80},{title:"",dataIndex:"notes",key:"notes",width:140,ellipsis:!0},{title:"",dataIndex:"created_at",key:"created_at",width:120,render:O=>lt(O).format("MM-DD HH:mm")}],V=()=>{y.validateFields().then(O=>{b==="in"?N.mutate(O):b==="out"?T.mutate({inventory_id:v.id,...O}):b==="adjust"&&j.mutate({inventory_id:v.id,...O})})};return e?i.jsxs("div",{style:{background:"#f5f5f5",minHeight:"100vh"},children:[i.jsx("div",{style:{padding:"12px 16px",background:"#fff",position:"sticky",top:0,zIndex:10},children:i.jsx(Pe,{placeholder:"/",prefix:i.jsx(gi,{style:{color:"#bbb"}}),value:n,onChange:O=>s(O.target.value),onPressEnter:()=>u(1),allowClear:!0,style:{borderRadius:20}})}),i.jsxs("div",{className:"mobile-filter-pills",style:{padding:"8px 12px"},children:[i.jsx("div",{className:`mobile-filter-pill ${o?"":"active"}`,onClick:()=>l(!1),children:""}),i.jsx("div",{className:`mobile-filter-pill ${o?"active":""}`,onClick:()=>l(!0),children:""})]}),i.jsxs("div",{style:{padding:"0 12px"},children:[D?i.jsx("div",{style:{textAlign:"center",padding:40},children:i.jsx(tn,{tip:"..."})}):E.map(O=>i.jsxs("div",{onClick:()=>{C(O),g(!0)},style:{background:"#fff",borderRadius:10,padding:"12px 14px",marginBottom:8,boxShadow:"0 1px 3px rgba(0,0,0,0.04)",cursor:"pointer",borderLeft:M(O)?"3px solid #cf1322":void 0},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[i.jsx(os,{strong:!0,style:{flex:1,fontSize:14},children:O.material_name}),M(O)&&i.jsx(_e,{color:"red",style:{margin:0},children:""})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",fontSize:13,color:"#666",gap:8},children:[O.material_code&&i.jsx(os,{code:!0,style:{fontSize:11},children:O.material_code}),i.jsxs(os,{strong:!0,style:{color:M(O)?"#cf1322":"#389e0d",fontSize:15,marginLeft:"auto"},children:[O.quantity," ",O.unit]}),i.jsx(Oi,{style:{fontSize:10,color:"#ccc"}})]})]},O.id)),E.length===0&&!D&&i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:""})]}),i.jsx("div",{onClick:()=>{C(null),_("in")},style:{position:"fixed",bottom:80,right:20,width:52,height:52,borderRadius:26,background:"#1677ff",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(22,119,255,0.4)",zIndex:100,fontSize:22,cursor:"pointer"},children:i.jsx(Yt,{})}),i.jsx(ci,{title:v?.material_name||"",open:m,onClose:()=>{g(!1),C(null)},width:"100%",children:v&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:16,padding:12,background:"#fafafa",borderRadius:8},children:[i.jsxs(os,{children:[": ",i.jsxs(os,{strong:!0,style:{fontSize:18,color:M(v)?"#cf1322":"#389e0d"},children:[v.quantity," ",v.unit]})]}),v.safety_stock>0&&i.jsxs(os,{type:"secondary",style:{marginLeft:12},children:[": ",v.safety_stock]})]}),i.jsxs(Be,{style:{marginBottom:12},children:[i.jsx(J,{size:"small",icon:i.jsx(Vy,{}),onClick:()=>_("out"),children:""}),i.jsx(J,{size:"small",icon:i.jsx(Gr,{}),onClick:()=>_("adjust"),children:""})]}),i.jsx(sn,{columns:z,dataSource:R,rowKey:"id",size:"small",pagination:!1,scroll:{x:500}})]})}),i.jsx(Nt,{title:b==="in"?"":b==="out"?"":"",open:!!b,onOk:V,onCancel:()=>{_(null),y.resetFields()},confirmLoading:N.isPending||T.isPending||j.isPending,children:i.jsxs(ee,{form:y,layout:"vertical",children:[b==="in"&&i.jsxs(i.Fragment,{children:[i.jsx(ee.Item,{name:"material_name",label:"",rules:[{required:!0}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"material_code",label:"",children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"quantity",label:"",rules:[{required:!0}],children:i.jsx(en,{min:.01,style:{width:"100%"}})}),i.jsx(ee.Item,{name:"warehouse",label:"",children:i.jsx(Pe,{placeholder:""})})]}),b==="out"&&i.jsx(ee.Item,{name:"quantity",label:` (: ${v?.quantity??0})`,rules:[{required:!0}],children:i.jsx(en,{min:.01,max:v?.quantity,style:{width:"100%"}})}),b==="adjust"&&i.jsx(ee.Item,{name:"quantity",label:` (: ${v?.quantity??0})`,rules:[{required:!0}],children:i.jsx(en,{min:0,style:{width:"100%"}})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2})})]})})]}):i.jsxs("div",{children:[i.jsx(Mt,{title:"",extra:i.jsxs(Be,{wrap:!0,children:[i.jsx(Xe,{value:o?"low":"all",onChange:O=>{l(O==="low"),u(1)},style:{width:110},options:[{value:"all",label:""},{value:"low",label:""}]}),i.jsx(j9,{placeholder:"",allowClear:!0,style:{width:200},value:n,onChange:O=>s(O.target.value),onSearch:()=>u(1)}),i.jsx(J,{icon:i.jsx(Ka,{}),onClick:()=>t.invalidateQueries({queryKey:["srm-inventory"]}),children:""}),i.jsx(J,{type:"primary",icon:i.jsx(LT,{}),onClick:()=>{C(null),_("in")},children:""})]}),children:i.jsx(sn,{columns:I,dataSource:E,rowKey:"id",loading:D,scroll:{x:1100},pagination:{current:d,pageSize:h,total:S?.pagination?.total||0,showSizeChanger:!0,showTotal:O=>` ${O} `,onChange:(O,k)=>{u(O),p(k)}},onRow:O=>({onClick:()=>{C(O),g(!0)},style:{cursor:"pointer"}})})}),i.jsx(ci,{title:v?.material_name||"",open:m,onClose:()=>{g(!1),C(null)},width:700,children:v&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:16,marginBottom:16,padding:12,background:"#fafafa",borderRadius:8,alignItems:"center"},children:[i.jsxs(os,{children:[": ",i.jsxs(os,{strong:!0,style:{fontSize:20,color:M(v)?"#cf1322":"#389e0d"},children:[v.quantity," ",v.unit]})]}),v.safety_stock>0&&i.jsxs(os,{type:"secondary",children:[": ",v.safety_stock]}),M(v)&&i.jsx(_e,{color:"red",children:""}),i.jsxs(Be,{style:{marginLeft:"auto"},children:[i.jsx(J,{size:"small",icon:i.jsx(Vy,{}),onClick:()=>_("out"),children:""}),i.jsx(J,{size:"small",icon:i.jsx(Gr,{}),onClick:()=>_("adjust"),children:""})]})]}),i.jsx("h4",{children:""}),i.jsx(sn,{columns:z,dataSource:R,rowKey:"id",size:"small",pagination:!1})]})}),i.jsx(Nt,{title:b==="in"?"":b==="out"?"":"",open:!!b,onOk:V,onCancel:()=>{_(null),y.resetFields()},confirmLoading:N.isPending||T.isPending||j.isPending,children:i.jsxs(ee,{form:y,layout:"vertical",children:[b==="in"&&i.jsxs(i.Fragment,{children:[i.jsx(ee.Item,{name:"material_name",label:"",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:""})}),i.jsx(ee.Item,{name:"material_code",label:"",children:i.jsx(Pe,{placeholder:""})}),i.jsxs(Be,{style:{width:"100%"},children:[i.jsx(ee.Item,{name:"quantity",label:"",rules:[{required:!0,message:""}],children:i.jsx(en,{min:.01,style:{width:150}})}),i.jsx(ee.Item,{name:"unit",label:"",initialValue:"pcs",children:i.jsx(Pe,{style:{width:80}})})]}),i.jsx(ee.Item,{name:"warehouse",label:"",children:i.jsx(Pe,{placeholder:"/"})})]}),b==="out"&&i.jsx(ee.Item,{name:"quantity",label:` (: ${v?.quantity??0} ${v?.unit||""})`,rules:[{required:!0}],children:i.jsx(en,{min:.01,max:v?.quantity,style:{width:"100%"}})}),b==="adjust"&&i.jsx(ee.Item,{name:"quantity",label:` (: ${v?.quantity??0} ${v?.unit||""})`,rules:[{required:!0}],children:i.jsx(en,{min:0,style:{width:"100%"}})}),i.jsx(ee.Item,{name:"notes",label:"",children:i.jsx(Pe.TextArea,{rows:2,placeholder:""})})]})})]})},D9={draft:{color:"default",label:""},pending:{color:"processing",label:""},approved:{color:"success",label:""},rejected:{color:"error",label:""},executing:{color:"warning",label:""},closed:{color:"default",label:""},implemented:{color:"success",label:""}},I9={low:{color:"blue",label:""},medium:{color:"blue",label:""},high:{color:"orange",label:""},critical:{color:"red",label:""}},O9={design:"",material:"",process:"",spec:"",document:""},P9={bom_update:"BOM",drawing_update:"",supplier_notify:"",inventory_handle:"",doc_update:"",sop_update:"SOP"},L9={created:"ECN",updated:"ECN",submitted:"",approved:"",rejected:"",executing:"",task_completed:"",closed:"ECN",bom_applied:"BOM"},N9=()=>{const{id:t}=td(),e=Ni(),{message:n,modal:s}=Ya.useApp(),[o,l]=P.useState(null),[d,u]=P.useState(!0),[h,p]=P.useState([]),[m,g]=P.useState([]),[v,C]=P.useState(""),[b,_]=P.useState(""),[y,S]=P.useState(!1),[D,L]=P.useState(!1),N=async()=>{if(t){u(!0);try{const ne=await ia.get(t);l(ne)}catch{n.error("ECN")}finally{u(!1)}}},T=async()=>{if(t)try{const ne=await ia.listHistory(t);p(ne.items||[])}catch{}},j=async()=>{if(t)try{const ne=await ia.listTasks(t);g(ne.items||[])}catch{}};P.useEffect(()=>{N(),T(),j()},[t]);const E=async()=>{t&&s.confirm({title:"",content:"ECN",onOk:async()=>{try{await ia.submit(t),n.success(""),N(),T()}catch{n.error("")}}})},R=async()=>{if(t)try{await ia.approve(t,{comment:v}),n.success(""),S(!1),C(""),N(),T(),j()}catch{n.error("")}},M=async()=>{if(!(!t||!b))try{await ia.reject(t,{reason:b}),n.success(""),L(!1),_(""),N(),T()}catch{n.error("")}},I=async ne=>{if(t)try{await ia.updateTask(t,ne,{status:"completed"}),n.success(""),j(),N(),T()}catch{n.error("")}},z=async()=>{t&&s.confirm({title:"BOM",content:"BOM",onOk:async()=>{try{await ia.applyBOMChanges(t),n.success("BOM"),j(),N(),T()}catch{n.error("")}}})};if(d||!o)return i.jsx(Mt,{loading:d});const V=D9[o.status]||{color:"default",label:o.status},O=I9[o.urgency]||{color:"default",label:o.urgency},k=()=>{const ne=[];return(o.status==="draft"||o.status==="rejected")&&ne.push(i.jsx(J,{icon:i.jsx($u,{}),onClick:()=>e(`/ecn/${t}/edit`),children:""},"edit"),i.jsx(J,{type:"primary",icon:i.jsx(Tl,{}),onClick:E,children:""},"submit")),o.status==="pending"&&ne.push(i.jsx(J,{type:"primary",icon:i.jsx(ET,{}),onClick:()=>S(!0),children:""},"approve"),i.jsx(J,{danger:!0,icon:i.jsx(Wu,{}),onClick:()=>L(!0),children:""},"reject")),o.status==="executing"&&ne.push(i.jsx(J,{type:"primary",icon:i.jsx(NT,{}),onClick:z,children:"BOM"},"bom")),ne},F=()=>i.jsx("div",{children:i.jsxs(pe,{bordered:!0,column:{xs:1,sm:2},size:"small",children:[i.jsx(pe.Item,{label:"ECN",children:o.code}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:V.color,children:V.label})}),i.jsx(pe.Item,{label:"",children:o.product?.name||"-"}),i.jsx(pe.Item,{label:"",children:O9[o.change_type]||o.change_type}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:O.color,children:O.label})}),i.jsx(pe.Item,{label:"",children:o.approval_mode==="parallel"?"":""}),i.jsx(pe.Item,{label:"",children:o.requester?.name||"-"}),i.jsx(pe.Item,{label:"",children:o.created_at?lt(o.created_at).format("YYYY-MM-DD HH:mm"):"-"}),o.planned_date&&i.jsx(pe.Item,{label:"",children:lt(o.planned_date).format("YYYY-MM-DD")}),o.completion_rate>0&&i.jsx(pe.Item,{label:"",children:i.jsx(Mi,{percent:o.completion_rate,size:"small",style:{width:200}})}),i.jsx(pe.Item,{label:"",span:2,children:o.reason||"-"}),i.jsx(pe.Item,{label:"",span:2,children:o.description||"-"}),o.technical_plan&&i.jsx(pe.Item,{label:"",span:2,children:o.technical_plan}),o.impact_analysis&&i.jsx(pe.Item,{label:"",span:2,children:o.impact_analysis}),o.rejection_reason&&i.jsx(pe.Item,{label:"",span:2,children:i.jsx("span",{style:{color:"#ff4d4f"},children:o.rejection_reason})})]})}),A=()=>{const ne=o.affected_items||[];return ne.length===0?i.jsx(ft,{description:""}):i.jsx("div",{children:ne.map(de=>i.jsxs(Mt,{size:"small",style:{marginBottom:12},children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:i.jsxs(Be,{children:[i.jsx(_e,{children:de.item_type==="material"?"":de.item_type==="bom_item"?"BOM":de.item_type}),i.jsx("span",{style:{fontWeight:500},children:de.material_name||de.item_id}),de.material_code&&i.jsxs("span",{style:{color:"#999"},children:["(",de.material_code,")"]})]})}),de.change_description&&i.jsx("div",{style:{color:"#666",marginBottom:8},children:de.change_description}),(de.before_value||de.after_value)&&i.jsx("div",{style:{background:"#fafafa",borderRadius:4,padding:12},children:Object.keys({...de.before_value,...de.after_value}).filter($=>$!=="ids").map($=>{const X=de.before_value?.[$],le=de.after_value?.[$],oe=JSON.stringify(X)!==JSON.stringify(le);return i.jsxs("div",{style:{display:"flex",gap:16,marginBottom:4},children:[i.jsx("span",{style:{width:100,color:"#999"},children:$}),i.jsx("span",{style:{color:oe?"#ff4d4f":"#333",textDecoration:oe?"line-through":void 0},children:X!==void 0?String(X):"-"}),oe&&i.jsxs(i.Fragment,{children:[i.jsx("span",{style:{color:"#999"},children:""}),i.jsx("span",{style:{color:"#52c41a",fontWeight:500},children:le!==void 0?String(le):"-"})]})]},$)})})]},de.id))})},q=()=>{const ne=o.approvals||[];if(ne.length===0)return i.jsx(ft,{description:""});const de=ne.findIndex($=>$.status==="pending");return i.jsx(vv,{direction:"vertical",current:de>=0?de:ne.length,items:ne.map($=>({title:i.jsxs(Be,{children:[i.jsx("span",{children:$.approver?.name||$.approver_id}),$.status==="approved"&&i.jsx(_e,{color:"success",children:""}),$.status==="rejected"&&i.jsx(_e,{color:"error",children:""}),$.status==="pending"&&i.jsx(_e,{color:"processing",children:""})]}),description:i.jsxs("div",{children:[$.comment&&i.jsxs("div",{style:{color:"#666"},children:["",$.comment]}),$.decided_at&&i.jsx("div",{style:{color:"#999",fontSize:12},children:lt($.decided_at).format("YYYY-MM-DD HH:mm")})]}),status:$.status==="approved"?"finish":$.status==="rejected"?"error":$.status==="pending"?"process":"wait"}))})},B=()=>{if(m.length===0)return i.jsx(ft,{description:o.status==="executing"?"":""});const ne=m.filter($=>$.status==="completed").length,de=m.filter($=>$.status!=="skipped").length;return i.jsxs("div",{children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx(Mi,{percent:de>0?Math.round(ne*100/de):0})}),m.map($=>i.jsx(Mt,{size:"small",style:{marginBottom:8},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs(Be,{children:[i.jsx(pa,{checked:$.status==="completed",disabled:$.status==="completed"||$.status==="skipped",onChange:()=>I($.id)}),i.jsx(_e,{children:P9[$.type]||$.type}),i.jsx("span",{style:{textDecoration:$.status==="completed"?"line-through":void 0,color:$.status==="completed"?"#999":"#333"},children:$.title})]}),i.jsxs(Be,{children:[$.assignee?.name&&i.jsx("span",{style:{color:"#999",fontSize:12},children:$.assignee.name}),$.due_date&&i.jsxs("span",{style:{color:"#999",fontSize:12},children:["",lt($.due_date).format("MM-DD")]}),$.status==="completed"&&i.jsx(_e,{color:"success",children:""}),$.status==="pending"&&i.jsx(_e,{children:""}),$.status==="in_progress"&&i.jsx(_e,{color:"processing",children:""})]})]})},$.id))]})},W=()=>h.length===0?i.jsx(ft,{description:""}):i.jsx(Il,{items:h.map(ne=>({color:ne.action==="rejected"?"red":ne.action==="approved"?"green":"blue",children:i.jsxs("div",{children:[i.jsxs("div",{children:[i.jsx("span",{style:{fontWeight:500},children:L9[ne.action]||ne.action}),ne.user?.name&&i.jsxs("span",{style:{color:"#999",marginLeft:8},children:["- ",ne.user.name]})]}),ne.detail&&Object.keys(ne.detail).length>0&&i.jsxs("div",{style:{color:"#666",fontSize:12},children:[ne.detail.comment&&i.jsxs("span",{children:["",ne.detail.comment]}),ne.detail.reason&&i.jsxs("span",{children:["",ne.detail.reason]}),ne.detail.task_title&&i.jsxs("span",{children:["",ne.detail.task_title]})]}),i.jsx("div",{style:{color:"#999",fontSize:12},children:lt(ne.created_at).format("YYYY-MM-DD HH:mm:ss")})]})}))}),Q=[{key:"overview",label:"",children:F()},{key:"affected",label:` (${o.affected_items?.length||0})`,children:A()},{key:"approval",label:"",children:q()},{key:"tasks",label:` (${m.length})`,children:B()},{key:"history",label:"",children:W()}];return i.jsxs("div",{children:[i.jsx(FT,{items:[{title:i.jsx("a",{onClick:()=>e("/ecn"),children:"ECN"})},{title:o.code}],style:{marginBottom:16}}),i.jsx(Mt,{style:{marginBottom:16},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[i.jsxs("div",{children:[i.jsxs(Be,{align:"center",style:{marginBottom:8},children:[i.jsx(J,{type:"text",icon:i.jsx(Ls,{}),onClick:()=>e("/ecn")}),i.jsx("h2",{style:{margin:0},children:o.title}),i.jsx(_e,{color:V.color,children:V.label}),(o.urgency==="high"||o.urgency==="critical")&&i.jsx(_e,{color:O.color,children:O.label})]}),i.jsxs("div",{style:{color:"#999",paddingLeft:40},children:[o.code,"  ",o.requester?.name,"  ",lt(o.created_at).format("YYYY-MM-DD HH:mm")]})]}),i.jsx(Be,{children:k()})]})}),i.jsx(Mt,{children:i.jsx(Ol,{items:Q})}),i.jsx(Nt,{title:"ECN",open:y,onOk:R,onCancel:()=>S(!1),okText:"",children:i.jsx(Pe.TextArea,{placeholder:"",value:v,onChange:ne=>C(ne.target.value),rows:3})}),i.jsx(Nt,{title:"ECN",open:D,onOk:M,onCancel:()=>L(!1),okText:"",okButtonProps:{danger:!0,disabled:!b},children:i.jsx(Pe.TextArea,{placeholder:"",value:b,onChange:ne=>_(ne.target.value),rows:3})})]})},F9=[{label:"",value:"design"},{label:"",value:"material"},{label:"",value:"process"},{label:"",value:"spec"},{label:"",value:"document"}],z9=[{label:"",value:"medium"},{label:"",value:"high"},{label:"",value:"critical"}],rT=()=>{const{id:t}=td(),e=Ni(),{message:n}=Ya.useApp(),[s]=ee.useForm(),[o,l]=P.useState(0),[d,u]=P.useState(!1),[h,p]=P.useState([]),[m,g]=P.useState([]),[v,C]=P.useState(null),b=!!t;P.useEffect(()=>{_(),y(),b&&S()},[t]);const _=async()=>{try{const I=await Z.get("/products",{params:{page_size:100}}),z=I.data?.data?.materials||I.data?.data?.items||[];if(z.length===0){const O=(await Ci.list())?.items||[];p(O.map(k=>({id:k.product_id||k.id,name:k.product_name||k.name})));return}p(z.map(V=>({id:V.id,name:V.name})))}catch{try{const z=(await Ci.list())?.items||[];p(z.map(V=>({id:V.product_id||V.id,name:V.product_name||V.name})))}catch{}}},y=async()=>{try{const z=(await Z.get("/users")).data?.data?.items||[];g(z.map(V=>({id:V.id,name:V.name})))}catch{}},S=async()=>{if(t)try{const I=await ia.get(t);C(I),s.setFieldsValue({title:I.title,product_id:I.product_id,change_type:I.change_type,urgency:I.urgency,reason:I.reason,description:I.description,technical_plan:I.technical_plan,impact_analysis:I.impact_analysis,approval_mode:I.approval_mode||"serial",sop_assembly:I.sop_impact?.assembly,sop_testing:I.sop_impact?.testing,sop_packaging:I.sop_impact?.packaging})}catch{n.error("ECN")}},D=async()=>{u(!0);try{const I=s.getFieldsValue(!0),z={};if(I.sop_assembly&&(z.assembly=!0),I.sop_assembly_desc&&(z.assembly_desc=I.sop_assembly_desc),I.sop_testing&&(z.testing=!0),I.sop_testing_desc&&(z.testing_desc=I.sop_testing_desc),I.sop_packaging&&(z.packaging=!0),I.sop_packaging_desc&&(z.packaging_desc=I.sop_packaging_desc),b&&t)await ia.update(t,{title:I.title,change_type:I.change_type,urgency:I.urgency,reason:I.reason,description:I.description,technical_plan:I.technical_plan,impact_analysis:I.impact_analysis,approval_mode:I.approval_mode,sop_impact:Object.keys(z).length>0?z:void 0}),n.success(""),e(`/ecn/${t}`);else{const V={title:I.title,product_id:I.product_id,change_type:I.change_type,urgency:I.urgency||"medium",reason:I.reason,description:I.description,technical_plan:I.technical_plan,impact_analysis:I.impact_analysis,approval_mode:I.approval_mode||"serial",sop_impact:Object.keys(z).length>0?z:void 0,approver_ids:I.approver_ids},O=await ia.create(V);n.success("ECN"),e(`/ecn/${O.id}`)}}catch(I){n.error(""+(I?.response?.data?.message||I.message))}finally{u(!1)}},L=async()=>{u(!0);try{const I=s.getFieldsValue(!0);let z=t;if(!b){const V={};I.sop_assembly&&(V.assembly=!0),I.sop_testing&&(V.testing=!0),I.sop_packaging&&(V.packaging=!0);const O={title:I.title,product_id:I.product_id,change_type:I.change_type,urgency:I.urgency||"medium",reason:I.reason,description:I.description,technical_plan:I.technical_plan,impact_analysis:I.impact_analysis,approval_mode:I.approval_mode||"serial",sop_impact:Object.keys(V).length>0?V:void 0,approver_ids:I.approver_ids};z=(await ia.create(O)).id}z&&(await ia.submit(z),n.success(""),e(`/ecn/${z}`))}catch(I){n.error(""+(I?.response?.data?.message||I.message))}finally{u(!1)}},N=[{title:""},{title:""},{title:""},{title:""}],M=[()=>i.jsxs(i.Fragment,{children:[i.jsx(ee.Item,{label:"",name:"title",rules:[{required:!0,message:""}],children:i.jsx(Pe,{placeholder:"120",maxLength:120,showCount:!0})}),i.jsx(ee.Item,{label:"",name:"product_id",rules:[{required:!0,message:""}],children:i.jsx(Xe,{placeholder:"",showSearch:!0,optionFilterProp:"label",options:h.map(I=>({label:I.name,value:I.id}))})}),i.jsx(ee.Item,{label:"",name:"change_type",rules:[{required:!0,message:""}],children:i.jsx(Ws.Group,{options:F9})}),i.jsx(ee.Item,{label:"",name:"urgency",initialValue:"medium",children:i.jsx(Ws.Group,{options:z9,optionType:"button",buttonStyle:"solid"})}),i.jsx(ee.Item,{label:"",name:"reason",rules:[{required:!0,message:""}],children:i.jsx(Pe.TextArea,{rows:4,placeholder:""})})]}),()=>i.jsxs(i.Fragment,{children:[i.jsx(ee.Item,{label:"",name:"description",children:i.jsx(Pe.TextArea,{rows:4,placeholder:""})}),i.jsx(ee.Item,{label:"",name:"impact_analysis",children:i.jsx(Pe.TextArea,{rows:3,placeholder:""})}),i.jsxs("div",{style:{marginBottom:24},children:[i.jsx("h4",{children:"SOP"}),i.jsxs(Mt,{size:"small",children:[i.jsx(ee.Item,{name:"sop_assembly",valuePropName:"checked",style:{marginBottom:8},children:i.jsx(pa,{children:"SOP"})}),i.jsx(ee.Item,{noStyle:!0,shouldUpdate:(I,z)=>I.sop_assembly!==z.sop_assembly,children:({getFieldValue:I})=>I("sop_assembly")?i.jsx(ee.Item,{name:"sop_assembly_desc",style:{marginLeft:24},children:i.jsx(Pe.TextArea,{rows:2,placeholder:"SOP"})}):null}),i.jsx(ee.Item,{name:"sop_testing",valuePropName:"checked",style:{marginBottom:8},children:i.jsx(pa,{children:"SOP"})}),i.jsx(ee.Item,{noStyle:!0,shouldUpdate:(I,z)=>I.sop_testing!==z.sop_testing,children:({getFieldValue:I})=>I("sop_testing")?i.jsx(ee.Item,{name:"sop_testing_desc",style:{marginLeft:24},children:i.jsx(Pe.TextArea,{rows:2,placeholder:"SOP"})}):null}),i.jsx(ee.Item,{name:"sop_packaging",valuePropName:"checked",style:{marginBottom:8},children:i.jsx(pa,{children:"SOP"})}),i.jsx(ee.Item,{noStyle:!0,shouldUpdate:(I,z)=>I.sop_packaging!==z.sop_packaging,children:({getFieldValue:I})=>I("sop_packaging")?i.jsx(ee.Item,{name:"sop_packaging_desc",style:{marginLeft:24},children:i.jsx(Pe.TextArea,{rows:2,placeholder:"SOP"})}):null})]})]})]}),()=>i.jsx(i.Fragment,{children:i.jsx(ee.Item,{label:"",name:"technical_plan",children:i.jsx(Pe.TextArea,{rows:6,placeholder:""})})}),()=>i.jsxs(i.Fragment,{children:[i.jsx(ee.Item,{label:"",name:"approval_mode",initialValue:"serial",children:i.jsxs(Ws.Group,{children:[i.jsx(Ws,{value:"serial",children:""}),i.jsx(Ws,{value:"parallel",children:""})]})}),i.jsx(ee.Item,{label:"",name:"approver_ids",children:i.jsx(Xe,{mode:"multiple",placeholder:"",showSearch:!0,optionFilterProp:"label",options:m.map(I=>({label:I.name,value:I.id}))})})]})];return i.jsxs("div",{children:[i.jsx(FT,{items:[{title:i.jsx("a",{onClick:()=>e("/ecn"),children:"ECN"})},{title:b?"":""}],style:{marginBottom:16}}),i.jsxs(Mt,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[i.jsx(J,{type:"text",icon:i.jsx(Ls,{}),onClick:()=>e("/ecn")}),i.jsx("h2",{style:{margin:"0 0 0 8px"},children:b?"":""})]}),i.jsx(vv,{current:o,items:N,style:{marginBottom:32}}),i.jsx(ee,{form:s,layout:"vertical",style:{maxWidth:700},children:M[o]()}),i.jsxs("div",{style:{borderTop:"1px solid #f0f0f0",paddingTop:16,marginTop:24,display:"flex",justifyContent:"space-between"},children:[i.jsx(Be,{children:o>0&&i.jsx(J,{onClick:()=>l(I=>I-1),children:""})}),i.jsxs(Be,{children:[i.jsx(J,{onClick:D,loading:d,children:""}),o<N.length-1?i.jsx(J,{type:"primary",onClick:()=>{o===0?s.validateFields(["title","product_id","change_type","reason"]).then(()=>{l(I=>I+1)}).catch(()=>{}):l(I=>I+1)},children:""}):i.jsx(J,{type:"primary",onClick:L,loading:d,children:""})]})]})]})]})},{Text:Ts}=An,k9={concept:"",evt:"EVT",dvt:"DVT",pvt:"PVT",mp:"MP",CONCEPT:"",EVT:"EVT",DVT:"DVT",PVT:"PVT",MP:"MP"},B9={concept:"purple",evt:"blue",dvt:"cyan",pvt:"orange",mp:"green",CONCEPT:"purple",EVT:"blue",DVT:"DVT",PVT:"orange",MP:"green"},U9={planning:"",active:"",completed:"",on_hold:""},H9={planning:"default",active:"processing",completed:"success",on_hold:"warning"},oT=t=>`${t.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,V9=()=>{const t=Ni(),e=Tn(),[n,s]=P.useState(""),{data:o,isLoading:l}=ct({queryKey:["projects","bom-management"],queryFn:()=>Ci.list({page:1,page_size:100})}),{data:d}=ct({queryKey:["bom-cost-summary"],queryFn:()=>Zt.bomCostSummary(),staleTime:3e4}),u=P.useMemo(()=>{const g={};for(const v of d||[])g[v.project_id]=v;return g},[d]),h=P.useMemo(()=>{let g=0,v=0,C=0;for(const b of d||[])g+=b.total_cost||0,v+=b.total_items||0,C+=b.unpriced_items||0;return{cost:g,items:v,unpriced:C}},[d]),m=(o?.items||o||[]).filter(g=>!n||g.name.toLowerCase().includes(n.toLowerCase())||g.code?.toLowerCase().includes(n.toLowerCase()));return i.jsxs("div",{style:{padding:e?0:24},children:[!e&&i.jsxs("div",{style:{marginBottom:16},children:[i.jsx(Ts,{strong:!0,style:{fontSize:20},children:"BOM"}),i.jsx(Ts,{type:"secondary",style:{marginLeft:12,fontSize:14},children:"BOM"})]}),i.jsx("div",{style:{padding:e?"8px 16px":"0 0 16px 0"},children:i.jsx(Pe,{placeholder:"...",prefix:i.jsx(gi,{}),value:n,onChange:g=>s(g.target.value),allowClear:!0,style:e?{borderRadius:20,height:40,background:"#f5f5f5",border:"none"}:{width:320}})}),h.items>0&&i.jsxs("div",{style:{display:"flex",gap:16,padding:"8px 16px",background:"#f6ffed",borderRadius:6,border:"1px solid #b7eb8f",marginBottom:16,flexWrap:"wrap",alignItems:"center",...e?{margin:"0 12px 12px"}:{}},children:[i.jsxs(Ts,{style:{fontSize:13},children:["BOM: ",i.jsx(Ts,{strong:!0,style:{color:"#1677ff",fontSize:15},children:oT(h.cost)})]}),i.jsxs(Ts,{type:"secondary",style:{fontSize:12},children:[" ",h.items," "]}),h.unpriced>0&&i.jsxs(Ts,{type:"warning",style:{fontSize:12},children:[h.unpriced,""]})]}),l&&i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(tn,{})}),!l&&m.length===0&&i.jsx(ft,{description:"",style:{padding:60}}),i.jsx("div",{style:{padding:e?"0 12px":0,display:"grid",gridTemplateColumns:e?"1fr":"repeat(auto-fill, minmax(340px, 1fr))",gap:e?8:16},children:m.map(g=>{const v=u[g.id];return i.jsxs("div",{onClick:()=>t(`/bom-management/${g.id}`),style:{background:"#fff",borderRadius:12,padding:e?"14px 16px":"16px 20px",cursor:"pointer",border:e?"none":"1px solid #f0f0f0",boxShadow:e?"none":"0 1px 2px rgba(0,0,0,0.04)",borderBottom:e?"1px solid #f0f0f0":void 0,display:"flex",alignItems:"center",gap:12,transition:"background 0.15s"},children:[i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[i.jsx(Ts,{strong:!0,style:{fontSize:15,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g.name}),g.code&&i.jsx(Ts,{type:"secondary",style:{fontSize:12,flexShrink:0},children:g.code})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(_e,{color:B9[g.phase],children:k9[g.phase]||g.phase}),i.jsx(Ii,{status:H9[g.status],text:U9[g.status]||g.status})]}),v&&v.total_cost>0&&i.jsxs("div",{style:{marginTop:4,fontSize:12},children:[i.jsx(Ts,{style:{color:"#1677ff"},children:oT(v.total_cost)}),i.jsxs(Ts,{type:"secondary",style:{marginLeft:8},children:[v.total_items,""]}),v.unpriced_items>0&&i.jsxs(Ts,{type:"warning",style:{marginLeft:6},children:[v.unpriced_items,""]})]})]}),i.jsx(Mi,{type:"circle",percent:g.progress,size:36}),i.jsx(Oi,{style:{color:"#ccc",fontSize:12}})]},g.id)})})]})},q9=[{label:"pcs",value:"pcs"},{label:"set",value:"set"},{label:"kg",value:"kg"},{label:"m",value:"m"},{label:"roll",value:"roll"},{label:"pair",value:"pair"},{label:"lot",value:"lot"}],lT=({item:t,category:e,subCategory:n,config:s,onSave:o,onClose:l,bomType:d})=>{const u=!!t,[h,p]=P.useState(!1),[m,g]=P.useState(!1),[v,C]=P.useState([]),[b,_]=P.useState(()=>t?{name:t.name||"",item_number:t.item_number||"",quantity:t.quantity||1,unit:t.unit||"pcs",unit_price:t.unit_price||void 0,specification:t.specification||"",manufacturer:t.manufacturer||"",supplier:t.supplier||"",notes:t.notes||"",...t.extended_attrs||{}}:{name:"",item_number:"",quantity:1,unit:"pcs",unit_price:void 0,specification:"",manufacturer:"",supplier:"",notes:""}),y=P.useRef(null);P.useEffect(()=>{requestAnimationFrame(()=>p(!0))},[]),P.useEffect(()=>{Zt.listTemplates({sub_category:n}).then(E=>{C(d==="MBOM"?E.filter(R=>R.bom_type==="EBOM"||R.bom_type==="PBOM"):E.filter(R=>R.bom_type===d))}).catch(()=>{})},[n,d]);const S=()=>{p(!1),setTimeout(l,300)},D=(E,R)=>{_(M=>({...M,[E]:R}))},L=async()=>{if(!b.name?.trim()){me.warning("");return}g(!0);try{const E=["name","item_number","quantity","unit","unit_price","specification","manufacturer","supplier","notes"],R={},M={};for(const[z,V]of Object.entries(b))E.includes(z)?R[z]=V:M[z]=V;const I={...R,category:e,sub_category:n,extended_attrs:M};u&&t&&(I.id=t.id),o(I),S()}catch{me.error("")}finally{g(!1)}},N=(E,R,M="text",I)=>i.jsxs("div",{style:G9,children:[i.jsx("div",{style:$9,children:R}),M==="number"?i.jsx(en,{value:b[E],onChange:z=>D(E,z),style:{width:"100%",borderRadius:10},size:"large",placeholder:`${R}`}):M==="select"&&I?i.jsx(Xe,{value:b[E],onChange:z=>D(E,z),style:{width:"100%"},size:"large",options:I,placeholder:`${R}`}):M==="textarea"?i.jsx(Pe.TextArea,{value:b[E],onChange:z=>D(E,z.target.value),rows:3,style:{borderRadius:10},placeholder:`${R}`}):i.jsx(Pe,{value:b[E],onChange:z=>D(E,z.target.value),size:"large",style:{borderRadius:10},placeholder:`${R}`})]},E),T=E=>{const R=E.field_key,M=E.field_name;if(E.field_type==="number")return N(R,M+(E.unit?` (${E.unit})`:""),"number");if(E.field_type==="select"&&E.options){const I=Array.isArray(E.options)?E.options.map(z=>({label:String(z),value:String(z)})):Object.entries(E.options).map(([z,V])=>({label:String(V),value:z}));return N(R,M,"select",I)}return E.field_type==="boolean"?N(R,M,"select",[{label:"",value:"true"},{label:"",value:"false"}]):N(R,M,"text")},j=Yr[n]||n;return i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1100,background:"#fff",transform:h?"translateX(0)":"translateX(100%)",transition:"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 16px",borderBottom:"1px solid #f0f0f0",background:"#fff",position:"sticky",top:0,zIndex:1},children:[i.jsx(Ls,{onClick:S,style:{fontSize:18,cursor:"pointer",padding:4}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontSize:16,fontWeight:600},children:u?"":""}),i.jsx("div",{style:{fontSize:12,color:"#999"},children:j})]}),i.jsx(J,{type:"primary",onClick:L,loading:m,style:{borderRadius:8,fontWeight:500},children:""})]}),i.jsxs("div",{ref:y,style:{flex:1,overflow:"auto",padding:"16px",WebkitOverflowScrolling:"touch"},children:[i.jsxs("div",{style:gp,children:[i.jsx("div",{style:zy,children:""}),N("name",""),N("specification",""),i.jsxs("div",{style:{display:"flex",gap:12},children:[i.jsx("div",{style:{flex:1},children:N("quantity","","number")}),i.jsx("div",{style:{flex:1},children:N("unit","","select",q9)})]}),N("unit_price"," ()","number")]}),i.jsxs("div",{style:gp,children:[i.jsx("div",{style:zy,children:""}),N("manufacturer",""),N("supplier","")]}),v.length>0&&i.jsxs("div",{style:gp,children:[i.jsx("div",{style:zy,children:""}),v.sort((E,R)=>E.sort_order-R.sort_order).map(E=>T(E))]}),i.jsx("div",{style:gp,children:N("notes","","textarea")}),i.jsx("div",{style:{height:40}})]})]})},gp={marginBottom:20,background:"#fafafa",borderRadius:12,padding:"16px"},zy={fontSize:14,fontWeight:600,color:"#333",marginBottom:12},G9={marginBottom:14},$9={fontSize:13,color:"#666",marginBottom:6},{Text:Pr,Title:W9}=An,Y9={draft:{color:"default",text:""},pending_review:{color:"processing",text:""},published:{color:"green",text:""},released:{color:"green",text:""},rejected:{color:"red",text:""},frozen:{color:"purple",text:""},obsolete:{color:"default",text:""},editing:{color:"blue",text:""},ecn_pending:{color:"orange",text:"ECN"}},cT=["name","quantity","unit","supplier","unit_price","notes","item_number","category","sub_category","material_id","parent_item_id","level","is_alternative","thumbnail_url"],K9=()=>{const{projectId:t}=td(),[e]=Xp(),n=Ni(),s=Ln(),o=Tn(),[l,d]=P.useState(e.get("type")||"EBOM"),[u,h]=P.useState(null),[p,m]=P.useState(!1),[g,v]=P.useState(!1),[C,b]=P.useState(""),[_,y]=P.useState(!1),[S,D]=P.useState(""),[L]=ee.useForm(),[N,T]=P.useState(!1),[j,E]=P.useState(""),[R,M]=P.useState(!1),[I,z]=P.useState(null),[V,O]=P.useState(null),[k,F]=P.useState(null),[A,q]=P.useState([]),B=P.useRef([]),W=P.useRef(null),Q=P.useRef(!1),ne=P.useMemo(()=>["EBOM","PBOM","MBOM"],[]),de=P.useRef(null),$=P.useCallback(je=>{de.current={x:je.touches[0].clientX,y:je.touches[0].clientY}},[]),X=P.useCallback(je=>{if(!de.current)return;const He=je.changedTouches[0].clientX-de.current.x,dt=je.changedTouches[0].clientY-de.current.y;if(Math.abs(He)>50&&Math.abs(He)>Math.abs(dt)){const gt=ne.indexOf(l);He<0&&gt<ne.length-1&&d(ne[gt+1]),He>0&&gt>0&&d(ne[gt-1])}de.current=null},[l,ne]),{data:le}=ct({queryKey:["project",t],queryFn:()=>Ci.get(t),enabled:!!t}),{data:oe}=ct({queryKey:["bom-permissions",t],queryFn:()=>Zt.getBOMPermissions(t),enabled:!!t}),{data:ue=[],isLoading:Ye}=ct({queryKey:["project-boms",t],queryFn:()=>Zt.list(t),enabled:!!t}),ae=P.useMemo(()=>ue.filter(je=>je.bom_type===l&&je.status!=="obsolete"),[ue,l]);P.useEffect(()=>{ae.length>0&&!ae.find(je=>je.id===u)?h(ae[0].id):ae.length===0&&h(null)},[ae,u]);const{data:fe,isLoading:pt}=ct({queryKey:["project-bom-detail",t,u],queryFn:()=>Zt.get(t,u),enabled:!!t&&!!u}),_t=fe&&(fe.status==="draft"||fe.status==="rejected"||fe.status==="editing"),Se=fe&&(fe.status==="released"||fe.status==="frozen"),$e=fe&&fe.status==="editing",jt=fe&&fe.status==="ecn_pending",Fe=P.useCallback(je=>(je||[]).map(({material:He,children:dt,...gt})=>({...gt,...gt.extended_attrs||{},material_code:He?.code||""})),[]);P.useEffect(()=>{if(!fe?.items)return;const je=Fe(fe.items);B.current=je,q(je)},[fe,Fe]);const Dt=Rt({mutationFn:je=>Zt.create(t,je),onSuccess:je=>{me.success("BOM"),m(!1),L.resetFields(),s.invalidateQueries({queryKey:["project-boms",t]}),h(je.id)},onError:()=>me.error("")}),te=Rt({mutationFn:je=>Zt.reject(t,u,je),onSuccess:()=>{me.success(""),y(!1),D(""),s.invalidateQueries({queryKey:["project-bom-detail",t,u]})},onError:()=>me.error("")}),bt=Rt({mutationFn:je=>Zt.release(t,u,je),onSuccess:()=>{me.success(""),v(!1),b(""),s.invalidateQueries({queryKey:["project-bom-detail",t,u]}),s.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),It=Rt({mutationFn:()=>Zt.startEditing(t,u),onSuccess:()=>{me.success(""),s.invalidateQueries({queryKey:["project-bom-detail",t,u]}),M(!1)},onError:()=>me.error("")}),tt=Rt({mutationFn:()=>Zt.discardDraft(t,u),onSuccess:()=>{me.success(""),M(!1),z(null),s.invalidateQueries({queryKey:["project-bom-detail",t,u]})},onError:()=>me.error("")}),nt=Rt({mutationFn:je=>Zt.submitECN(t,u,{title:je}),onSuccess:()=>{me.success("ECN"),T(!1),E(""),M(!1),s.invalidateQueries({queryKey:["project-bom-detail",t,u]}),s.invalidateQueries({queryKey:["project-boms",t]})},onError:()=>me.error("")}),G=Rt({mutationFn:je=>wt.generatePOsFromBOM(je),onSuccess:je=>{me.success(` ${je.length} `)},onError:()=>me.error("")}),H=P.useCallback(je=>{q(je),$e&&M(!0)},[$e]);P.useEffect(()=>{if(!(!t||!u||!_t)&&!Q.current)return W.current&&clearTimeout(W.current),W.current=setTimeout(async()=>{if(!Q.current){Q.current=!0;try{const je=B.current,He=A,dt=new Set(je.map(it=>it.id)),gt=new Set(He.map(it=>it.id));if($e){JSON.stringify(He)!==JSON.stringify(je)&&(await Zt.saveDraft(t,u,{items:He}),z({items:He}),B.current=He),Q.current=!1;return}const We=[...dt].filter(it=>!gt.has(it));for(const it of We)await Zt.deleteItem(t,u,it);const qe=He.filter(it=>typeof it.id=="string"&&it.id.startsWith("new-")||!dt.has(it.id)),at={};for(const it of qe){const re=await Zt.addItem(t,u,{category:it.category,sub_category:it.sub_category,name:it.name||"",quantity:it.quantity??1,unit:it.unit||"pcs",item_number:it.item_number});at[it.id]=re.id}const ot=He.filter(it=>!(typeof it.id=="string"&&it.id.startsWith("new-"))&&dt.has(it.id));for(const it of ot){const re=je.find(ye=>ye.id===it.id);if(!re)continue;const rt={};let Ze=!1;for(const ye of cT)JSON.stringify(it[ye])!==JSON.stringify(re[ye])&&(rt[ye]=it[ye]??null,Ze=!0);const ht={};let Ke=!1;const Ue=re.extended_attrs||{},Je=Object.keys(it).filter(ye=>!cT.includes(ye)&&!["id","bom_id","created_at","updated_at","extended_cost","material_code","material","children","extended_attrs"].includes(ye));for(const ye of Je)JSON.stringify(it[ye])!==JSON.stringify(re[ye])&&JSON.stringify(it[ye])!==JSON.stringify(Ue[ye])&&(ht[ye]=it[ye],Ke=!0);Ke&&(rt.extended_attrs=ht,Ze=!0),Ze&&await Zt.updateItem(t,u,it.id,rt)}const st=He.map(it=>at[it.id]?{...it,id:at[it.id]}:it);B.current=st,Object.keys(at).length>0&&q(st)}catch{me.error(""),s.invalidateQueries({queryKey:["project-bom-detail",t,u]})}finally{Q.current=!1}}},1500),()=>{W.current&&clearTimeout(W.current)}},[A,t,u,_t,$e,s,me]);const ie=P.useCallback(je=>{!o||!_t||O(je)},[o,_t]),we=P.useCallback((je,He)=>{o&&F({category:je,subCategory:He})},[o]),Ce=P.useCallback(async je=>{if(!(!t||!u)){try{if(je.id){const{id:He,category:dt,sub_category:gt,...We}=je;await Zt.updateItem(t,u,He,We),me.success("")}else await Zt.addItem(t,u,je),me.success("");s.invalidateQueries({queryKey:["project-bom-detail",t,u]})}catch{me.error("")}O(null),F(null)}},[t,u,s]),ge=P.useMemo(()=>({bom_type:l,visible_categories:[],category_config:{}}),[l]);return t?i.jsxs("div",{style:{padding:o?12:24},children:[i.jsxs("div",{style:{marginBottom:o?12:16},children:[i.jsx(J,{type:"link",icon:i.jsx(Ls,{}),onClick:()=>n("/bom-management"),style:{padding:0,marginBottom:8},children:""}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(W9,{level:o?5:4,style:{margin:0},children:le?.name||"..."}),le?.code&&i.jsx(Pr,{code:!0,style:{fontSize:12},children:le.code})]})]}),i.jsx(Ol,{activeKey:l,onChange:je=>d(je),size:o?"small":void 0,items:[{key:"EBOM",label:o?"EBOM":"EBOM BOM"},{key:"PBOM",label:o?"PBOM":"PBOM BOM"},{key:"MBOM",label:o?"MBOM":"MBOM BOM"}],style:{marginBottom:8}}),ae.length>1&&i.jsx("div",{style:{marginBottom:12},children:i.jsx(Xe,{value:u||void 0,onChange:h,style:{width:o?"100%":300},placeholder:"BOM",loading:Ye,options:ae.map(je=>({label:`${je.bom_type} ${je.version||""} - ${Y9[je.status]?.text||je.status}`,value:je.id}))})}),fe&&i.jsxs("div",{style:{marginBottom:16,display:"flex",gap:8,alignItems:"center"},children:[Se&&i.jsx(J,{type:"primary",onClick:()=>It.mutate(),loading:It.isPending,children:""}),$e&&i.jsxs(i.Fragment,{children:[i.jsx(J,{onClick:()=>{Nt.confirm({title:"",content:"",onOk:()=>tt.mutate()})},loading:tt.isPending,children:""}),i.jsx(J,{type:"primary",disabled:!R,onClick:()=>T(!0),children:"ECN"})]}),jt&&i.jsx(Pr,{type:"warning",strong:!0,children:" ECNBOM"})]}),(Ye||pt)&&!fe&&i.jsx("div",{style:{textAlign:"center",padding:60},children:i.jsx(tn,{})}),!Ye&&ae.length===0&&i.jsx(ft,{description:`${l}`,style:{padding:60}}),fe&&i.jsxs("div",{onTouchStart:o?$:void 0,onTouchEnd:o?X:void 0,children:[l==="EBOM"&&i.jsx(sf,{config:ge,value:A,onChange:H,readonly:!_t,showMaterialCode:!0,editableCategories:_t?oe?.can_edit_categories:void 0,onItemClick:o&&_t?ie:void 0,onMobileAddRow:o&&_t?we:void 0}),l==="PBOM"&&i.jsx(rf,{config:ge,value:A,onChange:H,readonly:!_t,showMaterialCode:!0,editableCategories:_t?oe?.can_edit_categories:void 0,onItemClick:o&&_t?ie:void 0,onMobileAddRow:o&&_t?we:void 0}),l==="MBOM"&&i.jsx(of,{config:ge,value:A,onChange:H,readonly:!_t,showMaterialCode:!0,editableCategories:_t?oe?.can_edit_categories:void 0,onItemClick:o?ie:void 0})]}),fe&&A.length>0&&(()=>{const je=A.filter(qe=>qe.unit_price!=null&&qe.unit_price>0),He=A.reduce((qe,at)=>{const ot=at.extended_cost??(at.quantity||0)*(at.unit_price||0);return qe+(ot||0)},0),dt=A.length-je.length,gt=je.length>0?je.reduce((qe,at)=>qe+(at.unit_price||0),0)/je.length:0,We=qe=>qe>0?`${qe.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-";return i.jsxs("div",{style:{display:"flex",gap:16,padding:"10px 16px",background:"#f6ffed",borderRadius:6,border:"1px solid #b7eb8f",flexWrap:"wrap",marginTop:12,alignItems:"center"},children:[i.jsxs(Pr,{style:{fontSize:13},children:[l,": ",i.jsx(Pr,{strong:!0,style:{color:"#1677ff",fontSize:15},children:We(He)})]}),i.jsxs(Pr,{type:"secondary",style:{fontSize:12},children:[" ",A.length," "]}),gt>0&&i.jsxs(Pr,{type:"secondary",style:{fontSize:12},children:[": ",We(gt)]}),dt>0&&i.jsxs(Pr,{type:"warning",style:{fontSize:12},children:[dt,""]}),u&&A.length>0&&i.jsx(J,{size:"small",type:"primary",style:{marginLeft:"auto"},loading:G.isPending,onClick:()=>{const qe=A.map(at=>at.id).filter(Boolean);if(qe.length===0){me.warning("");return}Nt.confirm({title:"",content:` ${qe.length} BOM`,onOk:()=>G.mutate({bom_id:u,item_ids:qe})})},children:""})]})})(),i.jsx(Nt,{title:"BOM",open:p,onCancel:()=>{m(!1),L.resetFields()},onOk:()=>L.submit(),confirmLoading:Dt.isPending,children:i.jsxs(ee,{form:L,layout:"vertical",onFinish:je=>Dt.mutate({...je,name:je.bom_type}),children:[i.jsx(ee.Item,{name:"bom_type",label:"BOM",initialValue:l,rules:[{required:!0}],children:i.jsx(Xe,{options:[{label:"EBOM - BOM",value:"EBOM"},{label:"PBOM - BOM",value:"PBOM"},{label:"MBOM - BOM",value:"MBOM"}]})}),i.jsx(ee.Item,{name:"description",label:"",children:i.jsx(Pe.TextArea,{rows:3,placeholder:"BOM"})})]})}),i.jsxs(Nt,{title:` ${fe?.bom_type||""}`,open:g,onCancel:()=>{v(!1),b("")},onOk:()=>bt.mutate(C),confirmLoading:bt.isPending,okText:"",children:[i.jsx(Pr,{type:"secondary",children:"BOM"}),i.jsx(Pe.TextArea,{rows:3,placeholder:"...",value:C,onChange:je=>b(je.target.value),style:{marginTop:12}})]}),i.jsx(Nt,{title:"BOM",open:_,onCancel:()=>{y(!1),D("")},onOk:()=>te.mutate(S),confirmLoading:te.isPending,okText:"",okButtonProps:{danger:!0},children:i.jsx(Pe.TextArea,{rows:4,placeholder:"...",value:S,onChange:je=>D(je.target.value)})}),i.jsxs(Nt,{title:"ECN",open:N,onCancel:()=>{T(!1),E("")},onOk:()=>nt.mutate(j),confirmLoading:nt.isPending,okText:"",children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx(Pr,{type:"secondary",children:"ECNBOM"})}),i.jsx(Pe,{placeholder:"ECN",value:j,onChange:je=>E(je.target.value),maxLength:100})]}),o&&V&&i.jsx(lT,{item:V,category:V.category||"",subCategory:V.sub_category||"",config:ge,bomType:l,onSave:Ce,onClose:()=>O(null)}),o&&k&&i.jsx(lT,{category:k.category,subCategory:k.subCategory,config:ge,bomType:l,onSave:Ce,onClose:()=>F(null)})]}):null},ky={list:async t=>{const e=new URLSearchParams;t?.bom_id&&e.set("bom_id",t.bom_id),t?.status&&e.set("status",t.status);const n=e.toString();return(await Z.get(`/bom-ecn${n?`?${n}`:""}`)).data.data},get:async t=>(await Z.get(`/bom-ecn/${t}`)).data.data,approve:async t=>(await Z.post(`/bom-ecn/${t}/approve`)).data.data,reject:async(t,e)=>(await Z.post(`/bom-ecn/${t}/reject`,e)).data.data},{Text:Su,Title:dT}=An,xp={pending:{color:"processing",text:""},approved:{color:"success",text:""},rejected:{color:"error",text:""}},X9=()=>{const t=Ln(),[e,n]=P.useState(""),[s,o]=P.useState(!1),[l,d]=P.useState(null),[u,h]=P.useState(!1),[p,m]=P.useState(""),{data:g,isLoading:v}=ct({queryKey:["bom-ecns",e],queryFn:()=>ky.list({status:e||void 0})}),C=g?.items||[],b=Rt({mutationFn:T=>ky.approve(T),onSuccess:()=>{me.success("ECN"),t.invalidateQueries({queryKey:["bom-ecns"]}),o(!1),d(null)},onError:()=>me.error("")}),_=Rt({mutationFn:({id:T,note:j})=>ky.reject(T,{note:j}),onSuccess:()=>{me.success("ECN"),t.invalidateQueries({queryKey:["bom-ecns"]}),h(!1),m(""),o(!1),d(null)},onError:()=>me.error("")}),y=T=>{d(T),o(!0)},S=()=>{l&&Nt.confirm({title:"ECN",content:"BOM",onOk:()=>b.mutate(l.id)})},D=()=>{h(!0)},L=[{title:"ECN",dataIndex:"ecn_number",key:"ecn_number",width:150,render:T=>i.jsx(Su,{code:!0,children:T})},{title:"",dataIndex:"title",key:"title",ellipsis:!0},{title:"BOM",dataIndex:["bom","name"],key:"bom_name",render:(T,j)=>j.bom?.name||j.bom_id},{title:"",dataIndex:"status",key:"status",width:100,render:T=>i.jsx(_e,{color:xp[T]?.color,children:xp[T]?.text||T})},{title:"",dataIndex:["creator","name"],key:"creator",width:100},{title:"",dataIndex:"created_at",key:"created_at",width:180,render:T=>new Date(T).toLocaleString("zh-CN")},{title:"",key:"action",width:100,fixed:"right",render:(T,j)=>i.jsx(J,{type:"link",size:"small",icon:i.jsx(rr,{}),onClick:()=>y(j),children:""})}],N=T=>{const{added:j=[],removed:E=[],modified:R=[]}=T;return i.jsxs("div",{style:{marginTop:16},children:[i.jsx(dT,{level:5,children:""}),j.length>0&&i.jsx(Ur,{message:` ${j.length} `,type:"success",showIcon:!0,style:{marginBottom:8}}),E.length>0&&i.jsx(Ur,{message:` ${E.length} `,type:"error",showIcon:!0,style:{marginBottom:8}}),R.length>0&&i.jsx(Ur,{message:` ${R.length} `,type:"warning",showIcon:!0,style:{marginBottom:8}}),R.length>0&&i.jsxs("div",{style:{marginTop:12},children:[i.jsx(Su,{strong:!0,children:""}),R.slice(0,5).map((M,I)=>i.jsx("div",{style:{marginTop:8,paddingLeft:16},children:i.jsxs(Su,{type:"secondary",children:[" ",M.changes?.join(", ")]})},I))]})]})};return i.jsxs("div",{style:{padding:24},children:[i.jsxs(Mt,{children:[i.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(dT,{level:4,style:{margin:0},children:"ECN"}),i.jsx(Xe,{placeholder:"",allowClear:!0,style:{width:150},value:e||void 0,onChange:T=>n(T||""),options:[{label:"",value:"pending"},{label:"",value:"approved"},{label:"",value:"rejected"}]})]}),i.jsx(sn,{columns:L,dataSource:C,loading:v,rowKey:"id",pagination:{pageSize:20}})]}),i.jsx(Nt,{title:l?.ecn_number,open:s,onCancel:()=>{o(!1),d(null)},width:800,footer:l?.status==="pending"?i.jsxs(Be,{children:[i.jsx(J,{onClick:()=>o(!1),children:""}),i.jsx(J,{danger:!0,icon:i.jsx($r,{}),onClick:D,children:""}),i.jsx(J,{type:"primary",icon:i.jsx(ra,{}),onClick:S,loading:b.isPending,children:""})]}):i.jsx(J,{onClick:()=>o(!1),children:""}),children:l&&i.jsxs(i.Fragment,{children:[i.jsxs(pe,{column:2,bordered:!0,size:"small",children:[i.jsx(pe.Item,{label:"ECN",span:2,children:i.jsx(Su,{code:!0,children:l.ecn_number})}),i.jsx(pe.Item,{label:"",span:2,children:l.title}),i.jsx(pe.Item,{label:"",span:2,children:l.description||"-"}),i.jsx(pe.Item,{label:"",children:i.jsx(_e,{color:xp[l.status]?.color,children:xp[l.status]?.text})}),i.jsx(pe.Item,{label:"",children:l.creator?.name||"-"}),i.jsx(pe.Item,{label:"",children:new Date(l.created_at).toLocaleString("zh-CN")}),l.approved_at&&i.jsxs(i.Fragment,{children:[i.jsx(pe.Item,{label:"",children:l.approver?.name||"-"}),i.jsx(pe.Item,{label:"",children:new Date(l.approved_at).toLocaleString("zh-CN")})]}),l.rejected_at&&i.jsxs(i.Fragment,{children:[i.jsx(pe.Item,{label:"",children:l.rejecter?.name||"-"}),i.jsx(pe.Item,{label:"",children:new Date(l.rejected_at).toLocaleString("zh-CN")}),i.jsx(pe.Item,{label:"",span:2,children:l.rejection_note||"-"})]})]}),N(l.change_summary)]})}),i.jsxs(Nt,{title:"ECN",open:u,onCancel:()=>{h(!1),m("")},onOk:()=>{l&&_.mutate({id:l.id,note:p})},confirmLoading:_.isPending,okText:"",okButtonProps:{danger:!0},children:[i.jsx(Su,{type:"secondary",style:{display:"block",marginBottom:12},children:""}),i.jsx(Pe.TextArea,{rows:4,placeholder:"...",value:p,onChange:T=>m(T.target.value)})]})]})},{Text:Hn}=An,uT=[{label:"",value:""},{label:"",value:"electronic"},{label:"",value:"structural"},{label:"",value:"optical"},{label:"",value:"packaging"},{label:"",value:"tooling"},{label:"",value:"consumable"}],fT={electronic:"blue",structural:"green",optical:"orange",packaging:"gold",tooling:"purple",consumable:"cyan"},yp=t=>t==null||isNaN(t)?"-":`${t.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,Q9=()=>{const t=Ni(),e=Tn(),[n,s]=P.useState(""),[o,l]=P.useState(""),[d,u]=P.useState(""),[h,p]=P.useState(""),[m,g]=P.useState(""),[v,C]=P.useState(1),[b,_]=P.useState(20),{data:y}=ct({queryKey:["projects-filter"],queryFn:()=>Ci.list({page_size:200}),staleTime:6e4}),S=P.useMemo(()=>{const V=y?.items||[];return[{label:"",value:""},...V.map(O=>({label:O.name,value:O.id}))]},[y]),{data:D}=ct({queryKey:["suppliers-filter"],queryFn:()=>wt.listSuppliers({page_size:200}),staleTime:6e4}),L=P.useMemo(()=>{const V=D?.items||[];return[{label:"",value:""},...V.map(O=>({label:O.short_name||O.name,value:O.id}))]},[D]),N=P.useMemo(()=>{const O=(D?.items||[]).filter(k=>k.category==="manufacturer"||k.category==="both");return[{label:"",value:""},...O.map(k=>({label:k.short_name||k.name,value:k.id}))]},[D]),{data:T,isLoading:j}=ct({queryKey:["material-global-search",n,o,d,h,m,v,b],queryFn:()=>Zt.globalSearch({q:n||void 0,category:o||void 0,project_id:d||void 0,supplier_id:h||void 0,manufacturer_id:m||void 0,page:v,page_size:b}),staleTime:1e4}),E=T?.data||[],R=T?.total||0,M=P.useMemo(()=>{let V=0,O=0;for(const k of E){const F=k.unit_price;F==null||F===0?O++:V+=(k.quantity||0)*F}return{totalCost:V,unpriced:O,count:E.length}},[E]),I=[{title:"",dataIndex:"name",key:"name",width:160,ellipsis:!0,render:V=>i.jsx(Hn,{strong:!0,style:{fontSize:13},children:V||"-"})},{title:"",dataIndex:"category",key:"category",width:80,render:V=>V?i.jsx(_e,{color:fT[V]||"default",style:{fontSize:11},children:tr[V]||V}):"-"},{title:"",dataIndex:"sub_category",key:"sub_category",width:90,render:V=>i.jsx(Hn,{style:{fontSize:12},children:Yr[V]||V||"-"})},{title:"MPN",dataIndex:"mpn",key:"mpn",width:130,ellipsis:!0,render:V=>V?i.jsx(Hn,{code:!0,style:{fontSize:11},children:V}):i.jsx(Hn,{type:"secondary",style:{fontSize:11},children:"-"})},{title:"",key:"manufacturer_name",width:100,ellipsis:!0,render:(V,O)=>{const k=O.manufacturer_name||O.extended_attrs?.manufacturer||"";return k?i.jsx(Hn,{style:{fontSize:12},children:k}):i.jsx(Hn,{type:"secondary",style:{fontSize:11},children:"-"})}},{title:"",key:"supplier_display",width:100,ellipsis:!0,render:(V,O)=>{const k=O.supplier_name||O.supplier||"";return k?i.jsx(Hn,{style:{fontSize:12},children:k}):i.jsx(Hn,{type:"secondary",style:{fontSize:11},children:"-"})}},{title:"",dataIndex:"quantity",key:"quantity",width:70,align:"right",render:(V,O)=>i.jsxs(Hn,{style:{fontSize:12},children:[V," ",O.unit||""]})},{title:"",dataIndex:"unit_price",key:"unit_price",width:90,align:"right",render:V=>V?i.jsx(Hn,{style:{fontSize:12},children:yp(V)}):i.jsx(Hn,{type:"secondary",style:{fontSize:11},children:"-"})},{title:"BOM",key:"bom_info",width:110,ellipsis:!0,render:(V,O)=>i.jsxs("span",{style:{fontSize:12},children:[O.bom_type&&i.jsx(_e,{style:{fontSize:10,marginRight:4},children:O.bom_type}),O.bom_name||"-"]})},{title:"",dataIndex:"project_name",key:"project_name",width:130,ellipsis:!0,render:(V,O)=>V?i.jsx("a",{onClick:()=>O.project_id&&t(`/bom-management/${O.project_id}`),style:{fontSize:12},children:V}):i.jsx(Hn,{type:"secondary",style:{fontSize:11},children:"-"})}],z=()=>{s(""),l(""),u(""),p(""),g(""),C(1)};return e?i.jsxs("div",{style:{padding:12},children:[i.jsx(Pe,{prefix:i.jsx(gi,{}),placeholder:"MPN...",value:n,onChange:V=>{s(V.target.value),C(1)},allowClear:!0,style:{marginBottom:8}}),i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8,flexWrap:"wrap"},children:[i.jsx(Xe,{value:o,onChange:V=>{l(V),C(1)},options:uT,style:{flex:1,minWidth:100},size:"small"}),i.jsx(Xe,{value:d,onChange:V=>{u(V),C(1)},options:S,style:{flex:1,minWidth:100},size:"small",showSearch:!0,optionFilterProp:"label"})]}),E.length>0&&i.jsxs("div",{style:{padding:"8px 12px",background:"#f6ffed",borderRadius:6,marginBottom:12,fontSize:12},children:[i.jsxs(Hn,{children:[" ",R," "]}),M.totalCost>0&&i.jsxs(Hn,{style:{marginLeft:12},children:[": ",i.jsx(Hn,{strong:!0,style:{color:"#1677ff"},children:yp(M.totalCost)})]}),M.unpriced>0&&i.jsxs(Hn,{type:"warning",style:{marginLeft:8},children:[M.unpriced,""]})]}),E.map(V=>i.jsxs(Mt,{size:"small",style:{marginBottom:8},onClick:()=>V.project_id&&t(`/bom-management/${V.project_id}`),children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx(Hn,{strong:!0,style:{fontSize:13},children:V.name}),i.jsx(_e,{color:fT[V.category]||"default",style:{fontSize:10},children:tr[V.category]||V.category})]}),i.jsxs("div",{style:{marginTop:4,fontSize:12,color:"#666"},children:[V.mpn&&i.jsx(Hn,{code:!0,style:{fontSize:11,marginRight:8},children:V.mpn}),(V.supplier_name||V.supplier)&&i.jsxs(Hn,{style:{marginRight:8},children:[": ",V.supplier_name||V.supplier]}),i.jsxs(Hn,{children:[": ",V.quantity," ",V.unit]}),V.unit_price>0&&i.jsxs(Hn,{style:{marginLeft:8},children:[": ",yp(V.unit_price)]})]}),V.project_name&&i.jsxs("div",{style:{marginTop:4},children:[i.jsx(_e,{style:{fontSize:10},children:V.bom_type}),i.jsx(Hn,{type:"secondary",style:{fontSize:11},children:V.project_name})]})]},V.id)),!j&&E.length===0&&i.jsx("div",{style:{textAlign:"center",padding:40,color:"#999"},children:n?"":""})]}):i.jsxs("div",{children:[i.jsx(Mt,{size:"small",style:{marginBottom:16},children:i.jsxs(Be,{wrap:!0,size:"middle",children:[i.jsx(Pe,{prefix:i.jsx(gi,{}),placeholder:"MPN...",value:n,onChange:V=>{s(V.target.value),C(1)},allowClear:!0,style:{width:320}}),i.jsx(Xe,{value:o,onChange:V=>{l(V),C(1)},options:uT,style:{width:130}}),i.jsx(Xe,{value:d,onChange:V=>{u(V),C(1)},options:S,style:{width:180},showSearch:!0,optionFilterProp:"label",placeholder:""}),i.jsx(Xe,{value:h,onChange:V=>{p(V),C(1)},options:L,style:{width:160},showSearch:!0,optionFilterProp:"label",placeholder:""}),i.jsx(Xe,{value:m,onChange:V=>{g(V),C(1)},options:N,style:{width:160},showSearch:!0,optionFilterProp:"label",placeholder:""}),(n||o||d||h||m)&&i.jsxs("a",{onClick:z,style:{fontSize:12},children:[i.jsx(Ka,{})," "]})]})}),E.length>0&&i.jsxs("div",{style:{display:"flex",gap:24,padding:"8px 16px",background:"#fafafa",borderRadius:6,border:"1px solid #f0f0f0",marginBottom:12,alignItems:"center"},children:[i.jsxs(Hn,{style:{fontSize:13},children:[" ",i.jsx(Hn,{strong:!0,children:R})," "]}),M.totalCost>0&&i.jsxs(Hn,{style:{fontSize:13},children:[": ",i.jsx(Hn,{strong:!0,style:{color:"#1677ff"},children:yp(M.totalCost)})]}),M.unpriced>0&&i.jsxs(Hn,{type:"warning",style:{fontSize:12},children:[M.unpriced,""]})]}),i.jsx(sn,{dataSource:E,columns:I,rowKey:"id",loading:j,size:"small",scroll:{x:1300},pagination:{current:v,pageSize:b,total:R,showSizeChanger:!0,showQuickJumper:!0,showTotal:V=>` ${V} `,onChange:(V,O)=>{C(V),_(O)}}})]})},Z9=({children:t})=>{const{isAuthenticated:e,isLoading:n}=sd();return n?null:e?i.jsx(i.Fragment,{children:t}):i.jsx(By,{to:"/login",replace:!0})},J9=yR([{path:"/login",element:i.jsx(Mz,{})},{path:"/",element:i.jsx(Z9,{children:i.jsx(bz,{})}),children:[{index:!0,element:i.jsx(By,{to:"/dashboard",replace:!0})},{path:"dashboard",element:i.jsx(jz,{})},{path:"projects",element:i.jsx(Bz,{})},{path:"projects/:id",element:i.jsx(Mk,{})},{path:"material-search",element:i.jsx(Q9,{})},{path:"materials",element:i.jsx(Ck,{})},{path:"templates",element:i.jsx(Ez,{})},{path:"templates/:id",element:i.jsx(Fz,{})},{path:"approvals",element:i.jsx(Rk,{})},{path:"approval-admin",element:i.jsx(zk,{})},{path:"approval-editor/:id",element:i.jsx(Bk,{})},{path:"my-tasks",element:i.jsx(kH,{})},{path:"roles",element:i.jsx(HH,{})},{path:"__my__",element:i.jsx(i.Fragment,{})},{path:"bom-management",element:i.jsx(V9,{})},{path:"bom-management/:projectId",element:i.jsx(K9,{})},{path:"bom-ecn",element:i.jsx(X9,{})},{path:"documents",element:i.jsx(Ek,{})},{path:"ecn",element:i.jsx(Tk,{})},{path:"ecn/new",element:i.jsx(rT,{})},{path:"ecn/:id",element:i.jsx(N9,{})},{path:"ecn/:id/edit",element:i.jsx(rT,{})},{path:"srm",element:i.jsx(GH,{})},{path:"srm/suppliers",element:i.jsx(XH,{})},{path:"srm/purchase-requests",element:i.jsx(e9,{})},{path:"srm/purchase-orders",element:i.jsx(n9,{})},{path:"srm/inspections",element:i.jsx(a9,{})},{path:"srm/projects",element:i.jsx(f9,{})},{path:"srm/kanban",element:i.jsx(p9,{})},{path:"srm/settlements",element:i.jsx(_9,{})},{path:"srm/corrective-actions",element:i.jsx(b9,{})},{path:"srm/evaluations",element:i.jsx(w9,{})},{path:"srm/projects/:id",element:i.jsx(C9,{})},{path:"srm/inventory",element:i.jsx(R9,{})},{path:"srm/equipment",element:i.jsx(T9,{})}]},{path:"*",element:i.jsx(By,{to:"/dashboard",replace:!0})}]);lt.locale("zh-cn");const eV=new Y3({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!0,staleTime:0}}}),tV=()=>i.jsx(Qi,{locale:yD,theme:{token:{colorPrimary:"#1890ff",borderRadius:6}},children:i.jsx(Ya,{children:i.jsx(K3,{client:eV,children:i.jsx(ZI,{children:i.jsx(vR,{router:J9})})})})});w3.createRoot(document.getElementById("root")).render(i.jsx(P.StrictMode,{children:i.jsx(tV,{})}));
