# 07 - SRM 库存与结算

> 版本: v1.0 | 日期: 2026-02-19 | 编制: PM Agent
> 涵盖：库存管理、对账结算

---

## 一、功能概述

### 1.1 已实现功能

| 功能 | 状态 | 页面 |
|------|------|------|
| 库存管理 | ✅ 已实现 | /srm/inventory |
| 对账结算 | ✅ 已实现 | /srm/settlements |

---

## 二、库存管理

### 2.1 功能说明

管理来料检验通过后的物料入库、出库、库存查询。

### 2.2 入库来源

| 来源 | 触发条件 |
|------|---------|
| 采购入库 | 来料检验通过后 |
| 退货入库 | 生产退料 |

### 2.3 出库类型

| 类型 | 说明 |
|------|------|
| 生产领料 | 打样/量产用料 |
| 报废出库 | 物料报废 |

### 2.4 库存预警（规划中）

| 预警类型 | 触发条件 | 通知对象 |
|---------|---------|---------|
| 低库存预警 | 可用库存 < 安全库存 | 采购负责人 |
| 呆滞预警 | 超过90天无出库 | 仓库负责人 |

---

## 三、对账结算

### 3.1 核心理念

**三单匹配**贯穿系统：PO(买了什么) + GR(收了多少) + Settlement(结多少钱)

### 3.2 对账流程

```
采购订单(PO) + 收货记录(GR)
    ↓
系统自动匹配：PO金额 vs 实际收货金额
    ↓
生成对账清单
    ↓
采购员确认 → 结算
```

### 3.3 对账状态

| 状态 | 说明 |
|------|------|
| PENDING | 待对账 |
| CONFIRMED | 已确认 |
| SETTLED | 已结算 |
| DISPUTED | 有争议 |

---

## 四、API接口汇总

### 4.1 库存接口

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/v1/srm/inventory | 库存查询 |
| POST | /api/v1/srm/inventory/inbound | 入库 |
| POST | /api/v1/srm/inventory/outbound | 出库 |

### 4.2 结算接口

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/v1/srm/settlements | 结算列表 |
| POST | /api/v1/srm/settlements | 创建结算单 |
| PUT | /api/v1/srm/settlements/:id | 更新结算状态 |
| POST | /api/v1/srm/settlements/:id/confirm | 确认对账 |

---

## 五、规划中功能

| 功能 | 优先级 | 说明 |
|------|--------|------|
| 自动对账（三单匹配） | P2 | PO+GR自动生成对账清单 |
| 库存预警 | P2 | 低库存/呆滞预警 + 飞书通知 |
| 结算推送ERP | P3 | 结算数据推送财务系统 |
| 批次管理 | P3 | 批次号追溯 |

---

*本文档基于已有SRM前端页面（Inventory.tsx, Settlements）整理。当前库存和结算为基础CRUD，详细业务逻辑待后续迭代增强。*
