# 00 - 产品总览与系统架构

> 版本: v1.0 | 日期: 2026-02-19 | 编制: PM Agent
> 本文档为 nimo PLM+SRM 统一PRD体系的总纲

---

## 一、产品定位

### 1.1 公司背景

**Bitfantasy（比特幻境）** 是一家智能眼镜终端消费品牌，产品为带近视功能的AI智能眼镜 **nimo**。

产品模式：**平台+镜框**快速迭代
- **镜腿平台**：包含MicroLED芯片、光机、波导镜片、电子部分、电池、铰链等核心组件
- **镜框迭代**：在平台基础上快速迭代不同外观的镜框
- 年产出能力：几十甚至上百个不同SKU

### 1.2 系统定位

**nimo PLM/SRM** 是 Bitfantasy 的内部产品全生命周期管理 + 供应链管理系统，覆盖从产品立项到量产采购的全链路。

```
┌─────────────────────────────────────────────────────┐
│                  nimo PLM/SRM 系统                    │
│                                                       │
│   PLM（产品数据中心）          SRM（供应链管理中心）     │
│   ├── 项目管理                 ├── 供应商管理            │
│   ├── BOM管理                  ├── 采购项目管理          │
│   ├── ECN变更管理              ├── 采购需求/订单         │
│   ├── 物料选型库               ├── 来料检验              │
│   ├── 文档管理                 ├── 库存管理              │
│   ├── 流程/审批管理            ├── 对账结算              │
│   └── 角色管理                 ├── 8D改进               │
│                                ├── 供应商评价            │
│                                └── 通用设备              │
└─────────────────────────────────────────────────────┘
```

### 1.3 系统边界

**PLM负责：**
- 产品数据管理（PDM）：产品信息、物料、BOM
- 项目任务管理：四阶段（EVT→DVT→PVT→MP）+ 甘特图
- 工程变更管理（ECN）
- 文档管理
- CMF配色管理
- 流程模板与审批

**SRM负责：**
- 供应商全生命周期管理
- 采购项目化管理（与PLM BOM审批联动）
- 采购需求/订单/来料检验
- 多轮打样管理
- 库存管理
- 对账结算
- 质量改进（8D）

**不在当前系统范围内（未来ERP扩展）：**
- 生产执行（MES）
- 销售订单管理
- 售后管理
- 财务核算

---

## 二、用户角色

### 2.1 角色定义

| 角色代码 | 角色名称 | 说明 |
|---------|---------|------|
| ADMIN | 系统管理员 | 系统配置、权限管理 |
| PM | 项目经理 | 项目管理、阶段评审、任务确认 |
| HW_LEAD | 硬件负责人 | 硬件设计审批、BOM审核 |
| HW_ENG | 硬件工程师 | 硬件设计、电子BOM编辑 |
| ME_ENG | 结构工程师 | 结构设计、结构BOM编辑 |
| ID_ENG | 工业设计师 | 外观设计、CMF定义 |
| OPT_ENG | 光学工程师 | 光学设计 |
| QA_ENG | 质量工程师 | 来料检验、质量分析 |
| PROC_LEAD | 采购负责人 | 采购审批、供应商管理 |
| PROC | 采购员 | 日常采购、询价、跟单 |
| VIEWER | 只读用户 | 查看产品信息 |

### 2.2 认证方式

- **飞书SSO**：通过飞书OAuth 2.0单点登录
- **JWT Token**：登录后签发JWT，有效期24小时
- 系统不维护独立用户表，完全依赖飞书身份

---

## 三、已实现功能全景

### 3.1 PLM模块（12个页面，全部已上线 ✅）

| 路由 | 功能 | 状态 |
|------|------|------|
| /dashboard | 工作台 | ✅ 已实现 |
| /my-tasks | 我的任务 | ✅ 已实现 |
| /projects | 项目管理 | ✅ 已实现 |
| /projects/:id | 项目详情（任务/BOM/CMF/文档） | ✅ 已实现 |
| /bom-management | BOM管理 | ✅ 已实现 |
| /bom-management/:projectId | BOM详情 | ✅ 已实现 |
| /ecn | ECN变更管理 | ✅ 已实现 |
| /materials | 物料选型库 | ✅ 已实现 |
| /templates | 流程管理 | ✅ 已实现 |
| /approvals | 审批管理 | ✅ 已实现 |
| /documents | 文档管理 | ✅ 已实现 |
| /roles | 角色管理 | ✅ 已实现 |

### 3.2 SRM模块（10个页面，全部已上线 ✅）

| 路由 | 功能 | 状态 |
|------|------|------|
| /srm | 采购总览 | ✅ 已实现 |
| /srm/suppliers | 供应商管理 | ✅ 已实现 |
| /srm/purchase-requests | 采购需求 | ✅ 已实现 |
| /srm/purchase-orders | 采购订单 | ✅ 已实现 |
| /srm/inspections | 来料检验 | ✅ 已实现 |
| /srm/inventory | 库存管理 | ✅ 已实现 |
| /srm/settlements | 对账结算 | ✅ 已实现 |
| /srm/corrective-actions | 8D改进 | ✅ 已实现 |
| /srm/evaluations | 供应商评价 | ✅ 已实现 |
| /srm/equipment | 通用设备 | ✅ 已实现 |

---

## 四、技术架构

### 4.1 技术栈

| 层级 | 技术 | 说明 |
|-----|------|------|
| 前端 | React 18 + TypeScript + Ant Design 5 + Vite | 单页应用，嵌入Go二进制 |
| 后端 | Go（Gin + GORM） | 单体架构，模块化设计 |
| 数据库 | PostgreSQL 16 | 主数据库 |
| 认证 | 飞书OAuth 2.0 + JWT | 统一身份 |
| 部署 | 单二进制 + systemd | 腾讯云 43.134.86.237:8080 |

### 4.2 代码结构

```
nimo-plm/
├── cmd/server/main.go              # 统一入口
├── internal/plm/
│   ├── entity/                      # 数据模型（30+实体）
│   ├── handler/                     # HTTP处理器（30+handler）
│   ├── service/                     # 业务逻辑
│   └── repository/                  # 数据访问
├── nimo-plm-web/src/                # 前端
│   ├── pages/                       # 页面组件（PLM + SRM）
│   ├── api/                         # API调用层（25+模块）
│   ├── types/index.ts               # TypeScript类型定义
│   └── routes/index.tsx             # 路由定义
└── docs/prd/                        # 本PRD文档体系
```

### 4.3 架构决策

| 决策 | 选择 | 理由 |
|------|------|------|
| 服务架构 | 单体Go服务 | 20人团队，单一二进制部署，运维简单 |
| PLM+SRM集成 | 同一进程，内部Service调用 | 零延迟数据共享，物料/BOM/供应商天然打通 |
| 前端方案 | 内嵌SPA | 编译后嵌入Go二进制，一键部署 |
| 流程管理 | PLM任务驱动 + SRM文档驱动 | PLM适合阶段化管理，SRM适合单据独立流转 |
| 物料架构 | 当前项目中心，渐进式演进 | 团队规模小，物料复用有限，先保持简单 |

### 4.4 API规范

- **协议**：HTTP REST
- **格式**：JSON
- **认证**：Bearer Token (JWT)
- **前缀**：`/api/v1/`
- **响应格式**：`{ code, message, data, timestamp }`

---

## 五、PLM↔SRM 数据流

### 5.1 核心联动机制

```
PLM BOM审批通过
    ↓
自动创建SRM采购项目 + 采购需求(PR)
    ↓
采购员在SRM执行：寻源→询价→下单→收货→检验
    ↓
SRM进度实时回写PLM（采购任务进度百分比）
    ↓
PLM甘特图实时展示采购进度
```

### 5.2 共享数据

| 数据 | 维护方 | 引用方 |
|------|-------|-------|
| 物料主数据 | PLM | SRM（采购需求引用） |
| BOM数据 | PLM | SRM（BOM审批触发采购） |
| 供应商 | SRM | PLM（BOM中选择供应商/制造商） |
| 采购进度 | SRM | PLM（项目任务进度展示） |

---

## 六、PRD文档索引

本文档体系包含以下模块PRD：

| 编号 | 文档 | 涵盖内容 |
|------|------|---------|
| 00 | 产品总览与系统架构（本文档） | 全局视角、用户角色、技术架构 |
| 01 | PLM-项目管理 | 项目/任务/模板/审批/甘特图/任务表单 |
| 02 | PLM-BOM管理 | BOM/物料/CMF/SKU/多类型BOM |
| 03 | PLM-ECN变更管理 | ECN流程/品类差异化/执行跟踪 |
| 04 | PLM-文档与物料库 | 文档管理、物料选型库、编码体系 |
| 05 | SRM-供应商管理 | 供应商档案/评价/8D改进 |
| 06 | SRM-采购流程 | 采购项目/需求/订单/来料检验 |
| 07 | SRM-库存与结算 | 库存管理/对账结算/通用设备 |
| 08 | AI集成与飞书 | AI员工体系/飞书SSO/审批/通知 |
| 09 | 技术架构 | 技术选型/API设计/部署/安全 |

---

## 七、版本规划

### 已完成（v1.0）
- PLM 12个核心模块
- SRM 10个核心模块
- 飞书SSO集成
- 基础审批流程

### 规划中
- [ ] 采购项目化管理（SRM Phase 2）
- [ ] 交期刚性管控 + 看板/甘特图多视图
- [ ] 物料编码体系升级（分类前缀 + 流水号）
- [ ] MPN查重 + PADS导入增强
- [ ] ECN品类差异化字段 + 执行跟踪
- [ ] 多轮打样管理 + 质量闭环
- [ ] 询价比价（RFQ）
- [ ] SRM委外加工（PCBA贴片/表面处理）
- [ ] AI员工体系（AI-OS愿景）
- [ ] 物料中心化架构演进

---

*本文档基于现有代码、已有PRD文档和MODULES.md综合整理。*
